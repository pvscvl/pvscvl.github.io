<html><head><title>Externalizing ActionScript Code (ActionScript: The Definitive Guide)</title><link rel="stylesheet" type="text/css" href="../style/style1.css" />

<meta name="DC.Creator" content="Colin Moock" /><meta name="DC.Format" content="text/xml" scheme="MIME" /><meta name="DC.Language" content="en-US" /><meta name="DC.Publisher" content="O'Reilly &amp; Associates, Inc." /><meta name="DC.Source" scheme="ISBN" content="1565928520L" /><meta name="DC.Subject.Keyword" content="stuff" /><meta name="DC.Title" content="ActionScript: The Definitive Guide" /><meta name="DC.Type" content="Text.Monograph" />

</head><body bgcolor="#ffffff">

<img alt="Book Home" border="0" src="gifs/smbanner.gif" usemap="#banner-map" /><map name="banner-map"><area shape="rect" coords="1,-2,616,66" href="index.htm" alt="ActionScript: The Definitive Guide" /><area shape="rect" coords="629,-11,726,25" href="jobjects/fsearch.htm" alt="Search this book" /></map>

<div class="navbar"><table width="684" border="0"><tr><td align="left" valign="top" width="228"><a href="ch16_06.htm"><img alt="Previous" border="0" src="../gifs/txtpreva.gif" /></a></td><td align="center" valign="top" width="228"><a href="index.htm">ActionScript: The Definitive Guide</a></td><td align="right" valign="top" width="228"><a href="ch16_08.htm"><img alt="Next" border="0" src="../gifs/txtnexta.gif" /></a></td></tr></table></div>
<hr width="684" align="left" />


<h2 class="sect1">16.7. Externalizing ActionScript Code</h2>


<p>ActionScript <a name="INDEX-2077" />code can be saved in external text files
(which use the <em class="filename">.as</em> extension by convention) or
<a name="INDEX-2078" /><em class="filename">.swf</em> files and
imported into a Flash document. By maintaining code in external
files, we facilitate the use of standard code libraries across many
projects. We can import external code into Flash using Import From
File, using the <tt class="literal">#include</tt> directive, or using a
shared library.</p>


<a name="ch16-15-fm2xml" /><div class="sect2">
<h3 class="sect2">16.7.1. Import From File (Author-Time Import)</h3>


<p>While editing a <em class="filename">.fla</em> file, we may bring code
into the Action panel's Script pane using
<a name="INDEX-2079" />Import From File, found under the
arrow button in the top-right corner of the Actions panel (see <a href="ch16_01.htm">Figure 16-1</a>). Import From File is a one-time operation
that copies the contents of the external file into the Actions panel,
<em class="emphasis">replacing</em> any script currently there. Code
imported via Import From File is not persistently linked to the
<em class="filename">.fla</em> file in any way. To append or insert script
text instead of replacing it, you need to manually cut and paste the
text from an external text-editing application.</p>
</div>




<a name="ch16-16-fm2xml" /><div class="sect2">
<h3 class="sect2">16.7.2. #include (Compile-Time Import)</h3>


<p>When <a name="INDEX-2080" />
<a name="INDEX-2081" />
<a name="INDEX-2082" />we
<a name="INDEX-2083" />
<a name="INDEX-2084" /> <a name="INDEX-2085" />export (<em class="emphasis">compile</em>) a
<em class="filename">.swf</em> file from a <em class="filename">.fla</em> file,
we may import code from an external text file using the
<tt class="literal">#include</tt> directive. For information on using
<tt class="literal">#include</tt>, see <a href="part3.htm">Part III, "Language Reference"</a>.</p>
</div>




<a name="ch16-17-fm2xml" /><div class="sect2">
<h3 class="sect2">16.7.3. Shared Library (Runtime Import)</h3>


<p>To <a name="INDEX-2086" /> <a name="INDEX-2087" />
<a name="INDEX-2088" />import code from an external source
while a movie is actually playing, we must create a shared library
<em class="filename">.swf</em> file with a movie clip containing the code
to import. Runtime import offers the most flexible approach to
sharing code across movies because it does not require recompilation
of the movies that import the shared code; when the shared library
<em class="filename">.swf</em> file is updated, the movies that link to it
automatically reflect the update.</p>


<p>The following procedures describe how to share a simple test function
from a movie called <em class="filename">codeLibrary.swf</em> to a movie
called <em class="filename">myMovie.swf</em>. We'll create the
<em class="filename">codeLibrary.swf</em> movie first:</p>


<ol><li><p>Create a new Flash document.</p></li><li><p>Create a new movie clip symbol named
<tt class="literal">sharedFunctions</tt>.</p></li><li><p>On frame 1 of the <tt class="literal">sharedFunctions</tt> clip, add the
following code:</p>
<blockquote><pre class="code">function test ( ) {
  trace("The shared function, test, was called.");
}</pre></blockquote></li>

<li><p>Select the <tt class="literal">sharedFunctions</tt> clip in the Library.</p></li><li><p>From the Library panel, select Options <img align="absmiddle" src="figs/U2192.gif" /> Linkage.</p></li><li><p>Select Export This Symbol.</p></li><li><p>In the Identifier box, type <tt class="userinput"><b>sharedFunctions</b></tt>.</p></li><li><p>Save the document as <em class="filename">codeLibrary.fla</em>.</p></li><li><p>Use File <img align="absmiddle" src="figs/U2192.gif" /> Export Movie to create
<em class="filename">codeLibrary.swf</em> from
<em class="filename">codeLibrary.fla</em>.</p></li><li><p>Close the <em class="filename">codeLibrary.swf</em> and
<em class="filename">codeLibrary.fla</em> files.</p></li></ol>
<p>Now, we'll create the <em class="filename">myMovie.swf</em> file,
which will execute the code imported from
<em class="filename">codeLibrary.swf</em>:</p>


<ol><li><p>Create a new Flash document.</p></li><li><p>Save the new document as <em class="filename">myMovie.fla</em> in the same
folder as <em class="filename">codeLibrary.fla</em>.</p></li><li><p>Rename <em class="filename">Layer 1</em> to
<em class="filename">sharedCode</em>.</p></li><li><p>Select File <img align="absmiddle" src="figs/U2192.gif" /> Open As Shared Library, and choose
<em class="filename">codeLibrary.fla</em>. The
<em class="filename">codeLibrary.fla</em> Library appears.</p></li><li><p>Drag an instance of the <tt class="literal">sharedFunctions</tt> clip from
the <em class="filename">codeLibrary.fla</em> Library onto the Stage of
frame 1 of <em class="filename">myMovie.fla</em>.</p></li><li><p>Select the instance on stage, then select Modify <img align="absmiddle" src="figs/U2192.gif" /> Instance.</p></li><li><p>Name the instance <tt class="literal">sharedFunctions</tt>.</p></li><li><p>On the main timeline of <em class="filename">myMovie.fla</em>, create a
new layer called <em class="filename">scripts</em>.</p></li><li><p>Add a keyframe to the <em class="filename">scripts</em> layer at frame 2.</p></li><li><p>Add a new frame to the <em class="filename">sharedCode</em> layer.</p></li><li><p>On frame 2 of the <em class="filename">scripts</em> layer, attach the
following code:</p>
<blockquote><pre class="code">stop( );
sharedFunctions.test( );</pre></blockquote></li>

<li><p>Export <em class="filename">myMovie.swf</em>.</p></li><li><p>The following text appears in the Output window: "The shared
function, test, was called."</p></li></ol>
<p>Note that a shared library is a linked asset, much like a
<em class="filename">.gif</em> image is linked to an
<em class="filename">.html</em> file. Shared library
<em class="filename">.swf</em> files must, therefore, always be uploaded
correctly with the files that use them. To change the location of a
link from an imported symbol to a shared library, follow these steps:</p>


<ol><li><p>Select the symbol in the Library.</p></li><li><p>From the Library panel, select Options <img align="absmiddle" src="figs/U2192.gif" /> Linkage.</p></li><li><p>Under Import This Symbol from URL, set the <a name="INDEX-2089" />new <a name="INDEX-2090" />location.</p></li></ol>
</div>


<hr width="684" align="left" />
<div class="navbar"><table width="684" border="0"><tr><td align="left" valign="top" width="228"><a href="ch16_06.htm"><img alt="Previous" border="0" src="../gifs/txtpreva.gif" /></a></td><td align="center" valign="top" width="228"><a href="index.htm"><img alt="Home" border="0" src="../gifs/txthome.gif" /></a></td><td align="right" valign="top" width="228"><a href="ch16_08.htm"><img alt="Next" border="0" src="../gifs/txtnexta.gif" /></a></td></tr><tr><td align="left" valign="top" width="228">16.6. Productivity</td><td align="center" valign="top" width="228"><a href="index/index.htm"><img alt="Book Index" border="0" src="../gifs/index.gif" /></a></td><td align="right" valign="top" width="228">16.8. Packaging Components as Smart Clips</td></tr></table></div>
<hr width="684" align="left" />

<img alt="Library Navigation Links" border="0" src="../gifs/navbar.gif" usemap="#library-map" />
<p><font size="-1"><a href="copyrght.htm">Copyright &copy; 2002</a> O'Reilly &amp; Associates. All rights reserved.</font></p>

<map name="library-map"><area href="../index.htm" coords="0,1,78,93" shape="rect" /><area href="../wdesign/index.htm" coords="80,2,155,96" shape="rect" /><area href="../xhtml/index.htm" coords="158,0,263,97" shape="rect" /><area href="../audio/index.htm" coords="265,1,335,97" shape="rect" /><area href="../css/index.htm" coords="338,1,434,93" shape="rect" /><area href="index.htm" coords="439,0,540,102" shape="rect" /><area href="../infoarch/index.htm" coords="544,0,685,102" shape="rect" /></map>

</body></html>