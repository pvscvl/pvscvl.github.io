<html><head><title>Demystifying CGI (Web Design in a Nutshell, 2nd Edition)</title><link rel="stylesheet" type="text/css" href="style/style1.css" />

<meta name="DC.Creator" content="Jennifer Niederst" /><meta name="DC.Format" content="text/xml" scheme="MIME" /><meta name="DC.Language" content="en-US" /><meta name="DC.Publisher" content="O'Reilly &amp; Associates, Inc." /><meta name="DC.Source" scheme="ISBN" content="0596001967L" /><meta name="DC.Subject.Keyword" content="stuff" /><meta name="DC.Title" content="Web Design in a Nutshell, 2nd Edition" /><meta name="DC.Type" content="Text.Monograph" />

</head><body bgcolor="#ffffff">

<img alt="Book Home" border="0" src="gifs/smbanner.gif" usemap="#banner-map" /><map name="banner-map"><area shape="rect" coords="1,-2,616,66" href="index.htm" alt="Web Design in a Nutshell" /><area shape="rect" coords="629,-11,726,25" href="jobjects/fsearch.htm" alt="Search this book" /></map>

<div class="navbar"><table cellpadding=3 width="684" border="0"><tr><td align="left" valign="top" width="228"><a href="ch15_06.htm"><img alt="Previous" border="0" src="../gifs/txtpreva.gif" /></a></td><td align="center" valign="top" width="228"><a href="index.htm">Web Design in a Nutshell, 2nd Edition</a></td><td align="right" valign="top" width="228"><a href="ch16_01.htm"><img alt="Next" border="0" src="../gifs/txtnexta.gif" /></a></td></tr></table></div>
<hr width="684" align="left" />


<h2 class="sect1">15.7. Demystifying CGI</h2>

<p><a name="INDEX-1852" /> <a name="INDEX-1853" />Today, there are
many options for processing forms on the server, such as ASP, PHP,
and Java servlets. The traditional method is to use CGI scripts.
</p>

<p>A CGI program (or script) can be written in a number of programming
languages. It doesn't matter to the server which you use, as
long as it can retrieve data and send data back. On Unix, the most
popular language is Perl, but <a name="INDEX-1854" />C, C++,<a name="INDEX-1855" /> Tcl, and
<a name="INDEX-1856" />Python are also used. On Windows,
programmers write scripts in <a name="INDEX-1857" />Visual Basic, <a name="INDEX-1858" />Perl, and C/C++. On the Mac,
AppleScript and C/C++ are common.
</p>

<p>Often designers assume that the <em class="citetitle">cgi-bin</em>
directory contains things beyond our comprehension. It's time
to look behind the curtain! Although it is true that creating Perl
and C scripts from scratch requires programming experience, you can
still take advantage of the power of scripts by using one that is
already made.
</p>

<p>Many web-hosting services offer a library of standard CGI scripts
that are already installed on their servers. In that case, all you
may need to do is point to the script from your page. Some hosting
providers also allow you to upload scripts of your own.
</p>

<p>There are a number of great resources for CGI scripts on the Web,
including scripts that process forms and send their contents in
formatted email messages. Many of them are available for free and
include exhaustive documentation that leads even a novice through the
process of customizing and installing the script on the server. Some
of the more popular CGI archives include:
</p>

<dl>
<dt><b>Matt's Script Archive</b></dt>
<dd>
<p>A collection of free and useful scripts written by Matt
<a name="INDEX-1859" />Wright
(including FormMail discussed later in this chapter) with excellent
documentation for configuring. See <a href="../../../../../../www.worldwidemart.com/scripts/">http://www.worldwidemart.com/scripts/</a>.
</p>
</dd>

</dl>

<dl>
<dt><b>The CGI Resource Index</b></dt>
<dd>
<p>A complete index of over 1200 CGI-related resources. This site is
compiled by Matt Wright of Matt's Script Archive. See
<a href="../../../../../../www.cgi-resources.com/">http://www.cgi-resources.com</a>.
</p>
</dd>

</dl>

<dl>
<dt><b>Selena <a name="INDEX-1860" />Sol's Public Domain CGI Script Archive</b></dt>
<dd>
<p>"A public service website developed out of the late-night
scripting expeditions of Selena Sol and Gunther Birznieks." See
<a href="../../../../../../www.extropia.com/Scripts/">http://www.extropia.com/Scripts/</a>.
</p>
</dd>

</dl>

<dl>
<dt><b>Freescripts.com</b></dt>
<dd>
<p>Like the name says, this is another site providing useful and free
customizable CGI scripts. See <a href="../../../../../../www.freescripts.com/">http://www.freescripts.com</a>.
</p>
</dd>

</dl>

<a name="wdnut2-CHP-15-SECT-7.1" /><div class="sect2">
<h3 class="sect2">15.7.1. Ask Your Server Administrator</h3>

<p>Because adding scripts and programs to your web site relies heavily
on your server and its configuration, you'll need to work with
your server administrator to get things set up. Before you start, you
should ask your administrator the following questions:
</p>

<ul><li>
<p><b class="emphasis-bold">Does your web site-hosting package include
access to CGI scripts?</b> Not all web site hosting services
provide access to CGI scripts and functions.
</p>
</li><li>
<p><b class="emphasis-bold">Does the server have a script available that
does what you're looking for?</b> Many web site-hosting
services have standard scripts available for their customers'
use. If there's one already installed, it may save you some
time in development.
</p>
</li><li>
<p><b class="emphasis-bold">Can you upload your own scripts to the
server?</b> Again, depending upon your arrangement for web
site-hosting, you may not be permitted to upload your own scripts to
the server, particularly if you are sharing a server with other
sites.
</p>
</li><li>
<p><b class="emphasis-bold">Do you have upload privileges to the</b>
<em class="emphasis">cgi-bin</em><b class="emphasis-bold">
directory?</b> Assuming you can upload your own scripts to the
server, you need to make sure that you have write privileges to the
directory where the scripts are stored (usually called
<em class="emphasis">cgi-bin</em>). Your administrator may need to set up
an account for you that gives you access to the directory and allows
you to make your scripts readable and executable by other users.
</p>
</li><li>
<p><b class="emphasis-bold">On what kind of server is your site hosted?
What server software is it running?</b> Scripts are usually
written to perform on a particular platform and web server software
configuration. Before you spend time customizing a script, be sure
that it can be run on your server.
</p>
</li><li>
<p><b class="emphasis-bold">What is the exact pathname to the script (once
installed)?</b> You will need to include this in the
<tt class="literal">action</tt> setting in a
<tt class="literal">&lt;form&gt;</tt>, or wherever you need to reference
the script.
</p>
</li></ul>
<p>In addition, there will usually be a few questions specific to your
chosen script that will need to be answered by your administrator.
For instance, in order to run a Perl script, the basic Perl
interpreter needs to be installed on the server. Or if you want a
script that automatically takes the contents of a form and sends it
in an email message, you may need to know the exact pathname of the
sendmail program on the server (as we'll see in the following
example). You will need to find out what names to use for the form
elements, since the CGI program will be expecting forms to use
certain names for specific data. You should also ask whether to use
the <tt class="literal">post</tt> or <tt class="literal">get</tt> method for
transmitting form information.
</p>

</div>
<a name="wdnut2-CHP-15-SECT-7.2" /><div class="sect2">
<h3 class="sect2">15.7.2. Using Available Scripts</h3>

<p>Let's take a look at the process for customizing a free script
found on one of the CGI script archives. The purpose of this tutorial
is to give you an idea of what to expect and to show that you
don't need specific programming skills to do it.
</p>

<p>In the following example, we use the <a name="INDEX-1861" />
<a name="INDEX-1862" /> <a name="INDEX-1863" /> <a name="INDEX-1864" />FormMail
script (written by Matt <a name="INDEX-1865" />Wright), which takes the contents of a form
and sends it to a specified user in a formatted email message.
Although the script in its entirety (about nine book pages worth) is
not shown here, you can easily download it from Matt's Script
Archive (<a href="../../../../../../www.worldwidemart.com/scripts/">http://www.worldwidemart.com/scripts/</a> ).
</p>

<ol><li>
<p>First, make all the necessary arrangements with your server
administrator as outlined in the previous section. You should have an
understanding of how your particular server and account handle CGI
scripts before proceeding.
</p>
</li><li>
<p>Download the script. Upon downloading, you are given the script as
well as a very complete ReadMe file that outlines, step by step, the
process for using the script. Read the documentation carefully.
</p>
</li><li>
<p>Configure the script. You may need to make changes within the script
itself to customize it for your use. Following is a sample of the
FormMail script. (Note that certain portions of this script have been
omitted where indicated for purposes of fitting it in this chapter).
</p>

<p>The FormMail program requires only three variables to be changed
(highlighted in bold type in this example):
</p>

<ul><li>
<p>The pathname of the Perl interpreter on your server (in the first
line of the script)
</p>
</li><li>
<p>The pathname of your server's sendmail program (after
<tt class="literal">$mailprog</tt> in the sample below)
</p>
</li><li>
<p>The list of domains on which you will allow forms to reside and use
your FormMail script (following <tt class="literal">@referers</tt> in the
sample below).
</p>
</li></ul>

<p>These variables are clearly explained in the ReadMe file and are
presented with labels in the beginning of the script for ease of
customization. Furthermore, each section of the script is clearly
labeled as to its function, if you are interested.
</p>

<blockquote><pre class="code">#!<b class="emphasis-bold">/usr/bin/perl</b>
########################################################################
# FormMail                        Version 1.6                          #
# Copyright 1995-1997 Matt Wright mattw@worldwidemart.com              #
# Created 06/09/95                Last Modified 05/02/97               #
# Matt's Script Archive, Inc.:    http://www.worldwidemart.com/scripts/#
########################################################################
# COPYRIGHT NOTICE                                                     #
# Copyright 1995-1997 Matthew M. Wright  All Rights Reserved.          #

[full copyright notice omitted]

########################################################################
# Define Variables                                                     #
#      Detailed Information Found In README File.                      #

# $mailprog defines the location of your sendmail program on your unix #
#           system.                                                    #

$mailprog = <b class="emphasis-bold">'/usr/lib/sendmail'</b>;

# @referers allows forms to be located only on servers which are       #
# defined in this field.  This security fix from the last version      #
# which allowed anyone on any server to use your FormMail script on    #
# their web site.                                                      #

@referers = ('<b class="emphasis-bold">worldwidemart.com</b>',<b class="emphasis-bold">'206.31.72.203'</b>);

# Done                                                                 #
########################################################################

[section omitted]

sub check_url {

   # Localize the check_referer flag which determines if user is valid.#
   local($check_referer) = 0;

   # If a referring URL was specified, for each valid referer, make    #
   # sure that a valid referring URL was passed to FormMail.          #
if ($ENV{'HTTP_REFERER'}) {
        foreach $referer (@referers) {
            if ($ENV{'HTTP_REFERER'} =~ m|https?://([^/]*)$referer|i) {
                $check_referer = 1;
                last;
            }
        }
    }
    else {
        $check_referer = 1;
    }

    # If the HTTP_REFERER was invalid, send back an error.           #
    if ($check_referer != 1) { &amp;error('bad_referer') }
}
[remaining script omitted]</pre></blockquote></li>

<li>
<p>Add mandatory controls to the form. The FormMail script relies on the
following hidden input control, which must be included in the form.
It tells the script who to mail the form results to.
</p>

<blockquote><pre class="code">&lt;INPUT TYPE=hidden NAME="recipient" VALUE="email@your.host.com"&gt;</pre></blockquote>
</li><li>
<p>Add optional controls to the form. The FormMail documentation also
provides a listing of other form controls you might include in your
form and the exact HTML for creating them. The following is an
example taken from the documentation that describes how to specify
the "subject" field of an email message generated by the
script:
</p>

<dl>
<dt><b>Field</b></dt>
<dd>
<p>subject</p>
</dd>

</dl>

<dl>
<dt><b>Description</b></dt>
<dd>
<p>The subject field allows you to specify the subject you wish to
appear in the email sent to you after this form has been filled out.
If you do not have this option turned on, the script will default to
a message subject: WWW Form Submission.
</p>
</dd>

</dl>

<dl>
<dt><b>Syntax</b></dt>
<dd>
<p>If you wish to choose what the subject is:</p>

<blockquote><pre class="code">     &lt;INPUT TYPE=hidden NAME="subject" VALUE="Your Subject"&gt;</pre></blockquote>

<p>To allow the user to choose a subject:</p>


<blockquote><pre class="code">     &lt;INPUT TYPE=text
NAME="subject"&gt;</pre></blockquote>
</dd>

</dl>
</li><li>
<p>Upload the script to the correct directory, following the
instructions of your server administrator. Be sure that you have
included the proper pathname to the script with the action
attribute<a name="INDEX-1866" />
<a name="INDEX-1867" /> in the
<a name="INDEX-1868" /> <a name="INDEX-1869" /> <a name="INDEX-1870" /><tt class="literal">&lt;form&gt;</tt><a name="INDEX-1871" /> <a name="INDEX-1872" />
tag.<a name="INDEX-1873" />
</p>
</li></ol>
</div>


<hr width="684" align="left" />
<div class="navbar"><table cellpadding=3 width="684" border="0"><tr><td align="left" valign="top" width="228"><a href="ch15_06.htm"><img alt="Previous" border="0" src="../gifs/txtpreva.gif" /></a></td><td align="center" valign="top" width="228"><a href="index.htm"><img alt="Home" border="0" src="../gifs/txthome.gif" /></a></td><td align="right" valign="top" width="228"><a href="ch16_01.htm"><img alt="Next" border="0" src="../gifs/txtnexta.gif" /></a></td></tr><tr><td align="left" valign="top" width="228">15.6. Affecting the Appearance of Forms</td><td align="center" valign="top" width="228"><a href="index/index.htm"><img alt="Book Index" border="0" src="../gifs/index.gif" /></a></td><td align="right" valign="top" width="228">16. Specifying Color in HTML</td></tr></table></div>
<hr width="684" align="left" />

<img alt="Library Navigation Links" border="0" src="../gifs/navbar.gif" usemap="#library-map" />
<p><font size="-1"><a href="copyrght.htm">Copyright &copy; 2002</a> O'Reilly &amp; Associates. All rights reserved.</font></p>

<map name="library-map"><area href="../index.htm" coords="0,0,77,93" shape="rect" /><area href="index.htm" coords="81,0,156,93" shape="rect" /><area href="../xhtml/index.htm" coords="161,0,261,102" shape="rect" /><area href="../audio/index.htm" coords="265,1,335,97" shape="rect" /><area href="../css/index.htm" coords="339,1,433,109" shape="rect" /><area href="../action/index.htm" coords="438,2,540,109" shape="rect" /><area href="../infoarch/index.htm" coords="544,0,694,104" shape="rect" /></map>

</body></html>