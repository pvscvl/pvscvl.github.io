<html><head><title>Streaming RealAudio from a web server  (Designing Web Audio)</title><link rel="stylesheet" type="text/css" href="../style/style1.css" />

<meta name="DC.Creator" content="Josh Beggs and Dylan Thede" /><meta name="DC.Format" content="text/xml" scheme="MIME" /><meta name="DC.Language" content="en-US" /><meta name="DC.Publisher" content="O'Reilly &amp; Associates, Inc." /><meta name="DC.Source" scheme="ISBN" content="1565923537L" /><meta name="DC.Subject.Keyword" content="stuff" /><meta name="DC.Title" content="Designing Web Audio" /><meta name="DC.Type" content="Text.Monograph" />

</head><body bgcolor="#ffffff">

<img alt="Book Home" border="0" src="gifs/smbanner.gif" usemap="#banner-map" /><map name="banner-map"><area shape="rect" coords="1,-2,616,66" href="index.htm" alt="Designing Web Audio" /><area shape="rect" coords="629,-11,726,25" href="jobjects/fsearch.htm" alt="Search this book" /></map>

<div class="navbar"><table width="684" border="0"><tr><td align="left" valign="top" width="228"><a href="ch06_01.htm"><img alt="Previous" border="0" src="../gifs/txtpreva.gif" /></a></td><td align="center" valign="top" width="228"><a href="index.htm">Designing Web Audio</a></td><td align="right" valign="top" width="228"><a href="ch06_03.htm"><img alt="Next" border="0" src="../gifs/txtnexta.gif" /></a></td></tr></table></div>
<hr width="684" align="left" />


<h2 class="sect1">6.2. Streaming RealAudio from a web server </h2>

<p>If you are <a name="INDEX-673" />adding streaming media to your
web site for the first time, you may wonder where to start. If you
have your own <a name="INDEX-674" />web server, your first option is to
download and install the free RealServer 5.0 or RealServer G2 basic
servers from the RealNetworks web site. For the simplest and most
cost-effective way to add streaming media to your web site without
installing RealServer, HTTP pseudo-streaming from a standard web
server is a good solution.
</p>

<p>You can serve RealMedia content from your existing web site in the
same manner that you serve JPEGs, GIFs, and HTML. However, remember
that while an ordinary web server can deliver a RealAudio clip, it
cannot fast forward the clip or compensate for network congestion.
Computer networks are not built for real-time media delivery. To
compensate, a dedicated streaming media system such as
RealNetwork's <a name="INDEX-675" />Basic Server Plus employs many
sophisticated techniques for delivering media efficiently and
robustly.
</p>

<p>Although streaming media from a web server is not as reliable as a
dedicated RealServer, it is adequate for small-scale broadcasting to
a handful of simultaneous listeners.
</p>
<blockquote><table border="1" cellpadding="6"><tr><td>
<h4 class="objtitle">Support for simultaneous streams</h4>
<p>The number of streams supported by your web server or dedicated RealServer is largely determined by your available bandwidth. Bandwidth usage of HTTP streaming is dependent on the combined bitrates of the content being streamed. Sixty simultaneous streams of 20 Kbps RealAudio clips would roughly consume the better part of a T1 line (1.2 MB out of 1.5 available).</p>
</td></tr></table></blockquote> 
<a name="sound-CHP-6-SECT-2.1" /><div class="sect2">
<h3 class="sect2">6.2.1. Pros and cons </h3>

<p>There are advantages and disadvantages to streaming audio from a web
server. HTTP pseudo-streaming, for example, is a good option for
serving RealAudio and RealVideo files on the Web without the added
management requirements and expense of server-side streaming
software. And from the developer's point of view, there's
no added work because RealAudio and RealVideo files require no
special handling for HTTP serving.
</p>

<p>One of the main disadvantages to <a name="INDEX-676" />HTTP
pseudo-streaming is that it is not well-suited for high-volume sites
serving numerous simultaneous streams. There are some important
differences, however, between the capabilities of HTTP and those of
specialized server software such as RealNetworks' RealServer
5.0. For example, you can't automatically detect the
user's modem speed using HTTP. Instead, files optimized for
each of the various connection speeds must be made available for
users to select themselves. Also, the HTTP-based approach does not
allow for live streaming audio or video presentations because
complete files must be stored on the web server before they can be
accessed.
</p>

<p>Finally, HTTP does not perform well under heavy server loads. But for
sites serving no more than a handful of simultaneous streams at any
given time, this is a great way to add streaming audio and video
features to your web site without incurring extra costs.
</p>

</div>
<a name="sound-CHP-6-SECT-2.2" /><div class="sect2">
<h3 class="sect2">6.2.2. Requirements for HTTP streaming</h3>

<p>The only requirement for <a name="INDEX-677" />HTTP
streaming is a web server configured to recognize
the<a name="INDEX-678" /> <a name="INDEX-679" /> <a name="INDEX-680" />
<a name="INDEX-681" />
<em class="emphasis">.ra</em>, <em class="emphasis">.ram</em>,
<em class="emphasis">.rm</em>,and <em class="emphasis">.rpm</em>
MIME types, which are standardized file classifications.
You or your ISP will have to define the following
<a name="INDEX-682" />MIME types for your web server:
</p>

<dl>
<dt><b><em class="filename">audio/x-pn-realaudio</em></b></dt>
<dd>
<p>Files with a .<em class="emphasis">ra</em>, .<em class="emphasis">ram</em>, or
.<em class="emphasis">rm</em> file extension
</p>
</dd><dt><b><em class="filename">audio/x-pn-realaudio-plugin</em></b></dt>
<dd>
<p>Files with a .<em class="emphasis">rpm</em> file extension</p>
</dd>

</dl>

<p>Many servers already use the appropriate MIME types. If not,
it's a relatively simple process to configure your host server
for these types, and you can request that your service provider add
this feature for you.
</p>

<p>Let's take a quick look at how to broadcast RealAudio clips
from a web server. Most popular web servers automatically support the
<em class="emphasis">.ra</em> and <em class="emphasis">.ram</em> extensions.
However, you may need to add the more recent <em class="emphasis">.rm</em>
and <em class="emphasis">.rpm</em> file extensions since many web servers
do not yet understand them. Note that many of the problems associated
with embedding the player in web pages spawn from missing or
incorrect MIME typing.
</p>

</div>
<a name="sound-CHP-6-SECT-2.3" /><div class="sect2">
<h3 class="sect2">6.2.3. HTTP streaming tutorial </h3>

<p>To prepare, upload, and broadcast your RealAudio content from a HTTP
web server, perform the following steps:<a name="INDEX-683" />
</p>

<ol><li>
<p>Plug your audio source into the "line in" on your
soundcard.
</p>
</li><li>
<p>Start a basic sound recording and editing application such as
SoundForge, CoolEdit, or SoundEdit 16. Open the record window and
make sure you are getting an incoming signal (green LEDs should be
flashing up and down). Even though it's possible to record
directly into the
<a name="INDEX-684" />RealEncoder 5.0, you get better
results with a standalone recording application that has editing
capabilities. To enhance your sound file, remove unwanted noises and
silence at the beginning of a track, add fade-ins and fade-outs, and
normalize the sound file before converting it to a RealAudio clip.
</p>
</li><li>
<p>Bring up a volume control window and adjust the amplitude gain for
optimum recording levels. Try a few short tests to make sure the
input gain is not too low or too high. If the input gain is set too
high (if the meters peak into the red), you are likely to get
distortion. If they are too low, you will get more system noise and
dull-sounding files. When you are satisfied with the recording level
settings, click Record.
</p>
</li><li>
<p>Optimize and edit your file as mentioned in step 2 and save it as a
WAV file. Refer to <a href="ch04_01.htm">Chapter 4, "Optimizing Your Sound Files"</a> for more in-depth
information about file optimization and editing techniques.
</p>
</li><li>
<p>Start the <a name="INDEX-685" />RealEncoder 5.0
application and select File <img height="15" alt="Figure 6.2.3" src="figs/U2192.gif" width="19" /> New Session, as shown in <a href="ch06_02.htm">Figure 6-5</a>. An <a name="INDEX-686" />Advanced Mode dialog window
will appear, asking you to specify input and output settings. Under
input settings, you will need to specify whether you are encoding a
live signal or a prerecorded sound file. For the output settings, you
will need to specify the various codecs for different bandwidths that
you want. If you are not sure which settings to choose, try the
step-by-step Wizard Mode guide accessible from the dialog box.
</p>

<a name="sound-CHP-6-FIG-5" /><div class="figure"><img height="310" alt="Figure 6-5" src="figs/aud.0605.gif" width="399" /></div><h4 class="objtitle">Figure 6-5. In RealEncoder's Advanced Mode window, you specify whether you are encoding a live signal or a prerecorded sound file.</h4>
</li><li>
<p>Consider <a name="INDEX-687" />backwards compatibility. Even with
the release of RealSystem G2, many listeners still use
<a name="INDEX-688" />RealPlayer
version 3.0 or lower. If a lot of your listeners are using older
players, download a "legacy" 3.0 RealEncoder from the
<a name="INDEX-689" />RealNetworks DevZone and create an 8
Kbps encoded <em class="filename">.ra</em> file. Then create an additional
hyperlink on your web page to the alternative<a name="INDEX-690" /> .<em class="emphasis">ra</em> file
that's compatible with older RealPlayers.
</p>

<p>You might also want to include a third link to a high fidelity file
encoded with the new G2 RealProducer encoder for listeners with
high-speed connections.
</p>

<p>Under Input Source, select File to import your audio file. If you do
not have a sound editor for recording, you can capture an audio input
signal directly into the RealEncoder 5.0 by selecting Media Device
and Capture Audio as shown in <a href="ch06_02.htm">Figure 6-6</a>.
</p>

<a name="sound-CHP-6-FIG-6" /><div class="figure"><img height="310" alt="Figure 6-6" src="figs/aud.0606.gif" width="399" /></div><h4 class="objtitle">Figure 6-6. Select Media Device and check Capture Audio to capture an audio signal directly to RealEncoder.</h4>
</li>
<li>
<p>Under Output Source, select RealMedia File then hit OK. A dialog box
will appear asking you to specify a codec, the Media Clip
Information, and checkboxes for Mobile Download and Selective
Recording as shown in <a href="ch06_02.htm">Figure 6-7</a>. Mobile Download
enables users to download audio clips in a format suitable for
playback over an alternative mobile playback device.Selective Recording allows users to record
and download audio clips to their desktop.
</p>

<a name="sound-CHP-6-FIG-7" /><div class="figure"><img height="310" alt="Figure 6-7" src="figs/aud.0607.gif" width="400" /></div><h4 class="objtitle">Figure 6-7. The RealMedia Output dialog box</h4>
</li>
<li>
<p>After you have selected a good all-purpose codec such as Audio 28.8
Voice, click on Start, and the RealEncoder will be converted your
audio file into a RealMedia file named
<em class="emphasis">yourfilename.rm</em>. At this point, you should see
the green LED lights. The LED amplitude meter should not trigger the
red peak light indicator at the top of the graph. If the signal peaks
up in the red zone, go back to the original file and use a sound
editor to reduce the amplitude peak before encoding. When the encoder
is finished converting your file, you'll see the message
"Encoding Complete."
</p>
</li><li>
<p>Use a text editor (such as Notepad or Simple Text) to create a
metafile ( <em class="emphasis">yourfilename.ram</em>) containing a link
to the RealAudio/RealVideo file (
<em class="emphasis">yourfilename.rm</em>). A metafile is a simple text
document containing a URL that points to the RealMedia file. The
contents of the file will look like this:
</p>

<blockquote><pre class="code">http://www.hostname.com/yourfilename.rm</pre></blockquote>
</li>
<li>
<p>On your web page, create a hyperlink to the metafile. The code should
look like this:
</p>

<blockquote><pre class="code">&lt;A HREF="yourfilename.ram"&gt;</pre></blockquote>

<p>If you want to use absolute paths, you must include both the hostname
and the complete path. For example:
</p>

<blockquote><pre class="code">&lt;A HREF="http://www.hostname.com/yourfilename.ram"&gt;</pre></blockquote>
</li>
<li>
<p>Upload the both the <em class="emphasis">.ram</em> file and the
<em class="emphasis">.rm</em> file, along with the new HTML page, to the
web server, and you should be up and running with <a name="INDEX-691" />a sound-enhanced
web <a name="INDEX-692" />site.
</p>
</li></ol>
<a name="sound-CHP-6-SIDEBAR-5" /><blockquote><table border="1" cellpadding="6"><tr><td>
<h4 class="objtitle">All things audio</h4>
&nbsp;
<p>Exactly on the hour, a lone SGI Challenge computer in the middle of
Washington, D.C., opens its audio input port, receives a five-minute
live news update, converts the audio signal to the appropriate
format, sends the file to the RealServer, and then streams it across
the globe without the touch of a human hand.
</p>
&nbsp;
<p>For <a name="INDEX-693" />National Public Radio's
webmaster, Robert Holt, processing and encoding NPR's daily
programming is one of the greatest challenges of broadcasting
RealAudio content. Robert created a custom Unix script to automate
the entire RealAudio conversion and streaming process for NPR's
hourly news update.
</p>
&nbsp;
<p>At 55 minutes after the hour, NPR's SGI Indy machine runs a
time query that syncs the machine's internal clock with
NPR's master clock. Then, at exactly one minute past the hour,
the SGI opens its built-in audio port and records a five-minute live
feed from NPR's broadcast sound studio. At seven past the hour,
the SGI computer converts the five-minute AIFF file to a WAV file. A
script then commands the RealEncoder to encode the file and place a
time and date stamp into the <em class="emphasis">.ra</em> file. Finally,
the script copies the file through a firewall to NPR's
RealServer, replacing the previous five-minute news update file.
<a name="INDEX-694" />
</p>
&nbsp;
<p>NPR's system configuration is a dedicated audio server
consisting of a RealServer 5.0 running on a Sun Sparc 20 and Netscape
Enterpriseweb server software
running on an SGI Origin 200 server<b class="emphasis-bold">.</b>
The system includes 128 MB of RAM to ensure enough memory
for NPR's thousand-stream license, and a 10 GB hard drive to
hold NPR's RealAudio content. NPR has a partial T3 connection
(equivalent of five T1 lines) to the Internet.
</p>
&nbsp;
<p>Installing the system was a simple process for Robert: "For the
most part, installing the RealServer is a just a matter of
configuring your MIME types and going through the automatic
installation process." And there was little trouble keeping the
system running smoothly. In fact, the hardest part about maintaining
the RealAudio System is not the server but the content.
"It's easy to get the system up and working. The hard
part is feeding the beast new content and retooling your audio files
with the newest codecs."
</p>
&nbsp;
<p>Robert works as part of a three-person team, editing, encoding, and
administering the delivery of over five hours of daily programming,
in addition to the five-minute hourly news update. Since the
installation of NPR's RealServer in 1995, Robert has edited,
processed, and served many RealAudio files. Here are some of his tips
for getting quality results from RealAudio:
</p>
&nbsp;
<ul><li>
<p>Use the highest-quality source audio files you can get. Internet
compression algorithms, especially higher-bandwidth 40 and 80 Kbps
codecs magnify mistakes or glitches in the original recording. NPR is
fortunate enough to use source files that have been recorded in their
custom $150,000 broadcast studio, with top-of-the-line
<a name="INDEX-695" />Neumann condenser microphones. All the
audio is recorded from the very beginning with the proper
equalization and compression. Note that even if you do not have a
deluxe studio, there are steps you can take to capture high-quality
source material. See <a href="ch03_01.htm">Chapter 3, "Capturing Original Source Material"</a> and <a href="ch04_01.htm">Chapter 4, "Optimizing Your Sound Files"</a> for more information.
</p>
</li>
&nbsp;
<li>
<p>Make sure you have plenty of <a name="INDEX-696" />disk space for all of your content. An
hour of content encoded with the RealAudio 28.8 algorithm fills 8 MB.
All your programming, especially if you keep archives on disk, can
quickly add up to a huge amount of disk space.
</p>
</li>
&nbsp;
<li>
<p>Make sure your connection to the Internet is stable and that you are
using a high-quality Internet Service Provider. Call your
<a name="INDEX-697" /> <a name="INDEX-698" />ISP and check the data throughput
with a program such as Net Medic.
</p>
</li>
&nbsp;
<li>
<p>Make sure your ISP has enough bandwidth to deliver all your streams.
One of the most common problems with the RealAudio System is not the
system performance or the CPU speed, but inadequate bandwidth.
Typically,
<a name="INDEX-699" />bandwidth on the
Internet router gets swallowed up first. There is not much you can do
about that, but you can make sure your connection to the Internet is
big enough to meet your needs.
</p>
</li>
&nbsp;
<li>
<p>If you are broadcasting from your own in-house server, always watch
system performance. Keep an eye on CPU usage and keep the load
balanced between two <a name="INDEX-700" />servers. Always pay attention to
memory and system speed.
</p>
</li></ul>
</td></tr></table></blockquote>

</div>


<hr width="684" align="left" />
<div class="navbar"><table width="684" border="0"><tr><td align="left" valign="top" width="228"><a href="ch06_01.htm"><img alt="Previous" border="0" src="../gifs/txtpreva.gif" /></a></td><td align="center" valign="top" width="228"><a href="index.htm"><img alt="Home" border="0" src="../gifs/txthome.gif" /></a></td><td align="right" valign="top" width="228"><a href="ch06_03.htm"><img alt="Next" border="0" src="../gifs/txtnexta.gif" /></a></td></tr><tr><td align="left" valign="top" width="228">6. Encoding, Serving, and Streaming Sound with RealAudio</td><td align="center" valign="top" width="228"><a href="index/index.htm"><img alt="Book Index" border="0" src="../gifs/index.gif" /></a></td><td align="right" valign="top" width="228">6.3. Professional webcasting </td></tr></table></div>
<hr width="684" align="left" />

<img alt="Library Navigation Links" border="0" src="../gifs/navbar.gif" usemap="#library-map" />
<p><font size="-1"><a href="copyrght.htm">Copyright &copy; 2002</a> O'Reilly &amp; Associates. All rights reserved.</font></p>

<map name="library-map"><area href="../index.htm" coords="0,1,78,93" shape="rect" /><area href="../wdesign/index.htm" coords="80,2,155,96" shape="rect" /><area href="../xhtml/index.htm" coords="158,0,263,97" shape="rect" /><area href="index.htm" coords="265,1,335,97" shape="rect" /><area href="../css/index.htm" coords="338,1,434,93" shape="rect" /><area href="../action/index.htm" coords="439,0,540,102" shape="rect" /><area href="../infoarch/index.htm" coords="544,0,685,102" shape="rect" /></map>

</body></html>