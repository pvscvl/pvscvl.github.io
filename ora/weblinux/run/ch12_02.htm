<?label 12.2. Sharing Programs?><html><head><title>Sharing Programs (Running Linux)</title><link href="../style/style1.css" type="text/css" rel="stylesheet" />

<meta name="DC.Creator" content="" /><meta scheme="MIME" content="text/xml" name="DC.Format" /><meta content="en-US" name="DC.Language" /><meta content="O'Reilly & Associates, Inc." name="DC.Publisher" /><meta scheme="ISBN" name="DC.Source" content="" /><meta name="DC.Subject.Keyword" content="stuff" /><meta name="DC.Title" content="" /><meta content="Text.Monograph" name="DC.Type" />

</head><body bgcolor="#ffffff">

<img src="gifs/smbanner.gif" alt="Book Home" usemap="#banner-map" border="0" /><map name="banner-map"><area alt="Running Linux" href="index.htm" coords="0,0,466,65" shape="rect" /><area alt="Search this book" href="jobjects/fsearch.htm" coords="467,0,514,18" shape="rect" /></map>

<div class="navbar"><table border="0" width="515"><tr><td width="172" valign="top" align="left"><a href="ch12_01.htm"><img src="../gifs/txtpreva.gif" alt="Previous" border="0" /></a></td><td width="171" valign="top" align="center"><a href="index.htm" /></td><td width="172" valign="top" align="right"><a href="ch13_01.htm"><img src="../gifs/txtnexta.gif" alt="Next" border="0" /></a></td></tr></table></div>
<hr align="left" width="515" />


<h2 class="sect1">12.2. Sharing Programs</h2>

<p><a name="INDEX-2560" />
<a name="INDEX-2561" />
<a name="INDEX-2562" />
<a name="INDEX-2563" />
<a name="INDEX-2564" />
The most popular non-Linux operating systems where compatibility is
important--where people want to run its programs and files on
Linux--are derivates of <span class="acronym">DOS</span>:
<span class="acronym">MS-DOS</span>,
<span class="acronym">PC-DOS</span>, Novell <span class="acronym">DOS</span>, and Windows
3.1 and later.  You can use the Linux MTools package to search
<span class="acronym">DOS</span> filesystems, read and copy files, and write to
a <span class="acronym">DOS</span> filesystem.  Still, compatibility with
<span class="acronym">DOS</span> obviously requires a lot more than handling a
<span class="acronym">DOS</span> filesystem.</p>

<p><a name="INDEX-2565" />
<a name="INDEX-2566" />
<a name="INDEX-2567" />
There are two packages intended to provide Linux with the desired
<span class="acronym">DOS</span> compatibility.  One is Dosemu and the other is
Wine.  We discuss them both in this chapter because of their
importance to the Linux community.</p>

<p>It should be noted, though, that neither Dosemu nor Wine are finished
products. While both development teams have made amazing progress,
given the difficulty of their task, you should use them currently only if you are 
willing to fiddle around with them, trying to reconfigure things, and
perhaps even trying to find and fix bugs. If you'd rather try a
<a name="INDEX-2568" />
finished, commercial product, you can buy WABI (Windows Application
Binary Interface) from Caldera, Inc., which is a port of the same
product for Solaris and is quite stable, but it can run only Windows
3.1
<?troff \p?> programs.</p>

<p>Another remark: Two years ago, binary emulators like Dosemu and Wine
were of utmost importance to the Linux community, because there was
not much commercial software available. This situation has utterly
changed, however. Many commercial software vendors are providing their 
products for Linux now, so you might be able to get what you want
without running an emulator. Remember that emulation takes its toll;
no emulated program can be faster or more stable than a native one.</p>

<p>Recently, new life was breathed into Wine because Corel
announced that they would port their products (like CorelDRAW) to
Linux by means of Wine, that is, they would support the further
development of Wine. This is a notable acceptance of the outstanding
work of the Wine team, but it remains to be seen whether these plans
will be successful.</p>

<p>The development teams working on Dosemu and Wine are delighted to
encourage more developers to pitch in and help, but if you are simply
an end user, or a programmer with no access to the Internet and
thus no ready access to the developer community, these packages may
not be right for you.</p>

<p><a name="INDEX-2569" />
<a name="INDEX-2570" />
There are also emulators for the Apple II and <span class="acronym">CP/M</span>
operating systems, as well as many other machines long forgotten by
most users. They originally were run on other operating 
systems (such as <span class="acronym">MS-DOS</span>) and have now been ported
to Linux.  You can get them from the usual Linux
<span class="acronym">FTP</span> sites that archive the emulator software, which
are primarily ftp://ftp.metalab.unc.edu
and its mirror sites in the path
<em class="filename">/pub/Linux/system/emulators</em>.</p>

<p><a name="INDEX-2571" />
A demo of a commercial (but low-priced) Macintosh emulator is also
available from <a href="../../../../../../www.ardi.com/">http://www.ardi.com</a> called
Executor/Linux. This is a Linux version of a package that has been
offered for several years on NeXT machines, and for more than a year on
<span class="acronym">DOS</span> machines.  You might try it if only to gain the
ability to read and write Mac floppy and <span class="acronym">SCSI</span> disk
formats, which the demo package provides.  (The developers of this
product have announced that they will release the source code for
their Mac file browser to the public.)</p>

<p>If you want to keep up with developments on 
Executor/Linux, send mail to majordomo@nacm.com with nothing 
in the <tt class="literal">Subject:</tt> field, and with the message text
<tt class="literal">subscribe executor</tt>.</p>

<a name="x-100-3-sec-windows-dosemu" /><div class="sect2">
<h3 class="sect2">12.2.1. DOS Emulators: Dosemu and xdos</h3>

<p><a name="INDEX-2572" />
<a name="INDEX-2573" />
<a name="INDEX-2574" />
<a name="INDEX-2575" />
First, we should make it clear that Linux's
"<span class="acronym">DOS</span> emulators," the Dosemu and
<tt class="command">xdos</tt> packages, aren't really emulators.  They can
be considered virtual machines that allow <span class="acronym">DOS</span> and
applications running on <span class="acronym">DOS</span> to execute in real mode
(virtual 8086 mode) in a "compatibility box" environment
similar to the operation of <span class="acronym">DOS</span> on a standard Intel
80286 or 80386.  Because a necessary element of the compatibility box
is the virtual 8086, only chipsets that implement the Intel real mode
will ever have Dosemu or <tt class="command">xdos</tt> ported to them.
<tt class="command">xdos</tt> is just a convenient wrapper for Dosemu that
lets you run it in an X window, so for this discussion we'll
focus primarily on Dosemu.</p>

<p><a name="INDEX-2576" />
You should have 8 MB of <span class="acronym">RAM</span> to use Dosemu, and it
would be wise to also have a 12 MB swap partition set up on the hard
disk.
<a name="INDEX-2577" />
<a name="INDEX-2578" /></p>

<p><a name="INDEX-2579" />
Dosemu emulates the <span class="acronym">BIOS</span>, <span class="acronym">CMOS</span>
memory, <span class="acronym">XMS</span> and <span class="acronym">EMS</span> memory, disk
services, keyboard, serial devices and printer, and other necessary
machine functions, letting <span class="acronym">DOS</span> work in this
controlled environment.  Dosemu requires that you have a (licensed)
copy of either OpenDOS (formerly known as <span class="acronym">DR-DOS</span>)
or <span class="acronym">MS-DOS</span> 6.22, but other versions might work as
well. Since OpenDOS is freely available, it is preferred by the Dosemu 
developers.</p>

<p><a name="INDEX-2580" />
<a name="INDEX-2581" />
Dosemu tries to trap <span class="acronym">DOS</span> and BIOS system calls and handle them in
Linux, but it isn't always successful in doing this. 
<span class="acronym">DOS</span> BIOS 
printer services are emulated with Unix file I/O,
with the output 
intended for a printer spooled to a corresponding Linux file.  Dosemu
has problems with mouse support for some mice, particularly 
busmouse systems.</p>

<p>We don't encourage you to use Dosemu unless you are willing and able 
to contribute to the further development of the package and have Internet
access to work with the development team.  However, Dosemu appears to be
useful enough and stable enough to justify discussing it as a
package you should consider installing.  You should be aware, though, that the development of 
documentation for Dosemu lags behind the development of software.  If 
you aren't involved in Dosemu development, you may find it difficult to 
use new features; they may not be that safe anyhow.</p>

<p>More recent versions of Dosemu include some functions originally
developed as part of Carnegie Mellon University's <span class="acronym">DOS</span> emulator for Mach,
so Dosemu distributions include the nonrestrictive
<span class="acronym">CMU</span> copyright notice.  This notice asks that
developers who build software using <span class="acronym">CMU</span>'s
work provide a copy of their work to <span class="acronym">CMU</span> and allow
<span class="acronym">CMU</span> the right to use
and redistribute it.  (The copyright notice <em class="emphasis">requires</em> that their 
notice be reproduced and included in any distribution that uses their 
software, whether or not their code is modified.)  You should honor 
CMU's copyright, so if you will participate in developing Dosemu, be
sure to read and observe its copyright notice.</p>

<p>The Dosemu package includes scripts and utilities to install and 
maintain the package.  Dosemu is updated weekly, and each distribution 
includes a list of software known to run (or not to run) with the current 
release of the package.</p>

<a name="INDEX-2582" />
</div>




<div class="sect2">
<h3 class="sect2">12.2.2. Getting Dosemu and xdos</h3>

<p><a name="INDEX-2583" />
<a name="INDEX-2584" />
<a name="INDEX-2585" />
The <span class="acronym">FTP</span> site guaranteed to maintain the latest public version of the 
Dosemu package is ftp://tsx-11.mit.edu.
The files can be found in the <em class="filename">/pub/linux/ALPHA/dosemu</em> 
directory.  ("Alpha" refers to the state of development of the 
application, not to a distribution for Alpha architecture Linux.)
This includes the most recent documentation files.</p>

<p>Dosemu does not itself support compressed filesystems, but you can use 
a special driver in the Linux kernel that can mount compressed
filesystems and then access those mounted filesystems from within Dosemu.</p>

<a name="INDEX-2586" />
</div>




<div class="sect2">
<h3 class="sect2">12.2.3. Installing and Configuring Dosemu</h3>

<p><a name="INDEX-2587" />
<a name="INDEX-2588" />
<a name="INDEX-2589" />
<a name="INDEX-2590" />
<a name="INDEX-2591" />

Before you install the Dosemu package, you must first compile the
Linux kernel with IPC (System V InterProcess Communication
facilities).  If you did not build Linux with IPC during the
configuration process when installing Linux, you will have
to rebuild the kernel to add the facilities before installing Dosemu,
which uses System V-shared memory.  We strongly recommend that you use
a current release of Linux as a basis for running Dosemu and compile
Dosemu with a current <tt class="command">gcc</tt> compiler and libraries.
Linux 2.0.28/2.1.15 and later include the needed kernel support for Dosemu.</p>

<?troff .sp -.2?><p>You must have <tt class="command">gcc</tt> Version 2.7.2 and
<tt class="command">libc</tt> Version 5.4.7 or later for this version of Dosemu.  Later 
versions of Dosemu may require later versions of Linux,
<tt class="command">gcc</tt>, and C libraries.</p>

<p>Boot Linux and login as root.  
Place the Dosemu package in the / root directory and unpack it.  (The Dosemu package name may
vary from this example, whose name reflects our downloading the file
via <span class="acronym">DOS</span> before copying it into the Linux filesystem):
<blockquote><pre class="code"># <tt class="userinput"><b>gunzip dosemu-0.98.4.tgz</b></tt> 
# <tt class="userinput"><b>tar -xvf dosemu-0.98.4.tar</b></tt></pre></blockquote>

The files unpack into the directory
<em class="filename">dosemu-0.98.4</em> and its subdirectories.</p>

<p><a name="INDEX-2592" />
Now read the documentation. A Dosemu <span class="acronym">HOWTO</span> file comes with the
distribution package in the <em class="filename">/dosemu-0.98.4/doc</em> directory.  Also
read the file <em class="filename">QuickStart</em> that comes with the distribution. A script <em class="filename">ViewDocs</em> provided with Dosemu lets you view
the documentation comfortably.</p>

<p><a name="INDEX-2593" />
A file named 
<em class="filename">DANG</em> (Dosemu Novice's Altering Guide)
contains notes for customizing source code.  This file is extracted automatically
from the source code itself, at each release.  Additionally,
the <tt class="command">dos(1)</tt> manual page describes the state of the <tt class="command">dos</tt> 
command for your version of Dosemu.  There is a Texinfo 
document for Dosemu (<em class="filename">dosemu.texinfo</em>) that lags well behind 
the current state of development of the package.  It contains 
information useful in preparing to install the Dosemu package.</p>

<p>If you need to rebuild your kernel to add IPC and DOS filesystem
      support and to install a kernel patch, do it now.</p>

<p>Still as <b class="emphasis-bold">root</b>, go to the <em class="filename">dosemu-0.98.4</em> directory and verify
that the distribution Makefile exists there.  Enter the commands:</p>

<blockquote><pre class="code"># <tt class="userinput"><b>make</b></tt>
# <tt class="userinput"><b>make install</b></tt></pre></blockquote>

<p>You can now try your newly installed Dosemu with a
		tiny provided FreeDOS image by issuing:</p>

<blockquote><pre class="code"># <tt class="userinput"><b>./first-test</b></tt>
C:&gt; <tt class="userinput"><b>exitemu</b></tt></pre></blockquote>

<p>If this works for you, your Dosemu is probably
		built correctly.</p>

<p>Next, you will have to copy and edit some configuration
		files:</p>

<ul><li><p><a name="INDEX-2594" />
<a name="INDEX-2595" />
Copy the file <em class="filename">etc/dosemu.conf</em>
			to <em class="filename">/etc/dosemu.conf</em> and modify this
			file according to the documentation. Be sure to read the
			documentation, especially the file
			<em class="filename">doc/README.txt</em> to do this. You might
			also want to leave it as it is for now and come back here
			once you have gotten a little bit more feel for
			Dosemu.</p></li><li><p>Depending on your security needs, copy either
			<em class="filename">etc/dosemu.users.easy</em> or
			<em class="filename">etc/dosemu.users.secure</em> to
			<em class="filename">/etc/dosemu.users</em> and edit this file
			according to your needs.</p></li></ul><p>Next, you need to create a <span class="acronym">DOS</span> boot
		image. If you have a contemporary version of the MTools
		package (Version 3.8 or newer) and a bootable
		<span class="acronym">DOS</span> partition or <span class="acronym">DOS</span>
		boot floppy, you can run the program
<a name="INDEX-2596" />
		<em class="filename">setup-hdimage</em> provided with the Dosemu
		distribution as in the following example:</p>

<blockquote><pre class="code">tigger: # <tt class="userinput"><b>./setup-hdimage</b></tt>
checking your partitions, wait...
...done
I've seen the following DOS partitions (perhaps non-bootable):

     /dev/sdc1

If none of them are valid, you can continue any way using a bootable
floppy as input. Which one do you want to use as input?
Type in the full device name or ENTER to cancel

<tt class="userinput"><b>/dev/fd0</b></tt>

A normal MSDOS system has command.com as shell.
If you have a different one, please enter the name,
else just type ENTER



We now try to generate a bootable hdimage into /var/lib/dosemu/
hdimage.first and are calling ./dexe/mkdexe for this.

You will be prompted to edit the configuration files
(config.sys, autoexec.bat e.t.c).

Enter the name of your favorite editor, if you type just ENTER, the
editor given via the EDITOR environment variable will be used.


Starting ...
System type is IBMorOpenDos. sysfiles: ibmbio.com, ibmdos.com, command.com
1+0 records in
1+0 records out
Cannot create entry named . or ..

Skipping "config.sys", is not a directory

Skipping "autoexec.bat", is not a directory
 ... done</pre></blockquote>

<p>In this case, we use a bootable OpenDOS floppy disk. If
		everything goes well, the file
		<em class="filename">/var/lib/dosemu/hdimage.first</em> should 
		be generated and contain your DOS boot image. If there are
		problems, you might need to use the old method of creating a
		boot image; see the file
		<em class="filename">doc/README-tech.txt</em>, section 7, in the
		Dosemu distribution.</p>

<p>Next, check that there is a line like:</p>

<blockquote><pre class="code">$_hdimage = "hdimage.first"</pre></blockquote>

<p>in your <em class="filename">/etc/dosemu.conf</em>. There can 
		be more than one image file present here, but
		<em class="filename">hdimage.first</em> should be the first one
		mentioned.</p>

<p>Now you are ready to start your Dosemu with:</p>

<blockquote><pre class="code">dosemu -C</pre></blockquote>

<p>Dosemu should come up with something like:</p>

<blockquote><pre class="code">Linux DOS emulator 0.98.4.0 $Date: 2001/06/18 18:18:10 $
Last configured at Mon Mar 22 13:05:19 CET 1999 on linux
This is work in progress.
Please test against a recent version before reporting bugs and problems.
Bugs, Patches &amp; New Code to linux-msdos@vger.rutgers.edu


Starting DOS...

[Host File System] drive D: is directory /
[dosemu EMS 4.0 driver installed]

Caldera OpenDOS 7.01
Copyright (c) 1976, 1997 Caldera, Inc.
All rights reserved.

"Welcome to dosemu 0.98!"
C:\&gt;</pre></blockquote>

<p>Now you are ready to try your <span class="acronym">DOS</span>
		emulator. Be sure to read the documentation to see the many
		possibilities of configuring Dosemu. By editing
		<em class="filename">/etc/dosemu.conf</em>, you can quickly solve
		problems that occur with specific <span class="acronym">DOS</span>
		software, terminal modes, sound system support, and the
		like. You can add pointers to additional
		<span class="acronym">DOS</span> directories on hard disks. When you are 
		done working with Dosemu, you can exit it with:</p>

<blockquote><pre class="code">C:\&gt; exitemu</pre></blockquote>

<p>If you want to start Dosemu in an X window of its own,
		you can run the program <tt class="command">xdos</tt> instead. You
		might need to execute:</p>

<blockquote><pre class="code">xset fp rehash</pre></blockquote>

<p>first to make the newly installed <span class="acronym">DOS</span> 
		fonts available.</p>

<p>If you are adventurous, you can now even try to run Windows 3.x in real
mode by installing it into your <span class="acronym">DOS</span> hard-disk image 
and then typing: 
<blockquote><pre class="code">win /r</pre></blockquote></p>

<a name="INDEX-2597" /><a name="INDEX-2598" /><a name="INDEX-2599" /><a name="INDEX-2600" />
</div>




<?troff .wcon_off?><div class="sect2">
<h3 class="sect2">12.2.4. Windows Emulation: Wine</h3>

<p><a name="INDEX-2601" />
<a name="INDEX-2602" />
<a name="INDEX-2603" />
Wine is the most ambitious <span class="acronym">DOS</span>/Windows
compatibility package, and it bears tremendous potential value to the
Linux community.  Wine is inspired by <span class="acronym">WABI</span>, which
originally was developed by Sun Microsystems to allow Microsoft
Windows packages to run directly on Solaris.
<span class="acronym">WABI</span> has been licensed by Sun to other System V
ports to the Intel PC, and a <span class="acronym">WABI</span> development group
comprised of several Unix vendors guides further the
development of <span class="acronym">WABI</span>.  No Linux vendor that we are
aware of is a member of the
<span class="acronym">WABI</span> development group.  However, Caldera has
licensed <span class="acronym">WABI</span> from SunSoft. The
<span class="acronym">WABI</span> specifications are made available to the
public, and the Linux Dosemu team has applied them
to the Wine development effort.  Wine is being developed for Linux,
NetBSD, and FreeBSD at this time, and the first commercial 
support has been announced by Corel.</p>

<p><a name="INDEX-2604" />
<a name="INDEX-2605" />
<a name="INDEX-2606" />
You need at least 16 MB of <span class="acronym">RAM</span> to use Wine, and at
least a 32 MB swap partition set up on the hard disk.</p>

<p>Wine consists primarily of a program loader that 
loads and executes 16-bit MS Windows application binaries and 
an emulation library that translates calls to MS Windows functions 
and translates them into Linux and X Window System function calls.  As 
the Wine <span class="acronym">FAQ</span> notes, Wine means either "WINdows Emulator, or Wine 
Is Not an Emulator.  Both are right." When Wine is fully developed, 
most Windows applications will run under Wine in the Linux/X 
environment and will run about as fast under Wine as they do 
under windows.  Maybe faster.  A Linux-supported graphics coprocessor 
makes the X Window System perform a lot better and 
therefore makes a big difference to Wine performance.</p>

<p>At the time of this writing, Wine support for the
Win32 ABI (used by 32-bit Windows 95 and NT applications) is
progressing. Ultimately, Wine developers hope that it will
be able to run both 16- and 32-bit Windows applications.</p>

<p>Wine is
filesystem independent and can be used on any Linux (or
Unix) filesystem.  You must use the X Window
System to run Wine; Wine is invoked from a window opened by your
favorite Linux window manager:

<blockquote><pre class="code">wine /<em class="replaceable">pathname</em>/<em class="replaceable">winapp.exe</em></pre></blockquote>


where <em class="replaceable">pathname</em> is either a Linux- or a
<span class="acronym">DOS</span>-style pathname and
<em class="replaceable">winapp.exe</em> is a Windows-based executable.</p>

<p>We can't encourage you to use Wine at this time unless you are a programmer who
will contribute to the further development of this ambitious package.
Wine is very much in alpha-stage development.  As of this writing, 
Wine does not implement all of the MS-Windows application 
programming interface (<span class="acronym">API</span>) functions.
Because we think you won't be able to use Wine effectively at this stage
unless you are a programmer with Internet access who can contribute to
the project, we don't discuss how to install and configure
Wine.</p>

<p>If you want to join the Wine developers team or are just looking for
more
<?troff \p?> information, your best bet is to check the Wine Headquarters web
site at <a href="../../../../../../www.winehq.com/">http://www.winehq.com</a>; this is 
also where you can download the most current version of Wine.</p>

<a name="INDEX-2607" /><a name="INDEX-2608" /><a name="INDEX-2609" />
</div>




<a name="INDEX-2610" /><a name="INDEX-2611" /><a name="INDEX-2612" /><a name="INDEX-2613" /><a name="INDEX-2614" /><a name="INDEX-2615" />


<hr align="left" width="515" />
<div class="navbar"><table border="0" width="515"><tr><td width="172" valign="top" align="left"><a href="ch12_01.htm"><img src="../gifs/txtpreva.gif" alt="Previous" border="0" /></a></td><td width="171" valign="top" align="center"><a href="index.htm"><img src="../gifs/txthome.gif" alt="Home" border="0" /></a></td><td width="172" valign="top" align="right"><a href="ch13_01.htm"><img src="../gifs/txtnexta.gif" alt="Next" border="0" /></a></td></tr><tr><td width="172" valign="top" align="left">12. Windows
 Compatibility
 and Samba</td><td width="171" valign="top" align="center"><a href="index/index.htm"><img src="../gifs/index.gif" alt="Book Index" border="0" /></a></td><td width="172" valign="top" align="right">13. Programming
 Languages</td></tr></table></div>
<hr align="left" width="515" />

<img src="../gifs/navbar.gif" alt="Library Navigation Links" usemap="#library-map" border="0" />
<p><font size="-1"><a href="copyrght.htm">Copyright &copy; 2001</a> O'Reilly &amp; Associates. All rights reserved.</font></p>

<map name="library-map"><area href="../index.htm" coords="1,1,83,102" shape="rect" /><area href="../lnut/index.htm" coords="81,0,152,95" shape="rect" /><area href="index.htm" coords="172,2,252,105" shape="rect" /><area href="../apache/index.htm" coords="238,2,334,95" shape="rect" /><area href="../sql/index.htm" coords="336,0,412,104" shape="rect" /><area href="../dbi/index.htm" coords="415,0,507,101" shape="rect" /><area href="../cgi/index.htm" coords="511,0,601,99" shape="rect" /></map>

</body></html>