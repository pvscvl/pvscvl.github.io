<?label 16.2. Electronic Mail?><html><head><title>Electronic Mail (Running Linux)</title><link href="../style/style1.css" type="text/css" rel="stylesheet" />

<meta name="DC.Creator" content="" /><meta scheme="MIME" content="text/xml" name="DC.Format" /><meta content="en-US" name="DC.Language" /><meta content="O'Reilly & Associates, Inc." name="DC.Publisher" /><meta scheme="ISBN" name="DC.Source" content="" /><meta name="DC.Subject.Keyword" content="stuff" /><meta name="DC.Title" content="" /><meta content="Text.Monograph" name="DC.Type" />

</head><body bgcolor="#ffffff">

<img src="gifs/smbanner.gif" alt="Book Home" usemap="#banner-map" border="0" />
<map name="banner-map"><area alt="Running Linux" href="index.htm" coords="0,0,466,65" shape="rect" /><area alt="Search this book" href="jobjects/fsearch.htm" coords="467,0,514,18" shape="rect" /></map>

<div class="navbar"><table border="0" width="515"><tr><td width="172" valign="top" align="left">
<a href="ch16_01.htm"><img src="../gifs/txtpreva.gif" alt="Previous" border="0" /></a></td>
<td width="171" valign="top" align="center"><a href="index.htm" /></td>
<td width="172" valign="top" align="right"><a href="appa_01.htm">
<img src="../gifs/txtnexta.gif" alt="Next" border="0" /></a></td></tr></table></div>
<hr align="left" width="515" />


<h2 class="sect1">16.2. Electronic Mail</h2>

<p><a name="INDEX-3308" />
Electronic mail (email) is one of the most desirable features of a
computer system.
You can send and receive email on your Linux system 
locally between users on the host and between hosts on a network.
You have to set up three classes of software to provide email 
service.  These are the <em class="emphasis">mail user agent</em> or
mailer, the <em class="emphasis">mail transport agent</em>
(<span class="acronym">MTA</span>), and the
<em class="emphasis">transport protocol</em>.
<a name="INDEX-3309" /></p>

<p>The mailer provides the user interface for displaying mail,
writing new messages, and filing messages.
Linux offers you many choices for mailers.  They
are always being improved, and a particular mailer may provide certain features,
such as the ability to serve as a newsreader or to serve as a
web browser.</p>

<p>The mailer relies on the <span class="acronym">MTA</span> to route mail from one user to another, whether
locally or across systems.  The <span class="acronym">MTA</span> in turn uses a transport protocol, 
usually either <span class="acronym">UUCP</span> (Unix-to-Unix Copy) or Simple
Mail Transport 
Protocol (<span class="acronym">SMTP</span>), to provide the medium for mail
transfer.</p>

<p>There are a number of possible scenarios when using email
	  on a Linux system, and depending on those scenarios, you will
	  have to install a different set of software packages. However,
	  no matter which option you choose, you will always need a
	  mailer.</p>

<p>The first scenario applies to dial-up access to the
	  Internet via an Internet Service Provider
	  (<span class="acronym">ISP</span>). In this scenario, there is often only
	  one user on the Linux machine, even though this is not a
	  requirement. The <span class="acronym">ISP</span> accepts your mail from
	  then Internet and stores it for you on its hard disks. You can 
	  then retrieve the mail whenever you want by using the common
	  <span class="acronym">POP3</span> (Post Office Protocol) protocol or the
	  newer protocol 
	  <span class="acronym">IMAP</span>. Outgoing mail in this scenario is
	  almost exclusively sent via the protocol <span class="acronym">SMTP</span>
	  (Simple Mail Transfer Protocol) that is generally used to
	  transport mail over the Internet.</p>

<p>In the easiest case, you use your mailer both to retrieve
	  the mail via <span class="acronym">POP3</span> or <span class="acronym">IMAP</span>
	  and to send it back via <span class="acronym">SMTP</span>. When you do
	  this, you do not even need to set up an <span class="acronym">MTA</span>,
	  because the mailer handles everything. This is not terribly
	  flexible, but if all you want is to access your mail easily,
	  this might be an option for you. Mailers that support this include
	  Netscape Messenger (see later) and KMail from KDE.</p>

<p>If you want more flexibility (which comes at the price of
	  more configuration and maintenance work), you can install an
	  <span class="acronym">MTA</span> (like <tt class="command">smail</tt>,
	  described in the next section). You will need a program
	  that transports the mail from your provider's
	  <span class="acronym">POP3</span> or <span class="acronym">IMAP</span> server. This
	  program fetches your mail when you ask it to and passes the
	  messages on to the <span class="acronym">MTA</span> running on your system,
	  which then distributed the mail to the recipients' mail
	  folders. One program that does exactly that is
	  <tt class="command">fetchmail</tt>, which we will cover later in this
	  chapter. Outgoing mail is again sent via
	  <span class="acronym">SMTP</span>, but with an <span class="acronym">MTA</span>
	  running on your machine, you can choose not to send the outgoing 
	  messages directly to your provider's <span class="acronym">SMTP</span>
	  server, but rather to your own server, which is provided by the
	  <span class="acronym">MTA</span>. The <span class="acronym">MTA</span> then forwards 
	  the mail to your provider, which in turn sends it to the
	  recipients. With this setup, you can instruct your
	  <span class="acronym">MTA</span> to send outgoing mails at certain
	  intervals only, so that you do not always have to make a dial-up
	  connection.</p>

<p>The third scenario is meant for machines that have a
	  permanent connection to the Internet, either because they are in 
	  a network that has a gateway with a permanent connection, or
	  because your machine is using a leased line to your Internet
	  provider. In this case, you might want to receive mail messages as soon
	  as they arrive at your provider and not have them stored
	  there. This also requires setting up an
	  <span class="acronym">MTA</span>. Incoming mails will be directed to your
	  <span class="acronym">SMTP</span> server (i.e., your
	  <span class="acronym">MTA</span>). Your provider will have to set things up
	  accordingly for this to work.</p>

<p>	  
	  Of course, there are many more scenarios how to get your
	  mail, and mixtures between the three mentioned are possible as
	  well. If you are going to set up a mail service for a whole
	  network, you will most certainly want to read the <em class="emphasis">Linux 
	  Network Administrator's Guide</em> as well as
	  <em class="emphasis">sendmail</em>.</p>

<p> 
You have a number of software choices for setting up email on a
Linux host. We can't describe all the available email solutions, but
we do describe some packages that are often used and quite suitable
for their respective tasks.  We document what we think is the most
popular Linux solution at this time: the Elm mailer (Version 2.4 at
the time of this writing), the Netscape Messenger (Version 4.5), the
<tt class="command">smail</tt> (<tt class="command">smail3.1.29</tt>) mail
transport agent, and the <tt class="command">fetchmail</tt> implementation of
the <span class="acronym">POP3</span> and <span class="acronym">IMAP</span> protocols.
These are relatively simple to configure but provide all the features
most users need. In addition, with these tools, you can cover all the
scenarios described earlier.</p>

<a name="x-100-3-sec-net-smail" /><div class="sect2">
<h3 class="sect2">16.2.1. The smail Mail Transport Agent</h3>

<p> 
<a name="INDEX-3310" />
<a name="INDEX-3311" />
<a name="INDEX-3312" />
There are two major <span class="acronym">MTA</span>s available on Linux:
<tt class="command">smail</tt> and <tt class="command">sendmail</tt>.  They both
support the 
<span class="acronym">SMTP</span> and <span class="acronym">UUCP</span> protocols for
handling mail.  The <tt class="command">sendmail</tt> package 
has been around for a long time.  It is generally considered 
somewhat more difficult to use than <tt class="command">smail</tt>, but it is 

thoroughly documented in the book <em class="emphasis">sendmail</em>, by Costales, 
Allman, and Rickert.  The <tt class="command">smail</tt> package is reportedly easier 
to configure and manage than <tt class="command">sendmail</tt> and is perhaps
more robust on systems with limited memory.  It is very popular 
on Linux.  We've decided to go with the most popular Linux <span class="acronym">MTA</span>, 
<tt class="command">smail</tt>, and describe its essential configuration and use here.
However, if you need to configure a mail host that has many connections and
handles lots of mail, you really need
<tt class="command">sendmail</tt>. Recently, other mail transport agents
like <tt class="command">qmail</tt>, <tt class="command">exim</tt>, and <tt class="command">zmailer</tt> have
become popular as well, but <tt class="command">smail</tt> (for its easy
installation) and <tt class="command">sendmail</tt> (for demanding
requirements) should cover about everything you need.</p>

<p><a name="INDEX-3313" />
<a name="INDEX-3314" />
<tt class="command">smail</tt> can be invoked in many modes by a specific invocation name that 
establishes its special uses.  For example, <tt class="command">smail</tt> can be invoked as
<tt class="command">rmail</tt>, and it replaces the original <tt class="command">rmail</tt> in that
function.  It also can be invoked as a daemon process
(<tt class="command">smtpd</tt> or <tt class="command">in.smtpd</tt>
<?troff \|?>) and replaces other mail utilities, such as
<tt class="command">mailq</tt>.  <tt class="command">smail</tt> is compatible with
the <tt class="command">sendmail</tt> <span class="acronym">MTA</span>
and interfaces satisfactorily with it.</p>

<p><a name="INDEX-3315" />

Olaf Kirch's <em class="emphasis">Linux Network
Administrator's Guide</em> provides information specific to 
installing <tt class="command">smail</tt> on Linux hosts.  Also, the
<tt class="command">smail3</tt> package has an  
excellent guide to installing and maintaining
<tt class="command">smail</tt>, entitled  
<em class="emphasis">Smail--Installation and Administration
Guide</em> by Karr 
and Noll.  Finally, you should also print out the manual
pages for <tt class="command">smail</tt>, which describe in detail all the configuration 
files and directories that <tt class="command">smail</tt> uses.</p>

<p><a name="INDEX-3316" />
The <tt class="command">smail</tt> package is bundled with some Linux distributions.
On the distributions that bundle <tt class="command">smail</tt>, most use the Linux
installation script to perform basic configuration of <tt class="command">smail</tt>
as well.  One
problem with this approach is that you need to periodically
update your <tt class="command">smail</tt> installation, and there is no convenient script to do
this unless you reinstall Linux at the same time.  Another problem is 
that some major Linux distributions seem to miss some detail or another
in configuring the <tt class="command">smail</tt> utilities, so that you need to go in and add a 
file link, edit a resource file, or something of the kind.</p>

<p>But take heart: even though patches are applied and features are added,
your same old <tt class="command">smail</tt> configuration files almost always continue to work
just fine.  You usually only need to update your binaries to stay up to date.</p>

<p>That's the good news.  The bad news is that different distributions of 
<tt class="command">smail</tt> install the files in different places.  If you grab a set of binaries
from an <span class="acronym">FTP</span> site and install it over your obsolete installation, you might 
find that you have one version of <tt class="command">smail</tt> installed in 
<em class="filename">/usr/bin</em> and another in <em class="filename">/sbin</em>.  Because <tt class="command">smail</tt> 
functions, as a number of mail utilities do, through the use of 
file links, this kind of inconsistency can cause real problems with
your installation.</p>

<p>If you build a distribution from scratch, though, you may find that it is
a generic installation not tailored for Linux.  (However, a generic
Unix <span class="acronym">FTP</span> site is likely to have
the full set of documentation that seems to be missing from some of
the Linux sites we've checked.)</p>

<p>What can you do?  Well, if you take a distribution from a particular
<span class="acronym">FTP</span> 
site, it might help to stick with that site, even if it means you don't
get the latest and greatest update at the earliest possible moment.  This
works particularly well if the site is a binary
distribution site--your
configuration files will be left untouched.  Or you can just jump in and 
install updated files and then use <tt class="command">find</tt> or
<tt class="command">whereis</tt> to  
sort out tangled up links and duplicated files. In any case, you will 
likely find that even if your Linux installation script installed and 
configured <tt class="command">smail</tt> correctly on your system, you don't like 
all the selected behaviors. If this is the case, often your best bet is 
to simply edit the <tt class="command">smail</tt> configuration file for your system.</p>

<div class="sect3">
<h3 class="sect3">16.2.1.1. Getting and installing smail</h3>

<p><a name="INDEX-3317" />
An excellent <span class="acronym">FTP</span> site that contains an up-to-date Linux binary distribution 
(at the time of this writing) is ftp://metalab.unc.edu.  
The <tt class="command">smail</tt> package 
can be found in <em class="filename">/pub/Linux/system/mail/mta/smail-linuxbin-3.1.29.1.tar.gz</em>.  The
specific filename will presumably change with each update to the 
source files, but the path will probably remain the same.</p>

<p>We should perhaps add that nobody seems to be
		  currently working on <tt class="command">smail</tt>. It works as it is, but you
		  shouldn't hold your breath waiting for
		  enhancements or bug fixes.</p>

<p>You can also get <tt class="command">smail</tt> as a source package to
compile yourself from the same location. In this case, get the file
<em class="filename">smail-3.1.29.1.tar.gz</em>.</p>

<p>To install the binary Linux distribution:</p>

<ol><li><p>
<span class="acronym">FTP</span> the file in binary mode.</p></li><li><p>
Move the file to the Linux root directory as <em class="filename">/smail.tar.gz</em>.</p></li><li><p>
Run <tt class="command">gunzip</tt> on the file, which results in a file named
<em class="filename">smail.tar</em>.</p></li><li><p>
Execute <tt class="command">tar -xvf smail.tar</tt> on the file in the root directory.
The <em class="filename">smail.tar</em> unpacks into a directory tree.</p></li></ol><p />

<p>
The section "<a href="ch07_01.htm">Section 7.1, "Archive and Compression Utilities"</a>" in
<a href="ch07_01.htm">Chapter 7, "Upgrading Software and the Kernel"</a>,
tells you all you need to know about <tt class="command">gunzip</tt> and
<tt class="command">tar</tt>.</p>

<p>If you should run across a package called <tt class="command">smailcfg</tt> when browsing
an <span class="acronym">FTP</span> site, you might think it is a configuration utility for 
<tt class="command">smail</tt>.  It isn't; it's a configuration utility for 
<tt class="command">sendmail</tt>.</p>
</div>


<div class="sect3">
<h3 class="sect3">16.2.1.2. Configuring a Linux-installed smail package</h3>

<p><a name="INDEX-3318" />
Some Linux distributions come with <tt class="command">smail</tt> already packaged, and <tt class="command">smail</tt> is 
installed when you run the Linux installation program.  Linux systems 
typically install the various parts of the <tt class="command">smail</tt> package to the following
directories: <em class="filename">/bin</em>, <em class="filename">/usr/bin</em>, <em class="filename">/usr/lib/smail</em>, and 
<em class="filename">/usr/man/man?</em>.  The <tt class="command">smail</tt> configuration may be stored in
<em class="filename">/var/lib/smail/config</em>.</p>

<p>Many of the variables <tt class="command">smail</tt>
uses are assigned based on information collected from the Linux 
configuration.  If you installed Linux with
<span class="acronym">TCP/IP</span>, for example,
<tt class="command">smail</tt>
will be configured to use <span class="acronym">SMTP</span> with 
it.  There are some <tt class="command">smail</tt> variables you still need to set, 
however.  These include:</p>

<dl>
<dt><b><tt class="literal">postmaster</tt></b></dt><dd><p><a name="INDEX-3319" />
This variable supplies a user ID to serve as postmaster on the local system.  
The mail administrator on the system is normally the designated postmaster. It is almost a moral obligation of a system on an open network (with links
beyond a LAN) to have a designated postmaster. If there is
a problem with email on a system, any user (anywhere) should be able
to send a
message to postmaster@hostname to have it investigated. In the
most rudimentary system, the postmaster can be the <b class="emphasis-bold">root</b> user, but it is
preferable for the postmaster to be assigned to an ordinary 
user ID.  (Some systems set up a "phony" account for the postmaster, 
so the duties can be rotated.)</p></dd>


<dt><b><tt class="literal">smart_path</tt></b></dt><dd><p><a name="INDEX-3320" />
This is an important variable to set, especially when you are a fledgling
mail host.  <tt class="literal">smart_path</tt> should be the name of the "smart host"
to which your
system routes all mail that it doesn't already know how to deliver.
In the simplest setup, anything that isn't local mail is routed to
the <tt class="literal">smart_path</tt> host you specify.  If you have a connection to an 
Internet host, it should be your smart host.</p></dd>


<dt><b><tt class="literal">visible_name</tt></b></dt><dd><p><a name="INDEX-3321" />
This variable specifies a name <tt class="command">smail</tt> uses as the return address
for all mail sent by your host.  For example, if your full hostname is
<b class="emphasis-bold">deus.x-machina.org</b>, 
you might prefer the visible name to be
<b class="emphasis-bold">x-machina.org</b>. A user on the host 
<em>deus</em> would have her
From address set to 
user@x-machina.org instead of 
user@deus.x-machina.org. This is especially useful if there 
are several hosts that users on the local network have accounts on, or if names
of specific host systems in the domain change.</p></dd>


<dt><b><tt class="literal">smart_user</tt></b></dt><dd><p><a name="INDEX-3322" />
The <tt class="literal">smart_user</tt> isn't necessarily a user.  You can leave <tt class="literal">smart_user</tt>
with no value assigned, in which case any mail that cannot be delivered will
be bounced (returned to sender).  If you assign a user ID to <tt class="literal">smart_user</tt>, improperly addressed mail sent to your system will be
forwarded to the <tt class="literal">smart_user</tt>.  Often, <tt class="literal">smart_user</tt> is the same
user as postmaster, but for a small system, it is probably best to 
bounce the mail.  <tt class="literal">smart_user</tt> is intended to allow manual rerouting of
mail when a user moves, loses an account, and so on.  It has little use
on a
system with few users.</p></dd>

</dl>

<p />

<p>
There are additional variables that you can set.  The online manual
page describes them all in its discussion of the <em class="filename">config</em>
file.  Your distribution might not contain the documents in printable form, but
you should print your own if you need to, by entering one of the following
commands.  (The first generates plain text for every printer; the second 
assumes you have configured <tt class="command">ghostscript</tt> to drive
your specific printer by default):
<blockquote><pre class="code">$ <tt class="userinput"><b>man 5 smail | col -b | lpr</b></tt> 
$ <tt class="userinput"><b>gtroff -man /usr/man/man5/smail.5 | ghostscript | lpr</b></tt></pre></blockquote></p>

<p>There has been a configuration script floating around some
distributions (look for
<em class="filename">/usr/lib/smail/tools.linux/config</em> ), but on the
other hand, all you really need is <tt class="command">smail(5)</tt> and
your trusty <span class="acronym">ASCII</span> editor to fix up your
<tt class="command">smail</tt> configuration files.  (Though 
we would also use the <em class="emphasis">Linux Network Administrator's
Guide</em> and the <em class="emphasis">Smail--Installation
and Administration Guide</em>.)
</p>
</div>


<div class="sect3">
<h3 class="sect3">16.2.1.3. Configuring smail</h3>

<p>Fortunately, <tt class="command">smail</tt>
default values for the Linux <tt class="command">smail</tt> distribution are decent, and the 
<tt class="command">mkconfig</tt> script largely automates the remaining <tt class="command">smail</tt> installation 
issues.  With any luck you can accept all default values and just run
<tt class="command">smail</tt> "out of the box."</p>

<p>Look for a <em class="filename">README</em> text file in the current distribution. You should
begin by reading this file if it exists.  On a typical Linux distribution
of <tt class="command">smail</tt>, the <em class="filename">README</em> file is found in 
<em class="filename">/usr/lib/smail/linux.tools/README</em>.  The
<em class="filename">README</em> file describes the 
release and provides any special notes and general instructions for 
installing and configuring the current version of the software. If
your distribution does not have a <em class="filename">README</em> file for 
<tt class="command">smail</tt>, you will have to make do with the manual pages,
which should give you all the information you need.</p>

<a name="INDEX-3323" />
</div>


<div class="sect3">
<h3 class="sect3">16.2.1.4. smail EDITME file</h3>

<p><a name="INDEX-3324" />
The first step in configuring <tt class="command">smail</tt> from a Linux
distribution is to go to the
<em class="filename">/usr/lib/smail/linux.tools</em> directory (or
wherever your distribution stores the <tt class="command">smail</tt>
configuration files) and copy
the <em class="filename">EDITME-dist</em> file to
<em class="filename">EDITME</em>. There are some distributions out there in 
netland where even the <em class="filename">EDITME</em> file is missing.
These distributions typically contain only the binary files needed,
but no configuration files whatsoever. If this is case, look again at the
place where you downloaded your <tt class="command">smail</tt>
package; sometimes you can find another package that contains
configuration files. If all else fails, download the source package
and take the <em class="filename">EDITME-dist</em> file you find there.</p>

<p>Once you are the lucky owner of an <em class="filename">EDITME</em> file,
edit it to alter any variables you need to.  
Some of the values you can assign in <em class="filename">EDITME</em> are better handled
in a later step, when you run <em class="filename">/usr/lib/smail/linux.tools/mkconfig</em>
to complete the <tt class="command">smail</tt> installation.  Variable assignments in the <em class="filename">EDITME</em>
file are in the form of <em class="replaceable">variable</em><tt class="literal">=</tt><em class="replaceable">value</em>.  The following are 
variables to which you might wish to give special attention to in the 
<em class="filename">EDITME</em> file:</p>

<dl>
<dt><b><tt class="literal">OS_TYPE=linux</tt></b></dt><dd><p>The <tt class="literal">OS_TYPE</tt> should already have a value of <tt class="literal">linux</tt> if you
are using a standard Linux distribution of <tt class="command">smail</tt>.  Check this just in case.</p></dd>


<dt><b><tt class="literal">HAVE=HDB_UUCP</tt></b></dt><dd><p>
If you've installed some other <span class="acronym">UUCP</span> package than
the usual Taylor <span class="acronym">UUCP</span>, you
should study the comments about the <tt class="literal">HAVE</tt> variable.
For Taylor <span class="acronym">UUCP</span>,
you don't want to set a value for <tt class="literal">HAVE</tt>.</p></dd>


<dt><b><tt class="literal">UUCP_ZONE</tt></b></dt><dd><p>If you are on a <span class="acronym">UUCP</span> network, and you
are not going to be on the Internet, look at the comments on
the <tt class="literal">UUCP_ZONE</tt> variable.  You may need to set <tt class="literal">UUCP_ZONE=true</tt> to achieve the
address-handling behavior you want for certain <span class="acronym">UUCP</span> networks.</p></dd>


<dt><b><tt class="literal">DOMAINS</tt></b></dt><dd><p>
You may need to set <tt class="literal">DOMAINS</tt> to a domain name if you did not perform a standard
Linux installation and configuration.  If you did, however, you will probably
want to omit setting <tt class="literal">DOMAINS</tt> in the
<em class="filename">EDITME</em> file, and make any changes you
need when you run <tt class="command">mkconfig</tt>.</p></dd>


<dt><b><tt class="literal">SMAIL_BIN_DIR</tt></b></dt><dd><p><a name="INDEX-3325" />
<a name="INDEX-3326" />
Linux normally sets <em class="filename">/usr/bin</em> as the <tt class="literal">SMAIL_BIN_DIR</tt> value.  This
variable establishes the path to the primary mailer on the system.  If
you've put your primary mailer somewhere else, you'll have to change
this variable's value.</p></dd>


<dt><b><tt class="literal">LIB_DIR</tt></b></dt><dd><p>
Linux normally sets <em class="filename">/usr/lib/smail</em> as the
<tt class="literal">LIB_DIR</tt> path.
If you put <tt class="command">smail</tt> files somewhere other than 
<em class="filename">/usr/lib/smail</em>, you need either to change <tt class="literal">LIB_DIR</tt> to reflect
this or to link the directory you use to <em class="filename">/usr/lib/smail</em>.</p></dd>


<dt><b><tt class="literal">NEWALIASES</tt></b></dt><dd><p><a name="INDEX-3327" />
The <tt class="command">mkaliases</tt> command functions as the <tt class="command">newaliases</tt> utility
if you set this variable; otherwise you must invoke the utility as 
<tt class="command">mkaliases</tt>.  The default behavior is the latter.  If you want
to enable
invocation as <tt class="command">newaliases</tt>, the argument to <tt class="literal">NEWALIASES</tt> should be set to
the path of the <tt class="command">newaliases</tt> command.</p></dd>


<dt><b><tt class="literal">UUCP_SYSTEM_FILE</tt></b></dt><dd><p>
If you are using a <span class="acronym">UUCP</span> package other than Taylor <span class="acronym">UUCP</span>, you may need to set
this variable to something different from its current value.  Currently, it is
set as <tt class="literal">UUCP_SYSTEM_FILE=/usr/lib/UUCP/Systems</tt>, which is typical for a <span class="acronym">BNU</span>
or HoneyDanBer <span class="acronym">UUCP</span> distribution.</p></dd>


<dt><b><tt class="literal">SPOOL_DIRS</tt></b></dt><dd><p><a name="INDEX-3328" />
By default, <tt class="literal">SPOOL_DIRS</tt> is set to
<em class="filename">/var/spool/smail</em>, but you may want
more than one spool directory available if you think you will need
more inodes to handle the volume of pending mail or if you change the
directory specified.  To specify more than one spooling directory, enter
each spooling directory's path, separated by a colon.  
If you have set aside a fast disk drive for spooling operations, 
you may need to change the path in order to place the primary spooling 
directory in that mounted path.  For example, if your fast disk drive 
is mounted as <em class="filename">/var/spool</em>, you might have something like:
<blockquote><pre class="code">SPOOL_DIRS=/var/spool/smail:/usr/spool/smail</pre></blockquote></p></dd>


<dt><b><tt class="literal">NEWS_SPOOL_DIR</tt></b></dt><dd><p><a name="INDEX-3329" />
This is normally set to <em class="filename">/var/spool/news</em>; considerations are similar
to <tt class="literal">SPOOL_DIRS</tt> variable, except, of course, that Netnews volume is getting
huge, so you really might need more spooling directories.</p></dd>

</dl>

<p />
</div>


<div class="sect3">
<h3 class="sect3">16.2.1.5. The mkconfig file</h3>

<p><a name="INDEX-3330" /> 
After you are satisfied with the state of your <em class="filename">EDITME</em> file (and in fact,
you may have determined that you need not set any special values
in an <em class="filename">EDITME</em> file), you are ready to run 
<tt class="command">/usr/lib/smail/tools.linux/mkconfig</tt>.  This utility creates a
supplementary file that overrides or supplements other <tt class="command">smail</tt> variables;
the file is <em class="filename">/usr/lib/smail/tools.linux/config.state</em>.  We'll provide
responses to a few of these questions and show you the resulting output file.
These are the considerations
you should be ready to resolve when <tt class="command">mkconfig</tt> is run:</p>

<dl>
<dt><b><em class="emphasis">Extra hostnames</em></b></dt><dd><p>
<tt class="command">mkconfig</tt> already knows a hostname if you installed
Linux using one of the standard distributions or if you gave a value
in the <em class="filename">EDITME</em> file.  Now you are asked if you want your host to be 
known by multiple hostnames.  This is useful if the host is on more than
one network, for example.  For our configuration run, the host value was 
already set to <em>pond.walden.com</em>
(composed from the hostname value 
of <em>pond</em> and from the domain name value
of <em>walden.com</em>). We answered
the query by entering an additional hostname of
<em>pond.conserve.org</em>, because we'd like to be known to some
correspondents on the outside by that domain name.</p></dd>


<dt><b><em class="emphasis">System's visible name</em></b></dt><dd><p><a name="INDEX-3331" />
You can set the visible name to something other than the actual hostname.
The purpose of this is to provide a single visible mailing address for mail
coming from a cluster of machines. You should specify the machine that all mail coming from outside the local
network will be sent to. If the visible name value isn't set, the primary host
and domain names form the name used.</p></dd>


<dt><b><em class="emphasis">Smart host</em></b></dt><dd><p><a name="INDEX-3332" />
This is a very important consideration; you should have a
<em class="emphasis">smart host</em>, which is a host to which you route
all mail you can't deliver.  If you don't answer this question when
you run <tt class="command">mkconfig</tt>,
you should edit the <em class="filename">/usr/lib/smail/config</em> file to provide this data when
you are ready to designate a smart host.  We responded to this query with
<em>Netscape Messenger window
ruby.ora.com</em>, because we are using it as our connection to the
outside world.</p></dd>


<dt><b><em class="emphasis">Smart transport</em></b></dt><dd><p>
This specifies the preferred mail-transport medium; the default is TCP.</p></dd>


<dt><b><em class="emphasis">Smart user</em></b></dt><dd><p><a name="INDEX-3333" />
This is for email wizards who can figure out forwarding addresses for
misrouted mail.  You should probably leave it unset, so mail that is
routed to an unknown user on the local host is bounced back to the sender.</p></dd>


<dt><b><em class="emphasis">Postmaster</em></b></dt><dd><p><a name="INDEX-3334" />
Someone should take responsibility for email.  If you are performing 
<tt class="command">mkconfig</tt>, you are probably "it" and should provide your
own user ID in response.  If the postmaster isn't designated,
all mail sent to postmaster goes 
to the root user.
We supplied lark
as the user ID for postmaster.</p></dd>


<dt><b><em class="emphasis">Primary mailer</em></b></dt><dd><p><a name="INDEX-3335" />
Basically, <tt class="command">mkconfig</tt> checks to see if <em class="filename">/bin/mail</em> exists, and if
it does (as it does on most Linux systems), it regretfully accepts this
as the primary mailer.  You can edit your customization file to use
another mailer, like Elm.</p></dd>

</dl>

<p />

<p>The file that results from the interactive <tt class="command">mkconfig</tt> procedure
looks like this:
 
<blockquote><pre class="code">more_hostnames=pond.walden.com:pond.conserve.org
visible_name=
smart_path=ruby.ora.com
smart_user=
postmaster=lark</pre></blockquote></p>
</div>


<div class="sect3">
<h3 class="sect3">16.2.1.6. Final smail installation notes</h3>

<p><a name="INDEX-3336" />
<a name="INDEX-3337" />

When your <tt class="command">smail</tt> installation is complete, make sure
you remove or rename any existing <tt class="command">rmail</tt>,
<tt class="command">sendmail</tt>, or other commands that
<tt class="command">smail</tt> is intended to replace.  (The
<tt class="command">smail</tt> installation script probably already has
created these links, but you need to verify the situation; if you had
existing utilities before installing <tt class="command">smail</tt>, they may not have been replaced with links to
<tt class="command">smail</tt>.)  Create the <tt class="command">smail</tt> links
that are needed to carry out all of its many roles, so programs that
depend on these utilities can find them:</p>

<blockquote><pre class="code"># <tt class="userinput"><b>ln /usr/bin/smail /usr/bin/mailq</b></tt> 
# <tt class="userinput"><b>ln /usr/bin/smail /usr/bin/rmail</b></tt> 
# <tt class="userinput"><b>ln /usr/bin/smail /usr/bin/rsmtp</b></tt>
 
# <tt class="userinput"><b>ln /usr/bin/smail /usr/bin/runq</b></tt> 
# <tt class="userinput"><b>ln /usr/bin/smail /usr/sbin/sendmail</b></tt> 
# <tt class="userinput"><b>ln /usr/bin/smail /usr/bin/smtpd</b></tt> 
# <tt class="userinput"><b>ln /usr/bin/smail /usr/bin/mkaliases</b></tt></pre></blockquote>

<p>When you have
established these links, the utilities that rely on them can be configured

for full network operation.  For good instructions on that process,
refer to (of course) the <em class="emphasis">Linux Network Administrator's
Guide</em>.</p>

<p><a name="INDEX-3338" /> 
<a name="INDEX-3339" />
If <tt class="command">smail</tt> is configured correctly on your system, there is a line in
the <em class="filename">/etc/services</em> file that says:
<blockquote><pre class="code">smtp        25/tcp        mail</pre></blockquote>

There is also a line in the <em class="filename">/etc/services</em> file that says:
<blockquote><pre class="code">SMTP   stream  tcp    nowait  root  /usr/sbin/tcpd  /usr/bin/rSMTP -bs</pre></blockquote></p>
</div>


<div class="sect3">
<h3 class="sect3">16.2.1.7. smail runtime configuration files</h3>

<p><a name="INDEX-3340" />
The <tt class="command">smail</tt> binary is preconfigured and needs only
minor tuning.  Usually the changes can be made through the
<em class="filename">EDITME</em> script, the
<em class="filename">linux.tools/config</em> script, or directly to the
<em class="filename">/var/lib/smail/config</em> (<em class="filename">/etc/smail/config</em> on
Debian 1.3) file.
 
Normally, you need no other configuration, but there are some other
files <tt class="command">smail</tt> uses to alter configuration at runtime.
If you should ever need any of these, build them according to
"Setting Up Runtime Configuration Files" in
<em class="emphasis">Smail--Installation and Administration
Guide</em>. Also use <tt class="command">smail(5)</tt> to provide
information about the meanings of the variables you set.</p>

<p> 
<a name="INDEX-3341" />
A second host configuration file,
<em class="filename">/private/usr/lib/smail/config</em>, redefines mailer
behavior on a local workstation.  This is intended for use on a
<span class="acronym">LAN</span>, in cases where your local system might need to
behave differently from the central <tt class="command">smail</tt>
configuration file that controls the site as a whole.</p>

<p><a name="INDEX-3342" />
<a name="INDEX-3343" />
<a name="INDEX-3344" />
The <em class="filename">directors</em>, <em class="filename">routers</em>, and
<em class="filename">transports</em> files redefine attributes of the
<tt class="command">smail</tt> director, router, or transport
<span class="acronym">MTA</span> functions.  Again,
these normally apply to <span class="acronym">LAN</span> and multipathed network connections.</p>

<p><a name="INDEX-3345" />
A <em class="filename">methods</em> file is used in conjunction with
runtime configuration files to assign different transport protocols
to use with different hosts.  This isn't necessary for mixed
<span class="acronym">UUCP</span> and <span class="acronym">TCP/IP</span> use, but it can
be employed when you want to do something unusual, such as using an
<span class="acronym">SMTP</span> protocol over <span class="acronym">UUCP</span> or a
<span class="acronym">UUCP</span> batch protocol over <span class="acronym">TCP/IP</span>.
The technique is useful, but is not for the novice mail administrator.</p>

<p><a name="INDEX-3346" />
A <em class="filename">qualify</em> file tells a host the domain to route
mail to if a bare hostname is given as a mail address.  This is an
easily abused feature and should normally be avoided.  However, it can
define <span class="acronym">UUCP</span> mail routing to a
<span class="acronym">UUCP</span> system that keeps full and accurate
<span class="acronym">UUCP</span> maps (with the cooperation of that host's mail
administrator).</p>

<p> 
<a name="INDEX-3347" />
A <em class="filename">retry</em> file modifies retry and timeout behavior
of <tt class="command">smail</tt>.  This file sets minimum delivery
intervals, maximum durations, and the number of attempts separately
for each target domain that the mail host connects to.  Its use is
beyond the scope of this book, but you may need to use this file at
some point.</p>

<a name="INDEX-3348" /><a name="INDEX-3,349" /><a name="INDEX-3,350" />
</div>
</div>




<div class="sect2">
<h3 class="sect2">16.2.2. Getting the Mail to Your Computer with Fetchmail</h3>

<a name="INDEX-3351" /><a name="INDEX-3,352" /><p>If your provider stores your mail for you until you
		fetch it, and you do not want to use your mailer to download
		the mail, you need a program that retrieves the mail from your 
		provider's computer. There are a lot of programs for doing
		this; we will discuss
		<tt class="command">fetchmail</tt> here briefly, because it is both robust
		and flexible and can handle both <span class="acronym">POP3</span> and
		<span class="acronym">IMAP</span>.</p>

<p>You can get <tt class="command">fetchmail</tt> from your
		friendly Linux archive; chances are that your distribution
		carries it, too. In case you download a source distribution of 
		<tt class="command">fetchmail</tt>, unpack, build, and install it according to the
		installation instructions.</p>

<p>You can control <tt class="command">fetchmail</tt> 's behavior 
		both via command-line options or by a configuration
		file. It is a good idea to first try to fetch your mail by 
		passing the necessary information on the command line, and
		when this works, to write the configuration file.</p>

<p>As an example, let's assume that my provider is running
		the <span class="acronym">POP3</span> protocol, that my username there
		is <b class="emphasis-bold">joeuser</b> and that my password is
		<tt class="literal">secret</tt>. The hostname of the machine where
		the <span class="acronym">POP3</span> server is running is <b class="emphasis-bold">mail.isp.com</b>. I can then retrieve 
		my mail with the following command:</p>

<blockquote><pre class="code">fetchmail --protocol POP3 --username joeuser mail.isp.com</pre></blockquote>

<p><tt class="command">fetchmail</tt> then asks me for my password, and after I
		specify it correctly, retrieves the mail waiting for 
		me and passes it on to my <span class="acronym">MTA</span> for
		further delivery. This assumes that a <span class="acronym">SMTP</span>
		server is running on port 25 of my machine, but this should
		be the case if I have set up my <span class="acronym">MTA</span>
		correctly.</p>

<p>While you are experimenting with
		<tt class="command">fetchmail</tt>, it might be a good idea to also
		specify the option <tt class="command">--keep</tt>. This prevents
		<tt class="command">fetchmail</tt> from deleting the messages from
		your <span class="acronym">POP3</span> account. Normally, all messages
		are deleted from your provider's hard disk once they are
		safely stored on your own machine. This is a good thing,
		because most providers limit the amount of mail you can store
		on their machines before retrieving them, and if you don't
		delete the messages after fetching them, you might reach this
		limit quite soon. On the other hand, while testing, it is a good idea
		to be on the safe side and use <tt class="command">--keep</tt> so as not to lose any mail.</p>

<p>With the options just shown to <tt class="command">fetchmail</tt>, you should already be able 
		to get your mail in most cases. For example, if your provider
		uses the newer <span class="acronym">IMAP</span> protocol, simply
		specify <tt class="literal">IMAP</tt> in the command line
		instead of <tt class="literal">POP3</tt>. If your provider has some
		unusual setup, you might need one of the other options that
		the <tt class="command">fetchmail</tt> manual page tells you
		about.</p>

<p>Once you are satisfied with the download process, you
		can write a <tt class="command">fetchmail</tt> configuration file in 
		order not to have to enter all the options each time you use the command. This
		configuration file is called <em class="filename">.fetchmailrc</em> 
		and should reside in your home directory. Once you are done
		editing it, make sure it has the permission value 0600 so that 
		nobody except yourself can read it, because this file might
		contain your password:</p>

<blockquote><pre class="code">chmod 0600 ~/.fetchmailrc</pre></blockquote>

<p>The full syntax of the configuration file is detailed in 
		the <tt class="command">fetchmail</tt> man page, but in general you
		need only very simple lines that start with
		<tt class="literal">poll</tt>. To specify the same data as on the
		command line in the previous example, but this time include the password, put
		the following line into your configuration file:</p>

<blockquote><pre class="code">poll mail.isp.com protocol pop3 username joeuser password secret</pre></blockquote>

<p>Now you can run <tt class="command">fetchmail</tt> without any 
		parameters. Since <tt class="command">fetchmail</tt> already knows about your password from
		the configuration file, it will not prompt you for it this
		time. If you want to play safe while testing, add the
		word <tt class="literal">keep</tt> to the <tt class="literal">poll</tt>
		line.</p>

<p>Using <tt class="command">fetchmail</tt> with a configuration
		file has one additional advantage: You can fetch mail from as
		many mailboxes as  you want. Just add more <tt class="literal">poll</tt> 
		lines to your <em class="filename">.fetchmailrc</em>, and <tt class="command">fetchmail</tt> 
		happily retrieves your mail from one server after the
		other.</p>

<p>When and how you run <tt class="command">fetchmail</tt> depends on
what kind of connection to the Internet you have. If you have a
permanent connection or a cheap, flat rate, you might want to have
<tt class="command">fetchmail</tt> invoked by <tt class="command">cron</tt> at a suitable interval
(like once an hour). However, if your Internet connection is
nonpermanent (dial-up) and costly, you might want to choose to run
<tt class="command">fetchmail</tt> by hand whenever you actually want to
fetch and read your mail so as to minimize your Internet connection
time. Finally, if you are using PPP for dialing in to your Internet
service provider, you might want to invoke <tt class="command">fetchmail</tt> from the
<tt class="command">ip-up</tt> script, which is invoked as soon as an
Internet connection is made. With this setup, when you browse a web
page and your computer dials up your provider, your mail is fetched automatically.</p>

<a name="INDEX-3353" /><a name="INDEX-3,354" />
</div>




<div class="sect2">
<h3 class="sect2">16.2.3. Other Email Administrative Issues</h3>

<p><a name="INDEX-3355" />
<a name="INDEX-3356" />
In this section we describe tasks, services, and some additional 
utilities involved in managing your electronic mail system.</p>

<p><a name="INDEX-3357" />
<a name="INDEX-3358" />
You should normally use only one Internet host to get all your
mail.  It is possible to use a more complex arrangement, but this is
frowned upon because of the possibility of setting up loops--virtual
Sargasso Seas of lost network information. Loops can route mail
in circles, passing over and over through the same machines until
they "time out" by exceeding the limit on the number of machines
they can pass through.</p>

<div class="sect3">
<h3 class="sect3">16.2.3.1. Registering an address</h3>

<p><a name="INDEX-3359" />
<a name="INDEX-3360" />
<a name="INDEX-3361" />
<a name="INDEX-3362" />
<a name="INDEX-3363" />
<a name="INDEX-3364" />
If you want to get your mail directly from the Internet, you need to
register an Internet domain name for your system.
You may have the domain name
of your Internet connecting host, but you could have some other domain
name entirely.  It doesn't matter; the Domain Name System
(<span class="acronym">DNS</span>) database routes mail for your domain to your
Internet host connection.  We call this host your
<em class="emphasis">gateway</em> connection.  (If your system routes all
mail back only to this gateway connection, your system is called a
<em class="emphasis">leaf</em> system.)</p>

<p><a name="INDEX-3365" />
In turn, the gateway host that connects you to the Internet normally
holds your MX (mail exchanger) record.  A host that holds an MX record
for a system acts as the mail forwarder to that system.  It must know
the exact paths to deliver mail to all the machines in your domain, if
you use more than one host as a mail host.  The gateway host 
connects
directly to your system, generally either by Ethernet or by
<span class="acronym">UUCP</span> connection over a switched telephone line.</p>

<p>Your own mail host should be configured so that all email not
sent to the local host, or not otherwise sent directly 
to a host you connect to, is routed to your Internet mail
gateway--your smart host.</p>

<p>The <em class="emphasis">Linux Network Administrator's Guide</em> tells how to register domain names,
fill out MX records, and configure both sides of the gateway-leaf

mail connection.  Two other books that can help you manage your
Internet connection are <em class="emphasis">TCP/IP Network
Administration</em> and <em class="emphasis">DNS and BIND</em>.</p>

<p>It should be noted that registering a domain does not
		  automatically imply that you'll be doing all the mail handling
		  yourself. Many Internet service providers offer the service
		  of registering a domain of your choice and then do all the
		  mail handling for you, that is, you still get the mail in your
		  mailbox.</p>
</div>


<div class="sect3">
<h3 class="sect3">16.2.3.2. Mail system maintenance</h3>

<p><a name="INDEX-3366" />
<a name="INDEX-3367" />
You should set up a <tt class="command">cron</tt> task to occasionally check
the mail queue (usually <em class="filename">/var/spool/smail</em> )
and force an attempt to deliver mail that wasn't previously delivered
for some reason.  Mail can be queued because a host is temporarily
unreachable, or a filesystem is full, or for myriad other little
reasons.

<tt class="command">cron</tt> is discussed in the section "<a href="ch08_02.htm">Section 8.2, "Scheduling Jobs Using cron"</a>"
in <a href="ch08_01.htm">Chapter 8, "Other
 Administrative
 Tasks"</a>.</p>

<p>The mail administrator also should occasionally check the mail queue
and make sure there are no messages "stuck" there:
<blockquote><pre class="code">$ <tt class="userinput"><b>mailq -v</b></tt></pre></blockquote>

This command generates a report on any mail in the queue, along with log 
information that informs you if there is a persistent
mail-delivery problem.</p>
</div>
</div>




<a name="x-100-3-net-mail-elm" /><div class="sect2">
<h3 class="sect2">16.2.4. Installing Elm</h3>

<p><a name="INDEX-3368" />
<a name="INDEX-3369" />
<a name="INDEX-3370" />
Now you can get mail to your system, and it is sitting in a spool
directory waiting to be read.  Your last job is to install a mailer
that provides a convenient interface for reading, composing, and
filing mail messages.</p>

<p>The Elm mailer was created by Dave Taylor, of the Elm Development Group,
and continues to be developed through the Usenet Community Trust.
Copyrights on Elm are held by Dave Taylor and the Usenet
Community Trust.</p>

<p>Elm isn't the most powerful mailer available, but it is 
robust and suits the needs of most users.  It has a simple user interface 
with menus and built-in help.  Most other screen-oriented mailers available on 
Linux support much the same basic mailer features, using a similar display 
interface.  Once you know Elm, you can easily switch to another mailer if you 
find one more to your taste. Other popular text-mode mailers are
<tt class="command">pine</tt> and <tt class="command">mutt</tt>; the
supporters of the different mailers can start arguments that are no
less violent than those between Emacs supporters and <tt class="command">vi</tt> lovers. In
addition, there are now also a great number of X-based GUI mailers that 
are often easier to set up and use than the traditional text-mode
mailers like Elm. We will cover one of them, Netscape Messenger, later 
in this chapter.</p>

<p>In this discussion, we mention different directories and files that Elm 
uses.  These are defaults; the mail administrator can set up
some different locations, and each Elm user can change the setup of
files and directories.</p>

<div class="sect3">
<h3 class="sect3">16.2.4.1. Preparing for installation</h3>

<p>Before you install Elm, you should already have
set up communications links to any <span class="acronym">UUCP</span> and <span class="acronym">TCP/IP</span>
hosts with which you
exchange mail directly.  If these connections change, you may
have to reinstall Elm or edit some files.  During installation, you need
to supply the Elm configuration program with essential data
about the host domain name and system name, about the routing
of mail, and so on.  Specific information you need includes:</p>

<dl>
<dt><b><em class="emphasis">Domain name</em></b></dt><dd><p><a name="INDEX-3371" />
If you are on the Internet, you need to register a domain name, or
(more commonly) become part
of an established domain--probably the domain of the host that will
provide you with mail service and hold your MX record.</p></dd>


<dt><b><em class="emphasis">Hostname</em></b></dt><dd><p><a name="INDEX-3372" />
This is the name of the mail host you are configuring.</p></dd>


<dt><b><em class="emphasis">Absolute name</em></b></dt><dd><p>This is the complete hostname, including the domain.</p></dd>


<dt><b><em class="emphasis">Locking methods</em></b></dt><dd><p><a name="INDEX-3373" />
<a name="INDEX-3374" />
Elm uses mail spool files, and sometimes it needs to lock files.  Elm 
supports <span class="acronym">UUCP</span> "dotlock," locking, BSD
<em class="emphasis">flock</em> locking, and
System V <em class="emphasis">fcntl</em> locking.  Linux possesses both <em class="emphasis">fcntl</em>
and <em class="emphasis">flock</em> functions.  If you are also using <span class="acronym">UUCP</span> on your system,
you need dotlock and you should also enable <em class="emphasis">fcntl</em>
locking.  Elm will ask you interactively when you run <tt class="command">Configure</tt> 
what forms of locking to
<?troff \p?> support.</p></dd>


<dt><b><em class="emphasis">Content-length control</em></b></dt><dd><p><a name="INDEX-3375" />
<span class="acronym">MTA</span>s can now transmit binary messages embedded in email.  However, to do
so, they cannot tolerate changes in message content by mailers.  A 
<tt class="literal">Content-Length:</tt> header is used to specify the message length, and
you should allow this header to be used.  However,
honoring <tt class="literal">Content-Length:</tt> headers requires that the mailer not insert 
escapes or buffering characters in front of instances of the text string 
<tt class="literal">From</tt> occurring at the start of a line.</p></dd>


<dt><b><em class="emphasis">Dot-message termination</em></b></dt><dd><p><a name="INDEX-3376" />
<a name="INDEX-3377" />
<a name="INDEX-3378" />
By default, Elm turns off dot-termination of mail (where a line containing
only a <tt class="literal">.</tt> causes the mailer to end the message).  You don't want to enable dot termination if you enable content-length control, which you probably
want to allow in the brave new multimedia world.</p></dd>

</dl>

<p />

<p><a name="INDEX-3379" />
Before using <tt class="command">Configure</tt> to install Elm, read the 
<em class="emphasis">Elm Configuration Guide</em> to make sure you have the answers you need
to complete the process successfully.  There are a number of lesser issues
to decide in addition to the issues just mentioned.  Some of them require
knowledge of your Linux file tree, so you should investigate these first to
avoid having to abort or reinstall later.  You may also find it useful to

refer to the chapter in the <em class="emphasis">Linux Network Administrator's Guide</em>
that gives an introduction to electronic mail, for
a broader view of electronic mail issues, including mail addressing
and routing and use of <span class="acronym">UUCP</span> as a mail-routing agent.</p>

<p><a name="INDEX-3380" />
If you reinstall Elm, you may 
need to replace system alias files and have all the users replace
their alias files.  A <tt class="command">newalias</tt> command is provided for the 
purpose and should be run by each Elm user.</p>
</div>


<div class="sect3">
<h3 class="sect3">16.2.4.2. Installation Procedure</h3>

<p>First, get the latest released sources for Elm and put the source
files in a build directory, such as
<em class="filename">/usr/local/bin/elm2.4</em>.  Elm may have been
included with your Linux distribution and could have been built when
installing or reinstalling the Linux package.  If this is the case,
you should test the installation to make sure it is complete and up to
date.</p>

<p>At least one major distribution of Linux that includes the Elm package
includes only the executable and omits example configuration files and
installation instructions.  You can get the rest of the package
(including documentation) through <span class="acronym">FTP</span> sites that
have the full package.  These are not necessarily Linux source sites.</p>

<p>The Elm package contains a <tt class="command">Configure</tt> shell script
you should run to install Elm. 
 
A file named <em class="filename">Instruct</em> contains fundamental directions for 
installing the current version of Elm on your system, but it probably 
doesn't tell you the information you should have on hand when you run
<tt class="command">Configure</tt>.  We'll try to tell you the needed key
information, but if we miss something, reinstalling Elm is as easy
as running <tt class="command">Configure</tt> again. From your Elm build directory,
as the root user, execute <tt class="command">Configure</tt>:
 
<blockquote><pre class="code"># <tt class="userinput"><b>sh Configure</b></tt></pre></blockquote></p>

<p><tt class="command">Configure</tt> installs localized configuration 
files after asking you some questions.</p>

<p>Next, you need to build the Elm document set:
<blockquote><pre class="code"># <tt class="userinput"><b>make documentation</b></tt></pre></blockquote></p>

<p>Then run a full <tt class="command">make</tt> process, building a log file and 
showing messages in case of <tt class="command">make</tt> errors:<blockquote><pre class="code"># <tt class="userinput"><b>make all &gt; MAKELOG 2&gt;&amp;1 &amp;</b></tt> 
# <tt class="userinput"><b>tail -f MAKELOG</b></tt></pre></blockquote></p>

<p>This assumes you are using the <tt class="command">bash</tt> shell.  If you use
<tt class="command">csh</tt> or <tt class="command">tcsh</tt>, enter the <tt class="command">make</tt> command this way:</p>

<blockquote><pre class="code">% <tt class="userinput"><b>make all &gt;&amp; MAKELOG &amp;</b></tt></pre></blockquote>

<p>This process takes a while.  On successful completion, you should find
most of these commands in <em class="filename">/usr/bin</em>:
<tt class="command">answer</tt>,
<tt class="command">checkalias</tt>,
<tt class="command">elm</tt>, <tt class="command">fastmail</tt>,
<tt class="command">filter</tt>, <tt class="command">frm</tt>,
<tt class="command">listalias</tt>, <tt class="command">messages</tt>,
<tt class="command">newalias</tt>, <tt class="command">newmail</tt>,
<tt class="command">printmail</tt>, and <tt class="command">readmsg</tt>.  There
should also be equivalent online reference pages in
<em class="filename">/usr/man/man1</em> and
<em class="filename">/usr/man/man8</em>.</p>

<p>Next, install your software on the system:
<blockquote><pre class="code"># <tt class="userinput"><b>make install</b></tt></pre></blockquote></p>

<p>
<img src="figs/bomb.gif">&nbsp;&nbsp; As of the time of this writing (Elm Version 2.4), there is a
known security risk with <tt class="command">arepdaemon</tt> and
<tt class="command">autoreply</tt>.  These should be removed from your
system.  The manual pages for these utilities should also be removed
before you update your <tt class="command">whatis</tt> database by running
<tt class="command">makewhatis</tt>. If you are using Elm 2.4 PL 24 or
later, these programs have already been removed from the ELM distribution.</p>

<p>Before running Elm, read and dispose of any queued mail for the
root user.  You will be testing
the Elm configuration as root,
and you don't want to lose any pending messages.</p>

<p>Now test your installation by running Elm.  First, check that Elm correctly detects that you have no existing mail (still as the root user):</p>

<blockquote><pre class="code"># <tt class="userinput"><b>elm -z</b></tt></pre></blockquote>

<p>Elm should display the message <tt class="literal">no mail</tt> and exit.  (If there is mail
for root, Elm will come up in interactive mode and list the messages at
the Index screen.)</p>

<p>Next, check for correct mailbox handling.  (Elm creates a test mail
folder when it installs):</p>

<blockquote><pre class="code"># <tt class="userinput"><b>elm -f test/test.mail</b></tt></pre></blockquote>

<p>Exit without marking any messages for deletion.  Elm should prompt you
for correct handling of the messages.</p>

<p>Assume a nonprivileged user identity and run <tt class="command">elm
-z</tt>.  Elm should not load unless there is pending
mail.  If there is pending mail and you have not previously had Elm
installed (don't have a <em class="filename">$HOME/.elm</em> directory),
Elm should prompt you to create the directory.  You need to edit the
<em class="filename">SYSTEM_ALIASES</em> file to set up at least one alias,
defining the identity of the system postmaster so that mail sent to
the postmaster at your site is handled correctly.  Then, the
<tt class="command">newaliases</tt> command must be run to set up the
aliases table.  The procedure is described in the <em class="emphasis">Elm
Configuration Guide</em> for your version of Elm.</p>

<p>Once you are satisfied that Elm is configured and installed properly,
you can propagate the installation of Elm on your whole
<span class="acronym">LAN</span>, if you maintain mail services on more than one
host.  The directions for the <tt class="command">make</tt> process are
included in the <em class="filename">Instruct</em> file of the Elm
distribution.</p>
</div>


<div class="sect3">
<h3 class="sect3">16.2.4.3. Elm documentation</h3>

<p><a name="INDEX-3381" />
There is a set of documents for Elm that may be useful for tuning Elm
or building scripts for advanced mail management. The Elm document
set on your system most likely matches the version of Elm you are
running, which is a critical advantage.  These are the guides available in the Elm
document set:</p>

<dl>
<dt><b><em class="emphasis">Elm User's Guide</em></b></dt><dd><p>
Provides some history of Elm, fundamental usage, and credits for 
contributors to the continued development of Elm. This guide provides basic usage 
information but is thin on concepts, some of which are described in the 
<em class="emphasis">Elm Reference Guide</em> or in other guides.  Unless your version of
Elm is later than Version 2.4, you probably won't need this except to 
satisfy your curiosity.</p></dd>


<dt><b><em class="emphasis">Elm Reference Guide</em></b></dt><dd><p>
Discusses Elm and the options within the Elm environment, Elm advanced
features and debugging, <em class="filename">elmrc</em> options file customization, and more. This guide provides some of the conceptual information that the <em class="emphasis">Elm User's Guide</em> omits as well as useful practical and conceptual information on various 
Elm features and utilities. This volume can be 
handy when configuring Elm, and it contains some information
of interest only to mail administrators.</p></dd>


<dt><b><em class="emphasis">Elm Alias User's Guide</em></b></dt><dd><p>
Tells how to set up and maintain mail aliases in Elm and the related files.</p></dd>


<dt><b><em class="emphasis">Elm Filter System User's Guide</em></b></dt><dd><p>
Tells how to use Elm mail-filter utilities to automate some mail handling.</p></dd>


<dt><b><em class="emphasis">Elm Configuration Guide</em></b></dt><dd><p>
Discusses all the available options of the current version of Elm to
help you fine-tune your configuration.  You can get into trouble if you rely only on this volume, so if you decide to tinker with some of
the more arcane options, we recommend you change them one by one and
test the results rather than make wholesale changes.  This volume is
of practical interest to mail administrators, though, who should use
it in conjunction with a printout of a complete
<em class="filename">elmrc</em> file and the <em class="filename">sysdefs.h</em>
file on the system.</p></dd>


<dt><b><em class="emphasis">Elm Forms Mode Guide</em></b></dt><dd><p>
Describes the use of <span class="acronym">AT&amp;T</span> Mail Forms, which Elm
supports.  This feature
isn't useful to most Elm mail users, but if you need the feature, you
need this guide as well.</p></dd>


<dt><b><em class="emphasis">Elm reference pages</em></b></dt><dd><p>
<a name="INDEX-3382" />
Elm has online reference pages you can access using the 
<tt class="command">man</tt> command for each utility that you can invoke from the
command line and a reference page that describes files that Elm
creates and uses in mail management.  These are always useful, and you
should use them generously at any time.  They describe the command-line
options for each command and provide technical detail that may not be
available anywhere else.  Some sites may keep these files in a
printable format as well--in PostScript, text, or another format--so you can have them at hand for personal reference.</p></dd>

</dl>

<p> 
Elm also contains internal help, which is stored in a set of files
you can print for convenient hardcopy reference.  These files are:</p>

<dl>
<dt><b><em class="filename">elm-help.0</em></b></dt><dd><p>
Help for Elm Actions (internal commands) available from the Index screen</p></dd>


<dt><b><em class="filename">elm-help.1</em></b></dt><dd><p>
Help for Elm Options (user customization) menu</p></dd>


<dt><b><em class="filename">elm-help.2</em></b></dt><dd><p>
Help for the Elm Alias menu</p></dd>


<dt><b><em class="filename">elm-help.3</em></b></dt><dd><p>
Help for Elm Actions available from the message display screen</p></dd>

</dl>

<p />

<a name="INDEX-3383" /><a name="INDEX-3,384" /><a name="INDEX-3,385" /><a name="INDEX-3,386" />
</div>
</div>




<div class="sect2">
<h3 class="sect2">16.2.5. Using Netscape Messenger</h3>

<p>Netscape Navigator, the web browser that you
<a name="INDEX-3387" />
<a name="INDEX-3388" />
		learned about at the beginning of this chapter, is
		accompanied by a suite of other programs. These include the
		mailer, Netscape Messenger. If you have downloaded (or
		installed from your distribution media) the full Netscape
		Communicator package, you already have Netscape Messenger. If
		not, get Netscape Communicator, because Messenger is currently not
		available standalone.</p>

<p>Many people criticize Netscape Messenger for being slow
		and for missing some features. But on the other hand, Messenger is
		easy to set up and has some nice features like hierarchical
		folders and tight integration with the web browser.</p>

<p>Once you have installed Netscape Communicator, you can
		run the web browser Netscape Navigator as usual and then open
		up the Messenger window by selecting
		Messenger from the
		Communicator menu or by 
		pressing the key combination Alt-2.</p>

<p>The Messenger window (see <a href="ch16_02.htm">Figure 16-13</a>) is divided by default into
		three parts. On the left, you see the tree of folders (at
		first startup, you will have only the default
		folders, of course), the upper part of the right side shows a
		listing of mails in the currently selected folder, and the
		lower part of the right side shows the currently selected
		mail. You can change how the space is distributed between
		these parts by dragging on the knob on the separator line
		between them.</p>

<a name="x-100-3-fig-messenger" /><div class="figure"><img src="figs/rl3_1613.gif" alt="Figure 16-13" /></div><h4 class="objtitle">Figure 16-13. Netscape Messenger window</h4><p>Before you can first use Messenger, you have to
		set up
		some things first. Select Edit
		from the Preferences menu and then open the configuration group Mail &amp;
		Newsgroups by clicking on the little arrow next to
		it. You have to fill out at least the
		Identity and Mail
		Servers forms. First click on Identity
		and enter your name and email address as indicated in the
		dialog box.</p>

<p>Next, click on Mail Servers. The
		upper half of the dialog box shows a list of mail servers that
		Messenger should retrieve mail from. Unfortunately, even
		though there is a whole list provided here, you can have only
		one mail server unless you use the <span class="acronym">IMAP</span>
		protocol.</p>

<p>To configure an Incoming Mail Server, 
		click on the Add... button and fill out the 
		form that appears. Your system administrator or your Internet
		provider will be able to give you all the data you need. Note
		that you can choose between three server types. For
		<span class="acronym">POP3</span> and <span class="acronym">IMAP</span>, you will
		have to specify your username and password as they appear on your provider's
		server in addition to protocol-specific parameters. If you use 
		one of those two server types, you do not need an
		<span class="acronym">MTA</span> on your machine; Messenger automatically retrieves the mail and sorts the messages into
		your mail folders without any other programs intervening.</p>

<p>The option <tt class="literal">movemail</tt>, on the other
		hand, is used when you have set up other software like the
		<span class="acronym">MTA</span> <tt class="command">smail</tt> and the mail-fetching program <tt class="command">fetchmail</tt>, both described
		earlier in this chapter. In this case, those programs will
		retrieve your mail and put them into your mail folder somewhere on your system, often
		<em class="filename">/var/spool/mail/</em><em class="replaceable">username</em>. 
		In this case, tell Messenger where <tt class="command">movemail</tt> should pick up your mail from.</p>

<p>The next thing to set up is the outgoing mail server. If 
		you have set up your own <span class="acronym">SMTP</span> server
		because you have installed an <span class="acronym">MTA</span>, enter
		either <tt class="literal">localhost</tt> (if
		the <span class="acronym">SMTP</span> is running on the same machine as
		Messenger) or the hostname of the machine the
		<span class="acronym">SMTP</span> server is running on. On the
		other hand, if you want to send outgoing mail directly to your
		provider, enter the hostname of your provider's
		<span class="acronym">SMTP</span> server here. Depending on your
		provider, you might also need to specify your account name
		here again.</p>

<p>Once you are done with the configuration, you can tell
		Messenger to get your mail from wherever you specified
		and sort it into your folders. This is done by either
		clicking the Get Msg toolbar button or
		selecting File/Get New Messages from the
		File menu. If you get your mail from a
		<span class="acronym">POP3</span> or <span class="acronym">IMAP</span> server,
		Messenger will first ask you for your password and then fetch
		your mail. All messages
		will be put into the Inbox folder where you 
		can read them, store them into other folders, or simply delete
		them. How messages are dealt with is quite intuitive. You will 
		be able to guess most of the functionality from the user
		interface. But when you are in doubt, you can always use
		the Help menu which, when you select an
		entry, opens a browser window (or reuses an already
		existing one) and shows the documentation on Netscape's web
		server.</p>

<p>To write a mail message, press Alt-M, click on the
		New Msg toolbar button, or select
		Message/New Message from the Message
		menu. Messenger opens a form where you can enter the
		recipients, the subject and, of course, the text of your
		mail.</p>

<p>Once you are done editing your mail you can press
		Alt-Enter, click on the Send toolbar button,
		or select Send Now from the File menu of
		the composition window. Messenger then directly contacts
		the <span class="acronym">SMTP</span> server that you have configured and
		tries to send your mail. Of course, if you are using your
		provider's <span class="acronym">SMTP</span> server, this requires that you are
		connected to your provider at that time or that you have
		configured your computer or gateway to dial out on demand.</p>

<p>If you have configured Messenger to use your provider's
		<span class="acronym">SMTP</span> server and you have only a dial-up
		connection to the Internet, you might want to use another
		nifty feature of Messenger: if you send your mail by pressing
		Alt-Shift-Enter or selecting Send
		Later from the composition window's File menu, the
		message is not directly sent out, but instead stored in the
		Unsent Messages folder. You can collect
		your messages there until you have opened an Internet
		collection and then send them all at once by choosing
		Send Unsent Messages from the
		File menu. This is especially useful if dialing up to
		the Internet is costly where you live, because you can
		save yourself a lot of connection time.</p>

<p>We have only scratched the surface of what Messenger can 
		do, and you might want to experiment further with it. A
		fairly basic thing to try out is to create new folders by
		selecting New Subfolder... from the File
		menu and then have Messenger sort your incoming messages
		automatically into the folders by subject, sender, or a number
		of other criteria. Sorting is accomplished by a feature called
		filters, which you
		can configure by selecting Message
		Filters... from the Edit menu.</p>
</div>




<a name="INDEX-3389" />


<hr align="left" width="515" />
<div class="navbar">
<table border="0" width="515">
<tr><td width="172" valign="top" align="left"><a href="ch16_01.htm">
 <img src="../gifs/txtpreva.gif" alt="Previous" border="0" /></a></td>
<td width="171" valign="top" align="center"><a href="index.htm">
<img src="../gifs/txthome.gif" alt="Home" border="0" /></a></td>
<td width="172" valign="top" align="right"><a href="appa_01.htm">
<img src="../gifs/txtnexta.gif" alt="Next" border="0" /></a></td></tr><tr>
<td width="172" valign="top" align="left">16. The World Wide Web and
 Electronic Mail</td><td width="171" valign="top" align="center">
<a href="index/index.htm"><img src="../gifs/index.gif" alt="Book Index" border="0" /></a></td>
<td width="172" valign="top" align="right">Appendix A: Sources of Linux Information</td></tr></table></div>
<hr align="left" width="515" />

<img src="../gifs/navbar.gif" alt="Library Navigation Links" usemap="#library-map" border="0" />
<p><font size="-1"><a href="copyrght.htm">Copyright &copy; 2001</a> O'Reilly &amp; Associates. All rights reserved.</font></p>

<map name="library-map"><area href="../index.htm" coords="1,1,83,102" shape="rect" /><area href="../lnut/index.htm" coords="81,0,152,95" shape="rect" /><area href="index.htm" coords="172,2,252,105" shape="rect" /><area href="../apache/index.htm" coords="238,2,334,95" shape="rect" /><area href="../sql/index.htm" coords="336,0,412,104" shape="rect" /><area href="../dbi/index.htm" coords="415,0,507,101" shape="rect" /><area href="../cgi/index.htm" coords="511,0,601,99" shape="rect" /></map>

</body></html>