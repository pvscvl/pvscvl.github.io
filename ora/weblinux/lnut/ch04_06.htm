<?label 4.6. initrd: Using a RAM Disk?><html><head><title>initrd: Using a RAM Disk (Linux in a Nutshell, 3rd Edition)</title><link href="../style/style1.css" type="text/css" rel="stylesheet" />

<meta name="DC.Creator" content="Ellen Siever, Stephen Spainhour, Stephen Figgins and Jessica P. Hekman" /><meta scheme="MIME" content="text/xml" name="DC.Format" /><meta content="en-US" name="DC.Language" /><meta content="O'Reilly & Associates, Inc." name="DC.Publisher" /><meta scheme="ISBN" name="DC.Source" content="0596000251L" /><meta name="DC.Subject.Keyword" content="stuff" /><meta name="DC.Title" content="Linux in a Nutshell, 3rd Edition" /><meta content="Text.Monograph" name="DC.Type" />

</head><body bgcolor="#ffffff">

<img src="gifs/smbanner.gif" alt="Book Home" usemap="#banner-map" border="0" /><map name="banner-map"><area alt="Linux in a Nutshell" href="index.htm" coords="0,0,466,65" shape="rect" /><area alt="Search this book" href="jobjects/fsearch.htm" coords="467,0,514,18" shape="rect" /></map>

<div class="navbar"><table border="0" width="515"><tr><td width="172" valign="top" align="left"><a href="ch04_05.htm"><img src="../gifs/txtpreva.gif" alt="Previous" border="0" /></a></td><td width="171" valign="top" align="center"><a href="index.htm">Linux in a Nutshell, 3rd Edition</a></td><td width="172" valign="top" align="right"><a href="ch05_01.htm"><img src="../gifs/txtnexta.gif" alt="Next" border="0" /></a></td></tr></table></div>
<hr align="left" width="515" />


<h2 class="sect1">4.6. initrd: Using a RAM Disk</h2>


<p><a name="INDEX-1278" /><a name="INDEX-1279" /><a name="INDEX-1280" /><a name="INDEX-1281" /><a name="INDEX-1282" />Modern Linux distributions use a modular kernel, which allows modules
to be added without requiring that the kernel be rebuilt.  If your
root filesystem is on a device whose driver is a module, as is
frequently true of SCSI disks, you can use the <b class="emphasis-bold">initrd</b> facility, which provides a two-stage
boot process, to first set up a temporary root filesystem in a RAM
disk containing the modules you need to add (e.g., the SCSI driver)
and then load the modules and mount the real root filesystem.  The RAM
disk containing the temporary filesystem is the special device file
<em class="emphasis">/dev/initrd</em>.</p>


<p>Before you can use <b class="emphasis-bold">initrd</b>, both RAM
disk support (CONFIG_BLK_DEV_RAM=y) and initial RAM disk support
(CONFIG_BLK_DEV_INITRD=y) must be compiled into the Linux kernel.
Then you need to prepare the normal root filesystem and create the RAM
disk image. Your Linux distribution may have utilities to do some of
the setup for you; for example, the Red Hat distribution comes with
the
<?troff \p?><b class="emphasis-bold">mkinitrd</b> command, which builds
the <b class="emphasis-bold">initrd</b> image. For detailed
information, see the <b class="emphasis-bold">initrd</b> manpage
and the file <em class="emphasis">initrd.txt</em> (the path may vary but is
usually something like
<em class="emphasis">/usr/src/linux/Documentation/initrd.txt</em>).</p>


<p>Once your Linux system has been set up for <b class="emphasis-bold">initrd</b>, you can do one of the following,
depending on which boot loader you are using:</p>


<ul><li><p>If LILO is your boot loader, add the <b class="emphasis-bold">initrd</b> option to the appropriate image section:</p>


<blockquote><pre class="code">image = /vmlinuz
  initrd = /boot/initrd  # The file to load as the contents of /dev/initrd
  ...</pre></blockquote>


<p>Run the <b class="emphasis-bold">/sbin/lilo</b> command, and you
can reboot with <b class="emphasis-bold">initrd</b>.</p></li><li><p>If you are using Loadlin, add the <b class="emphasis-bold">initrd</b> option to the command line:</p>


<blockquote><pre class="code">loadlin c:\linux\vmlinuz initrd=c:\linux\initrd</pre></blockquote></li></ul>



<hr align="left" width="515" />
<div class="navbar"><table border="0" width="515"><tr><td width="172" valign="top" align="left"><a href="ch04_05.htm"><img src="../gifs/txtpreva.gif" alt="Previous" border="0" /></a></td><td width="171" valign="top" align="center"><a href="index.htm"><img src="../gifs/txthome.gif" alt="Home" border="0" /></a></td><td width="172" valign="top" align="right"><a href="ch05_01.htm"><img src="../gifs/txtnexta.gif" alt="Next" border="0" /></a></td></tr><tr><td width="172" valign="top" align="left">4.5. Boot-time Kernel Options</td><td width="171" valign="top" align="center"><a href="index/index.htm"><img src="../gifs/index.gif" alt="Book Index" border="0" /></a></td><td width="172" valign="top" align="right">5. Red Hat and Debian Package Managers</td></tr></table></div>
<hr align="left" width="515" />

<img src="../gifs/navbar.gif" alt="Library Navigation Links" usemap="#library-map" border="0" />
<p><font size="-1"><a href="copyrght.htm">Copyright &copy; 2001</a> O'Reilly &amp; Associates. All rights reserved.</font></p>

<map name="library-map"><area href="../index.htm" coords="1,1,83,102" shape="rect" /><area href="index.htm" coords="81,0,152,95" shape="rect" /><area href="../run/index.htm" coords="172,2,252,105" shape="rect" /><area href="../apache/index.htm" coords="238,2,334,95" shape="rect" /><area href="../sql/index.htm" coords="336,0,412,104" shape="rect" /><area href="../dbi/index.htm" coords="415,0,507,101" shape="rect" /><area href="../cgi/index.htm" coords="511,0,601,99" shape="rect" /></map>

</body></html>