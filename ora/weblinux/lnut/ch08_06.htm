<?label 8.6. Command History?><html><head><title>Command History (Linux in a Nutshell, 3rd Edition)</title><link href="../style/style1.css" type="text/css" rel="stylesheet" />

<meta name="DC.Creator" content="Ellen Siever, Stephen Spainhour, Stephen Figgins and Jessica P. Hekman" /><meta scheme="MIME" content="text/xml" name="DC.Format" /><meta content="en-US" name="DC.Language" /><meta content="O'Reilly & Associates, Inc." name="DC.Publisher" /><meta scheme="ISBN" name="DC.Source" content="0596000251L" /><meta name="DC.Subject.Keyword" content="stuff" /><meta name="DC.Title" content="Linux in a Nutshell, 3rd Edition" /><meta content="Text.Monograph" name="DC.Type" />

</head><body bgcolor="#ffffff">

<img src="gifs/smbanner.gif" alt="Book Home" usemap="#banner-map" border="0" /><map name="banner-map"><area alt="Linux in a Nutshell" href="index.htm" coords="0,0,466,65" shape="rect" /><area alt="Search this book" href="jobjects/fsearch.htm" coords="467,0,514,18" shape="rect" /></map>

<div class="navbar"><table border="0" width="515"><tr><td width="172" valign="top" align="left"><a href="ch08_05.htm"><img src="../gifs/txtpreva.gif" alt="Previous" border="0" /></a></td><td width="171" valign="top" align="center"><a href="index.htm">Linux in a Nutshell, 3rd Edition</a></td><td width="172" valign="top" align="right"><a href="ch08_07.htm"><img src="../gifs/txtnexta.gif" alt="Next" border="0" /></a></td></tr></table></div>
<hr align="left" width="515" />


<h2 class="sect1">8.6. Command History</h2>


<p><a name="INDEX-1568" /><a name="INDEX-1569" />Previously executed commands are stored in a history list.
The C shell lets you access this list
so you can verify commands, repeat them, or execute modified versions of them.
The <b class="emphasis-bold">history</b> built-in command displays 
the history list; the predefined variables 
<b class="emphasis-bold">histchars</b> and 
<b class="emphasis-bold">history</b> also affect the history mechanism.
There are four ways to use the history list:</p>


<ul><li><p>Rerun a previous command</p></li><li><p>Make command substitutions</p></li><li><p>Make argument substitutions (replace specific words in a command)</p></li><li><p>Extract or replace parts of a command or word</p></li></ul><p>The following subsections describe the <b class="emphasis-bold">csh</b> tools 
for editing and rerunning commands.  If you are running 
<b class="emphasis-bold">tcsh</b>, you can use any of these features. In addition,
you can use the arrow keys to move around in the command line and then
use the editing features described in <a href="ch08_07.htm">Section 8.7.5, "Command-Line Editing with tcsh"</a> to modify the command. The <b class="emphasis-bold">tcsh</b>
arrow keys are:</p>


<a name="ln.ch05.tbl.37" /><table cellpadding="4" border="1">




<tr>
<th>Key</th>
<th>Description</th>
</tr>






<tr>
<td>Up arrow</td>
<td>Previous command.</td>
</tr>


<tr>
<td>Down arrow</td>
<td>Next command.</td>
</tr>


<tr>
<td>Left arrow</td>
<td>Move left in command line.</td>
</tr>


<tr>
<td>Right arrow</td>
<td>Move right in command line.</td>
</tr>



</table><a name="ln.ch05.div.35" /><div class="sect2">
<h3 class="sect2">8.6.1. Command Substitution</h3>


<a name="INDEX-1570" /><a name="ln.ch05.tbl.20" /><table cellpadding="4" border="1">




<tr>
<th>Command</th>
<th>Description</th>
</tr>






<tr>
<td>

<tt class="literal">!</tt></td>
<td>Begin a history substitution.</td>
</tr>



<tr>
<td>

<tt class="literal">!!</tt></td>
<td>Previous command.</td>
</tr>



<tr>
<td>

<tt class="literal">!</tt><em class="replaceable">N</em></td>
<td><p>Command number <em class="replaceable">N</em> in history list.
</p></td>
</tr>


<tr>
<td>

<tt class="literal">!-</tt><em class="replaceable">N</em></td>
<td><p><em class="replaceable">N</em>th command back from current command.
</p></td>
</tr>


<tr>
<td>

<tt class="literal">!</tt><em class="replaceable">string</em></td>
<td><p>Most recent command that starts with <em class="replaceable">string</em>.
</p></td>
</tr>


<tr>
<td>

<tt class="literal">!?</tt><em class="replaceable">string</em>?</td>
<td><p>Most recent command that contains <em class="replaceable">string</em>.
</p></td>
</tr>


<tr>
<td>

<tt class="literal">!?</tt><em class="replaceable">string?%</em></td>
<td><p>Most recent command argument that contains <em class="replaceable">string</em>.
</p></td>
</tr>


<tr>
<td>

<tt class="literal">!$</tt></td>
<td>Last argument of previous command.</td>
</tr>



<tr>
<td>

<tt class="literal">!!</tt><em class="replaceable">string</em></td>
<td><p>Previous command, then append <em class="replaceable">string</em>.
</p></td>
</tr>


<tr>
<td>

<tt class="literal">!</tt><em class="replaceable">N string</em></td>
<td><p>Command <em class="emphasis">N</em>, then append <em class="replaceable">string</em>.
</p></td>
</tr>


<tr>
<td>

<tt class="literal">!{</tt><em class="replaceable">s1</em>}<em class="replaceable">s2</em></td>
<td><p>Most recent command starting with string <em class="replaceable">s1</em>,
then append string <em class="replaceable">s2</em>.
</p></td>
</tr>


<tr>
<td>

<tt class="literal">^</tt><em class="replaceable">old</em>^<em class="replaceable">new</em>^</td>
<td><p>Quick substitution; change string <em class="replaceable">old</em> to <em class="replaceable">new</em> in previous 
command; execute modified command.</p></td>
</tr>



</table>
</div>








<a name="ln.ch05.div.36" /><div class="sect2">
<h3 class="sect2">8.6.2. Command Substitution Examples</h3>


<p>The following command is assumed:</p>


<blockquote><pre class="code">%3 vi cprogs/01.c ch002 ch03</pre></blockquote>


<a name="ln.ch05.tbl.21" /><table cellpadding="4" border="1">






<tr>
<th><b class="emphasis-bold">Event</b></th>
<th><b class="emphasis-bold">Command</b></th>
<th><b class="emphasis-bold">Command</b></th>
</tr>


<tr>
<th><b class="emphasis-bold">Number</b></th>
<th><b class="emphasis-bold">Typed</b></th>
<th><b class="emphasis-bold">Executed

</b></th>
</tr>






<tr>
<td>4</td>
<td>

<tt class="literal">^00^0</tt></td>
<td>

<tt class="literal">vi cprogs/01.c ch02 ch03

</tt></td>
</tr>


<tr>
<td>5</td>
<td>

<tt class="literal">nroff !*</tt></td>
<td>

<tt class="literal">nroff cprogs/01.c ch02 ch03

</tt></td>
</tr>


<tr>
<td>6</td>
<td>

<tt class="literal">nroff !$</tt></td>
<td>

<tt class="literal">nroff ch03

</tt></td>
</tr>


<tr>
<td>7</td>
<td>

<tt class="literal">!vi</tt></td>
<td>

<tt class="literal">vi cprogs/01.c ch02 ch03

</tt></td>
</tr>


<tr>
<td>8</td>
<td>

<tt class="literal">!6</tt></td>
<td>

<tt class="literal">nroff ch03

</tt></td>
</tr>


<tr>
<td>9</td>
<td>

<tt class="literal">!?01</tt></td>
<td><tt class="literal">vi cprogs/01.c ch02 ch03

</tt></td>
</tr>


<tr>
<td>10</td>
<td>

<tt class="literal">!{nr}.new</tt></td>
<td>

<tt class="literal">nroff ch03.new

</tt></td>
</tr>


<tr>
<td>11</td>
<td>

<tt class="literal">!!|lp</tt></td>
<td>

<tt class="literal">nroff ch03.new | lp

</tt></td>
</tr>


<tr>
<td>12</td>
<td>

<tt class="literal">more !?pr?%</tt></td>
<td>

<tt class="literal">more cprogs/01.c

</tt></td>
</tr>



</table>
</div>








<a name="ln.ch05.div.37" /><div class="sect2">
<h3 class="sect2">8.6.3. Word Substitution</h3>


<a name="INDEX-1571" /><p>Colons may precede any word specifier. 
</p>


<a name="ln.ch05.tbl.22" /><table cellpadding="4" border="1">




<tr>
<th>Specifier</th>
<th>Description</th>
</tr>






<tr>
<td>

<tt class="literal">:0</tt></td>
<td>Command name</td>
</tr>



<tr>
<td>

<tt class="literal">:</tt><em class="replaceable">n</em></td>
<td>Argument number <em class="replaceable">n</em></td>
</tr>



<tr>
<td>

<tt class="literal">^</tt></td>
<td>First argument</td>
</tr>



<tr>
<td>

<tt class="literal">$</tt></td>
<td>Last argument</td>
</tr>



<tr>
<td>

<tt class="literal">:</tt><em class="replaceable">n</em>-<em class="replaceable">m</em></td>
<td>Arguments <em class="replaceable">n</em> through <em class="replaceable">m</em></td>
</tr>



<tr>
<td>

<tt class="literal">-</tt><em class="replaceable">m</em></td>
<td>Words 0 through <em class="replaceable">m</em> same as :0-<em class="replaceable">m</em></td>
</tr>



<tr>
<td>

<tt class="literal">:</tt><em class="replaceable">n</em>-</td>
<td>Arguments <em class="replaceable">n</em> through next-to-last</td>
</tr>



<tr>
<td>

<tt class="literal">:</tt><em class="replaceable">n</em>*</td>
<td><p>Arguments <em class="replaceable">n</em> through last; same as <em class="replaceable">n</em>-$
</p></td>
</tr>


<tr>
<td>

<tt class="literal">*</tt></td>
<td>All arguments; same as ^-$ or 1-$</td>
</tr>



<tr>
<td>

<tt class="literal">#</tt></td>
<td><p>Current command line up to this point; fairly useless</p></td>
</tr>



</table>

</div>








<a name="ln.ch05.div.38" /><div class="sect2">
<h3 class="sect2">8.6.4. Word Substitution Examples</h3>


<p>The following command is assumed:</p>


<blockquote><pre class="code">%13 <tt class="userinput"><b>cat ch01 ch02 ch03 biblio back</b></tt></pre></blockquote>


<a name="ln.ch05.tbl.23" /><table cellpadding="4" border="1">






<tr>
<th><b class="emphasis-bold">Event</b></th>
<th><b class="emphasis-bold">Command</b></th>
<th><b class="emphasis-bold">Command</b></th>
</tr>


<tr>
<th><b class="emphasis-bold">Number</b></th>
<th><b class="emphasis-bold">Typed</b></th>
<th><b class="emphasis-bold">Executed

</b></th>
</tr>






<tr>
<td>14</td>
<td>

<tt class="literal">ls !13^</tt></td>
<td>

<tt class="literal">ls ch01</tt></td>
</tr>


<tr>
<td>15</td>
<td>

<tt class="literal">sort !13:*</tt></td>
<td>

<tt class="literal">sort ch01 ch02 ch03 biblio back</tt></td>
</tr>


<tr>
<td>16</td>
<td>

<tt class="literal">lp !cat:3*</tt></td>
<td>

<tt class="literal">more ch03 biblio back</tt></td>
</tr>


<tr>
<td>17</td>
<td>

<tt class="literal">!cat:0-3</tt></td>
<td>

<tt class="literal">cat ch01 ch02 ch03</tt></td>
</tr>


<tr>
<td>18</td>
<td>

<tt class="literal">vi !-5:4</tt></td>
<td>

<tt class="literal">vi biblio</tt></td>
</tr>



</table>
</div>








<a name="ln.ch05.div.39" /><div class="sect2">
<h3 class="sect2">8.6.5. History Modifiers</h3>


<p>Command and word substitutions can be modified by one or more
of the following modifiers:</p>


<?troff .Nd 10?><a name="ln.ch05.div.40" /><div class="sect3">
<h3 class="sect3">8.6.5.1. Printing, substitution, and quoting</h3>



<a name="ln.ch05.tbl.24" /><table cellpadding="4" border="1">




<tr>
<th>Modifier</th>
<th>Description</th>
</tr>






<tr>
<td><b class="emphasis-bold">:p</b></td>
<td>Display command, but don't execute.</td>
</tr>


<tr>
<td><b class="emphasis-bold">:s</b>/<em class="replaceable">old</em>/<em class="replaceable">new</em></td>
<td><p>Substitute string <em class="replaceable">new</em> for <em class="replaceable">old</em>,
first instance only.</p></td>
</tr>


<tr>
<td><b class="emphasis-bold">:gs</b>/<em class="replaceable">old</em>/<em class="replaceable">new</em></td>
<td><p>Substitute string <em class="replaceable">new</em> for <em class="replaceable">old</em>, all instances.</p></td>
</tr>


<tr>
<td><b class="emphasis-bold">:&amp;</b></td>
<td><p>Repeat previous substitution (<b class="emphasis-bold">:s</b> or <b class="emphasis-bold">^</b> command),
first instance only.</p></td>
</tr>


<tr>
<td><b class="emphasis-bold">:g&amp;</b></td>
<td>Repeat previous substitution, all instances.</td>
</tr>


<tr>
<td><b class="emphasis-bold">:q</b></td>
<td>Quote a wordlist.</td>
</tr>


<tr>
<td><b class="emphasis-bold">:x</b></td>
<td>Quote separate words.</td>
</tr>



</table>

</div>




<a name="ln.ch05.div.41" /><div class="sect3">
<h3 class="sect3">8.6.5.2. Truncation</h3>



<a name="ln.ch05.tbl.25" /><table cellpadding="4" border="1">




<tr>
<th>Modifier</th>
<th>Description</th>
</tr>






<tr>
<td><b class="emphasis-bold">:r</b></td>
<td><p>Extract the first available pathname root (the portion before the
last period).</p></td>
</tr>


<tr>
<td><b class="emphasis-bold">:gr</b></td>
<td>Extract all pathname roots.</td>
</tr>


<tr>
<td><b class="emphasis-bold">:e</b></td>
<td><p>Extract the first available pathname extension (the portion
after the last period).</p></td>
</tr>


<tr>
<td><b class="emphasis-bold">:ge</b></td>
<td>Extract all pathname extensions.</td>
</tr>


<tr>
<td><b class="emphasis-bold">:h</b></td>
<td><p>Extract the first available pathname header (the portion before the
last slash).</p></td>
</tr>


<tr>
<td><b class="emphasis-bold">:gh</b></td>
<td>Extract all pathname headers.</td>
</tr>


<tr>
<td><b class="emphasis-bold">:t</b></td>
<td><p>Extract the first available pathname tail (the portion after the
last slash).</p></td>
</tr>


<tr>
<td><b class="emphasis-bold">:gt</b></td>
<td>Extract all pathname tails.</td>
</tr>


<tr>
<td><b class="emphasis-bold">:u</b></td>
<td>Make first lowercase letter uppercase (<b class="emphasis-bold">tcsh</b> only).</td>
</tr>


<tr>
<td><b class="emphasis-bold">:l</b></td>
<td>Make first uppercase letter lowercase (<b class="emphasis-bold">tcsh</b> only).</td>
</tr>


<tr>
<td><b class="emphasis-bold">:a</b></td>
<td><p>Apply modifier(s) following <b class="emphasis-bold">a</b> as many times as possible to a word. 
If used with <b class="emphasis-bold">g</b>, <b class="emphasis-bold">a</b> is applied to all words
(<b class="emphasis-bold">tcsh</b> only).</p></td>
</tr>



</table>

</div>
</div>








<a name="ln.ch05.div.42" /><div class="sect2">
<h3 class="sect2">8.6.6. History Modifier Examples</h3>


<p>From the preceding, command number 17 is:</p>


<blockquote><pre class="code">%17 <tt class="userinput"><b>cat ch01 ch02 ch03</b></tt></pre></blockquote>


<a name="ln.ch05.tbl.26" /><table cellpadding="4" border="1">






<tr>
<th><b class="emphasis-bold">Event</b></th>
<th><b class="emphasis-bold">Command</b></th>
<th><b class="emphasis-bold">Command</b></th>
</tr>


<tr>
<th><b class="emphasis-bold">Number</b></th>
<th><b class="emphasis-bold">Typed</b></th>
<th><b class="emphasis-bold">Executed</b></th>
</tr>







<tr>
<td>19</td>
<td>

<tt class="literal">!17:s/ch/CH/</tt></td>
<td>

<tt class="literal">cat CH01 ch02 ch03</tt></td>
</tr>


<tr>
<td>20</td>
<td>

<tt class="literal">!17g&amp;</tt></td>
<td>

<tt class="literal">cat CH01 CH02 CH03</tt></td>
</tr>


<tr>
<td>21</td>
<td>

<tt class="literal">!more:p</tt></td>
<td>

<tt class="literal">more cprogs/01.c</tt> <em class="emphasis">(displayed only)</em></td>
</tr>


<tr>
<td>22</td>
<td>

<tt class="literal">cd !$:h</tt></td>
<td>

<tt class="literal">cd cprogs</tt></td>
</tr>


<tr>
<td>23</td>
<td>

<tt class="literal">vi !mo:$:t</tt></td>
<td>

<tt class="literal">vi 01.c</tt></td>
</tr>


<tr>
<td>24</td>
<td>

<tt class="literal">grep stdio !$</tt></td>
<td>

<tt class="literal">grep stdio 01.c</tt></td>
</tr>


<tr>
<td>25</td>
<td>

<tt class="literal">^stdio^include stdio^:q</tt></td>
<td>

<tt class="literal">grep &lt;"&gt;include stdio&lt;"&gt; 01.c</tt></td>
</tr>


<tr>
<td>26</td>
<td>

<tt class="literal">nroff !21:t:p</tt></td>
<td>

<tt class="literal">nroff 01.c</tt> <em class="emphasis">(is that what I wanted?)</em></td>
</tr>


<tr>
<td>27</td>
<td>

<tt class="literal">!!</tt></td>
<td>

<tt class="literal">nroff 01.c</tt> <em class="emphasis">(execute it)</em></td>
</tr>



</table><p><a name="INDEX-1572" /></p>
</div>








<a name="ln.ch05.div.49" /><div class="sect2">
<h3 class="sect2">8.6.7. Special Aliases in tcsh</h3>


<a name="INDEX-1573" /><p>Certain special aliases can be set in <b class="emphasis-bold">tcsh</b>. The aliases
are initially undefined. Once set, they are executed when specific events occur.
The following is a list of the special aliases:</p>


<dl>
<dt><b><b class="emphasis-bold">beepcmd</b></b></dt><dd><p>At beep.</p></dd>



<dt><b><b class="emphasis-bold">cwdcmd</b></b></dt><dd><p>When the current working directory changes.</p></dd>



<dt><b><b class="emphasis-bold">periodic</b></b></dt><dd><p>Every few minutes. The exact amount of time is set by the 
<em class="emphasis">tperiod</em> shell
<?troff \p?>variable.</p></dd>



<dt><b><b class="emphasis-bold">precmd</b></b></dt><dd><p>Before printing a new prompt.</p></dd>



<dt><b><b class="emphasis-bold">shell</b> <em class="emphasis">shell</em></b></dt><dd><p>If a script does not specify a shell, interpret it with 
<em class="emphasis">shell</em>, which should be a full pathname.
</p></dd>

</dl>
</div>


<hr align="left" width="515" />
<div class="navbar"><table border="0" width="515"><tr><td width="172" valign="top" align="left"><a href="ch08_05.htm"><img src="../gifs/txtpreva.gif" alt="Previous" border="0" /></a></td><td width="171" valign="top" align="center"><a href="index.htm"><img src="../gifs/txthome.gif" alt="Home" border="0" /></a></td><td width="172" valign="top" align="right"><a href="ch08_07.htm"><img src="../gifs/txtnexta.gif" alt="Next" border="0" /></a></td></tr><tr><td width="172" valign="top" align="left">8.5. Expressions</td><td width="171" valign="top" align="center"><a href="index/index.htm"><img src="../gifs/index.gif" alt="Book Index" border="0" /></a></td><td width="172" valign="top" align="right">8.7. Command-Line Manipulation</td></tr></table></div>
<hr align="left" width="515" />

<img src="../gifs/navbar.gif" alt="Library Navigation Links" usemap="#library-map" border="0" />
<p><font size="-1"><a href="copyrght.htm">Copyright &copy; 2001</a> O'Reilly &amp; Associates. All rights reserved.</font></p>

<map name="library-map"><area href="../index.htm" coords="1,1,83,102" shape="rect" /><area href="index.htm" coords="81,0,152,95" shape="rect" /><area href="../run/index.htm" coords="172,2,252,105" shape="rect" /><area href="../apache/index.htm" coords="238,2,334,95" shape="rect" /><area href="../sql/index.htm" coords="336,0,412,104" shape="rect" /><area href="../dbi/index.htm" coords="415,0,507,101" shape="rect" /><area href="../cgi/index.htm" coords="511,0,601,99" shape="rect" /></map>

</body></html>