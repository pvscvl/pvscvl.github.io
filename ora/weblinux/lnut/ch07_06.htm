<?label 7.6. Command History?><html><head><title>Command History (Linux in a Nutshell, 3rd Edition)</title><link href="../style/style1.css" type="text/css" rel="stylesheet" />

<meta name="DC.Creator" content="Ellen Siever, Stephen Spainhour, Stephen Figgins and Jessica P. Hekman" /><meta scheme="MIME" content="text/xml" name="DC.Format" /><meta content="en-US" name="DC.Language" /><meta content="O'Reilly & Associates, Inc." name="DC.Publisher" /><meta scheme="ISBN" name="DC.Source" content="0596000251L" /><meta name="DC.Subject.Keyword" content="stuff" /><meta name="DC.Title" content="Linux in a Nutshell, 3rd Edition" /><meta content="Text.Monograph" name="DC.Type" />

</head><body bgcolor="#ffffff">

<img src="gifs/smbanner.gif" alt="Book Home" usemap="#banner-map" border="0" /><map name="banner-map"><area alt="Linux in a Nutshell" href="index.htm" coords="0,0,466,65" shape="rect" /><area alt="Search this book" href="jobjects/fsearch.htm" coords="467,0,514,18" shape="rect" /></map>

<div class="navbar"><table border="0" width="515"><tr><td width="172" valign="top" align="left"><a href="ch07_05.htm"><img src="../gifs/txtpreva.gif" alt="Previous" border="0" /></a></td><td width="171" valign="top" align="center"><a href="index.htm">Linux in a Nutshell, 3rd Edition</a></td><td width="172" valign="top" align="right"><a href="ch07_07.htm"><img src="../gifs/txtnexta.gif" alt="Next" border="0" /></a></td></tr></table></div>
<hr align="left" width="515" />


<h2 class="sect1">7.6. Command History</h2>


<p><b class="emphasis-bold">bash</b> lets you display or modify previous commands.
This is similar to the C shell's history mechanism.
Commands in the history list can be modified using:</p>


<ul><li><p>Line-edit mode</p></li><li><p>The <b class="emphasis-bold">fc</b> command</p></li></ul><p>In addition, the command substitutions described in <a href="ch08_01.htm">Chapter 8, "csh and tcsh"</a>, also work in <b class="emphasis-bold">bash</b>.</p>


<a name="ln.ch04.div.24" /><div class="sect2">
<h3 class="sect2">7.6.1. Line-Edit Mode</h3>


<a name="INDEX-1402" /><p>Line-edit mode lets you emulate many features of the <b class="emphasis-bold">vi</b> or Emacs editors.
The history list is treated like a file. When the editor
is invoked, you type editing keystrokes to move to
the command line you want to execute. Arrow keys work on
most terminals in both Emacs mode and 
<b class="emphasis-bold">vi</b> command mode.
You also can change the line before executing it.  See
<a href="ch07_06.htm">Table 7-23</a> for some examples of common line-edit
commands. When you're ready to issue the command, press Return.</p>


<p>The default line-edit mode is Emacs. To enable 
<b class="emphasis-bold">vi</b> mode, enter:</p>


<blockquote><pre class="code">$ <tt class="userinput"><b>set -o vi</b></tt></pre></blockquote>


<p>Note that <b class="emphasis-bold">vi</b> starts in input
mode; to type a <b class="emphasis-bold">vi</b> command, press
Esc first.</p>


<p>The mode you use for editing <b class="emphasis-bold">bash</b>
commands is an entirely separate choice from the editor that is
invoked for you automatically within many commands (for instance, the
editor mail readers invoke when you ask them to create a new mail
message). To change the default editor, set the VISUAL or EDITOR
variable to the filename or full pathname of your favorite editor:</p>


<blockquote><pre class="code">$ <tt class="userinput"><b>export EDITOR=emacs</b></tt></pre></blockquote>


<a name="ln.ch04.tbl.32" /><h4 class="objtitle">Table 7-23. Common Editing Keystrokes</h4><table cellpadding="4" border="1">






<tr>
<th><b class="emphasis-bold">vi</b></th>
<th><b class="emphasis-bold">Emacs</b></th>
<th><b class="emphasis-bold">Result

</b></th>
</tr>






<tr>
<td>

<tt class="userinput"><b>k</b></tt></td>
<td>

<tt class="userinput"><b>Ctrl-P</b></tt></td>
<td>Get previous command.</td>
</tr>


<tr>
<td>

<tt class="userinput"><b>j</b></tt></td>
<td>

<tt class="userinput"><b>Ctrl-N</b></tt></td>
<td>Get next command.</td>
</tr>


<tr>
<td>

<tt class="userinput"><b>/</b></tt><em class="replaceable">string</em></td>
<td>

<tt class="userinput"><b>Ctrl-R </b></tt><em class="replaceable">string</em></td>
<td>Get previous command containing <em class="emphasis">string</em>.</td>
</tr>


<tr>
<td>

<tt class="userinput"><b>h</b></tt></td>
<td>

<tt class="userinput"><b>Ctrl-B</b></tt></td>
<td>Move back one character.</td>
</tr>


<tr>
<td>

<tt class="userinput"><b>l</b></tt></td>
<td>

<tt class="userinput"><b>Ctrl-F</b></tt></td>
<td>Move forward one character.</td>
</tr>


<tr>
<td>

<tt class="userinput"><b>b</b></tt></td>
<td>

<tt class="userinput"><b>Esc B</b></tt></td>
<td>Move back one word.</td>
</tr>


<tr>
<td>

<tt class="userinput"><b>w</b></tt></td>
<td>

<tt class="userinput"><b>Esc F</b></tt></td>
<td>Move forward one word.</td>
</tr>


<tr>
<td>

<tt class="userinput"><b>X</b></tt></td>
<td>

<tt class="userinput"><b>Del</b></tt></td>
<td>Delete previous character.</td>
</tr>


<tr>
<td>

<tt class="userinput"><b>x</b></tt></td>
<td>

<tt class="userinput"><b>Ctrl-D</b></tt></td>
<td>Delete one character.</td>
</tr>


<tr>
<td>

<tt class="userinput"><b>dw</b></tt></td>
<td>

<tt class="userinput"><b>Esc D</b></tt></td>
<td>Delete word forward.</td>
</tr>


<tr>
<td>

<tt class="userinput"><b>db</b></tt></td>
<td>

<tt class="userinput"><b>Esc H</b></tt></td>
<td>Delete word back.</td>
</tr>


<tr>
<td>

<tt class="userinput"><b>xp</b></tt></td>
<td>

<tt class="userinput"><b>Ctrl-T</b></tt></td>
<td>Transpose two characters.</td>
</tr>



</table>
</div>








<a name="ln.ch04.div.25" /><div class="sect2">
<h3 class="sect2">7.6.2. The fc Command</h3>


<a name="INDEX-1403" /><p>Use <b class="emphasis-bold">fc -l</b> to list history commands and <b class="emphasis-bold">fc -e</b> to edit them.
See the entry under built-in commands for more information.</p>


<a name="ln.ch04.div.26" /><div class="sect3">
<h3 class="sect3">7.6.2.1. Examples</h3>


<blockquote><pre class="code">$ <tt class="userinput"><b>history</b></tt>          List the last 16 commands
$ <tt class="userinput"><b>fc -l 20 30</b></tt>      List commands 20 through 30
$ <tt class="userinput"><b>fc -l -5</b></tt>         List the last five commands
$ <tt class="userinput"><b>fc -l cat</b></tt>        List the last command beginning with cat
$ <tt class="userinput"><b>fc -ln 5 &gt; doit</b></tt>  Save command 5 to file doit
$ <tt class="userinput"><b>fc -e vi 5 20</b></tt>    Edit commands 5 through 20 using vi
$ <tt class="userinput"><b>fc -e emacs</b></tt>      Edit previous command using Emacs
$ <tt class="userinput"><b>!!</b></tt>               Reexecute previous command
$ <tt class="userinput"><b>!cat</b></tt>             Reexecute last cat command
$ <tt class="userinput"><b>!cat foo-file</b></tt>    Reexecute last command, adding foo-file to the end of the argument list</pre></blockquote>
</div>
</div>








<a name="ln.ch04.div.27" /><div class="sect2">
<h3 class="sect2">7.6.3. Command Substitution</h3>


<a name="INDEX-1404" />

<a name="ln.ch04.tbl.33" /><table cellpadding="4" border="1">




<tr>
<th><b class="emphasis-bold">Syntax</b></th>
<th><b class="emphasis-bold">Meaning</b></th>
</tr>






<tr>
<td>

<b class="emphasis-bold">!</b></td>
<td>Begin a history substitution.</td>
</tr>



<tr>
<td>

<b class="emphasis-bold">!!</b></td>
<td>Previous command.</td>
</tr>



<tr>
<td>

<b class="emphasis-bold">!</b><em class="replaceable">N</em></td>
<td><p>Command number <em class="replaceable">N</em> in history list.
</p></td>
</tr>


<tr>
<td>

<b class="emphasis-bold">!-</b><em class="replaceable">N</em></td>
<td><p><em class="replaceable">N</em>th command back from current command.
</p></td>
</tr>


<tr>
<td>

<b class="emphasis-bold">!</b><em class="replaceable">string</em></td>
<td><p>Most recent command that starts with <em class="replaceable">string</em>.
</p></td>
</tr>


<tr>
<td>

<b class="emphasis-bold">!?</b><em class="replaceable">string</em><b class="emphasis-bold">?</b></td>
<td><p>Most recent command that contains <em class="replaceable">string</em>.
</p></td>
</tr>


<tr>
<td>

<b class="emphasis-bold">!?</b><em class="replaceable">string</em><b class="emphasis-bold">?%</b></td>
<td><p>Most recent command argument that contains <em class="replaceable">string</em>.
</p></td>
</tr>


<tr>
<td>

<b class="emphasis-bold">!$</b></td>
<td>Last argument of previous command.</td>
</tr>



<tr>
<td>

<b class="emphasis-bold">!#</b></td>
<td>The current command up to this point.</td>
</tr>



<tr>
<td>

<b class="emphasis-bold">!!</b><em class="replaceable">string</em></td>
<td><p>Previous command, then append <em class="replaceable">string</em>.
</p></td>
</tr>


<tr>
<td>

<b class="emphasis-bold">!</b><em class="replaceable">N string</em></td>
<td><p>Command <em class="replaceable">N</em>, then append <em class="replaceable">string</em>.
</p></td>
</tr>


<tr>
<td>

<b class="emphasis-bold">!{</b><em class="replaceable">s1</em>}<em class="replaceable">s2</em></td>
<td><p>Most recent command starting with string <em class="replaceable">s1</em>,
then append string <em class="replaceable">s2</em>.
</p></td>
</tr>


<tr>
<td>

<b class="emphasis-bold">^</b><em class="replaceable">old</em>^<em class="replaceable">new</em>^</td>
<td><p>Quick substitution; change string <em class="replaceable">old</em> to <em class="replaceable">new</em> in previous
command; execute modified command.</p></td>
</tr>



</table>

</div>








<a name="ln.ch04.div.prmpt" /><div class="sect2">
<h3 class="sect2">7.6.4. Variables in Prompt</h3>


<a name="INDEX-1405" />

<p>Using the following variables, you can display information about the
current state of the shell or the system in your <b class="emphasis-bold">bash</b> prompt. Set the PS1 variable to a string
including the desired variables. For instance, the following command
sets PS1 to a string that includes the <b class="emphasis-bold">\w</b> variable in order to display
the current working directory and the <b class="emphasis-bold">\!</b> variable in order to display
the number of the current command. The next line is the prompt
displayed by the change.</p>


<blockquote><pre class="code">$ <tt class="userinput"><b>PS1='\w: Command \!$ '</b></tt>
~/book/linux: Command 504$</pre></blockquote>


<p>Some of the prompt variables are relatively new, such as <b class="emphasis-bold">\j</b> and <b class="emphasis-bold">\l</b>, so
they may not be supported in your version of <b class="emphasis-bold">bash</b>.</p>


<a name="ln.ch04.tbl.prmpt" /><table cellpadding="4" border="1">




<tr>
<th><b class="emphasis-bold">Variable</b></th>
<th><b class="emphasis-bold">Meaning</b></th>
</tr>






<tr>
<td>

<p><b class="emphasis-bold">\a</b></p></td>
<td><p>Alarm (bell)</p></td>
</tr>



<tr>
<td>

<p><b class="emphasis-bold">\d</b></p></td>
<td><p>Date in the format "Mon May  8"</p></td>
</tr>


<tr>
<td>

<p><b class="emphasis-bold">\e</b></p></td>
<td><p>Escape character (terminal escape, not backslash)</p></td>
</tr>


<tr>
<td>

<p><b class="emphasis-bold">\h</b></p></td>
<td><p>Hostname</p></td>
</tr>


<tr>
<td>

<p><b class="emphasis-bold">\j</b></p></td>
<td><p>Number of background jobs (active or stopped)</p></td>
</tr>


<tr>
<td>

<p><b class="emphasis-bold">\l</b></p></td>
<td><p>Current terminal name</p></td>
</tr>


<tr>
<td>

<p><b class="emphasis-bold">\n</b></p></td>
<td><p>Newline inserted in the prompt</p></td>
</tr>


<tr>
<td>

<p><b class="emphasis-bold">\r</b></p></td>
<td><p>Carriage return inserted in the prompt</p></td>
</tr>


<tr>
<td>

<p><b class="emphasis-bold">\s</b></p></td>
<td><p>Current shell</p></td>
</tr>


<tr>
<td>

<p><b class="emphasis-bold">\t</b></p></td>
<td><p>Time in 24-hour format, where 3:30 p.m. appears as 15:30:00</p></td>
</tr>


<tr>
<td>

<p><b class="emphasis-bold">\u</b></p></td>
<td><p>User's account name</p></td>
</tr>


<tr>
<td>

<p><b class="emphasis-bold">\v</b></p></td>
<td><p>Version and release of <b class="emphasis-bold">bash</b></p></td>
</tr>


<tr>
<td>

<p><b class="emphasis-bold">\w</b></p></td>
<td><p>Current working directory</p></td>
</tr>


<tr>
<td>

<p><b class="emphasis-bold">\H</b></p></td>
<td><p>Like <b class="emphasis-bold">\h</b></p></td>
</tr>


<tr>
<td>

<p><b class="emphasis-bold">\T</b></p></td>
<td><p>Time in 12-hour format, where 3:30 p.m. appears as 03:30:00</p></td>
</tr>


<tr>
<td>

<p><b class="emphasis-bold">\V</b></p></td>
<td><p>Version, release, and patch level of <b class="emphasis-bold">bash</b></p></td>
</tr>


<tr>
<td>

<p><b class="emphasis-bold">\W</b></p></td>
<td><p>Last element (following last slash) of current working directory</p></td>
</tr>


<tr>
<td>

<p><b class="emphasis-bold">\\</b></p></td>
<td><p>Single backslash inserted in the prompt</p></td>
</tr>


<tr>
<td>

<p><b class="emphasis-bold">\!</b></p></td>
<td><p>Number of current command in the command history</p></td>
</tr>


<tr>
<td>

<p><b class="emphasis-bold">\#</b></p></td>
<td><p>Number of current command, where numbers started at 1 when
the shell started</p></td>
</tr>


<tr>
<td>

<p><b class="emphasis-bold">\@</b></p></td>
<td><p>Time in 12-hour format, where 3:30 P.M. appears as 03:30 p.m.</p></td>
</tr>


<tr>
<td>

<p><b class="emphasis-bold">\$</b></p></td>
<td><p>Indicates whether you are <b class="emphasis-bold">root</b>: displays <b class="emphasis-bold">#</b> for <b class="emphasis-bold">root</b>, <b class="emphasis-bold">$</b>
for other users</p></td>
</tr>


<tr>
<td>

<p><b class="emphasis-bold">\[</b></p></td>
<td><p>Starts a sequence of nonprinting characters, to be ended
by <b class="emphasis-bold">\]</b></p></td>
</tr>


<tr>
<td>

<p><b class="emphasis-bold">\]</b></p></td>
<td><p>Ends the sequence of nonprinting characters started
by <b class="emphasis-bold">\[</b></p></td>
</tr>


<tr>
<td>

<p><b class="emphasis-bold">\</b><em class="emphasis">nnn</em></p></td>
<td><p>The character in the ASCII set
corresponding to the octal number <em class="emphasis">nnn</em> inserted into the prompt</p></td>
</tr>




</table>

</div>


<hr align="left" width="515" />
<div class="navbar"><table border="0" width="515"><tr><td width="172" valign="top" align="left"><a href="ch07_05.htm"><img src="../gifs/txtpreva.gif" alt="Previous" border="0" /></a></td><td width="171" valign="top" align="center"><a href="index.htm"><img src="../gifs/txthome.gif" alt="Home" border="0" /></a></td><td width="172" valign="top" align="right"><a href="ch07_07.htm"><img src="../gifs/txtnexta.gif" alt="Next" border="0" /></a></td></tr><tr><td width="172" valign="top" align="left">7.5. Arithmetic Expressions</td><td width="171" valign="top" align="center"><a href="index/index.htm"><img src="../gifs/index.gif" alt="Book Index" border="0" /></a></td><td width="172" valign="top" align="right">7.7. Built-in Commands</td></tr></table></div>
<hr align="left" width="515" />

<img src="../gifs/navbar.gif" alt="Library Navigation Links" usemap="#library-map" border="0" />
<p><font size="-1"><a href="copyrght.htm">Copyright &copy; 2001</a> O'Reilly &amp; Associates. All rights reserved.</font></p>

<map name="library-map"><area href="../index.htm" coords="1,1,83,102" shape="rect" /><area href="index.htm" coords="81,0,152,95" shape="rect" /><area href="../run/index.htm" coords="172,2,252,105" shape="rect" /><area href="../apache/index.htm" coords="238,2,334,95" shape="rect" /><area href="../sql/index.htm" coords="336,0,412,104" shape="rect" /><area href="../dbi/index.htm" coords="415,0,507,101" shape="rect" /><area href="../cgi/index.htm" coords="511,0,601,99" shape="rect" /></map>

</body></html>