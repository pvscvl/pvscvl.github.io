<html>
<head>
<title>Session Beans (Enterprise JavaBeans)</title>

<!-- STYLESHEET -->

<link rel="stylesheet" type="text/css" href="../style/style1.css" webstripperlinkwas="../style/style1.css">

<!-- METADATA -->



<!--Dublin Core Metadata-->

<meta name="DC.Creator" content="Richard Monson-Haefel">
<meta name="DC.Date" content="">
<meta name="DC.Format" content="text/xml" scheme="MIME">
<meta name="DC.Generator" content="XSLT stylesheet, xt by James Clark">
<meta name="DC.Identifier" content="">
<meta name="DC.Language" content="en-US">
<meta name="DC.Publisher" content="O'Reilly &amp; Associates, Inc.">
<meta name="DC.Source" content="1-56592-869-5E" scheme="ISBN">
<meta name="DC.Subject.Keyword" content="">
<meta name="DC.Title" content="Session Beans">
<meta name="DC.Type" content="Text.Monograph">

</head>

<body>

<!-- START OF BODY -->



<!-- TOP BANNER -->

<a href="index.htm" webstripperlinkwas="http://ext.rlab.cs.nyu.edu/~jsr/oreilly/ebeans/index.htm"><img src="gifs/smbanner.gif" webstripperlinkwas="gifs/smbanner.gif" usemap="#banner-map" border="0" alt="Book Home"></a>
<map name="banner-map"><map name="banner-map"> <area shape="rect" coords="0,0,466,65" href="index.htm" webstripperlinkwas="http://ext.rlab.cs.nyu.edu/~jsr/oreilly/ebeans/index.htm" alt="Enterprise JavaBeans"> <area shape="rect" coords="467,0,514,18" href="jobjects/fsearch.htm" webstripperlinkwas="http://ext.rlab.cs.nyu.edu/~jsr/oreilly/ebeans/jobjects/fsearch.htm" alt="Search this book"> </map>
</map>

<!-- TOP NAV BAR -->

<div class="navbar">
<table width="515" border="0">
<tr>
<td align="left" valign="top" width="172"><a href="appb_01.htm" webstripperlinkwas="http://ext.rlab.cs.nyu.edu/~jsr/oreilly/ebeans/appb_01.htm"><img src="../gifs/txtpreva.gif" webstripperlinkwas="../gifs/txtpreva.gif" alt="Previous" border="0"></a></td><td align="center" valign="top" width="171"><a href="appb_01.htm" webstripperlinkwas="http://ext.rlab.cs.nyu.edu/~jsr/oreilly/ebeans/appb_01.htm">Appendix B: State and Sequence Diagrams</a></td><td align="right" valign="top" width="172"><a href="appc_01.htm" webstripperlinkwas="http://ext.rlab.cs.nyu.edu/~jsr/oreilly/ebeans/appc_01.htm"><img src="../gifs/txtnexta.gif" webstripperlinkwas="../gifs/txtnexta.gif" alt="Next" border="0"></a></td>
</tr>
</table>
</div>
<hr width="515" align="left">

<!-- SECTION BODY -->
<h2 class="sect1">B.2. Session Beans</h2>

<a name="appb-11-fm2xml"></a>
<h3 class="sect2">B.2.1. Stateless Session Beans</h3>
<p>
<a name="INDEX-2308"></a><a name="INDEX-2309"></a><a name="INDEX-2310"></a>
</p>
<a name="JBEANS-AP-B-FIG-6"></a>
<div class="figure">
<img alt="figure" src="figs/ejb2_ab06.gif" webstripperlinkwas="figs/ejb2_ab06.gif"></div>
<h4 class="objtitle">Figure B-6. Life cycle state diagram of the stateless session bean</h4>

<a name="appb-13-fm2xml"></a>
<div class="figure">
<img alt="figure" src="figs/ebj2_ab07.gif" webstripperlinkwas="http://ext.rlab.cs.nyu.edu/~jsr/oreilly/ebeans/figs/ebj2_ab07.gif"></div>
<h4 class="objtitle">Figure B-7. Creation and removal of the stateless session bean</h4>

<p>
<a name="INDEX-2311"></a><a href="#JBEANS-AP-B-TABLE-6">Table B-3</a> and <a href="#JBEANS-AP-B-TABLE-8">Table B-4</a>
summarize the operations that are legal for a stateless session bean.
</p>

<a name="JBEANS-AP-B-TABLE-6"></a>
<h4 class="objtitle">Table B-3. Allowed Operations for Stateless Session Beans in EJB 1.1</h4>
<table border="1">





<tr>
<th>
<p>
<a name="INDEX-2312"></a>
</p>
</th>
<th>
<p>Allowed Operations</p>
</th>
</tr>
<tr>
<th>
<p>Method</p>
</th>
<th>
<p>Container-Managed Transactions </p>
</th>
<th>
<p>Bean-Managed Transactions</p>
</th>
</tr>

<tr>
<td>
<p>
<tt class="literal">setSessionContext()</tt>
</p>
</td>
<td>
<p>
<tt class="literal">EntityContext</tt> methods: </p>

<blockquote class="simplelist">

<p>
<tt class="literal">getEJBHome()</tt>
</p>

<p>
</p>

</blockquote>

<p>JNDI ENC contexts:</p>

<blockquote class="simplelist">

<p>Properties <tt class="literal">java:comp/env</tt>
</p>

</blockquote>
</td>
<td>
<p>
<tt class="literal">EntityContext</tt> methods: </p>

<blockquote class="simplelist">

<p>
<tt class="literal">getEJBHome()</tt>
</p>

<p>
</p>

</blockquote>

<p>JNDI ENC contexts:</p>

<blockquote class="simplelist">

<p>Properties <tt class="literal">java:comp/env</tt>
</p>

</blockquote>
</td>
</tr>
<tr>
<td>
<p>
<tt class="literal">ejbCreate()</tt>
</p>

<p>
<tt class="literal">ejbRemove()</tt>
</p>
</td>
<td>
<p>
<tt class="literal">EntityContext</tt> methods: </p>

<blockquote class="simplelist">

<p>
<tt class="literal">getEJBHome()</tt>
</p>

<p>
<tt class="literal">getEJBObject()</tt>
</p>

<p>
</p>

</blockquote>

<p>JNDI ENC contexts:</p>

<blockquote class="simplelist">

<p>Properties <tt class="literal">java:comp/env</tt>
</p>

</blockquote>
</td>
<td>
<p>
<tt class="literal">EntityContext</tt> methods: </p>

<blockquote class="simplelist">

<p>
<tt class="literal">getEJBHome()</tt>
</p>

<p>
<tt class="literal">getEJBObject()</tt>
</p>

<p>
<tt class="literal">getUserTransaction()</tt>
</p>

<p>
</p>

</blockquote>

<p>JNDI ENC contexts:</p>

<blockquote class="simplelist">

<p>Properties <tt class="literal">java:comp/env</tt>
</p>

</blockquote>
</td>
</tr>
<tr>
<td>
<p>business methods</p>
</td>
<td>
<p>
<tt class="literal">EntityContext</tt> methods: </p>

<blockquote class="simplelist">

<p>
<tt class="literal">getEJHome()</tt>
</p>

<p>
<tt class="literal">getCallerPrincipal()</tt>
</p>

<p>
<tt class="literal">isCallerInRole()</tt>
</p>

<p>
<tt class="literal">getRollbackOnly()</tt>
</p>

<p>
<tt class="literal">setRollbackOnly()</tt>
</p>

<p>
<tt class="literal">getEJObject()</tt>
</p>

<p>
</p>

</blockquote>

<p>JNDI ENC contexts:</p>

<blockquote class="simplelist">

<p>Properties <tt class="literal">java:comp/env</tt>
</p>

<p>Resource Managers <tt class="literal">java:comp/env/jdbc</tt> </p>

<p>EJB references <tt class="literal">java:comp/env/ejb</tt>
</p>

</blockquote>
</td>
<td>
<p>
<tt class="literal">EntityContext</tt> methods: </p>

<blockquote class="simplelist">

<p>
<tt class="literal">getEJHome()</tt>
</p>

<p>
<tt class="literal">getCallerPrincipal()</tt>
</p>

<p>
<tt class="literal">isCallerInRole()</tt>
</p>

<p>
<tt class="literal">getEJObject()</tt>
</p>

<p>
<tt class="literal">getUserTransaction()</tt>
</p>

<p>
</p>

</blockquote>

<p>JNDI ENC contexts:</p>

<blockquote class="simplelist">

<p>Properties <tt class="literal">java:comp/env</tt>
</p>

<p>Resource Managers <tt class="literal">java:comp/env/jdbc</tt> </p>

<p>EJB references <tt class="literal">java:comp/env/ejb</tt>
</p>

</blockquote>
</td>
</tr>
<tr>
<td>
<p>
<tt class="literal">ejbActivate()</tt>
</p>

<p>
<tt class="literal">ejbPassivate()</tt>
</p>
</td>
<td>
<p>Not Supported</p>

<p>(stateless beans do not use these methods)</p>
</td>
<td>
<p>Not Supported</p>

<p>(stateless beans do not use these methods)</p>
</td>
</tr>

</table>

<a name="JBEANS-AP-B-TABLE-8"></a>
<h4 class="objtitle">Table B-4. Allowed Operations for Stateless Session Beans in EJB 1.0</h4>
<table border="1">





<tr>
<th>
<p>
</p>
</th>
<th>
<p>Allowed Operations</p>
</th>
</tr>
<tr>
<th>
<p>Method</p>
</th>
<th>
<p>Container-Managed Transactions </p>
</th>
<th>
<p>Bean-Managed Transactions</p>
</th>
</tr>

<tr>
<td>
<p>
<tt class="literal">setSessionContext()</tt>
</p>
</td>
<td>
<p>
<tt class="literal">EntityContext</tt> methods: </p>

<blockquote class="simplelist">

<p>
<tt class="literal">getEnvironment()</tt>
</p>

<p>
<tt class="literal">getEJBHome()</tt>
</p>

</blockquote>
</td>
<td>
<p>
<tt class="literal">EntityContext</tt> methods: </p>

<blockquote class="simplelist">

<p>
<tt class="literal">getEnvironment()</tt>
</p>

<p>
<tt class="literal">getEJBHome()</tt>
</p>

</blockquote>
</td>
</tr>
<tr>
<td>
<p>
<tt class="literal">ejbCreate()</tt>
</p>

<p>
<tt class="literal">ejbRemove()</tt>
</p>
</td>
<td>
<p>
<tt class="literal">EntityContext</tt> methods: </p>

<blockquote class="simplelist">

<p>
<tt class="literal">getEnvironment()</tt>
</p>

<p>
<tt class="literal">getEJBHome()</tt>
</p>

<p>
<tt class="literal">getEJBObject()</tt>
</p>

</blockquote>
</td>
<td>
<p>
<tt class="literal">EntityContext</tt> methods: </p>

<blockquote class="simplelist">

<p>
<tt class="literal">getEnvironment()</tt>
</p>

<p>
<tt class="literal">getEJBHome()</tt>
</p>

<p>
<tt class="literal">getEJBObject()</tt>
</p>

<p>
<tt class="literal">getUserTransaction()</tt>
</p>

</blockquote>
</td>
</tr>
<tr>
<td>
<p>business methods</p>
</td>
<td>
<p>
<tt class="literal">EntityContext</tt> methods: </p>

<blockquote class="simplelist">

<p>
<tt class="literal">getEnvironment()</tt>
</p>

<p>
<tt class="literal">getEJHome()</tt>
</p>

<p>
<tt class="literal">getCallerPrincipal()</tt>
</p>

<p>
<tt class="literal">isCallerInRole()</tt>
</p>

<p>
<tt class="literal">getRollbackOnly()</tt>
</p>

<p>
<tt class="literal">setRollbackOnly()</tt>
</p>

<p>
<tt class="literal">getEJObject()</tt>
</p>

</blockquote>
</td>
<td>
<p>
<tt class="literal">EntityContext</tt> methods: </p>

<blockquote class="simplelist">

<p>
<tt class="literal">getEnvironment()</tt>
</p>

<p>
<tt class="literal">getEJHome()</tt>
</p>

<p>
<tt class="literal">getCallerPrincipal()</tt>
</p>

<p>
<tt class="literal">isCallerInRole()</tt>
</p>

<p>
<tt class="literal">getEJObject()</tt>
</p>

<p>
<tt class="literal">getUserTransaction()</tt>
</p>

</blockquote>
</td>
</tr>
<tr>
<td>
<p>
<tt class="literal">ejbActivate()</tt>
</p>

<p>
<tt class="literal">ejbPassivate()</tt>
</p>
</td>
<td>
<p>Not Supported</p>

<p>(stateless beans do not use these methods)</p>
</td>
<td>
<p>Not Supported</p>

<p>(stateless beans do not use these methods)</p>
</td>
</tr>

</table>


<a name="appb-14-fm2xml"></a>
<h3 class="sect2">B.2.2. Stateful Session Beans</h3>
<p>
<a name="INDEX-2313"></a><a name="INDEX-2314"></a>
</p>
<a name="JBEANS-AP-B-FIG-8"></a>
<div class="figure">
<img alt="figure" src="figs/ejb2_ab08.gif" webstripperlinkwas="figs/ejb2_ab08.gif"></div>
<h4 class="objtitle">Figure B-8. EJB 1.1 stateful session bean life cycle</h4>

<a name="JBEANS-AP-B-FIG-9"></a>
<div class="figure">
<img alt="figure" src="figs/ejb2_ab09.gif" webstripperlinkwas="figs/ejb2_ab09.gif"></div>
<h4 class="objtitle">Figure B-9. EJB 1.0 life cycle state diagram of the stateful session bean life cycle</h4>

<a name="JBEANS-AP-B-FIG-10"></a>
<div class="figure">
<img alt="figure" src="figs/ejb2_ab10.gif" webstripperlinkwas="figs/ejb2_ab10.gif"></div>
<h4 class="objtitle">Figure B-10. EJB 1.1 life cycle of a stateful session bean with session synchronization interface</h4>

<a name="JBEANS-AP-B-FIG-11"></a>
<div class="figure">
<img alt="figure" src="figs/ejb2_ab11.gif" webstripperlinkwas="figs/ejb2_ab11.gif"></div>
<h4 class="objtitle">Figure B-11. EJB 1.0 life cycle of the stateful session bean with session synchronization interface</h4>

<a name="appb-19-fm2xml"></a>
<div class="figure">
<img alt="figure" src="figs/ejb2_ab12.gif" webstripperlinkwas="figs/ejb2_ab12.gif"></div>
<h4 class="objtitle">Figure B-12. Creation and removal of stateful session beans</h4>

<a name="appb-20-fm2xml"></a>
<div class="figure">
<img alt="figure" src="figs/ejb2_ab13.gif" webstripperlinkwas="figs/ejb2_ab13.gif"></div>
<h4 class="objtitle">Figure B-13. Activation process in stateful session beans</h4>

<a name="appb-21-fm2xml"></a>
<div class="figure">
<img alt="figure" src="figs/ejb2_ab14.gif" webstripperlinkwas="figs/ejb2_ab14.gif"></div>
<h4 class="objtitle">Figure B-14. Transaction notification in SessionSynchronization session beans</h4>

<p>
<a href="#JBEANS-AP-B-TABLE-10">Table B-5</a> and <a href="#JBEANS-AP-B-TABLE-12">Table B-6</a>
summarize the operations that are legal for a stateful session bean
in EJB 1.1 and 1.0.
<a name="INDEX-2315"></a>
</p>

<a name="JBEANS-AP-B-TABLE-10"></a>
<h4 class="objtitle">Table B-5. Allowed Operations for Stateful Session Beans in EJB 1.1</h4>
<table border="1">





<tr>
<th>
<p>
</p>
</th>
<th>
<p>Allowed Operations</p>
</th>
</tr>
<tr>
<th>
<p>Method</p>
</th>
<th>
<p>Container-Managed Transactions </p>
</th>
<th>
<p>Bean-Managed Transactions</p>
</th>
</tr>

<tr>
<td>
<p>
<tt class="literal">setSessionContext()</tt>
</p>
</td>
<td>
<p>
<tt class="literal">EntityContext</tt> methods: </p>

<blockquote class="simplelist">

<p>
<tt class="literal">getEJBHome()</tt>
</p>

<p>
</p>

</blockquote>

<p>JNDI ENC contexts:</p>

<blockquote class="simplelist">

<p>Properties <tt class="literal">java:comp/env</tt>
</p>

</blockquote>
</td>
<td>
<p>
<tt class="literal">EntityContext</tt> methods: </p>

<blockquote class="simplelist">

<p>
<tt class="literal">getEJBHome()</tt>
</p>

<p>
</p>

</blockquote>

<p>JNDI ENC contexts:</p>

<blockquote class="simplelist">

<p>Properties <tt class="literal">java:comp/env</tt>
</p>

</blockquote>
</td>
</tr>
<tr>
<td>
<p>
<tt class="literal">ejbCreate()</tt>
</p>

<p>
<tt class="literal">ejbRemove()</tt>
</p>

<p>
<tt class="literal">ejbActivate()</tt>
</p>

<p>
<tt class="literal">ejbPassivate()</tt>
</p>
</td>
<td>
<p>
<tt class="literal">EntityContext</tt> methods: </p>

<blockquote class="simplelist">

<p>
<tt class="literal">getEJBHome()</tt>
</p>

<p>
<tt class="literal">getCallerPrincipal()</tt>
</p>

<p>
<tt class="literal">isCallerInRole()</tt>
</p>

<p>
<tt class="literal">getEJBObject()</tt>
</p>

<p>
</p>

</blockquote>

<p>JNDI ENC contexts:</p>

<blockquote class="simplelist">

<p>Properties <tt class="literal">java:comp/env</tt>
</p>

<p>Resource Managers <tt class="literal">java:comp/env/jdbc</tt> </p>

<p>EJB references <tt class="literal">java:comp/env/ejb</tt>
</p>

</blockquote>
</td>
<td>
<p>
<tt class="literal">EntityContext</tt> methods: </p>

<blockquote class="simplelist">

<p>
<tt class="literal">getEJBHome()</tt>
</p>

<p>
<tt class="literal">getCallerPrincipal()</tt>
</p>

<p>
<tt class="literal">isCallerInRole()</tt>
</p>

<p>
<tt class="literal">getEJBObject()</tt>
</p>

<p>
<tt class="literal">getUserTransaction()</tt>
</p>

<p>
</p>

</blockquote>

<p>JNDI ENC contexts:</p>

<blockquote class="simplelist">

<p>Properties <tt class="literal">java:comp/env</tt>
</p>

<p>Resource Managers <tt class="literal">java:comp/env/jdbc</tt> </p>

<p>EJB references <tt class="literal">java:comp/env/ejb</tt>
</p>

</blockquote>
</td>
</tr>
<tr>
<td>
<p>business methods</p>
</td>
<td>
<p>
<tt class="literal">EntityContext</tt> methods: </p>

<blockquote class="simplelist">

<p>
<tt class="literal">getEJHome()</tt>
</p>

<p>
<tt class="literal">getCallerPrincipal()</tt>
</p>

<p>
<tt class="literal">isCallerInRole()</tt>
</p>

<p>
<tt class="literal">getRollbackOnly()</tt>
</p>

<p>
<tt class="literal">setRollbackOnly()</tt>
</p>

<p>
<tt class="literal">getEJObject()</tt>
</p>

<p>
</p>

</blockquote>

<p>JNDI ENC contexts:</p>

<blockquote class="simplelist">

<p>Properties <tt class="literal">java:comp/env</tt>
</p>

<p>Resource Managers <tt class="literal">java:comp/env/jdbc</tt> </p>

<p>EJB references <tt class="literal">java:comp/env/ejb</tt>
</p>

</blockquote>
</td>
<td>
<p>
<tt class="literal">EntityContext</tt> methods: </p>

<blockquote class="simplelist">

<p>
<tt class="literal">getEJHome()</tt>
</p>

<p>
<tt class="literal">getCallerPrincipal()</tt>
</p>

<p>
<tt class="literal">isCallerInRole()</tt>
</p>

<p>
<tt class="literal">getEJObject()</tt>
</p>

<p>
<tt class="literal">getUserTransaction()</tt>
</p>

<p>
</p>

</blockquote>

<p>JNDI ENC contexts:</p>

<blockquote class="simplelist">

<p>Properties <tt class="literal">java:comp/env</tt>
</p>

<p>Resource Managers <tt class="literal">java:comp/env/jdbc</tt> </p>

<p>EJB references <tt class="literal">java:comp/env/ejb</tt>
</p>

</blockquote>
</td>
</tr>
<tr>
<td>
<p>
<tt class="literal">afterBegin()</tt>
</p>

<p>
<tt class="literal">beforeCompetion()</tt>
</p>
</td>
<td>
<p>
<tt class="literal">EntityContext</tt> methods: </p>

<blockquote class="simplelist">

<p>
<tt class="literal">getEJHome()</tt>
</p>

<p>
<tt class="literal">getCallerPrincipal()</tt>
</p>

<p>
<tt class="literal">isCallerInRole()</tt>
</p>

<p>
<tt class="literal">getRollbackOnly()</tt>
</p>

<p>
<tt class="literal">setRollbackOnly()</tt>
</p>

<p>
<tt class="literal">getEJObject()</tt>
</p>

<p>
</p>

</blockquote>

<p>JNDI ENC contexts:</p>

<blockquote class="simplelist">

<p>Properties <tt class="literal">java:comp/env</tt>
</p>

<p>Resource Managers <tt class="literal">java:comp/env/jdbc</tt> </p>

<p>EJB references <tt class="literal">java:comp/env/ejb</tt>
</p>

</blockquote>
</td>
<td>
<p>Not Supported</p>

<p>(bean-managed transaction beans can not implement the
SessionSynchronization interface)
</p>
</td>
</tr>
<tr>
<td>
<p>
<tt class="literal">afterCompletion()</tt>
</p>
</td>
<td>
<p>
<tt class="literal">EntityContext</tt> methods: </p>

<blockquote class="simplelist">

<p>
<tt class="literal">getEJBHome()</tt>
</p>

<p>
<tt class="literal">getCallerPrincipal()</tt>
</p>

<p>
<tt class="literal">isCallerInRole()</tt>
</p>

<p>
<tt class="literal">getEJBObject()</tt>
</p>

<p>
</p>

</blockquote>

<p>JNDI ENC contexts:</p>

<blockquote class="simplelist">

<p>Properties <tt class="literal">java:comp/env</tt>
</p>

</blockquote>
</td>
<td>
<p>Not Supported</p>

<p>(bean-managed transaction beans can not implement the
SessionSynchronization interface)
</p>
</td>
</tr>

</table>

<p>
</p>

<a name="JBEANS-AP-B-TABLE-12"></a>
<h4 class="objtitle">Table B-6. Allowed Operations for Stateful Session Beans in EJB 1.0</h4>
<table border="1">





<tr>
<th>
<p>
</p>
</th>
<th>
<p>Allowed Operations</p>
</th>
</tr>
<tr>
<th>
<p>Method</p>
</th>
<th>
<p>Container-Managed Transactions </p>
</th>
<th>
<p>Bean-Managed Transactions</p>
</th>
</tr>

<tr>
<td>
<p>
<tt class="literal">setSessionContext()</tt>
</p>
</td>
<td>
<p>
<tt class="literal">EntityContext</tt> methods: </p>

<blockquote class="simplelist">

<p>
<tt class="literal">getEnvironment()</tt>
</p>

<p>
<tt class="literal">getEJBHome()</tt>
</p>

</blockquote>
</td>
<td>
<p>
<tt class="literal">EntityContext</tt> methods: </p>

<blockquote class="simplelist">

<p>
<tt class="literal">getEnvironment()</tt>
</p>

<p>
<tt class="literal">getEJBHome()</tt>
</p>

</blockquote>
</td>
</tr>
<tr>
<td>
<p>
<tt class="literal">ejbCreate()</tt>
</p>

<p>
<tt class="literal">ejbRemove()</tt>
</p>

<p>
<tt class="literal">ejbActivate()</tt>
</p>

<p>
<tt class="literal">ejbPassivate()</tt>
</p>
</td>
<td>
<p>
<tt class="literal">EntityContext</tt> methods: </p>

<blockquote class="simplelist">

<p>
<tt class="literal">getEnvironment()</tt>
</p>

<p>
<tt class="literal">getEJBHome()</tt>
</p>

<p>
<tt class="literal">getCallerPrincipal()</tt>
</p>

<p>
<tt class="literal">isCallerInRole()</tt>
</p>

<p>
<tt class="literal">getEJBObject()</tt>
</p>

</blockquote>
</td>
<td>
<p>
<tt class="literal">EntityContext</tt> methods: </p>

<blockquote class="simplelist">

<p>
<tt class="literal">getEnvironment()</tt>
</p>

<p>
<tt class="literal">getEJBHome()</tt>
</p>

<p>
<tt class="literal">getCallerPrincipal()</tt>
</p>

<p>
<tt class="literal">isCallerInRole()</tt>
</p>

<p>
<tt class="literal">getEJBObject()</tt>
</p>

<p>
<tt class="literal">getUserTransaction()</tt>
</p>

</blockquote>
</td>
</tr>
<tr>
<td>
<p>business methods</p>
</td>
<td>
<p>
<tt class="literal">EntityContext</tt> methods: </p>

<blockquote class="simplelist">

<p>
<tt class="literal">getEnvironment()</tt>
</p>

<p>
<tt class="literal">getEJHome()</tt>
</p>

<p>
<tt class="literal">getCallerPrincipal()</tt>
</p>

<p>
<tt class="literal">isCallerInRole()</tt>
</p>

<p>
<tt class="literal">getRollbackOnly()</tt>
</p>

<p>
<tt class="literal">setRollbackOnly()</tt>
</p>

<p>
<tt class="literal">getEJObject()</tt>
</p>

</blockquote>
</td>
<td>
<p>
<tt class="literal">EntityContext</tt> methods: </p>

<blockquote class="simplelist">

<p>
<tt class="literal">getEnvironment()</tt>
</p>

<p>
<tt class="literal">getEJHome()</tt>
</p>

<p>
<tt class="literal">getCallerPrincipal()</tt>
</p>

<p>
<tt class="literal">isCallerInRole()</tt>
</p>

<p>
<tt class="literal">getEJObject()</tt>
</p>

<p>
<tt class="literal">getUserTransaction()</tt>
</p>

</blockquote>
</td>
</tr>
<tr>
<td>
<p>
<tt class="literal">afterBegin()</tt>
</p>

<p>
<tt class="literal">beforeCompetion()</tt>
</p>
</td>
<td>
<p>
<tt class="literal">EntityContext</tt> methods: </p>

<blockquote class="simplelist">

<p>
<tt class="literal">getEnvironment()</tt>
</p>

<p>
<tt class="literal">getEJHome()</tt>
</p>

<p>
<tt class="literal">getCallerPrincipal()</tt>
</p>

<p>
<tt class="literal">isCallerInRole()</tt>
</p>

<p>
<tt class="literal">getRollbackOnly()</tt>
</p>

<p>
<tt class="literal">setRollbackOnly()</tt>
</p>

<p>
<tt class="literal">getEJObject()</tt>
</p>

</blockquote>
</td>
<td>
<p>Not Supported</p>

<p>(bean-managed transaction beans can not implement the
SessionSynchronization interface)
</p>
</td>
</tr>
<tr>
<td>
<p>
<tt class="literal">afterCompletion()</tt>
</p>
</td>
<td>
<p>
<tt class="literal">EntityContext</tt> methods: </p>

<blockquote class="simplelist">

<p>
<tt class="literal">getEnvironment()</tt>
</p>

<p>
<tt class="literal">getEJBHome()</tt>
</p>

<p>
<tt class="literal">getCallerPrincipal()</tt>
</p>

<p>
<tt class="literal">isCallerInRole()</tt>
</p>

<p>
<tt class="literal">getEJBObject()</tt>
</p>

</blockquote>
</td>
<td>
<p>Not Supported</p>

<p>(bean-managed transaction beans can not implement the
SessionSynchronization <a name="INDEX-2316"></a> interface)
</p>
</td>
</tr>

</table>


<a name="appb-22-fm2xml"></a>
<h3 class="sect2">B.2.3. EJB 1.1: Interactions Between Exceptions and Transactions</h3>
<p>
<a name="INDEX-2317"></a><a href="#JBEANS-AP-B-TABLE-14">Table B-7</a> summarizes what happens to a <a name="INDEX-2318"></a><a name="INDEX-2319"></a>
transaction if an exception is thrown while the transaction is in
process.
</p>

<a name="JBEANS-AP-B-TABLE-14"></a>
<h4 class="objtitle">Table B-7. Exceptions and Transactions</h4>
<table border="1">






<tr>
<th>
<p>Transaction Scope</p>
</th>
<th>
<p>Transactional Type Attributes</p>
</th>
<th>
<p>Exception Thrown</p>
</th>
<th>
<p>Container's Action</p>
</th>
<th>
<p>Client's View</p>
</th>
</tr>

<tr>
<td>
<p>Client Initiated Transaction</p>

<p>
</p>

<p>Transaction is started by the client (application or bean) and is
propagated to the bean method.
</p>
</td>
<td>
<p>transaction-type =</p>

<blockquote class="simplelist">

<p>Container</p>

</blockquote>

<p>transaction-attribute =</p>

<blockquote class="simplelist">

<p>Required |</p>

<p>Mandatory |</p>

<p>Supports |</p>

</blockquote>
</td>
<td>
<p>Application Exception</p>
</td>
<td>
<p>If the bean invoked <tt class="literal">EJBContext.setRollbackOnly()</tt>,
then mark the client's transaction for rollback.
</p>

<p>Rethrow Application Exception.</p>
</td>
<td>
<p>Receives the Application Exception. The client's transaction
may or may not have been marked for rolled back.
</p>
</td>
</tr>
<tr>
<td>
<p>
</p>
</td>
<td>
<p>
</p>
</td>
<td>
<p>System Exception</p>
</td>
<td>
<p>Mark the client's transaction for roll back.</p>

<p>Log the error.</p>

<p>Discard the instance.</p>

<p>Rethrow <tt class="literal">TransactionRollbackException</tt>.</p>
</td>
<td>
<p>Receives the <tt class="literal">TransactionRollbackException</tt>
</p>

<p>The client's transaction has been rolled back. </p>
</td>
</tr>
<tr>
<td>
<p>Container Initiated Transaction</p>

<p>
</p>

<p>The transaction started when the bean's method was invoked and
will end when method completes.
</p>
</td>
<td>
<p>transaction-type =</p>

<blockquote class="simplelist">

<p>Container</p>

</blockquote>

<p>transaction-attribute =</p>

<blockquote class="simplelist">

<p>Required |</p>

<p>Requires New</p>

</blockquote>
</td>
<td>
<p>Application Exception</p>
</td>
<td>
<p>If bean called <tt class="literal">EJBContext.setRollbackOnly()</tt>, then
rollback the transaction and rethrow the Application Exception.
</p>

<p>If bean didn't explicitly rollback the transaction, then
attempt to commit the transaction and rethrow the Application
Exception.
</p>
</td>
<td>
<p>Receives the Application Exception. The bean's transaction may
or may not have been rolled back. The client's transaction is
not affected.
</p>
</td>
</tr>
<tr>
<td>
<p>
</p>
</td>
<td>
<p>
</p>
</td>
<td>
<p>System Exception</p>
</td>
<td>
<p>Roll back the transaction.</p>

<p>Log the error.</p>

<p>Discard the instance.</p>

<p>Rethrow <tt class="literal">RemoteException</tt>.</p>
</td>
<td>
<p>Receives the <tt class="literal">RemoteException</tt>.</p>

<p>The bean's transaction was rolled back.</p>

<p>The client's transaction is not affected.</p>
</td>
</tr>
<tr>
<td>
<p>Bean is not part of a transaction</p>

<p>The bean was invoked but does not propagate the client's
transaction and does not start its own transaction.
</p>
</td>
<td>
<p>transaction-type =</p>

<blockquote class="simplelist">

<p>Container</p>

</blockquote>

<p>transaction-attribute =</p>

<blockquote class="simplelist">

<p>Never |</p>

<p>Not Supported |</p>

<p>Supports |</p>

</blockquote>
</td>
<td>
<p>Application Exception</p>
</td>
<td>
<p>Rethrow Application Exception</p>
</td>
<td>
<p>Receives the Application Exception. </p>

<p>The client's transaction is not affected.</p>
</td>
</tr>
<tr>
<td>
<p>
</p>
</td>
<td>
<p>
</p>
</td>
<td>
<p>System Exception</p>
</td>
<td>
<p>Log the error.</p>

<p>Discard the instance.</p>

<p>Rethrow <tt class="literal">RemoteException</tt>.</p>
</td>
<td>
<p>Receives the <tt class="literal">RemoteException</tt>.</p>

<p>The client's transaction is not affected.</p>
</td>
</tr>
<tr>
<td>
<p>Bean Managed Transaction.</p>

<p>
</p>

<p>The stateful or stateless session bean use the EJBContext to
explicitly manage its own transaction.
</p>
</td>
<td>
<p>transaction-type = </p>

<blockquote class="simplelist">

<p>bean</p>

</blockquote>

<p>transaction-attribute =</p>

<blockquote class="simplelist">

<p>Bean-Managed Transaction beans do not use transaction attributes.</p>

</blockquote>
</td>
<td>
<p>Application Exception</p>
</td>
<td>
<p>Rethrow the Application Exception.</p>
</td>
<td>
<p>Receive the Application Exception.</p>

<p>The client's transaction is not affected.</p>
</td>
</tr>
<tr>
<td>
<p>
</p>
</td>
<td>
<p>
</p>
</td>
<td>
<p>System Exception</p>
</td>
<td>
<p>Roll back the transaction.</p>

<p>Log the error.</p>

<p>Discard the instance.</p>

<p>
<a name="INDEX-2320"></a><a name="INDEX-2321"></a><a name="INDEX-2322"></a>
Rethrow <tt class="literal">RemoteException</tt>.
</p>
</td>
<td>
<p>Receives the <tt class="literal">RemoteException</tt>.</p>

<p>The client's transaction is <a name="INDEX-2323"></a><a name="INDEX-2324"></a> not affected.
</p>
</td>
</tr>

</table>

<p>
</p>




<!-- BOTTOM NAV BAR -->

<hr width="515" align="left">
<div class="navbar">
<table width="515" border="0">
<tr>
<td align="left" valign="top" width="172"><a href="appb_01.htm" webstripperlinkwas="http://ext.rlab.cs.nyu.edu/~jsr/oreilly/ebeans/appb_01.htm"><img src="../gifs/txtpreva.gif" webstripperlinkwas="../gifs/txtpreva.gif" alt="Previous" border="0"></a></td><td align="center" valign="top" width="171"><a href="index.htm" webstripperlinkwas="http://ext.rlab.cs.nyu.edu/~jsr/oreilly/ebeans/index.htm"><img src="../gifs/txthome.gif" webstripperlinkwas="../gifs/txthome.gif" alt="Home" border="0"></a></td><td align="right" valign="top" width="172"><a href="appc_01.htm" webstripperlinkwas="http://ext.rlab.cs.nyu.edu/~jsr/oreilly/ebeans/appc_01.htm"><img src="../gifs/txtnexta.gif" webstripperlinkwas="../gifs/txtnexta.gif" alt="Next" border="0"></a></td>
</tr>
<tr>
<td align="left" valign="top" width="172">B.1. Entity Beans</td><td align="center" valign="top" width="171"><a href="index/index.htm" webstripperlinkwas="http://ext.rlab.cs.nyu.edu/~jsr/oreilly/ebeans/index/index.htm"><img src="../gifs/index.gif" webstripperlinkwas="../gifs/index.gif" alt="Book Index" border="0"></a></td><td align="right" valign="top" width="172">C. EJB Vendors</td>
</tr>
</table>
</div>
<hr width="515" align="left">

<!-- LIBRARY NAV BAR -->

<img src="../gifs/smnavbar.gif" webstripperlinkwas="../gifs/smnavbar.gif" usemap="#library-map" border="0" alt="Library Navigation Links"><p>
<font size="-1"><a href="copyrght.htm" webstripperlinkwas="http://ext.rlab.cs.nyu.edu/~jsr/oreilly/ebeans/copyrght.htm">Copyright &copy; 2001</a> O'Reilly &amp; Associates. All rights reserved.</font>
</p>
<map name="library-map"> <map name="library-map"> <area shape="rect" coords="-8,-5,72,97" href="../index.htm" webstripperlinkwas="http://ext.rlab.cs.nyu.edu/~jsr/oreilly/index.htm"> <area shape="rect" coords="75,2,150,109" href="../jenut/index.htm" webstripperlinkwas="http://ext.rlab.cs.nyu.edu/~jsr/oreilly/jenut/index.htm"> <area shape="rect" coords="154,0,225,99" href="../jnut/index.htm" webstripperlinkwas="http://ext.rlab.cs.nyu.edu/~jsr/oreilly/jnut/index.htm"> <area shape="rect" coords="228,3,298,112" href="../jfc/index.htm" webstripperlinkwas="http://ext.rlab.cs.nyu.edu/~jsr/oreilly/jfc/index.htm"> <area shape="rect" coords="306,1,373,124" href="index.htm" webstripperlinkwas="http://ext.rlab.cs.nyu.edu/~jsr/oreilly/ebeans/index.htm"> <area shape="rect" coords="380,2,446,115" href="../servlet/index.htm" webstripperlinkwas="http://ext.rlab.cs.nyu.edu/~jsr/oreilly/servlet/index.htm"> <area shape="rect" coords="452,1,524,101" href="../security/index.htm" webstripperlinkwas="http://ext.rlab.cs.nyu.edu/~jsr/oreilly/security/index.htm"> <area shape="rect" coords="528,2,610,102" href="../dist/index.htm" webstripperlinkwas="http://ext.rlab.cs.nyu.edu/~jsr/oreilly/dist/index.htm"> </map>
</map>

<!-- END OF BODY -->

</body>
</html>
