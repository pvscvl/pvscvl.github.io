<HTML
><HEAD
>
<TITLE>20.2 Server-Side PerlScript (Perl in a Nutshell)</TITLE>
<META
NAME="DC.title"
CONTENT="Perl in a Nutshell"><META
NAME="DC.creator"
CONTENT="Ellen Siever, Stephen Spainhour &amp; Nathan Patwardhan"><META
NAME="DC.publisher"
CONTENT="O'Reilly &amp; Associates, Inc."><META
NAME="DC.date"
CONTENT="1999-07-02T02:00:47Z"><META
NAME="DC.type"
CONTENT="Text.Monograph"><META
NAME="DC.format"
CONTENT="text/html"
SCHEME="MIME"><META
NAME="DC.source"
CONTENT="1-56592-286-7"
SCHEME="ISBN"><META
NAME="DC.language"
CONTENT="en-US"><META
NAME="generator"
CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINK
REV="made"
HREF="mailto:online-books@oreilly.com"
TITLE="Online Books Comments"><LINK
REL="up"
HREF="ch20_01.htm"
TITLE="20. PerlScript"><LINK
REL="prev"
HREF="ch20_01.htm"
TITLE="20.1 Client-Side PerlScript"></HEAD
><BODY
BGCOLOR="#FFFFFF"
TEXT="#000000"
><DIV
CLASS="htmlnav"
><H1
><IMG
SRC="gifs/smbanner.gif"
ALT="Perl in a Nutshell"
USEMAP="#srchmap"
BORDER="0"></H1
><MAP
NAME="srchmap"
><AREA
SHAPE="RECT"
COORDS="0,0,466,71"
HREF="index.htm"
ALT="Perl in a Nutshell"><AREA
SHAPE="RECT"
COORDS="467,0,514,18"
HREF="jobjects/fsearch.htm"
ALT="Search this book"></MAP
><TABLE
WIDTH="515"
BORDER="0"
CELLSPACING="0"
CELLPADDING="0"
><TR
><TD
ALIGN="LEFT"
VALIGN="TOP"
WIDTH="172"
><A
CLASS="SECT1"
HREF="ch20_01.htm"
TITLE="20.1 Client-Side PerlScript"
><IMG
SRC="../gifs/txtpreva.gif"
ALT="Previous: 20.1 Client-Side PerlScript"
BORDER="0"></A
></TD
><TD
ALIGN="CENTER"
VALIGN="TOP"
WIDTH="171"
><B
><FONT
FACE="ARIEL,HELVETICA,HELV,SANSERIF"
SIZE="-1"
><A
CLASS="chapter"
REL="up"
HREF="ch20_01.htm"
TITLE="20. PerlScript"
>Chapter 20<BR>PerlScript</A
></FONT
></B
></TD
><TD
ALIGN="RIGHT"
VALIGN="TOP"
WIDTH="172"
>&nbsp;</TD
></TR
></TABLE
>&nbsp;<HR
ALIGN="LEFT"
WIDTH="515"
TITLE="footer"></DIV
><DIV
CLASS="SECT1"
><H2
CLASS="sect1"
><A
CLASS="title"
NAME="PNUT-CH-20-SECT-2"
>20.2 Server-Side PerlScript</A
></H2
><P
CLASS="para"
><A
CLASS="indexterm"
NAME="PNUT-CH-20-IX-SERVER-SIDE-PERLSCRIPT"
></A
><A
CLASS="indexterm"
NAME="PNUT-CH-20-IX-PERLSCRIPT-SERVER-SIDE-PERLSCRIPT"
></A
>PerlScript on the server-side of business is a much more
viable method of incorporating Perl into your web applications.<A
CLASS="indexterm"
NAME="AUTOID-45336"
></A
><A
CLASS="indexterm"
NAME="AUTOID-45338"
></A
>
You can use PerlScript as the scripting language for Active
Server Pages (ASP), which are used by such
applications as Microsoft's IIS and
O'Reilly's WebSite Pro. See the documentation for these products
to properly set up ASP on your server.
ActivePerl with PerlScript must be installed on the server machine
to be used with ASP.</P
><P
CLASS="para"
>Active Server Pages use PerlScript in pages much like client-side scripting
except that the object model is different, and most importantly, the
script is executed on the server. When an Active Server Page is requested,
the <EM
CLASS="emphasis"
>.asp</EM
> file is processed, scripts are executed, and an HTML
page is produced and delivered to the client.</P
><P
CLASS="para"
>Each script is contained within <CODE
CLASS="literal"
>&lt;SCRIPT&gt;</CODE
> tags. PerlScript must be declared
as the default scripting language for each file with:


<BLOCKQUOTE
CLASS="screen"
><PRE
CLASS="screen"
>&lt;SCRIPT LANGUAGE=&quot;PerlScript&quot; RUNAT=Server&gt;</PRE
></BLOCKQUOTE
>

<A
CLASS="indexterm"
NAME="AUTOID-45345"
></A
>
The <CODE
CLASS="literal"
>RUNAT</CODE
> attribute signals that the script is to be executed on the server
and not the client. The lines of the script follow, and the script is
closed with an ending <CODE
CLASS="literal"
>&lt;/SCRIPT&gt;</CODE
> tag.</P
><P
CLASS="para"
><A
CLASS="indexterm"
NAME="AUTOID-45350"
></A
><A
CLASS="indexterm"
NAME="AUTOID-45353"
></A
>An alternative syntax to the <CODE
CLASS="literal"
>&lt;SCRIPT&gt;</CODE
> tags are the <CODE
CLASS="literal"
>&lt;% %&gt;</CODE
> delimiters. These
are not HTML tags, but indicate that whatever happens between them is
to be executed. There are also special constructs used with these delimiters.
Since they can be interspersed with HTML throughout a file, the default
language must be declared at the top of the file with the <CODE
CLASS="literal"
>&lt;%@ %&gt;</CODE
> tag:


<BLOCKQUOTE
CLASS="screen"
><PRE
CLASS="screen"
>&lt;%@ PerlScript%&gt;</PRE
></BLOCKQUOTE
>


This delimiter syntax completely replaces the declarative <CODE
CLASS="literal"
>&lt;SCRIPT&gt;</CODE
> tag shown above, but it
must be placed at the top of any file using the <CODE
CLASS="literal"
>&lt;% %&gt;</CODE
> syntax for scripting. In
addition to this tag, you can use the <CODE
CLASS="literal"
>&lt;%= %&gt;</CODE
> tag throughout your file to
automatically assign a value to the output of your file (i.e., a
<CODE
CLASS="literal"
>$Response-&gt;write</CODE
> function). Here is an example:


<BLOCKQUOTE
CLASS="screen"
><PRE
CLASS="screen"
>&lt;%@ PerlScript&gt;
&lt;HTML&gt;
&lt;HEAD&gt;&lt;/HEAD&gt;
&lt;BODY&gt;
&lt;H1&gt;Say Hello, Boys!&lt;/H1&gt;

&lt;% my @onehit = (&quot;Bel&quot;, &quot;Biv&quot;, &quot;DeVoe&quot;); %&gt;

&lt;P&gt;
&lt;%= $onehit[0] %&gt; says &quot;Hello.&quot;
&lt;BR&gt;
&lt;%= $onehit[1] %&gt; says &quot;Hello.&quot;
&lt;BR&gt;
&lt;%= $onehit[2] %&gt; says &quot;Hello.&quot;

&lt;/P&gt;
&lt;/BODY&gt;
&lt;/HTML&gt;</PRE
></BLOCKQUOTE
>


The return value of any code within <CODE
CLASS="literal"
>&lt;%= %&gt;</CODE
> is placed into the output HTML returned to the client.
This syntax makes it very easy to intersperse the output of commands with
HTML throughout the ASP file.</P
><P
CLASS="para"
>The scripting object model for ASP contains the following top-level
objects:</P
><DL
CLASS="variablelist"
><DT
CLASS="term"
><EM
CLASS="emphasis"
>Application</EM
></DT
><DD
CLASS="listitem"
><P
CLASS="para"
><A
CLASS="indexterm"
NAME="AUTOID-45373"
></A
>Application objects can be created to share data among multiple users of defined
groups of <EM
CLASS="emphasis"
>.asp</EM
> files under a virtual directory on the server.</P
></DD
><DT
CLASS="term"
><EM
CLASS="emphasis"
>Request</EM
></DT
><DD
CLASS="listitem"
><P
CLASS="para"
><A
CLASS="indexterm"
NAME="PNUT-CH-20-IX-REQUEST-OBJECT-PERLSCRIPT"
></A
>The Request object encapsulates all of the information about
the browser and any data it supplies in its request, such as POST data
from a form. It is equivalent to the information contained in an HTTP request.</P
></DD
><DT
CLASS="term"
><EM
CLASS="emphasis"
>Response</EM
></DT
><DD
CLASS="listitem"
><P
CLASS="para"
><A
CLASS="indexterm"
NAME="AUTOID-45388"
></A
>The Response object represents information and data sent to a client after a request.
It is equivalent to an HTTP server response.</P
></DD
><DT
CLASS="term"
><EM
CLASS="emphasis"
>Server</EM
></DT
><DD
CLASS="listitem"
><P
CLASS="para"
><A
CLASS="indexterm"
NAME="AUTOID-45395"
></A
>The Server object contains certain control parameters for the server and provides methods
for creating connections to other applications.</P
></DD
><DT
CLASS="term"
><EM
CLASS="emphasis"
>Session</EM
></DT
><DD
CLASS="listitem"
><P
CLASS="para"
><A
CLASS="indexterm"
NAME="AUTOID-45402"
></A
>The Session object uses cookies to store state information for a user across
multiple pages accessed during a session.</P
></DD
></DL
><P
CLASS="para"
>The Request and Response objects provide an ASP interface to the HTTP protocol used
in web transactions. The other objects encapsulate special server features and connections
to outside applications.</P
><DIV
CLASS="sect2"
><H3
CLASS="sect2"
><A
CLASS="title"
NAME="PNUT-CH-20-SECT-2.1"
>20.2.1 The Request Object</A
></H3
><P
CLASS="para"
>The Request object contains all the information sent to the server in
the client's request. This object has only one property, TotalBytes, which
is read-only and gives the number of bytes sent in the body of a client request.<A
CLASS="indexterm"
NAME="AUTOID-45408"
></A
>
The <CODE
CLASS="literal"
>BinaryRead</CODE
> method of the Request object retrieves the client request
as raw binary data.</P
><P
CLASS="para"
>The information contained in a request is stored in various collection objects.
Collections contain objects that represent the important pieces of a request, for example,
form or cookie data. There are five collections under the Request
object:</P
><DL
CLASS="variablelist"
><DT
CLASS="term"
><EM
CLASS="emphasis"
>ClientCertificate</EM
></DT
><DD
CLASS="listitem"
><P
CLASS="para"
><A
CLASS="indexterm"
NAME="AUTOID-45418"
></A
>Contains information from a client certificate sent in the request. </P
></DD
><DT
CLASS="term"
><EM
CLASS="emphasis"
>Cookies</EM
></DT
><DD
CLASS="listitem"
><P
CLASS="para"
><A
CLASS="indexterm"
NAME="AUTOID-45425"
></A
>Contains the data from any cookies sent in the request.  </P
></DD
><DT
CLASS="term"
><EM
CLASS="emphasis"
>Form</EM
></DT
><DD
CLASS="listitem"
><P
CLASS="para"
><A
CLASS="indexterm"
NAME="AUTOID-45432"
></A
>Contains POST data from forms.</P
></DD
><DT
CLASS="term"
><EM
CLASS="emphasis"
>QueryString</EM
></DT
><DD
CLASS="listitem"
><P
CLASS="para"
><A
CLASS="indexterm"
NAME="AUTOID-45439"
></A
>Contains form data passed in the query string of the URL.  </P
></DD
><DT
CLASS="term"
><EM
CLASS="emphasis"
>ServerVariables</EM
></DT
><DD
CLASS="listitem"
><P
CLASS="para"
><A
CLASS="indexterm"
NAME="AUTOID-45446"
></A
>Contains the values of environment variables and header values in the request.</P
></DD
></DL
><P
CLASS="para"
><A
CLASS="indexterm"
NAME="AUTOID-45449"
></A
>To access the objects in the collection, the name of an object is given as the argument to the Collection object.
For example, to access a form variable named <CODE
CLASS="literal"
>&quot;birthday&quot;</CODE
> from the Form collection, you would use:


<BLOCKQUOTE
CLASS="screen"
><PRE
CLASS="screen"
>$object = $Request-&gt;Form(&quot;birthday&quot;);</PRE
></BLOCKQUOTE
>


This returns an object for the <CODE
CLASS="literal"
>&quot;birthday&quot;</CODE
> form variable. To get the value, you use
the <CODE
CLASS="literal"
>Item</CODE
> method on the object:


<BLOCKQUOTE
CLASS="screen"
><PRE
CLASS="screen"
>$data = $Request-&gt;Form(&quot;birthday&quot;)-&gt;Item;</PRE
></BLOCKQUOTE
>


This returns the value assigned to <CODE
CLASS="literal"
>&quot;birthday&quot;</CODE
> in the
request. Since ASP collection objects are OLE collections, the
functionality of the Win32::OLE modules can be employed. See
<A
CLASS="xref"
HREF="ch19_01.htm"
TITLE="Win32 Modules and Extensions"
>Chapter 19, <CITE
CLASS="chapter"
>Win32 Modules and Extensions</CITE
></A
>, for more information on OLE collections.</P
><P
CLASS="para"
>The QueryString collection contains form data input by the GET method and transmitted
at the end of the requested URL. Values are retrieved from the QueryString object the same
way they are retrieved from the form object, for example:


<BLOCKQUOTE
CLASS="screen"
><PRE
CLASS="screen"
>$data = $Request-&gt;QueryString(&quot;birthday&quot;)-&gt;Item;</PRE
></BLOCKQUOTE
>


Cookies sent within a client request are stored the same way. The name of the cookie
variable retrieves the cookie object from the collection, and <B
CLASS="emphasis.bold"
>Item</B
> retrieves the
value:


<BLOCKQUOTE
CLASS="screen"
><PRE
CLASS="screen"
>$data = $Request-&gt;Cookie(&quot;birthday&quot;)-&gt;Item;</PRE
></BLOCKQUOTE
>


The ServerVariables collection stores both environment variables relevant to the transaction
and HTTP headers sent in the request. The header objects are accessible by using the
syntax: HTTP_<EM
CLASS="emphasis"
>HeaderName</EM
>. Underscores contained within <EM
CLASS="emphasis"
>HeaderName</EM
> are interpreted
as dashes.<A
CLASS="indexterm"
NAME="AUTOID-45464"
></A
></P
></DIV
><DIV
CLASS="sect2"
><H3
CLASS="sect2"
><A
CLASS="title"
NAME="PNUT-CH-20-SECT-2.2"
>20.2.2 The Response Object</A
></H3
><P
CLASS="para"
><A
CLASS="indexterm"
NAME="PNUT-CH-20-IX-RESPONSE-OBJECT-PERLSCRIPT"
></A
>The Response object contains the information output to the client. 
The <CODE
CLASS="literal"
>Write</CODE
> method is primarily used to write the output of code to the client,
but the Response object is also used to create and send cookies to the client, as well
as manipulate headers, update server logs, and set control parameters for the document.</P
><DIV
CLASS="sect3"
><H4
CLASS="sect3"
><A
CLASS="title"
NAME="PNUT-CH-20-SECT-2.2.1"
>20.2.2.1 Setting cookies</A
></H4
><P
CLASS="para"
><A
CLASS="indexterm"
NAME="AUTOID-45474"
></A
>The Response object contains one collection for setting cookies with the client.
The Cookies collection allows you to create cookies and sets the information that
is delivered to the client in the Set-Cookie header of the HTTP response.<A
CLASS="indexterm"
NAME="AUTOID-45477"
></A
></P
><P
CLASS="para"
>In the ASP file, you can check for a returned cookie in the request, and if
there is none, you can set a new cookie:


<BLOCKQUOTE
CLASS="screen"
><PRE
CLASS="screen"
>&lt;%
if ( defined($Request-&gt;Cookie(&quot;user&quot;) )
  { $userid = $Request-&gt;Cookie(&quot;user&quot;)-&gt;Item; }
else
  { $Response-&gt;Cookie(&quot;user&quot;) = 123; };
%&gt;</PRE
></BLOCKQUOTE
>


This will check to see if a cookie named <CODE
CLASS="literal"
>user</CODE
> was sent in the
request. If it was not, a new cookie is sent in the response and set
on the client machine.</P
><P
CLASS="para"
>The Response cookie collection uses a number of properties to set the standard
attributes used with cookies. For example, to set the expiration of a cookie,
you would use the Expires attribute:


<BLOCKQUOTE
CLASS="screen"
><PRE
CLASS="screen"
>$Response-&gt;Cookie(&quot;user&quot;)-&gt;{Expires} = &quot;Tuesday, 31-Dec-99 00:00:00 GMT&quot;;</PRE
></BLOCKQUOTE
>


The client will no longer return a cookie after its expiration date.</P
><P
CLASS="para"
>The following properties are used to set attributes on a response cookie:</P
><DL
CLASS="variablelist"
><DT
CLASS="term"
><CODE
CLASS="replaceable"
><I
>Domain</I
></CODE
></DT
><DD
CLASS="listitem"
><P
CLASS="para"
><A
CLASS="indexterm"
NAME="AUTOID-45491"
></A
>If specified, the cookie will be sent in any request to this domain.
The value must contain at least two dots, e.g., <CODE
CLASS="literal"
>.oreilly.com</CODE
>. This
value would cover both <CODE
CLASS="literal"
>www.oreilly.com</CODE
> and <CODE
CLASS="literal"
>software.oreilly.com</CODE
>.</P
></DD
><DT
CLASS="term"
><CODE
CLASS="replaceable"
><I
>Expires</I
></CODE
></DT
><DD
CLASS="listitem"
><P
CLASS="para"
><A
CLASS="indexterm"
NAME="AUTOID-45501"
></A
>Sets the expiration date for the cookie.</P
></DD
><DT
CLASS="term"
><CODE
CLASS="replaceable"
><I
>Path</I
></CODE
></DT
><DD
CLASS="listitem"
><P
CLASS="para"
><A
CLASS="indexterm"
NAME="AUTOID-45508"
></A
>Sets the URL range for which the cookie is valid. If the value is set to
<CODE
CLASS="literal"
>/pub</CODE
>, for example, the cookie will be returned for URLs in <CODE
CLASS="literal"
>/pub</CODE
>
as well as subpaths such as <CODE
CLASS="literal"
>/pub/docs</CODE
> and <CODE
CLASS="literal"
>/pub/images</CODE
>. A path
value of &quot;/&quot; indicates that the cookie will be used for all URLs at the originating
site. If no path value is set, the cookie will be returned only for the originating
URL.</P
></DD
><DT
CLASS="term"
><CODE
CLASS="replaceable"
><I
>Secure</I
></CODE
></DT
><DD
CLASS="listitem"
><P
CLASS="para"
><A
CLASS="indexterm"
NAME="AUTOID-45519"
></A
>If set to true, this attribute instructs the client to return the cookie over only a secure
connection (via SHTTP or SSL).</P
></DD
></DL
></DIV
><DIV
CLASS="sect3"
><H4
CLASS="sect3"
><A
CLASS="title"
NAME="PNUT-CH-20-SECT-2.2.2"
>20.2.2.2 Response properties</A
></H4
><P
CLASS="para"
>The following properties can be set on the Response object. The
property syntax is as follows:


<BLOCKQUOTE
CLASS="screen"
><PRE
CLASS="screen"
>$Response-&gt;{<EM
CLASS="emphasis"
>property</EM
>} = <EM
CLASS="emphasis"
>value</EM
>;</PRE
></BLOCKQUOTE
>
&#13;</P
><DL
CLASS="variablelist"
><DT
CLASS="term"
><CODE
CLASS="replaceable"
><I
>Buffer</I
></CODE
></DT
><DD
CLASS="listitem"
><P
CLASS="para"
><A
CLASS="indexterm"
NAME="AUTOID-45533"
></A
>If set to false, output is sent the client immediately as it is processed by the script.
If set to true, output is buffered and sent only when the entire page has been processed,
or upon calls to the <CODE
CLASS="literal"
>Flush</CODE
> or <CODE
CLASS="literal"
>End</CODE
> methods.</P
></DD
><DT
CLASS="term"
><CODE
CLASS="replaceable"
><I
>CacheControl</I
></CODE
></DT
><DD
CLASS="listitem"
><P
CLASS="para"
><A
CLASS="indexterm"
NAME="AUTOID-45542"
></A
>If set to <CODE
CLASS="literal"
>Private</CODE
>, output from this ASP page will not be cached by a proxy server.
If set to <CODE
CLASS="literal"
>Public</CODE
>, the output can be cached by a proxy server.</P
></DD
><DT
CLASS="term"
><CODE
CLASS="replaceable"
><I
>Charset</I
></CODE
></DT
><DD
CLASS="listitem"
><P
CLASS="para"
><A
CLASS="indexterm"
NAME="AUTOID-45551"
></A
>Appends the given character set name to the Content-Type header. </P
></DD
><DT
CLASS="term"
><CODE
CLASS="replaceable"
><I
>ContentType</I
></CODE
></DT
><DD
CLASS="listitem"
><P
CLASS="para"
><A
CLASS="indexterm"
NAME="AUTOID-45558"
></A
>Specifies the HTTP content type of the response; for example, <CODE
CLASS="literal"
>text/html</CODE
>.  </P
></DD
><DT
CLASS="term"
><CODE
CLASS="replaceable"
><I
>Expires</I
></CODE
></DT
><DD
CLASS="listitem"
><P
CLASS="para"
><A
CLASS="indexterm"
NAME="AUTOID-45566"
></A
>Specifies the length of time in minutes before a client-cached page expires. After
this time, the page will be requested again. A setting of 0 forces
the page to expire immediately.</P
></DD
><DT
CLASS="term"
><CODE
CLASS="replaceable"
><I
>ExpiresAbsolute</I
></CODE
></DT
><DD
CLASS="listitem"
><P
CLASS="para"
><A
CLASS="indexterm"
NAME="AUTOID-45573"
></A
>Specifies the date and time on which a client-cached page expires. The date
and time are given in a format such as &quot;June 18,1999 00:00:00&quot;, where
the time is GMT.</P
></DD
><DT
CLASS="term"
><CODE
CLASS="replaceable"
><I
>IsClientConnected</I
></CODE
></DT
><DD
CLASS="listitem"
><P
CLASS="para"
><A
CLASS="indexterm"
NAME="AUTOID-45580"
></A
>Returns true if the client is still connected to the server (possibly waiting
on a request); false, otherwise.</P
></DD
><DT
CLASS="term"
><CODE
CLASS="replaceable"
><I
>Pics</I
></CODE
></DT
><DD
CLASS="listitem"
><P
CLASS="para"
><A
CLASS="indexterm"
NAME="AUTOID-45587"
></A
>Adds a PICS-label header to the response with the given PICS formatted string.</P
></DD
><DT
CLASS="term"
><CODE
CLASS="replaceable"
><I
>Status</I
></CODE
></DT
><DD
CLASS="listitem"
><P
CLASS="para"
><A
CLASS="indexterm"
NAME="AUTOID-45594"
></A
>Sets the status code and explanation string in a server response, for example
&quot;403 Forbidden&quot;.</P
></DD
></DL
></DIV
><DIV
CLASS="sect3"
><H4
CLASS="sect3"
><A
CLASS="title"
NAME="PNUT-CH-20-SECT-2.2.3"
>20.2.2.3 Response methods</A
></H4
><P
CLASS="para"
>The following methods can be used on the Response object.</P
><DL
CLASS="variablelist"
><DT
CLASS="term"
><CODE
CLASS="literal"
>AddHeader (<CODE
CLASS="replaceable"
><I
>header</I
></CODE
>, <CODE
CLASS="replaceable"
><I
>value</I
></CODE
>)</CODE
></DT
><DD
CLASS="listitem"
><P
CLASS="para"
><A
CLASS="indexterm"
NAME="AUTOID-45607"
></A
>Adds an HTTP <CODE
CLASS="replaceable"
><I
>header</I
></CODE
> with assigned <CODE
CLASS="replaceable"
><I
>value</I
></CODE
> to the header of the HTTP response.
The specified header will simply be added to the response; it will not replace an
existing header. This method must be used in the ASP file before any page content
is output. For buffered pages, it can be used anywhere before the first <CODE
CLASS="literal"
>Flush</CODE
>
call.</P
></DD
><DT
CLASS="term"
><CODE
CLASS="literal"
>AppendToLog (<CODE
CLASS="replaceable"
><I
>string</I
></CODE
>)</CODE
></DT
><DD
CLASS="listitem"
><P
CLASS="para"
><A
CLASS="indexterm"
NAME="AUTOID-45619"
></A
>Appends <CODE
CLASS="replaceable"
><I
>string</I
></CODE
> to the server log (if extended logging is properly configured). 
<CODE
CLASS="replaceable"
><I
>string</I
></CODE
> can be a maximum of 80 characters
and should not contain commas.</P
></DD
><DT
CLASS="term"
><CODE
CLASS="literal"
>BinaryWrite (<CODE
CLASS="replaceable"
><I
>data</I
></CODE
>)</CODE
></DT
><DD
CLASS="listitem"
><P
CLASS="para"
><A
CLASS="indexterm"
NAME="AUTOID-45629"
></A
>Writes the given binary <CODE
CLASS="replaceable"
><I
>data</I
></CODE
> to the HTTP output without any conversion.</P
></DD
><DT
CLASS="term"
><CODE
CLASS="literal"
>Clear </CODE
>()</DT
><DD
CLASS="listitem"
><P
CLASS="para"
><A
CLASS="indexterm"
NAME="AUTOID-45637"
></A
>Clears any response content from the output buffer. This method will not clear
header information, and will cause a runtime error if <CODE
CLASS="literal"
>$Response-&gt;Buffer</CODE
> has
not been set to true.</P
></DD
><DT
CLASS="term"
><CODE
CLASS="literal"
>End </CODE
>()</DT
><DD
CLASS="listitem"
><P
CLASS="para"
><A
CLASS="indexterm"
NAME="AUTOID-45646"
></A
>Stops all processing of the ASP file and outputs any buffered content.</P
></DD
><DT
CLASS="term"
><CODE
CLASS="literal"
>Flush </CODE
>()</DT
><DD
CLASS="listitem"
><P
CLASS="para"
><A
CLASS="indexterm"
NAME="AUTOID-45653"
></A
>If buffering has been enabled with <CODE
CLASS="literal"
>$Response-&gt;Buffer</CODE
>, this call clears the buffer
and outputs its contents.</P
></DD
><DT
CLASS="term"
><CODE
CLASS="literal"
>Redirect (<CODE
CLASS="replaceable"
><I
>url</I
></CODE
>)</CODE
></DT
><DD
CLASS="listitem"
><P
CLASS="para"
><A
CLASS="indexterm"
NAME="AUTOID-45663"
></A
>Instructs the client to connect to the specified <CODE
CLASS="replaceable"
><I
>url</I
></CODE
>.</P
></DD
><DT
CLASS="term"
><CODE
CLASS="literal"
>Write (<CODE
CLASS="replaceable"
><I
>data</I
></CODE
>)</CODE
></DT
><DD
CLASS="listitem"
><P
CLASS="para"
><A
CLASS="indexterm"
NAME="AUTOID-45672"
></A
>Writes the <CODE
CLASS="replaceable"
><I
>data</I
></CODE
> to the HTML output stream.<A
CLASS="indexterm"
NAME="AUTOID-45676"
></A
><A
CLASS="indexterm"
NAME="AUTOID-45677"
></A
><A
CLASS="indexterm"
NAME="AUTOID-45678"
></A
><A
CLASS="indexterm"
NAME="AUTOID-45679"
></A
></P
></DD
></DL
></DIV
></DIV
></DIV
><DIV
CLASS="htmlnav"
><P
></P
><HR
ALIGN="LEFT"
WIDTH="515"
TITLE="footer"><TABLE
WIDTH="515"
BORDER="0"
CELLSPACING="0"
CELLPADDING="0"
><TR
><TD
ALIGN="LEFT"
VALIGN="TOP"
WIDTH="172"
><A
CLASS="SECT1"
HREF="ch20_01.htm"
TITLE="20.1 Client-Side PerlScript"
><IMG
SRC="../gifs/txtpreva.gif"
ALT="Previous: 20.1 Client-Side PerlScript"
BORDER="0"></A
></TD
><TD
ALIGN="CENTER"
VALIGN="TOP"
WIDTH="171"
><A
CLASS="book"
HREF="index.htm"
TITLE="Perl in a Nutshell"
><IMG
SRC="../gifs/txthome.gif"
ALT="Perl in a Nutshell"
BORDER="0"></A
></TD
><TD
ALIGN="RIGHT"
VALIGN="TOP"
WIDTH="172"
>&nbsp;</TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="TOP"
WIDTH="172"
>20.1 Client-Side PerlScript</TD
><TD
ALIGN="CENTER"
VALIGN="TOP"
WIDTH="171"
><A
CLASS="index"
HREF="index/idx_0.htm"
TITLE="Book Index"
><IMG
SRC="../gifs/index.gif"
ALT="Book Index"
BORDER="0"></A
></TD
><TD
ALIGN="RIGHT"
VALIGN="TOP"
WIDTH="172"
>&nbsp;</TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="515"
TITLE="footer"><P
CLASS="nav"
><FONT
SIZE="-1"
></P
></DIV
<p><!-- LIBRARY NAV BAR --> <img src="../gifs/smnavbar.gif" usemap="#library-map" border="0" alt="Library Navigation Links"><p> <a href="copyrght.htm">Copyright &copy; 2001</a> O'Reilly &amp; Associates. All rights reserved.</font> </p> <map name="library-map"> <area shape="rect" coords="2,-1,79,99" href="../index.htm"><area shape="rect" coords="84,1,157,108" href="index.htm"><area shape="rect" coords="162,2,248,125" href="../prog/index.htm"><area shape="rect" coords="253,2,326,130" href="../advprog/index.htm"><area shape="rect" coords="332,1,407,112" href="../cookbook/index.htm"><area shape="rect" coords="414,2,523,103" href="../sysadmin/index.htm"></map> </BODY
></HTML
>
