<HTML
><HEAD
>
<TITLE>Reference: new (Perl in a Nutshell)</TITLE>
<META
NAME="DC.title"
CONTENT="Perl in a Nutshell"><META
NAME="DC.creator"
CONTENT="Ellen Siever, Stephen Spainhour &amp; Nathan Patwardhan"><META
NAME="DC.publisher"
CONTENT="O'Reilly &amp; Associates, Inc."><META
NAME="DC.date"
CONTENT="1999-07-02T02:00:25Z"><META
NAME="DC.type"
CONTENT="Text.Monograph"><META
NAME="DC.format"
CONTENT="text/html"
SCHEME="MIME"><META
NAME="DC.source"
CONTENT="1-56592-286-7"
SCHEME="ISBN"><META
NAME="DC.language"
CONTENT="en-US"><META
NAME="generator"
CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINK
REV="made"
HREF="mailto:online-books@oreilly.com"
TITLE="Online Books Comments"><LINK
REL="up"
HREF="ch19_18.htm"
TITLE="19.18 OLE Automation"><LINK
REL="prev"
HREF="ch19_18.htm"
TITLE="19.18 OLE Automation"><LINK
REL="next"
HREF="c19_164.htm#"
TITLE="Reference: GetActiveObject"></HEAD
><BODY
BGCOLOR="#FFFFFF"
TEXT="#000000"
><DIV
CLASS="htmlnav"
><H1
><IMG
SRC="gifs/smbanner.gif"
ALT="Perl in a Nutshell"
USEMAP="#srchmap"
BORDER="0"></H1
><MAP
NAME="srchmap"
><AREA
SHAPE="RECT"
COORDS="0,0,466,71"
HREF="index.htm"
ALT="Perl in a Nutshell"><AREA
SHAPE="RECT"
COORDS="467,0,514,18"
HREF="jobjects/fsearch.htm"
ALT="Search this book"></MAP
><TABLE
WIDTH="515"
BORDER="0"
CELLSPACING="0"
CELLPADDING="0"
><TR
><TD
ALIGN="LEFT"
VALIGN="TOP"
WIDTH="172"
><A
CLASS="SECT1"
HREF="ch19_18.htm"
TITLE="19.18 OLE Automation"
><IMG
SRC="../gifs/txtpreva.gif"
ALT="Previous: 19.18 OLE Automation"
BORDER="0"></A
></TD
><TD
ALIGN="CENTER"
VALIGN="TOP"
WIDTH="171"
><B
><FONT
FACE="ARIEL,HELVETICA,HELV,SANSERIF"
SIZE="-1"
><A
CLASS="chapter"
REL="up"
HREF="ch19_01.htm"
TITLE="19. Win32 Modules and Extensions"
>Chapter 19<BR>Win32 Modules and Extensions</A
></FONT
></B
></TD
><TD
ALIGN="RIGHT"
VALIGN="TOP"
WIDTH="172"
><A
CLASS="NUTENTRY"
HREF="c19_164.htm#"
TITLE="Reference: GetActiveObject"
><IMG
SRC="../gifs/txtnexta.gif"
ALT="Next: Reference: GetActiveObject"
BORDER="0"></A
></TD
></TR
></TABLE
>&nbsp;<HR
ALIGN="LEFT"
WIDTH="515"
TITLE="footer"></DIV
><DIV
CLASS="NUTENTRY"
><H2
CLASS="nutentry"
><A
CLASS="term"
NAME="AUTOID-44643"
>new</A
></H2
><PRE
CLASS="nutsynopsis"
><B
CLASS="emphasis.bold"
>Win32::OLE-&gt;new</B
>(<EM
CLASS="emphasis"
>progid</EM
>, [<EM
CLASS="emphasis"
>destructor</EM
>])</PRE
><DL
CLASS="nutentrybody"
><P
CLASS="para"
><A
CLASS="indexterm"
NAME="AUTOID-44651"
></A
>Creates a new automation object. This method always creates
a new instance of the server, even if a previous instance of
the server is running. If the object cannot be created, <CODE
CLASS="literal"
>new</CODE
>
returns <CODE
CLASS="literal"
>undef</CODE
>.</P
><P
CLASS="para"
><EM
CLASS="emphasis"
>progid</EM
>, the program identifier (ProgID), is a string that uniquely
identifies an automation object. <EM
CLASS="emphasis"
>progid</EM
> is used to look up
the object's class ID (CLSID), which is stored in the registry.</P
><P
CLASS="para"
>The second, optional argument to the <CODE
CLASS="literal"
>new</CODE
> method describes
a way to destroy the object in case the Perl program dies unexpectedly.
<EM
CLASS="emphasis"
>destructor</EM
> can be either a string with the name of the defined
OLE destructor method, or a code reference that will destroy the
object. You should use some form of destructor to close out all
your objects, for they can be extremely expensive in terms of system
resources. You can explicitly destroy an object using the <CODE
CLASS="literal"
>undef</CODE
> function.
If you don't explicitly destroy the object, Perl takes care of it for
you when the last reference to the object goes away.</P
><P
CLASS="para"
>Here is what <CODE
CLASS="literal"
>new</CODE
> would look like with the destructor arguments:


<BLOCKQUOTE
CLASS="screen"
><PRE
CLASS="screen"
># Quit is the OLE-defined destructor method
$x1 = Win32::OLE-&gt;new(&quot;Excel.Application&quot;, 'Quit');

# The object reference is the first argument ($_[0]) passed to new.
# The code reference will undef it to destroy the object.
$x2 = Win32::OLE-&gt;new(&quot;Excel.Application&quot;, sub{undef $_[0];})</PRE
></BLOCKQUOTE
>


Notice that we're supplying Excel.Application as the ProgID.
Excel supports several different automation objects, including an
Application object, WorkBook objects, and several more. You don't
necessarily have to create the top-level object (Application, in this
case) when dealing with automation objects (this is determined by
the automation server). In Excel's case, we could have directly created
a WorkSheet object (e.g., Excel.Sheet) or a Chart object, for example.</P
></DL
></DIV
><DIV
CLASS="htmlnav"
><P
></P
><HR
ALIGN="LEFT"
WIDTH="515"
TITLE="footer"><TABLE
WIDTH="515"
BORDER="0"
CELLSPACING="0"
CELLPADDING="0"
><TR
><TD
ALIGN="LEFT"
VALIGN="TOP"
WIDTH="172"
><A
CLASS="SECT1"
HREF="ch19_18.htm"
TITLE="19.18 OLE Automation"
><IMG
SRC="../gifs/txtpreva.gif"
ALT="Previous: 19.18 OLE Automation"
BORDER="0"></A
></TD
><TD
ALIGN="CENTER"
VALIGN="TOP"
WIDTH="171"
><A
CLASS="book"
HREF="index.htm"
TITLE="Perl in a Nutshell"
><IMG
SRC="../gifs/txthome.gif"
ALT="Perl in a Nutshell"
BORDER="0"></A
></TD
><TD
ALIGN="RIGHT"
VALIGN="TOP"
WIDTH="172"
><A
CLASS="NUTENTRY"
HREF="c19_164.htm#"
TITLE="Reference: GetActiveObject"
><IMG
SRC="../gifs/txtnexta.gif"
ALT="Next: Reference: GetActiveObject"
BORDER="0"></A
></TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="TOP"
WIDTH="172"
>19.18 OLE Automation</TD
><TD
ALIGN="CENTER"
VALIGN="TOP"
WIDTH="171"
><A
CLASS="index"
HREF="index/idx_0.htm"
TITLE="Book Index"
><IMG
SRC="../gifs/index.gif"
ALT="Book Index"
BORDER="0"></A
></TD
><TD
ALIGN="RIGHT"
VALIGN="TOP"
WIDTH="172"
>Reference: GetActiveObject</TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="515"
TITLE="footer"><P
CLASS="nav"
><FONT
SIZE="-1"
></P
></DIV
<p><!-- LIBRARY NAV BAR --> <img src="../gifs/smnavbar.gif" usemap="#library-map" border="0" alt="Library Navigation Links"><p> <a href="copyrght.htm">Copyright &copy; 2001</a> O'Reilly &amp; Associates. All rights reserved.</font> </p> <map name="library-map"> <area shape="rect" coords="2,-1,79,99" href="../index.htm"><area shape="rect" coords="84,1,157,108" href="index.htm"><area shape="rect" coords="162,2,248,125" href="../prog/index.htm"><area shape="rect" coords="253,2,326,130" href="../advprog/index.htm"><area shape="rect" coords="332,1,407,112" href="../cookbook/index.htm"><area shape="rect" coords="414,2,523,103" href="../sysadmin/index.htm"></map> </BODY
></HTML
>
