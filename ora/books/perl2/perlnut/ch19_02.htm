<HTML
><HEAD
>
<TITLE>19.2 Win32::Console (Perl in a Nutshell)</TITLE>
<META
NAME="DC.title"
CONTENT="Perl in a Nutshell"><META
NAME="DC.creator"
CONTENT="Ellen Siever, Stephen Spainhour &amp; Nathan Patwardhan"><META
NAME="DC.publisher"
CONTENT="O'Reilly &amp; Associates, Inc."><META
NAME="DC.date"
CONTENT="1999-07-02T01:59:13Z"><META
NAME="DC.type"
CONTENT="Text.Monograph"><META
NAME="DC.format"
CONTENT="text/html"
SCHEME="MIME"><META
NAME="DC.source"
CONTENT="1-56592-286-7"
SCHEME="ISBN"><META
NAME="DC.language"
CONTENT="en-US"><META
NAME="generator"
CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINK
REV="made"
HREF="mailto:online-books@oreilly.com"
TITLE="Online Books Comments"><LINK
REL="up"
HREF="ch19_01.htm"
TITLE="19. Win32 Modules and Extensions"><LINK
REL="prev"
HREF="ch19_01.htm"
TITLE="19.1 Win32::Clipboard"><LINK
REL="next"
HREF="ch19_03.htm"
TITLE="19.3 Win32::ChangeNotification"></HEAD
><BODY
BGCOLOR="#FFFFFF"
TEXT="#000000"
><DIV
CLASS="htmlnav"
><H1
><IMG
SRC="gifs/smbanner.gif"
ALT="Perl in a Nutshell"
USEMAP="#srchmap"
BORDER="0"></H1
><MAP
NAME="srchmap"
><AREA
SHAPE="RECT"
COORDS="0,0,466,71"
HREF="index.htm"
ALT="Perl in a Nutshell"><AREA
SHAPE="RECT"
COORDS="467,0,514,18"
HREF="jobjects/fsearch.htm"
ALT="Search this book"></MAP
><TABLE
WIDTH="515"
BORDER="0"
CELLSPACING="0"
CELLPADDING="0"
><TR
><TD
ALIGN="LEFT"
VALIGN="TOP"
WIDTH="172"
><A
CLASS="SECT1"
HREF="ch19_01.htm"
TITLE="19.1 Win32::Clipboard"
><IMG
SRC="../gifs/txtpreva.gif"
ALT="Previous: 19.1 Win32::Clipboard"
BORDER="0"></A
></TD
><TD
ALIGN="CENTER"
VALIGN="TOP"
WIDTH="171"
><B
><FONT
FACE="ARIEL,HELVETICA,HELV,SANSERIF"
SIZE="-1"
><A
CLASS="chapter"
REL="up"
HREF="ch19_01.htm"
TITLE="19. Win32 Modules and Extensions"
>Chapter 19<BR>Win32 Modules and Extensions</A
></FONT
></B
></TD
><TD
ALIGN="RIGHT"
VALIGN="TOP"
WIDTH="172"
><A
CLASS="SECT1"
HREF="ch19_03.htm"
TITLE="19.3 Win32::ChangeNotification"
><IMG
SRC="../gifs/txtnexta.gif"
ALT="Next: 19.3 Win32::ChangeNotification"
BORDER="0"></A
></TD
></TR
></TABLE
>&nbsp;<HR
ALIGN="LEFT"
WIDTH="515"
TITLE="footer"></DIV
><DIV
CLASS="SECT1"
><H2
CLASS="sect1"
><A
CLASS="title"
NAME="PNUT-CH-19-SECT-2"
>19.2 Win32::Console</A
></H2
><P
CLASS="para"
><A
CLASS="indexterm"
NAME="PNUT-CH-19-IX-WIN32-MODULES-WIN32CONSOLE-MODULE"
></A
><A
CLASS="indexterm"
NAME="PNUT-CH-19-IX-CONSOLE-IMPLEMENTATION"
></A
>Win32::Console implements the Win32 console and character mode functions. They give you 
full control on the console input and output, including: 
support of off-screen console buffers (e.g., multiple screen pages);
reading and writing of characters, attributes, and whole portions of the screen;
and complete processing of keyboard and mouse events.</P
><P
CLASS="para"
><A
CLASS="indexterm"
NAME="AUTOID-41002"
></A
>The <CODE
CLASS="literal"
>new</CODE
> constructor is used to create a console object. It can take two
forms:


<BLOCKQUOTE
CLASS="screen"
><PRE
CLASS="screen"
>$con = Win32::Console-&gt;new(<EM
CLASS="emphasis"
>standard_handle</EM
>); 
$con = Win32::Console-&gt;new(<EM
CLASS="emphasis"
>accessmode</EM
>, <EM
CLASS="emphasis"
>sharemode</EM
>);</PRE
></BLOCKQUOTE
>


The first form creates a handle to a standard channel.
<CODE
CLASS="replaceable"
><I
>standard_handle</I
></CODE
> can be one of <CODE
CLASS="literal"
>STD_OUTPUT_HANDLE</CODE
>,
<CODE
CLASS="literal"
>STD_ERROR_HANDLE</CODE
>, or <CODE
CLASS="literal"
>STD_INPUT_HANDLE</CODE
>.</P
><P
CLASS="para"
>The second form creates a console screen buffer in memory, 
which you can access for reading and writing as a normal console, and then 
redirect on the standard output (the screen) with <CODE
CLASS="literal"
>Display</CODE
>. In this case, you 
can specify <CODE
CLASS="replaceable"
><I
>accessmode</I
></CODE
> to be <CODE
CLASS="literal"
>GENERIC_READ</CODE
>,
<CODE
CLASS="literal"
>GENERIC_WRITE</CODE
>, or both, determining the permissions you will
have on the created buffer. </P
><P
CLASS="para"
><CODE
CLASS="replaceable"
><I
>sharemode</I
></CODE
> affects the way the console can be shared. It can be
specified either as <CODE
CLASS="literal"
>FILE_SHARE_READ</CODE
>, <CODE
CLASS="literal"
>FILE_SHARE_WRITE</CODE
>,
or both. If you don't specify any of 
those parameters, all four flags will be used. </P
><P
CLASS="para"
>Methods supported by the Win32::Console module are:
<UL
CLASS="nutlist"
><LI
CLASS="term"
><A
CLASS="nutentry"
HREF="c19_001.htm#"
TITLE="Reference: Alloc"
>Alloc</A
></LI
><LI
CLASS="term"
><A
CLASS="nutentry"
HREF="c19_002.htm#"
TITLE="Reference: Attr"
>Attr</A
></LI
><LI
CLASS="term"
><A
CLASS="nutentry"
HREF="c19_003.htm"
TITLE="Reference: Cls"
>Cls</A
></LI
><LI
CLASS="term"
><A
CLASS="nutentry"
HREF="c19_004.htm"
TITLE="Reference: Cursor"
>Cursor</A
></LI
><LI
CLASS="term"
><A
CLASS="nutentry"
HREF="c19_005.htm#"
TITLE="Reference: Display"
>Display</A
></LI
><LI
CLASS="term"
><A
CLASS="nutentry"
HREF="c19_006.htm#"
TITLE="Reference: FillAttr"
>FillAttr</A
></LI
><LI
CLASS="term"
><A
CLASS="nutentry"
HREF="c19_007.htm#"
TITLE="Reference: FillChar"
>FillChar</A
></LI
><LI
CLASS="term"
><A
CLASS="nutentry"
HREF="c19_008.htm"
TITLE="Reference: Flush"
>Flush</A
></LI
><LI
CLASS="term"
><A
CLASS="nutentry"
HREF="c19_009.htm#"
TITLE="Reference: Free"
>Free</A
></LI
><LI
CLASS="term"
><A
CLASS="nutentry"
HREF="c19_010.htm#"
TITLE="Reference: GenerateCtrlEvent"
>GenerateCtrlEvent</A
></LI
><LI
CLASS="term"
><A
CLASS="nutentry"
HREF="c19_011.htm#"
TITLE="Reference: GetEvents"
>GetEvents</A
></LI
><LI
CLASS="term"
><A
CLASS="nutentry"
HREF="c19_012.htm#"
TITLE="Reference: Info"
>Info</A
></LI
><LI
CLASS="term"
><A
CLASS="nutentry"
HREF="c19_013.htm#"
TITLE="Reference: Input"
>Input</A
></LI
><LI
CLASS="term"
><A
CLASS="nutentry"
HREF="c19_014.htm#"
TITLE="Reference: InputChar"
>InputChar</A
></LI
><LI
CLASS="term"
><A
CLASS="nutentry"
HREF="c19_015.htm#"
TITLE="Reference: InputCP"
>InputCP</A
></LI
><LI
CLASS="term"
><A
CLASS="nutentry"
HREF="c19_016.htm#"
TITLE="Reference: MaxWindow"
>MaxWindow</A
></LI
><LI
CLASS="term"
><A
CLASS="nutentry"
HREF="c19_017.htm#"
TITLE="Reference: Mode"
>Mode</A
></LI
><LI
CLASS="term"
><A
CLASS="nutentry"
HREF="c19_018.htm#"
TITLE="Reference: MouseButtons"
>MouseButtons</A
></LI
><LI
CLASS="term"
><A
CLASS="nutentry"
HREF="c19_019.htm#"
TITLE="Reference: OutputCP"
>OutputCP</A
></LI
><LI
CLASS="term"
><A
CLASS="nutentry"
HREF="c19_020.htm#"
TITLE="Reference: PeekInput"
>PeekInput</A
></LI
><LI
CLASS="term"
><A
CLASS="nutentry"
HREF="c19_021.htm#"
TITLE="Reference: ReadAttr"
>ReadAttr</A
></LI
><LI
CLASS="term"
><A
CLASS="nutentry"
HREF="c19_022.htm#"
TITLE="Reference: ReadChar"
>ReadChar</A
></LI
><LI
CLASS="term"
><A
CLASS="nutentry"
HREF="c19_023.htm#"
TITLE="Reference: ReadRect"
>ReadRect</A
></LI
><LI
CLASS="term"
><A
CLASS="nutentry"
HREF="c19_024.htm#"
TITLE="Reference: Scroll"
>Scroll</A
></LI
><LI
CLASS="term"
><A
CLASS="nutentry"
HREF="c19_025.htm#"
TITLE="Reference: Select"
>Select</A
></LI
><LI
CLASS="term"
><A
CLASS="nutentry"
HREF="c19_026.htm"
TITLE="Reference: Size"
>Size</A
></LI
><LI
CLASS="term"
><A
CLASS="nutentry"
HREF="c19_027.htm#"
TITLE="Reference: Title"
>Title</A
></LI
><LI
CLASS="term"
><A
CLASS="nutentry"
HREF="c19_028.htm#"
TITLE="Reference: Window"
>Window</A
></LI
><LI
CLASS="term"
><A
CLASS="nutentry"
HREF="c19_029.htm#"
TITLE="Reference: Write"
>Write</A
></LI
><LI
CLASS="term"
><A
CLASS="nutentry"
HREF="c19_030.htm#"
TITLE="Reference: WriteAttr"
>WriteAttr</A
></LI
><LI
CLASS="term"
><A
CLASS="nutentry"
HREF="c19_031.htm#"
TITLE="Reference: WriteChar"
>WriteChar</A
></LI
><LI
CLASS="term"
><A
CLASS="nutentry"
HREF="c19_032.htm#"
TITLE="Reference: WriteInput"
>WriteInput</A
></LI
><LI
CLASS="term"
><A
CLASS="nutentry"
HREF="c19_033.htm#"
TITLE="Reference: WriteRect"
>WriteRect</A
></LI
></UL
></P
><DIV
CLASS="sect2"
><H3
CLASS="sect2"
><A
CLASS="title"
NAME="PNUT-CH-19-SECT-2.0.1"
>19.2.1 Constants</A
></H3
><P
CLASS="para"
>The following constants are exported in the main namespace of your 
script using Win32::Console: 


<BLOCKQUOTE
CLASS="screen"
><PRE
CLASS="screen"
>BACKGROUND_BLUE		        BACKGROUND_GREEN
BACKGROUND_INTENSITY	    BACKGROUND_RED
CAPSLOCK_ON		            CONSOLE_TEXTMODE_BUFFER    
ENABLE_ECHO_INPUT		    ENABLE_LINE_INPUT
ENABLE_MOUSE_INPUT		    ENABLE_PROCESSED_INPUT
ENABLE_PROCESSED_OUTPUT	    ENABLE_WINDOW_INPUT
ENABLE_WRAP_AT_EOL_OUTPUT	ENHANCED_KEY
FILE_SHARE_READ		        FILE_SHARE_WRITE
FOREGROUND_BLUE		        FOREGROUND_GREEN
FOREGROUND_INTENSITY	    FOREGROUND_RED
LEFT_ALT_PRESSED		    LEFT_CTRL_PRESSED
NUMLOCK_ON		            GENERIC_READ
GENERIC_WRITE		        RIGHT_ALT_PRESSED
RIGHT_CTRL_PRESSED		    SCROLLLOCK_ON
SHIFT_PRESSED		        STD_INPUT_HANDLE
STD_OUTPUT_HANDLE		    STD_ERROR_HANDLE</PRE
></BLOCKQUOTE
>


Additionally, the following variables can be used: 


<BLOCKQUOTE
CLASS="screen"
><PRE
CLASS="screen"
>$FG_BLACK			$FG_BLUE
$FG_LIGHTBLUE		$FG_RED
$FG_LIGHTRED		$FG_GREEN
$FG_LIGHTGREEN		$FG_MAGENTA
$FG_LIGHTMAGENTA		$FG_CYAN
$FG_LIGHTCYAN		$FG_BROWN
$FG_YELLOW		$FG_GRAY
$FG_WHITE
$BG_BLACK			$BG_BLUE
$BG_LIGHTBLUE		$BG_RED
$BG_LIGHTRED		$BG_GREEN
$BG_LIGHTGREEN		$BG_MAGENTA
$BG_LIGHTMAGENTA		$BG_CYAN
$BG_LIGHTCYAN		$BG_BROWN
$BG_YELLOW		$BG_GRAY
$BG_WHITE
$ATTR_NORMAL		$ATTR_INVERSE</PRE
></BLOCKQUOTE
>


<CODE
CLASS="literal"
>ATTR_NORMAL</CODE
> is set to gray foreground on black background (DOS's standard colors). <A
CLASS="indexterm"
NAME="AUTOID-41584"
></A
><A
CLASS="indexterm"
NAME="AUTOID-41585"
></A
></P
></DIV
></DIV
><DIV
CLASS="htmlnav"
><P
></P
><HR
ALIGN="LEFT"
WIDTH="515"
TITLE="footer"><TABLE
WIDTH="515"
BORDER="0"
CELLSPACING="0"
CELLPADDING="0"
><TR
><TD
ALIGN="LEFT"
VALIGN="TOP"
WIDTH="172"
><A
CLASS="SECT1"
HREF="ch19_01.htm"
TITLE="19.1 Win32::Clipboard"
><IMG
SRC="../gifs/txtpreva.gif"
ALT="Previous: 19.1 Win32::Clipboard"
BORDER="0"></A
></TD
><TD
ALIGN="CENTER"
VALIGN="TOP"
WIDTH="171"
><A
CLASS="book"
HREF="index.htm"
TITLE="Perl in a Nutshell"
><IMG
SRC="../gifs/txthome.gif"
ALT="Perl in a Nutshell"
BORDER="0"></A
></TD
><TD
ALIGN="RIGHT"
VALIGN="TOP"
WIDTH="172"
><A
CLASS="SECT1"
HREF="ch19_03.htm"
TITLE="19.3 Win32::ChangeNotification"
><IMG
SRC="../gifs/txtnexta.gif"
ALT="Next: 19.3 Win32::ChangeNotification"
BORDER="0"></A
></TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="TOP"
WIDTH="172"
>19.1 Win32::Clipboard</TD
><TD
ALIGN="CENTER"
VALIGN="TOP"
WIDTH="171"
><A
CLASS="index"
HREF="index/idx_0.htm"
TITLE="Book Index"
><IMG
SRC="../gifs/index.gif"
ALT="Book Index"
BORDER="0"></A
></TD
><TD
ALIGN="RIGHT"
VALIGN="TOP"
WIDTH="172"
>19.3 Win32::ChangeNotification</TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="515"
TITLE="footer"><P
CLASS="nav"
><FONT
SIZE="-1"
></P
></DIV
<p><!-- LIBRARY NAV BAR --> <img src="../gifs/smnavbar.gif" usemap="#library-map" border="0" alt="Library Navigation Links"><p> <a href="copyrght.htm">Copyright &copy; 2001</a> O'Reilly &amp; Associates. All rights reserved.</font> </p> <map name="library-map"> <area shape="rect" coords="2,-1,79,99" href="../index.htm"><area shape="rect" coords="84,1,157,108" href="index.htm"><area shape="rect" coords="162,2,248,125" href="../prog/index.htm"><area shape="rect" coords="253,2,326,130" href="../advprog/index.htm"><area shape="rect" coords="332,1,407,112" href="../cookbook/index.htm"><area shape="rect" coords="414,2,523,103" href="../sysadmin/index.htm"></map> </BODY
></HTML
>
