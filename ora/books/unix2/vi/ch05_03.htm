<html><head><title>[Chapter 5] 5.3 Saving and Exiting Files </TITLE
><meta name="DC.Creator" content="Linda Lamb &amp; Arnold Robbins"><meta name="DC.Date" content="1999-11-23T17:56:25Z"><meta name="DC.Format" content="text/html" scheme="MIME"><meta name="DC.Identifier" content="O'Reilly Unix CDROM-unknown"><meta name="DC.Language" content="en-US"><meta name="DC.Publisher" content="O'Reilly &amp; Associates, Inc."><meta name="DC.Source" content="unknown" scheme="ISBN"><meta name="DC.Subject.Keyword" content="Unix, vi, text, editor, tool"><meta name="DC.Title" content="Learning the vi Editor"><meta name="DC.Type" content="Text.Monograph"><meta name="generator" content="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><link rev="made" href="mailto:online-books@oreilly.com" title="Online Books Comments"><link rel="up" href="ch05_01.htm" webstripperlinkwas="ch05_01.htm" title="5. Introducing the ex Editor"><link rel="prev" href="ch05_02.htm" webstripperlinkwas="ch05_02.htm" title="5.2 Editing with ex "><link rel="next" href="ch05_04.htm" webstripperlinkwas="ch05_04.htm" title="5.4 Copying a File into Another File "></HEAD
><body bgcolor="#FFFFFF" text="#000000"><div class="htmlnav"><h1><img src="gifs/smbanner.gif" webstripperlinkwas="gifs/smbanner.gif" alt="Learning the vi Editor" usemap="#srchmap" border="0"></H1
><map name="srchmap"><area shape="RECT" coords="0,0,466,65" href="index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/vi/index.htm" alt="Learning the vi Editor"><area shape="RECT" coords="467,0,514,18" href="jobjects/fsearch.htm" webstripperlinkwas="jobjects/fsearch.htm" alt="Search this book"></MAP
><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="SECT1" href="ch05_02.htm" webstripperlinkwas="ch05_02.htm" title="5.2 Editing with ex "><img src="../gifs/txtpreva.gif" webstripperlinkwas="../gifs/txtpreva.gif" alt="Previous: 5.2 Editing with ex " border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><b><font face="ARIEL,HELVETICA,HELV,SANSERIF" size="-1"><a class="chapter" rel="up" href="ch05_01.htm" webstripperlinkwas="ch05_01.htm" title="5. Introducing the ex Editor">Chapter 5<br>Introducing the ex Editor</A
></FONT
></B
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="SECT1" href="ch05_04.htm" webstripperlinkwas="ch05_04.htm" title="5.4 Copying a File into Another File "><img src="../gifs/txtnexta.gif" webstripperlinkwas="../gifs/txtnexta.gif" alt="Next: 5.4 Copying a File into Another File " border="0"></A
></TD
></TR
></TABLE
>&nbsp;<hr align="LEFT" width="515" title="footer"></DIV
><div class="SECT1"><h2 class="sect1"><a class="title" name="VI6-CH-5-SECT-3">5.3 Saving and Exiting Files </A
></H2
><p class="para"><a class="indexterm" name="CH05.SAVEQUIT1"></A
><a class="indexterm" name="CH05.SAVEQUIT2"></A
><a class="indexterm" name="CH05.SAVEQUIT3"></A
><a class="indexterm" name="CH05.SAVEQUIT4"></A
>You have learned the <kbd class="command">vi</KBD
> command <code class="literal">ZZ</CODE
> to quit and write
(save) your file.
But you will frequently want to exit a file using <kbd class="command">ex</KBD
> commands, because
these commands give you greater control. We've already
mentioned some of these commands in passing. Now let's take a
more formal look.</P
><dl class="variablelist"><dt class="term"><code class="literal">:w</CODE
></DT
><dd class="listitem"><p class="para">Writes (saves) the buffer to the file but does not exit.
You can (and should) use <code class="literal">:w</CODE
> throughout your editing
session to protect your edits against system failure or a major editing error.<a class="indexterm" name="AUTOID-5861"></A
></P
></DD
><dt class="term"><code class="literal">:q</CODE
></DT
><dd class="listitem"><p class="para">Quits the editor (and returns to the UNIX prompt).<a class="indexterm" name="AUTOID-5868"></A
></P
></DD
><dt class="term"><code class="literal">:wq</CODE
></DT
><dd class="listitem"><p class="para">Both writes the file and quits the editor.
The write happens unconditionally, even if the file was not changed.</P
></DD
><dt class="term"><code class="literal">:x</CODE
></DT
><dd class="listitem"><p class="para"><a class="indexterm" name="AUTOID-5880"></A
>Both writes the file and quits (e<b class="emphasis.bold">x</B
>its)
the editor. The file is written only if it has been modified.[<a class="footnote" href="#AUTOID-5883">3</A
>]</P
><blockquote class="footnote"><div class="footnote"><p class="para"><a class="footnote" name="AUTOID-5883">[3]</A
> The difference between <code class="literal">:wq</CODE
> and <code class="literal">:x</CODE
>
is important when editing source code and using <kbd class="command">make</KBD
>,
which performs actions based upon file modification times.</P
></DIV
></BLOCKQUOTE
></DD
></DL
><p class="para"><kbd class="command">vi</KBD
> protects existing files and your edits in the buffer.
For example, if you want to write your buffer to an existing file,
<kbd class="command">vi</KBD
> gives you a warning.
Likewise, if you have invoked <kbd class="command">vi</KBD
> on a file,
made edits,
and want to quit <em class="emphasis">without</EM
> saving the edits, <kbd class="command">vi</KBD
> gives
you an error message such as:<a class="indexterm" name="AUTOID-5894"></A
></P
><blockquote class="screen"><pre class="screen">No write since last change.</PRE
></BLOCKQUOTE
><p class="para">These warnings can prevent costly mistakes, but sometimes you want to
proceed with the command anyway.
An exclamation point (<code class="literal">!</CODE
>) after your command overrides the warning:<a class="indexterm" name="AUTOID-5899"></A
><a class="indexterm" name="AUTOID-5902"></A
><a class="indexterm" name="AUTOID-5905"></A
><a class="indexterm" name="AUTOID-5908"></A
></P
><p class="para"><blockquote class="screen"><pre class="screen">:w!
:q!</PRE
></BLOCKQUOTE
></P
><p class="para"><code class="literal">:w!</CODE
> can also be used to save edits in a file that was opened
in read-only mode with <code class="literal">vi</CODE
> <code class="literal">-R</CODE
> or <code class="literal">view</CODE
>
(assuming you have write permission for the file).</P
><p class="para"><code class="literal">:q!</CODE
> is an essential editing command that allows you to quit
without affecting the original file, regardless of any changes you
made in this session.
The contents of the buffer are discarded.</P
><div class="sect2"><h3 class="sect2"><a class="title" name="VI6-CH-5-SECT-3.1">5.3.1 Renaming the Buffer </A
></H3
><p class="para"><a class="indexterm" name="AUTOID-5923"></A
><a class="indexterm" name="AUTOID-5925"></A
><a class="indexterm" name="AUTOID-5928"></A
><a class="indexterm" name="AUTOID-5931"></A
>You can also use <code class="literal">:w</CODE
> to save the entire buffer (the copy of
the file you are editing) under a new filename.</P
><p class="para">Suppose you have a file <i class="filename">practice</I
>, which contains
600 lines. You open the file and make extensive edits.
You want to quit but save <em class="emphasis">both</EM
> the old version of
<i class="filename">practice</I
> and your new edits for comparison.
To save the edited
buffer in a file called <i class="filename">practice.new</I
>, give the command:</P
><p class="para"><blockquote class="screen"><pre class="screen">:w practice.new</PRE
></BLOCKQUOTE
></P
><p class="para">Your old version, in the file <i class="filename">practice</I
>, remains unchanged
(provided that you didn't previously use <code class="literal">:w</CODE
>).
You can now quit editing the new version by typing <code class="literal">:q</CODE
>.</P
></DIV
><div class="sect2"><h3 class="sect2"><a class="title" name="VI6-CH-5-SECT-3.2">5.3.2 Saving Part of a File </A
></H3
><p class="para"><a class="indexterm" name="AUTOID-5949"></A
><a class="indexterm" name="AUTOID-5951"></A
><a class="indexterm" name="AUTOID-5954"></A
>While editing, you will sometimes want to save
just part of your file as a separate, new file.
For example, you might
have entered formatting codes and text that you want to use as a
header for several files.</P
><p class="para"><a class="indexterm" name="AUTOID-5958"></A
>You can combine <kbd class="command">ex</KBD
> line addressing with the write command,
<code class="literal">w</CODE
>, to save part of a file.
For example, if you are in the file
<i class="filename">practice</I
> and want to save part of
<em class="emphasis">practice</EM
> as the file
<i class="filename">newfile</I
>, you could enter:</P
><dl class="variablelist"><dt class="term"><code class="literal">:230,$w&nbsp;</CODE
><code class="replaceable"><i>newfile</I
></CODE
></DT
><dd class="listitem"><p class="para">Saves from line 230 to end of file in <i class="filename">newfile</I
>.</P
></DD
><dt class="term"><code class="literal">:.,600w&nbsp;</CODE
><code class="replaceable"><i>newfile</I
></CODE
></DT
><dd class="listitem"><p class="para">Saves from the current line to line 600 in <i class="filename">newfile</I
>.</P
></DD
></DL
></DIV
><div class="sect2"><h3 class="sect2"><a class="title" name="VI6-CH-5-SECT-3.3">5.3.3 Appending to a Saved File </A
></H3
><p class="para"><a class="indexterm" name="AUTOID-5984"></A
><a class="indexterm" name="AUTOID-5987"></A
><a class="indexterm" name="AUTOID-5990"></A
><a class="indexterm" name="AUTOID-5993"></A
>You can use the UNIX redirect and append operator (<code class="literal">&gt;&gt;</CODE
>) with
<code class="literal">w</CODE
> to append all or part
of the contents of the buffer to an existing file.
For example, if you entered:</P
><p class="para"><blockquote class="screen"><pre class="screen"><code class="literal">:1,10w</CODE
> <code class="replaceable"><i>newfile</I
></CODE
></PRE
></BLOCKQUOTE
></P
><p class="para">then:</P
><p class="para"><blockquote class="screen"><pre class="screen"><code class="literal">:340,$w &gt;&gt;</CODE
><code class="replaceable"><i>newfile</I
></CODE
></PRE
></BLOCKQUOTE
></P
><p class="para"><em class="emphasis">newfile</EM
> would contain lines 1-10 and from line 340 to the end
of the buffer.</P
></DIV
><a class="indexterm" name="AUTOID-6009"></A
><a class="indexterm" name="AUTOID-6010"></A
><a class="indexterm" name="AUTOID-6011"></A
><a class="indexterm" name="AUTOID-6012"></A
></DIV
><div class="htmlnav"><p></P
><hr align="LEFT" width="515" title="footer"><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="SECT1" href="ch05_02.htm" webstripperlinkwas="ch05_02.htm" title="5.2 Editing with ex "><img src="../gifs/txtpreva.gif" webstripperlinkwas="../gifs/txtpreva.gif" alt="Previous: 5.2 Editing with ex " border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><a class="book" href="index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/vi/index.htm" title="Learning the vi Editor"><img src="../gifs/txthome.gif" webstripperlinkwas="../gifs/txthome.gif" alt="Learning the vi Editor" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="SECT1" href="ch05_04.htm" webstripperlinkwas="ch05_04.htm" title="5.4 Copying a File into Another File "><img src="../gifs/txtnexta.gif" webstripperlinkwas="../gifs/txtnexta.gif" alt="Next: 5.4 Copying a File into Another File " border="0"></A
></TD
></TR
><tr><td align="LEFT" valign="TOP" width="172">5.2 Editing with ex </TD
><td align="CENTER" valign="TOP" width="171"><a class="index" href="index/idx_0.htm" webstripperlinkwas="index/idx_0.htm" title="Book Index"><img src="../gifs/index.gif" webstripperlinkwas="../gifs/index.gif" alt="Book Index" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172">5.4 Copying a File into Another File </TD
></TR
></TABLE
><hr align="LEFT" width="515" title="footer"><img src="../gifs/smnavbar.gif" webstripperlinkwas="../gifs/smnavbar.gif" usemap="#map" border="0" alt="The UNIX CD Bookshelf Navigation"><map name="map"><area shape="RECT" coords="0,0,73,21" href="../index.html" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/index.html" alt="The UNIX CD Bookshelf"><area shape="RECT" coords="74,0,163,21" href="../upt/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/upt/index.htm" alt="UNIX Power Tools"><area shape="RECT" coords="164,0,257,21" href="../unixnut/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/unixnut/index.htm" alt="UNIX in a Nutshell"><area shape="RECT" coords="258,0,321,21" href="index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/vi/index.htm" alt="Learning the vi Editor"><area shape="RECT" coords="322,0,378,21" href="../sedawk/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/sedawk/index.htm" alt="sed &amp; awk"><area shape="RECT" coords="379,0,438,21" href="../ksh/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/ksh/index.htm" alt="Learning the Korn Shell"><area shape="RECT" coords="439,0,514,21" href="../lrnunix/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/lrnunix/index.htm" alt="Learning the UNIX Operating System"></MAP
></DIV
></BODY
></HTML
>

