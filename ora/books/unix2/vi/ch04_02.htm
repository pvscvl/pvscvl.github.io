<html><head><title>[Chapter 4] 4.2 Options When Starting vi  </TITLE
><meta name="DC.Creator" content="Linda Lamb &amp; Arnold Robbins"><meta name="DC.Date" content="1999-11-23T17:56:12Z"><meta name="DC.Format" content="text/html" scheme="MIME"><meta name="DC.Identifier" content="O'Reilly Unix CDROM-unknown"><meta name="DC.Language" content="en-US"><meta name="DC.Publisher" content="O'Reilly &amp; Associates, Inc."><meta name="DC.Source" content="unknown" scheme="ISBN"><meta name="DC.Subject.Keyword" content="Unix, vi, text, editor, tool"><meta name="DC.Title" content="Learning the vi Editor"><meta name="DC.Type" content="Text.Monograph"><meta name="generator" content="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><link rev="made" href="mailto:online-books@oreilly.com" title="Online Books Comments"><link rel="up" href="ch04_01.htm" webstripperlinkwas="ch04_01.htm" title="4. Beyond the Basics"><link rel="prev" href="ch04_01.htm" webstripperlinkwas="ch04_01.htm" title="4.1 More Command Combinations "><link rel="next" href="ch04_03.htm" webstripperlinkwas="ch04_03.htm" title="4.3 Making Use of Buffers"></HEAD
><body bgcolor="#FFFFFF" text="#000000"><div class="htmlnav"><h1><img src="gifs/smbanner.gif" webstripperlinkwas="gifs/smbanner.gif" alt="Learning the vi Editor" usemap="#srchmap" border="0"></H1
><map name="srchmap"><area shape="RECT" coords="0,0,466,65" href="index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/vi/index.htm" alt="Learning the vi Editor"><area shape="RECT" coords="467,0,514,18" href="jobjects/fsearch.htm" webstripperlinkwas="jobjects/fsearch.htm" alt="Search this book"></MAP
><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="SECT1" href="ch04_01.htm" webstripperlinkwas="ch04_01.htm" title="4.1 More Command Combinations "><img src="../gifs/txtpreva.gif" webstripperlinkwas="../gifs/txtpreva.gif" alt="Previous: 4.1 More Command Combinations " border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><b><font face="ARIEL,HELVETICA,HELV,SANSERIF" size="-1"><a class="chapter" rel="up" href="ch04_01.htm" webstripperlinkwas="ch04_01.htm" title="4. Beyond the Basics">Chapter 4<br>Beyond the Basics</A
></FONT
></B
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="SECT1" href="ch04_03.htm" webstripperlinkwas="ch04_03.htm" title="4.3 Making Use of Buffers"><img src="../gifs/txtnexta.gif" webstripperlinkwas="../gifs/txtnexta.gif" alt="Next: 4.3 Making Use of Buffers" border="0"></A
></TD
></TR
></TABLE
>&nbsp;<hr align="LEFT" width="515" title="footer"></DIV
><div class="SECT1"><h2 class="sect1"><a class="title" name="VI6-CH-4-SECT-2">4.2 Options When Starting vi  </A
></H2
><p class="para"><a class="indexterm" name="CH04.OPTIONS1"></A
><a class="indexterm" name="CH04.OPTIONS2"></A
><a class="indexterm" name="CH04.OPTIONS3"></A
><a class="indexterm" name="CH04.OPTIONS4"></A
><a class="indexterm" name="AUTOID-4315"></A
><a class="indexterm" name="AUTOID-4319"></A
>In this handbook, you have invoked the <kbd class="command">vi</KBD
> editor with the
command:</P
><p class="para"><blockquote class="screen"><pre class="screen">$ <code class="userinput"><b>vi</B
></CODE
> <code class="replaceable"><i>file</I
></CODE
></PRE
></BLOCKQUOTE
></P
><p class="para">There are other options to the <code class="literal">vi</CODE
> command that can be
helpful.
You can open a file directly to a specific line number or pattern.
You can also open a file in read-only mode.
Another option recovers all changes to a file that you were
editing when the system crashed.</P
><div class="sect2"><h3 class="sect2"><a class="title" name="VI6-CH-4-SECT-2.1">4.2.1 Advancing to a Specific Place </A
></H3
><p class="para"><a class="indexterm" name="AUTOID-4332"></A
><a class="indexterm" name="AUTOID-4335"></A
><a class="indexterm" name="AUTOID-4338"></A
><a class="indexterm" name="AUTOID-4341"></A
>When you begin editing an existing file, you can call the file in
and then move to the first occurrence of a <em class="emphasis">pattern</EM
> or to a
specific line number.
You can also specify
your first movement by search or by line
number right on the command line:[<a class="footnote" href="#AUTOID-4346">1</A
>]<a class="indexterm" name="AUTOID-4355"></A
><a class="indexterm" name="AUTOID-4358"></A
><a class="indexterm" name="AUTOID-4361"></A
></P
><blockquote class="footnote"><div class="footnote"><p class="para"><a class="footnote" name="AUTOID-4346">[1]</A
> According to the POSIX standard, <kbd class="command">vi</KBD
> should
use <i class="option">-c</I
> <code class="replaceable"><i>command</I
></CODE
><a class="indexterm" name="AUTOID-4351"></A
>
instead of <code class="literal">+</CODE
><code class="replaceable"><i>command</I
></CODE
>
as shown here.
Typically, for backwards compatibility, both versions are accepted.</P
></DIV
></BLOCKQUOTE
><dl class="variablelist"><dt class="term"><code class="literal">$</CODE
>&nbsp;<code class="userinput"><b>vi&nbsp;+</B
></CODE
><code class="replaceable"><i>n&nbsp;file</I
></CODE
></DT
><dd class="listitem"><p class="para">Opens <em class="emphasis">file</EM
> at line number <em class="emphasis">n</EM
>.<a class="indexterm" name="AUTOID-4374"></A
></P
></DD
><dt class="term"><code class="literal">$</CODE
>&nbsp;<code class="userinput"><b>vi&nbsp;+&nbsp;</B
></CODE
><code class="replaceable"><i>file</I
></CODE
></DT
><dd class="listitem"><p class="para">Opens <em class="emphasis">file</EM
> at last line.<a class="indexterm" name="AUTOID-4385"></A
></P
></DD
><dt class="term"><code class="literal">$</CODE
>&nbsp;<code class="userinput"><b>vi&nbsp;+/</B
></CODE
><code class="replaceable"><i>pattern&nbsp;file</I
></CODE
></DT
><dd class="listitem"><p class="para">Opens <em class="emphasis">file</EM
> at the first occurrence of <em class="emphasis">pattern</EM
>.<a class="indexterm" name="AUTOID-4397"></A
><a class="indexterm" name="AUTOID-4401"></A
><a class="indexterm" name="AUTOID-4405"></A
><a class="indexterm" name="AUTOID-4408"></A
></P
></DD
></DL
><p class="para">In the file <i class="filename">practice</I
>, to open the file and advance directly to the line
containing the word <em class="emphasis">Screen</EM
>, enter:
</P
><table class="informaltable" border="1" cellpadding="3"><thead class="thead"><tr class="row" valign="TOP"><th class="entry" align="LEFT" rowspan="1" colspan="1">Keystrokes</TH
><th class="entry" align="LEFT" rowspan="1" colspan="1">Results</TH
></TR
></THEAD
><tbody class="tbody"><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1"><code class="literal">vi&nbsp;+/Screen&nbsp;practice</CODE
></TD
><td class="entry" rowspan="1" colspan="1"><img class="graphic" src="figs/vi.0401.gif" webstripperlinkwas="figs/vi.0401.gif" alt="Graphic"><p class="para">Give the <code class="literal">vi</CODE
> command with the option
<code class="literal">+/</CODE
><code class="replaceable"><i>pattern</I
></CODE
>
to go directly to the line containing <em class="emphasis">Screen</EM
>.</P
></TD
></TR
></TBODY
></TABLE
><p class="para">
As you see in the example above, your search pattern will not
necessarily be positioned at the top of the screen.
If you include spaces in the <em class="emphasis">pattern</EM
>, you must enclose the whole
pattern within single or double quotes:[<a class="footnote" href="#AUTOID-4434">2</A
>]</P
><blockquote class="footnote"><div class="footnote"><p class="para"><a class="footnote" name="AUTOID-4434">[2]</A
> It is the shell that imposes the quoting requirement, not <kbd class="command">vi</KBD
>.</P
></DIV
></BLOCKQUOTE
><p class="para"><blockquote class="screen"><pre class="screen"><code class="literal">+/&quot;you make&quot;</CODE
></PRE
></BLOCKQUOTE
></P
><p class="para">or escape the space with a backslash:</P
><p class="para"><blockquote class="screen"><pre class="screen"><code class="literal">+/you\ make</CODE
></PRE
></BLOCKQUOTE
></P
><p class="para">In addition, if you want to use the general pattern-matching syntax
described in <a class="xref" href="ch06_01.htm" webstripperlinkwas="ch06_01.htm">Chapter 6, <cite class="CHAPTER">Global Replacement</CITE
></A
>,
you may need to protect one or more special characters
from interpretation by the shell with either single quotes or backslashes.</P
><p class="para">Using <code class="literal">+/</CODE
><em class="emphasis">pattern</EM
> is helpful
if you have to leave an editing session in the
middle. You can mark your place by inserting a pattern
such as <code class="literal">ZZZ</CODE
> or <code class="literal">HERE</CODE
>.  Then when you return to the
file, all you have to remember is <code class="literal">/ZZZ</CODE
> or <code class="literal">/HERE</CODE
>.</P
><blockquote class="note"><p class="para"><strong>NOTE:</STRONG
> <a class="indexterm" name="AUTOID-4455"></A
>Normally, when you're editing in <kbd class="command">vi</KBD
>, the <code class="literal">wrapscan</CODE
> option
is enabled. If you've customized your environment so that
<code class="literal">wrapscan</CODE
> is always disabled (see <a class="xref" href="ch03_03.htm" webstripperlinkwas="ch03_03.htm#VI6-CH-3-SECT-3.1">Section 3.3.1, "Repeating Searches "</A
> in <a class="xref" href="ch03_01.htm" webstripperlinkwas="ch03_01.htm">Chapter 3</A
>),
you might not be able to
use <code class="literal">+/</CODE
><em class="emphasis">pattern</EM
>.  If you try to open a file this way,
<kbd class="command">vi</KBD
> opens the file at the last line and displays the message
&quot;Address search hit BOTTOM without matching pattern.&quot;</P
></BLOCKQUOTE
></DIV
><div class="sect2"><h3 class="sect2"><a class="title" name="VI6-CH-4-SECT-2.2">4.2.2 Read-only Mode </A
></H3
><p class="para"><a class="indexterm" name="AUTOID-4467"></A
><a class="indexterm" name="AUTOID-4470"></A
><a class="indexterm" name="AUTOID-4472"></A
><a class="indexterm" name="AUTOID-4475"></A
>There will be times when you want to look at a file but want to
protect that file from inadvertent keystrokes and changes.
(You might want to call in a lengthy file to practice
<kbd class="command">vi</KBD
> movements,
or you might want to scroll through a command file or program).
You can enter a file in read-only mode and use all the <kbd class="command">vi</KBD
>
movement commands, but you won't be able to change the file.</P
><p class="para">To look at a file in read-only mode, enter either:<a class="indexterm" name="AUTOID-4482"></A
></P
><p class="para"><blockquote class="screen"><pre class="screen">$ <code class="userinput"><b>vi&nbsp;-R</B
></CODE
> <code class="replaceable"><i>file</I
></CODE
></PRE
></BLOCKQUOTE
></P
><p class="para">or:<a class="indexterm" name="AUTOID-4489"></A
></P
><p class="para"><blockquote class="screen"><pre class="screen">$ <code class="userinput"><b>view</B
></CODE
> <code class="replaceable"><i>file</I
></CODE
></PRE
></BLOCKQUOTE
></P
><p class="para">(The <code class="literal">view</CODE
> command, like the <code class="literal">vi</CODE
> command,
can use any of the command-line options for advancing to a
specific place in the file.)[<a class="footnote" href="#AUTOID-4498">3</A
>]<a class="indexterm" name="AUTOID-4502"></A
><a class="indexterm" name="AUTOID-4506"></A
>
If you do decide to make some edits to the file, you can override read-only
mode by adding an exclamation point to the <code class="literal">write</CODE
> command:<a class="indexterm" name="AUTOID-4510"></A
></P
><blockquote class="footnote"><div class="footnote"><p class="para"><a class="footnote" name="AUTOID-4498">[3]</A
> Typically <code class="literal">view</CODE
> is just a link to <code class="literal">vi</CODE
>.</P
></DIV
></BLOCKQUOTE
><p class="para"><blockquote class="screen"><pre class="screen"><code class="literal">:w!</CODE
></PRE
></BLOCKQUOTE
></P
><p class="para">or:</P
><p class="para"><blockquote class="screen"><pre class="screen"><code class="literal">:wq!</CODE
></PRE
></BLOCKQUOTE
></P
><p class="para">If you have a problem writing out the file, see the problem checklists
summarized in
<a class="xref" href="appd_01.htm" webstripperlinkwas="appd_01.htm">Appendix D, <cite class="APPENDIX">Problem Checklists</CITE
></A
>.</P
></DIV
><div class="sect2"><h3 class="sect2"><a class="title" name="VI6-CH-4-SECT-2.3">4.2.3 Recovering a Buffer </A
></H3
><p class="para"><a class="indexterm" name="AUTOID-4524"></A
><a class="indexterm" name="AUTOID-4526"></A
><a class="indexterm" name="AUTOID-4529"></A
><a class="indexterm" name="AUTOID-4531"></A
>Occasionally there is a system failure while you are editing a file.
Ordinarily, any edits made after your last write (save) are lost.<a class="indexterm" name="AUTOID-4534"></A
>
However, there is an option, <code class="literal">-r</CODE
>, which lets you
recover the edited buffer at the time of a system crash.</P
><p class="para">When you first log on after the system
is running again, you will receive a mail message stating
that your buffer has been saved. In addition, if you type the command:</P
><p class="para"><blockquote class="screen"><pre class="screen">$ <code class="userinput"><b>ex -r</B
></CODE
></PRE
></BLOCKQUOTE
></P
><p class="para">or:</P
><p class="para"><blockquote class="screen"><pre class="screen">$ <code class="userinput"><b>vi -r</B
></CODE
></PRE
></BLOCKQUOTE
></P
><p class="para">you will get a list of any files that the system has saved.</P
><p class="para">Use the <code class="literal">-r</CODE
> option
with a file name to recover the edited buffer.
For example, to recover the edited buffer of the file
<i class="filename">practice</I
> after a system crash, enter:</P
><p class="para"><blockquote class="screen"><pre class="screen">$ <code class="userinput"><b>vi -r practice</B
></CODE
></PRE
></BLOCKQUOTE
></P
><p class="para">It is wise to recover the file immediately, lest you inadvertently
make edits to the
file, and then have to resolve a version skew between the preserved buffer
and the newly edited file.</P
><p class="para"><a class="indexterm" name="AUTOID-4554"></A
><a class="indexterm" name="AUTOID-4557"></A
><a class="indexterm" name="AUTOID-4560"></A
>You can force the system to preserve your buffer even when there is
not a crash by using the command <code class="literal">:pre</CODE
>.
You may find it useful
if you have made edits to a file, then discover that you can't save
your edits because you don't have write permission. (You could also
just write out a copy of the file under another name or into a directory
where you do have write permission. See <a class="xref" href="ch01_02.htm" webstripperlinkwas="ch01_02.htm">Section 1.2.1, "Problems Saving Files "</A
> in <a class="xref" href="ch01_01.htm" webstripperlinkwas="ch01_01.htm">Chapter 1</A
>.)</P
><blockquote class="note"><p class="para"><strong>NOTE:</STRONG
> Recovery for the various clones may work differently, and can change
from version to version. It is best to check your local documentation.<a class="indexterm" name="AUTOID-4566"></A
>
<kbd class="command">vile</KBD
> does not support
any kind of recovery. The <kbd class="command">vile</KBD
> documentation<a class="indexterm" name="AUTOID-4570"></A
><a class="indexterm" name="AUTOID-4573"></A
><a class="indexterm" name="AUTOID-4576"></A
><a class="indexterm" name="AUTOID-4578"></A
>
recommends the use of the <code class="literal">autowrite</CODE
>
and <code class="literal">autosave</CODE
> options.
How to do this is described in <a class="xref" href="ch07_01.htm" webstripperlinkwas="ch07_01.htm">Section 7.1, "Customizing vi "</A
> in <a class="xref" href="ch07_01.htm" webstripperlinkwas="ch07_01.htm">Chapter 7</A
>.</P
></BLOCKQUOTE
></DIV
><a class="indexterm" name="AUTOID-4583"></A
><a class="indexterm" name="AUTOID-4584"></A
><a class="indexterm" name="AUTOID-4585"></A
><a class="indexterm" name="AUTOID-4586"></A
></DIV
><div class="htmlnav"><p></P
><hr align="LEFT" width="515" title="footer"><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="SECT1" href="ch04_01.htm" webstripperlinkwas="ch04_01.htm" title="4.1 More Command Combinations "><img src="../gifs/txtpreva.gif" webstripperlinkwas="../gifs/txtpreva.gif" alt="Previous: 4.1 More Command Combinations " border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><a class="book" href="index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/vi/index.htm" title="Learning the vi Editor"><img src="../gifs/txthome.gif" webstripperlinkwas="../gifs/txthome.gif" alt="Learning the vi Editor" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="SECT1" href="ch04_03.htm" webstripperlinkwas="ch04_03.htm" title="4.3 Making Use of Buffers"><img src="../gifs/txtnexta.gif" webstripperlinkwas="../gifs/txtnexta.gif" alt="Next: 4.3 Making Use of Buffers" border="0"></A
></TD
></TR
><tr><td align="LEFT" valign="TOP" width="172">4.1 More Command Combinations </TD
><td align="CENTER" valign="TOP" width="171"><a class="index" href="index/idx_0.htm" webstripperlinkwas="index/idx_0.htm" title="Book Index"><img src="../gifs/index.gif" webstripperlinkwas="../gifs/index.gif" alt="Book Index" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172">4.3 Making Use of Buffers</TD
></TR
></TABLE
><hr align="LEFT" width="515" title="footer"><img src="../gifs/smnavbar.gif" webstripperlinkwas="../gifs/smnavbar.gif" usemap="#map" border="0" alt="The UNIX CD Bookshelf Navigation"><map name="map"><area shape="RECT" coords="0,0,73,21" href="../index.html" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/index.html" alt="The UNIX CD Bookshelf"><area shape="RECT" coords="74,0,163,21" href="../upt/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/upt/index.htm" alt="UNIX Power Tools"><area shape="RECT" coords="164,0,257,21" href="../unixnut/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/unixnut/index.htm" alt="UNIX in a Nutshell"><area shape="RECT" coords="258,0,321,21" href="index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/vi/index.htm" alt="Learning the vi Editor"><area shape="RECT" coords="322,0,378,21" href="../sedawk/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/sedawk/index.htm" alt="sed &amp; awk"><area shape="RECT" coords="379,0,438,21" href="../ksh/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/ksh/index.htm" alt="Learning the Korn Shell"><area shape="RECT" coords="439,0,514,21" href="../lrnunix/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/lrnunix/index.htm" alt="Learning the UNIX Operating System"></MAP
></DIV
></BODY
></HTML
>

