<html><head><title>[Chapter 5] 5.2 Editing with ex </TITLE
><meta name="DC.Creator" content="Linda Lamb &amp; Arnold Robbins"><meta name="DC.Date" content="1999-11-23T17:56:21Z"><meta name="DC.Format" content="text/html" scheme="MIME"><meta name="DC.Identifier" content="O'Reilly Unix CDROM-unknown"><meta name="DC.Language" content="en-US"><meta name="DC.Publisher" content="O'Reilly &amp; Associates, Inc."><meta name="DC.Source" content="unknown" scheme="ISBN"><meta name="DC.Subject.Keyword" content="Unix, vi, text, editor, tool"><meta name="DC.Title" content="Learning the vi Editor"><meta name="DC.Type" content="Text.Monograph"><meta name="generator" content="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><link rev="made" href="mailto:online-books@oreilly.com" title="Online Books Comments"><link rel="up" href="ch05_01.htm" webstripperlinkwas="ch05_01.htm" title="5. Introducing the ex Editor"><link rel="prev" href="ch05_01.htm" webstripperlinkwas="ch05_01.htm" title="5.1 ex Commands "><link rel="next" href="ch05_03.htm" webstripperlinkwas="ch05_03.htm" title="5.3 Saving and Exiting Files "></HEAD
><body bgcolor="#FFFFFF" text="#000000"><div class="htmlnav"><h1><img src="gifs/smbanner.gif" webstripperlinkwas="gifs/smbanner.gif" alt="Learning the vi Editor" usemap="#srchmap" border="0"></H1
><map name="srchmap"><area shape="RECT" coords="0,0,466,65" href="index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/vi/index.htm" alt="Learning the vi Editor"><area shape="RECT" coords="467,0,514,18" href="jobjects/fsearch.htm" webstripperlinkwas="jobjects/fsearch.htm" alt="Search this book"></MAP
><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="SECT1" href="ch05_01.htm" webstripperlinkwas="ch05_01.htm" title="5.1 ex Commands "><img src="../gifs/txtpreva.gif" webstripperlinkwas="../gifs/txtpreva.gif" alt="Previous: 5.1 ex Commands " border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><b><font face="ARIEL,HELVETICA,HELV,SANSERIF" size="-1"><a class="chapter" rel="up" href="ch05_01.htm" webstripperlinkwas="ch05_01.htm" title="5. Introducing the ex Editor">Chapter 5<br>Introducing the ex Editor</A
></FONT
></B
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="SECT1" href="ch05_03.htm" webstripperlinkwas="ch05_03.htm" title="5.3 Saving and Exiting Files "><img src="../gifs/txtnexta.gif" webstripperlinkwas="../gifs/txtnexta.gif" alt="Next: 5.3 Saving and Exiting Files " border="0"></A
></TD
></TR
></TABLE
>&nbsp;<hr align="LEFT" width="515" title="footer"></DIV
><div class="SECT1"><h2 class="sect1"><a class="title" name="VI6-CH-5-SECT-2">5.2 Editing with ex </A
></H2
><p class="para"><a class="indexterm" name="CH05.EXEDITING1"></A
><a class="indexterm" name="CH05.EXEDITING2"></A
>Many <kbd class="command">ex</KBD
> commands that perform normal editing operations have an
equivalent in <kbd class="command">vi</KBD
> that does the job more simply.
Obviously, you will use <code class="literal">dw</CODE
> or <code class="literal">dd</CODE
> to delete a single word
or line rather than using the <code class="literal">delete</CODE
> command in <kbd class="command">ex</KBD
>.
However, when you want to make changes that affect numerous lines, you
will find the <kbd class="command">ex</KBD
> commands more useful.
They allow you to modify large blocks of text with a single command.</P
><p class="para">These <kbd class="command">ex</KBD
> commands are listed below, along with abbreviations
for those commands.
Remember that in <kbd class="command">vi</KBD
> each <kbd class="command">ex</KBD
> command must be preceded
with a colon.
You can use the full command
name or the abbreviation, whichever is easier to remember.<a class="indexterm" name="AUTOID-5268"></A
><a class="indexterm" name="AUTOID-5270"></A
><a class="indexterm" name="AUTOID-5272"></A
><a class="indexterm" name="AUTOID-5274"></A
><a class="indexterm" name="AUTOID-5276"></A
><a class="indexterm" name="AUTOID-5278"></A
><a class="indexterm" name="AUTOID-5280"></A
><a class="indexterm" name="AUTOID-5282"></A
><a class="indexterm" name="AUTOID-5285"></A
><a class="indexterm" name="AUTOID-5288"></A
><a class="indexterm" name="AUTOID-5291"></A
>
 
</P
><table class="informaltable" border="1" cellpadding="3"><tbody class="tbody"><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1"><code class="literal">delete</CODE
></TD
><td class="entry" rowspan="1" colspan="1"><code class="literal">d</CODE
></TD
><td class="entry" rowspan="1" colspan="1">Delete lines.</TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1"><code class="literal">move</CODE
></TD
><td class="entry" rowspan="1" colspan="1"><code class="literal">m</CODE
></TD
><td class="entry" rowspan="1" colspan="1">Move lines.</TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1"><code class="literal">copy</CODE
></TD
><td class="entry" rowspan="1" colspan="1"><code class="literal">co</CODE
></TD
><td class="entry" rowspan="1" colspan="1">Copy lines.</TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1"></TD
><td class="entry" rowspan="1" colspan="1"><code class="literal">t</CODE
></TD
><td class="entry" rowspan="1" colspan="1">Copy lines (a synonym for <code class="literal">co</CODE
>).</TD
></TR
></TBODY
></TABLE
><p class="para">
You can separate the different elements of an <kbd class="command">ex</KBD
> command
with spaces, if you find the command easier to read that way.
For example, you can separate line addresses, patterns, and commands
in this way.
You cannot, however, use a space as a separator inside a pattern
or at the end of a substitute command.</P
><div class="sect2"><h3 class="sect2"><a class="title" name="VI6-CH-5-SECT-2.1">5.2.1 Line Addresses </A
></H3
><p class="para"><a class="indexterm" name="AUTOID-5325"></A
><a class="indexterm" name="AUTOID-5328"></A
>For each <kbd class="command">ex</KBD
> editing command, you have to tell <kbd class="command">ex</KBD
>
which line number(s) to edit.
And for the <kbd class="command">ex</KBD
> <code class="literal">move</CODE
>
and <code class="literal">copy</CODE
> commands, you also need to tell <kbd class="command">ex</KBD
> where to
move or copy the text to.</P
><p class="para">You can specify line addresses in several ways:</P
><ul class="itemizedlist"><li class="listitem"><p class="para">With explicit line numbers</P
></LI
><li class="listitem"><p class="para">With symbols that help you specify line numbers relative to
your current position in the file</P
></LI
><li class="listitem"><p class="para">With search patterns as <em class="emphasis">addresses</EM
> that identify the lines to
be affected</P
></LI
></UL
><p class="para">Let's look at some examples.</P
></DIV
><div class="sect2"><h3 class="sect2"><a class="title" name="VI6-CH-5-SECT-2.2">5.2.2 Defining a Range of Lines </A
></H3
><p class="para"><a class="indexterm" name="AUTOID-5350"></A
><a class="indexterm" name="AUTOID-5352"></A
><a class="indexterm" name="AUTOID-5355"></A
><a class="indexterm" name="AUTOID-5359"></A
><a class="indexterm" name="AUTOID-5363"></A
><a class="indexterm" name="AUTOID-5366"></A
><a class="indexterm" name="AUTOID-5369"></A
>You can use line numbers to explicitly define a line or range of lines. 
Addresses that use explicit numbers are called <em class="emphasis">absolute</EM
> line
addresses.
 
For example:
</P
><table class="informaltable" border="1" cellpadding="3"><tbody class="tbody"><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1"><code class="literal">:3,18d</CODE
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Delete lines 3 through 18.</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1"><code class="literal">:160,224m23</CODE
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Move lines 160 through 224 to follow line 23.
(Like <code class="literal">delete</CODE
> and <code class="literal">put</CODE
> in <kbd class="command">vi</KBD
>.)</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1"><code class="literal">:23,29co100</CODE
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Copy lines 23 through 29 and put after line 100.
(Like <code class="literal">yank</CODE
> and <code class="literal">put</CODE
> in <kbd class="command">vi</KBD
>.)</P
></TD
></TR
></TBODY
></TABLE
><p class="para">
To make editing with line numbers easier, you can also display all line
numbers on the left of the screen.
The command:</P
><p class="para"><blockquote class="screen"><pre class="screen">:set number</PRE
></BLOCKQUOTE
></P
><p class="para">or its abbreviation:</P
><p class="para"><blockquote class="screen"><pre class="screen">:set nu</PRE
></BLOCKQUOTE
></P
><p class="para">displays line numbers.
The file <i class="filename">practice</I
> then appears:</P
><p class="para"><blockquote class="screen"><pre class="screen">  1  With a screen editor
  2  you can scroll the page,
  3  move the cursor, delete lines,
  4  insert characters and more</PRE
></BLOCKQUOTE
></P
><p class="para">The displayed line numbers are not saved when you write a file,
and they do not print if you print the file.
Line numbers are displayed either until you
quit the <kbd class="command">vi</KBD
> session or until you disable the
<code class="literal">set</CODE
> option:<a class="indexterm" name="AUTOID-5410"></A
><a class="indexterm" name="AUTOID-5413"></A
></P
><p class="para"><blockquote class="screen"><pre class="screen">:set nonumber</PRE
></BLOCKQUOTE
></P
><p class="para">or:</P
><p class="para"><blockquote class="screen"><pre class="screen">:set nonu</PRE
></BLOCKQUOTE
></P
><p class="para"><a class="indexterm" name="AUTOID-5421"></A
><a class="indexterm" name="AUTOID-5424"></A
><a class="indexterm" name="AUTOID-5427"></A
>To temporarily display the line numbers for a set of lines, you can use
the <code class="literal">#</CODE
> sign.
For example:</P
><p class="para"><blockquote class="screen"><pre class="screen">:1,10#</PRE
></BLOCKQUOTE
></P
><p class="para">would display the line numbers from line one to line ten.</P
><p class="para">As described in <a class="xref" href="ch03_01.htm" webstripperlinkwas="ch03_01.htm">Chapter 3, <cite class="CHAPTER">Moving Around in a Hurry</CITE
></A
>,
you can also
use the<a class="indexterm" name="AUTOID-5436"></A
>
<kbd class="keycap">[CTRL-G]</KBD
> command to
display the current line number. You can thus identify the line
numbers corresponding to the start and end of a block of text by
moving to the start of the block, typing
<kbd class="keycap">[CTRL-G]</KBD
>, then moving to the end of the block and typing
<kbd class="keycap">[CTRL-G]</KBD
> again.</P
><p class="para"><a class="indexterm" name="AUTOID-5443"></A
><a class="indexterm" name="AUTOID-5446"></A
>Yet another way to identify line numbers is with the <kbd class="command">ex</KBD
>
<code class="literal">=</CODE
> command:
<dl class="variablelist"><dt class="term"><code class="literal">:=</CODE
></DT
><dd class="listitem"><p class="para">Print the total number of lines.</P
></DD
><dt class="term"><code class="literal">:.=</CODE
></DT
><dd class="listitem"><p class="para">Print the line number of the current line.</P
></DD
><dt class="term"><code class="literal">:/</CODE
><code class="replaceable"><i>pattern</I
></CODE
><code class="literal">/=</CODE
></DT
><dd class="listitem"><p class="para">Print the line number of the first line that matches <em class="emphasis">pattern</EM
>.</P
></DD
></DL
></P
></DIV
><div class="sect2"><h3 class="sect2"><a class="title" name="VI6-CH-5-SECT-2.3">5.2.3 Line Addressing Symbols </A
></H3
><p class="para"><a class="indexterm" name="AUTOID-5473"></A
><a class="indexterm" name="AUTOID-5477"></A
><a class="indexterm" name="AUTOID-5481"></A
><a class="indexterm" name="AUTOID-5484"></A
><a class="indexterm" name="AUTOID-5487"></A
><a class="indexterm" name="AUTOID-5490"></A
><a class="indexterm" name="AUTOID-5493"></A
><a class="indexterm" name="AUTOID-5496"></A
><a class="indexterm" name="AUTOID-5499"></A
>You can also use symbols for line addresses.
A dot (<code class="literal">.</CODE
>) stands for the current line;
<code class="literal">$</CODE
> stands for the
last line of the file.<a class="indexterm" name="AUTOID-5504"></A
><a class="indexterm" name="AUTOID-5507"></A
>
<code class="literal">%</CODE
> stands for every line in the file;  it's the same as the
combination <code class="literal">1,$</CODE
>.
These symbols can also be combined with absolute line addresses.
For example:
<dl class="variablelist"><dt class="term"><code class="literal">:.,$d</CODE
></DT
><dd class="listitem"><p class="para">Delete from current line to end of file.</P
></DD
><dt class="term"><code class="literal">:20,.m$</CODE
></DT
><dd class="listitem"><p class="para">Move from line 20 through the current line to the end of the file.</P
></DD
><dt class="term"><code class="literal">:%d</CODE
></DT
><dd class="listitem"><p class="para">Delete all the lines in a file.</P
></DD
><dt class="term"><code class="literal">:%t$</CODE
></DT
><dd class="listitem"><p class="para">Copy all lines and place them at the end of the file (making a
consecutive duplicate).</P
></DD
></DL
></P
><p class="para"><a class="indexterm" name="AUTOID-5534"></A
><a class="indexterm" name="AUTOID-5537"></A
><a class="indexterm" name="AUTOID-5540"></A
><a class="indexterm" name="AUTOID-5543"></A
><a class="indexterm" name="AUTOID-5546"></A
><a class="indexterm" name="AUTOID-5549"></A
><a class="indexterm" name="AUTOID-5553"></A
><a class="indexterm" name="AUTOID-5557"></A
>In addition to an absolute line address, you can specify an address
relative to the current line.
The symbols <code class="literal">+</CODE
> and <code class="literal">-</CODE
>
work like arithmetic operators.
When placed before a number,
these symbols add or subtract the value that follows. For example:
<dl class="variablelist"><dt class="term"><code class="literal">:.,.+20d</CODE
></DT
><dd class="listitem"><p class="para">Delete from current line through the next 20 lines.</P
></DD
><dt class="term"><code class="literal">:226,$m.-2</CODE
></DT
><dd class="listitem"><p class="para">Move lines 226 through the end of the
file to two lines above the current line.</P
></DD
><dt class="term"><code class="literal">:.,+20#</CODE
></DT
><dd class="listitem"><p class="para">Display line numbers from the current line
to 20 lines further on in the file.</P
></DD
></DL
></P
><p class="para">In fact, you don't need to type the dot (.)
when you use <code class="literal">+</CODE
> or <code class="literal">-</CODE
>,
because the current line is the assumed starting position.</P
><p class="para">Without a number following them, <code class="literal">+</CODE
> and
<code class="literal">-</CODE
> are equivalent to +1 and -1, respectively.[<a class="footnote" href="#AUTOID-5583">2</A
>]
Similarly, <code class="literal">++</CODE
>
and <code class="literal">--</CODE
> each extend the range by
an additional line, and so on.
The <code class="literal">+</CODE
> and <code class="literal">-</CODE
> can also be used with
search patterns, as shown in the next section.</P
><blockquote class="footnote"><div class="footnote"><p class="para"><a class="footnote" name="AUTOID-5583">[2]</A
> In a relative address, you shouldn't separate the plus or minus
symbol from the number that follows it.
For example, <code class="literal">+10</CODE
> means &quot;10 lines following,&quot; but <code class="literal">+</CODE
> <code class="literal">10</CODE
>
means &quot;11 lines following (<code class="literal">1</CODE
> <code class="literal">+</CODE
> <code class="literal">10</CODE
>),&quot;
which is probably not what you mean (or want).</P
></DIV
></BLOCKQUOTE
><p class="para">The number <code class="literal">0</CODE
> stands for the top of the file (imaginary line 0).
<code class="literal">0</CODE
> is equivalent to <code class="literal">1-</CODE
>,
and both allow you to move or copy lines to the very start of a file,
before the first line of existing text. For example:
<dl class="variablelist"><dt class="term"><code class="literal">:-,+t0</CODE
></DT
><dd class="listitem"><p class="para">Copy three lines (the line above the cursor through the line below the
cursor) and put them at the top of the file.</P
></DD
></DL
>&#13;</P
></DIV
><div class="sect2"><h3 class="sect2"><a class="title" name="VI6-CH-5-SECT-2.4">5.2.4 Search Patterns </A
></H3
><p class="para"><a class="indexterm" name="AUTOID-5608"></A
><a class="indexterm" name="AUTOID-5611"></A
><a class="indexterm" name="AUTOID-5614"></A
><a class="indexterm" name="AUTOID-5618"></A
>Another way that <kbd class="command">ex</KBD
> can address lines is by using search
patterns.
For example:
<dl class="variablelist"><dt class="term"><code class="literal">:/</CODE
><code class="replaceable"><i>pattern</I
></CODE
><code class="literal">/d</CODE
></DT
><dd class="listitem"><p class="para">Delete the next line containing <em class="emphasis">pattern</EM
>.</P
></DD
><dt class="term"><code class="literal">:</CODE
>/<code class="replaceable"><i>pattern</I
></CODE
><code class="literal">/+d</CODE
></DT
><dd class="listitem"><p class="para">Delete the line <em class="emphasis">below</EM
> the next line containing <em class="emphasis">pattern</EM
>.
(You could also use <code class="literal">+1</CODE
> instead of <code class="literal">+</CODE
> alone.)</P
></DD
><dt class="term"><code class="literal">:</CODE
>/<code class="replaceable"><i>pattern1</I
></CODE
><code class="literal">/,/</CODE
><code class="replaceable"><i>pattern2</I
></CODE
><code class="literal">/d</CODE
></DT
><dd class="listitem"><p class="para">Delete from the first line containing <em class="emphasis">pattern1</EM
> through the
first line containing <em class="emphasis">pattern2</EM
>.</P
></DD
><dt class="term"><code class="literal">:.,/</CODE
><code class="replaceable"><i>pattern</I
></CODE
><code class="literal">/m23</CODE
></DT
><dd class="listitem"><p class="para">Take the text from the current line (<code class="literal">.</CODE
>) through the first
line containing <em class="emphasis">pattern</EM
> and put it after line 23.</P
></DD
></DL
>&#13;</P
><p class="para">Note that patterns are delimited by a slash both <em class="emphasis">before</EM
> and <em class="emphasis">after</EM
>.</P
><p class="para">If you make deletions by pattern with <kbd class="command">vi</KBD
> and <kbd class="command">ex</KBD
>, there is
a difference in the way the two editors operate.
Suppose your file <i class="filename">practice</I
> contains the lines:
<img class="graphic" src="figs/vi.0501.gif" webstripperlinkwas="figs/vi.0501.gif" alt="Graphic"></P
><p class="para"></P
><table class="informaltable" border="1" cellpadding="3"><thead class="thead"><tr class="row" valign="TOP"><th class="entry" align="LEFT" rowspan="1" colspan="1">Keystrokes</TH
><th class="entry" align="LEFT" rowspan="1" colspan="1">Results</TH
></TR
></THEAD
><tbody class="tbody"><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1"><code class="literal">d/while</CODE
></TD
><td class="entry" rowspan="1" colspan="1"><img class="graphic" src="figs/vi.0502.gif" webstripperlinkwas="figs/vi.0502.gif" alt="Graphic"><p class="para">The <kbd class="command">vi</KBD
> delete to <em class="emphasis">pattern</EM
> command deletes from the cursor up
to the word <em class="emphasis">while</EM
>, but leaves the remainder of both lines.</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1"><code class="literal">:.,/while/d</CODE
></TD
><td class="entry" rowspan="1" colspan="1"><img class="graphic" src="figs/vi.0503.gif" webstripperlinkwas="figs/vi.0503.gif" alt="Graphic"><p class="para">The <kbd class="command">ex</KBD
> command deletes the entire range of addressed lines;
in this case both the current line and the line containing the pattern.
All lines are deleted in their entirety.</P
></TD
></TR
></TBODY
></TABLE
><p class="para"></P
></DIV
><div class="sect2"><h3 class="sect2"><a class="title" name="VI6-CH-5-SECT-2.5">5.2.5 Redefining the Current Line Position </A
></H3
><p class="para"><a class="indexterm" name="AUTOID-5700"></A
><a class="indexterm" name="AUTOID-5704"></A
><a class="indexterm" name="AUTOID-5708"></A
>Sometimes, using a relative line address in a command
can give you unexpected results.
For example, suppose the cursor is on
line 1, and you want to print line 100 plus the
five lines below it. If you type:</P
><p class="para"><blockquote class="screen"><pre class="screen">:100,+5 p</PRE
></BLOCKQUOTE
></P
><p class="para"><a class="indexterm" name="AUTOID-5714"></A
><a class="indexterm" name="AUTOID-5716"></A
><a class="indexterm" name="AUTOID-5719"></A
><a class="indexterm" name="AUTOID-5723"></A
><a class="indexterm" name="AUTOID-5727"></A
>you'll get an error message saying, 
&quot;First address exceeds second.&quot;  The reason the command fails is that the second
address is calculated relative to the current cursor
position (line 1), so your command is really saying this:</P
><p class="para"><blockquote class="screen"><pre class="screen">:100,6 p</PRE
></BLOCKQUOTE
></P
><p class="para">What you need is some way to tell the command to think of
line 100 as the &quot;current line,&quot; even though the cursor is
on line 1.</P
><p class="para"><a class="indexterm" name="AUTOID-5733"></A
><a class="indexterm" name="AUTOID-5736"></A
><kbd class="command">ex</KBD
> provides such a way.
When you use a semicolon instead of a comma,
the first line address is recalculated as the current line.
For example, the command:</P
><p class="para"><blockquote class="screen"><pre class="screen">:100;+5 p</PRE
></BLOCKQUOTE
></P
><p class="para">prints the desired lines. The +5 is now calculated
relative to line 100. A semicolon is useful with
search patterns as well as absolute addresses.
For example,
to print the next line containing <em class="emphasis">pattern</EM
>, plus
the 10 lines that follow it, enter the command:</P
><p class="para"><blockquote class="screen"><pre class="screen">:/pattern/;+10 p</PRE
></BLOCKQUOTE
></P
></DIV
><div class="sect2"><h3 class="sect2"><a class="title" name="VI6-CH-5-SECT-2.6">5.2.6 Global Searches </A
></H3
><p class="para"><a class="indexterm" name="AUTOID-5749"></A
><a class="indexterm" name="AUTOID-5752"></A
><a class="indexterm" name="AUTOID-5755"></A
><a class="indexterm" name="AUTOID-5757"></A
>You already know how to use <code class="literal">/</CODE
> (slash) in <kbd class="command">vi</KBD
> to search for
patterns of characters in your files.
<kbd class="command">ex</KBD
> has a global command, <code class="literal">g</CODE
>, that lets you search for
a pattern and display all lines containing the pattern when it finds
them.
The command <code class="literal">:g!</CODE
> does the opposite of <code class="literal">:g</CODE
>.  Use
<code class="literal">:g!</CODE
> (or its synonym <code class="literal">:v</CODE
>) to search for all lines that
do <em class="emphasis">not</EM
> contain <em class="emphasis">pattern</EM
>.</P
><p class="para">You can use the global command on all lines in the file, or you can
use line addresses to limit a global search to specified lines or to a
range of lines.</P
><dl class="variablelist"><dt class="term"><code class="literal">:g/</CODE
><code class="replaceable"><i>pattern</I
></CODE
></DT
><dd class="listitem"><p class="para">Finds (moves to) the last occurrence of <em class="emphasis">pattern</EM
> in the file.</P
></DD
><dt class="term"><code class="literal">:g/</CODE
><code class="replaceable"><i>pattern</I
></CODE
><code class="literal">/p</CODE
></DT
><dd class="listitem"><p class="para">Finds and displays all lines in the file containing <em class="emphasis">pattern</EM
>.</P
></DD
><dt class="term"><code class="literal">:g!/</CODE
><code class="replaceable"><i>pattern</I
></CODE
><code class="literal">/nu</CODE
></DT
><dd class="listitem"><p class="para">Finds and displays all lines in the file that don't contain
<em class="emphasis">pattern</EM
>; also displays the line number for
each line found.</P
></DD
><dt class="term"><code class="literal">:60,124g/</CODE
><code class="replaceable"><i>pattern</I
></CODE
><code class="literal">/p</CODE
></DT
><dd class="listitem"><p class="para">Finds and displays any lines between lines 60 and 124 containing
<em class="emphasis">pattern</EM
>.</P
></DD
></DL
><p class="para">As you might expect, <code class="literal">g</CODE
> can also be used for global
replacements. We'll talk about that in <a class="xref" href="ch06_01.htm" webstripperlinkwas="ch06_01.htm">Chapter 6, <cite class="CHAPTER">Global Replacement</CITE
></A
>.</P
></DIV
><div class="sect2"><h3 class="sect2"><a class="title" name="VI6-CH-5-SECT-2.7">5.2.7 Combining ex Commands </A
></H3
><p class="para"><a class="indexterm" name="AUTOID-5808"></A
><a class="indexterm" name="AUTOID-5811"></A
><a class="indexterm" name="AUTOID-5814"></A
>You don't always need to type a colon to begin a new <kbd class="command">ex</KBD
>
command. In <kbd class="command">ex</KBD
>, the vertical bar (<code class="literal">|</CODE
>)
is a command separator, allowing you to
combine multiple commands from the same <kbd class="command">ex</KBD
> prompt (in much
the same way that a semicolon separates multiple commands at the
UNIX shell prompt). When you use the <code class="literal">|</CODE
>,
keep track of the line addresses you specify.
If one command affects the order of lines in the file,
the next command does its work using the new line positions.
For example:</P
><dl class="variablelist"><dt class="term"><code class="literal">:1,3d&nbsp;|&nbsp;s/thier/their/</CODE
></DT
><dd class="listitem"><p class="para">Delete lines 1 through 3 (leaving you now on the top line of the
file); then make a substitution on the current line (which was
line 4 before you invoked the <kbd class="command">ex</KBD
> prompt).</P
></DD
><dt class="term"><code class="literal">:1,5&nbsp;m&nbsp;10&nbsp;|&nbsp;g/<code class="replaceable"><i>pattern</I
></CODE
>/nu</CODE
></DT
><dd class="listitem"><p class="para">Move lines 1 through 5 after line 10, and then display all
lines (with numbers) containing <em class="emphasis">pattern</EM
>.</P
></DD
></DL
><p class="para">Note the use of spaces to make the commands easier to read.</P
></DIV
><a class="indexterm" name="AUTOID-5837"></A
><a class="indexterm" name="AUTOID-5838"></A
></DIV
><div class="htmlnav"><p></P
><hr align="LEFT" width="515" title="footer"><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="SECT1" href="ch05_01.htm" webstripperlinkwas="ch05_01.htm" title="5.1 ex Commands "><img src="../gifs/txtpreva.gif" webstripperlinkwas="../gifs/txtpreva.gif" alt="Previous: 5.1 ex Commands " border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><a class="book" href="index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/vi/index.htm" title="Learning the vi Editor"><img src="../gifs/txthome.gif" webstripperlinkwas="../gifs/txthome.gif" alt="Learning the vi Editor" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="SECT1" href="ch05_03.htm" webstripperlinkwas="ch05_03.htm" title="5.3 Saving and Exiting Files "><img src="../gifs/txtnexta.gif" webstripperlinkwas="../gifs/txtnexta.gif" alt="Next: 5.3 Saving and Exiting Files " border="0"></A
></TD
></TR
><tr><td align="LEFT" valign="TOP" width="172">5.1 ex Commands </TD
><td align="CENTER" valign="TOP" width="171"><a class="index" href="index/idx_0.htm" webstripperlinkwas="index/idx_0.htm" title="Book Index"><img src="../gifs/index.gif" webstripperlinkwas="../gifs/index.gif" alt="Book Index" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172">5.3 Saving and Exiting Files </TD
></TR
></TABLE
><hr align="LEFT" width="515" title="footer"><img src="../gifs/smnavbar.gif" webstripperlinkwas="../gifs/smnavbar.gif" usemap="#map" border="0" alt="The UNIX CD Bookshelf Navigation"><map name="map"><area shape="RECT" coords="0,0,73,21" href="../index.html" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/index.html" alt="The UNIX CD Bookshelf"><area shape="RECT" coords="74,0,163,21" href="../upt/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/upt/index.htm" alt="UNIX Power Tools"><area shape="RECT" coords="164,0,257,21" href="../unixnut/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/unixnut/index.htm" alt="UNIX in a Nutshell"><area shape="RECT" coords="258,0,321,21" href="index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/vi/index.htm" alt="Learning the vi Editor"><area shape="RECT" coords="322,0,378,21" href="../sedawk/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/sedawk/index.htm" alt="sed &amp; awk"><area shape="RECT" coords="379,0,438,21" href="../ksh/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/ksh/index.htm" alt="Learning the Korn Shell"><area shape="RECT" coords="439,0,514,21" href="../lrnunix/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/lrnunix/index.htm" alt="Learning the UNIX Operating System"></MAP
></DIV
></BODY
></HTML
>

