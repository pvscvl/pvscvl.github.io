<html><head><title>[Chapter 6] 6.2 Context-Sensitive Replacement</TITLE
><meta name="DC.Creator" content="Linda Lamb &amp; Arnold Robbins"><meta name="DC.Date" content="1999-11-23T17:56:31Z"><meta name="DC.Format" content="text/html" scheme="MIME"><meta name="DC.Identifier" content="O'Reilly Unix CDROM-unknown"><meta name="DC.Language" content="en-US"><meta name="DC.Publisher" content="O'Reilly &amp; Associates, Inc."><meta name="DC.Source" content="unknown" scheme="ISBN"><meta name="DC.Subject.Keyword" content="Unix, vi, text, editor, tool"><meta name="DC.Title" content="Learning the vi Editor"><meta name="DC.Type" content="Text.Monograph"><meta name="generator" content="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><link rev="made" href="mailto:online-books@oreilly.com" title="Online Books Comments"><link rel="up" href="ch06_01.htm" webstripperlinkwas="ch06_01.htm" title="6. Global Replacement"><link rel="prev" href="ch06_01.htm" webstripperlinkwas="ch06_01.htm" title="6.1 Confirming Substitutions "><link rel="next" href="ch06_03.htm" webstripperlinkwas="ch06_03.htm" title="6.3 Pattern-Matching Rules "></HEAD
><body bgcolor="#FFFFFF" text="#000000"><div class="htmlnav"><h1><img src="gifs/smbanner.gif" webstripperlinkwas="gifs/smbanner.gif" alt="Learning the vi Editor" usemap="#srchmap" border="0"></H1
><map name="srchmap"><area shape="RECT" coords="0,0,466,65" href="index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/vi/index.htm" alt="Learning the vi Editor"><area shape="RECT" coords="467,0,514,18" href="jobjects/fsearch.htm" webstripperlinkwas="jobjects/fsearch.htm" alt="Search this book"></MAP
><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="SECT1" href="ch06_01.htm" webstripperlinkwas="ch06_01.htm" title="6.1 Confirming Substitutions "><img src="../gifs/txtpreva.gif" webstripperlinkwas="../gifs/txtpreva.gif" alt="Previous: 6.1 Confirming Substitutions " border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><b><font face="ARIEL,HELVETICA,HELV,SANSERIF" size="-1"><a class="chapter" rel="up" href="ch06_01.htm" webstripperlinkwas="ch06_01.htm" title="6. Global Replacement">Chapter 6<br>Global Replacement</A
></FONT
></B
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="SECT1" href="ch06_03.htm" webstripperlinkwas="ch06_03.htm" title="6.3 Pattern-Matching Rules "><img src="../gifs/txtnexta.gif" webstripperlinkwas="../gifs/txtnexta.gif" alt="Next: 6.3 Pattern-Matching Rules " border="0"></A
></TD
></TR
></TABLE
>&nbsp;<hr align="LEFT" width="515" title="footer"></DIV
><div class="SECT1"><h2 class="sect1"><a class="title" name="VI6-CH-6-SECT-2">6.2 Context-Sensitive Replacement</A
></H2
><p class="para"><a class="indexterm" name="AUTOID-6625"></A
><a class="indexterm" name="AUTOID-6627"></A
><a class="indexterm" name="AUTOID-6630"></A
><a class="indexterm" name="AUTOID-6634"></A
><a class="indexterm" name="AUTOID-6638"></A
><a class="indexterm" name="AUTOID-6641"></A
><a class="indexterm" name="AUTOID-6644"></A
>The simplest global replacements substitute one word (or a
phrase) for another.
If you have typed a file with several misspellings (<em class="emphasis">editer</EM
> for
<em class="emphasis">editor</EM
>), you can do the global replacement:</P
><p class="para"><blockquote class="screen"><pre class="screen">:%s/editer/editor/g</PRE
></BLOCKQUOTE
></P
><p class="para">This substitutes <em class="emphasis">editor</EM
> for every occurrence of
<em class="emphasis">editer</EM
> throughout the file.</P
><p class="para">There is a second, slightly more complex syntax for global replacement.
This syntax lets you search for a pattern, and then, once you
find the line with the pattern, make a substitution on a string
different from the pattern.
You can think of this as context-sensitive replacement.</P
><p class="para">The syntax is as follows:</P
><p class="para"><blockquote class="screen"><pre class="screen">:g/<code class="replaceable"><i>pattern</I
></CODE
>/s/<code class="replaceable"><i>old</I
></CODE
>/<code class="replaceable"><i>new</I
></CODE
>/g</PRE
></BLOCKQUOTE
></P
><p class="para">The first <code class="literal">g</CODE
> tells the command to operate on all lines of a file.
<em class="emphasis">pattern</EM
> identifies the lines on which a substitution is to take
place.
On those lines containing <em class="emphasis">pattern</EM
>, <kbd class="command">ex</KBD
> is to
substitute (<code class="literal">s</CODE
>) for <em class="emphasis">old</EM
> the characters in <em class="emphasis">new</EM
>.
The last <code class="literal">g</CODE
> indicates that the substitution is to
occur globally <em class="emphasis">on that line</EM
>.</P
><p class="para">For example, in this book, the SGML directives
<code class="literal">&lt;keycap&gt;</CODE
> and <code class="literal">&lt;/keycap&gt;</CODE
>
place a box around <kbd class="keycap">[ESC]</KBD
> to show the ESCAPE key.
You want <kbd class="keycap">[ESC]</KBD
>
to be all in caps, but you
don't want to change any instances of <em class="emphasis">Esc</EM
>ape that might be in the text.
To change instances of <em class="emphasis">Esc</EM
> to <em class="emphasis">ESC</EM
>
only when <em class="emphasis">Esc</EM
> is
on a line that contains the
<code class="literal">&lt;keycap&gt;</CODE
> directive,
you could enter:</P
><p class="para"><blockquote class="screen"><pre class="screen">:g/&lt;keycap&gt;/s/Esc/ESC/g</PRE
></BLOCKQUOTE
></P
><p class="para">If the pattern being used to find the line is the same as the one you
want to change, you don't have to repeat it. The command:</P
><p class="para"><blockquote class="screen"><pre class="screen">:g/<code class="replaceable"><i>string</I
></CODE
>/s//<code class="replaceable"><i>new</I
></CODE
>/g</PRE
></BLOCKQUOTE
></P
><p class="para">would search for lines containing <em class="emphasis">string</EM
> and substitute for
that same <em class="emphasis">string</EM
>.</P
><p class="para">Note that:</P
><p class="para"><blockquote class="screen"><pre class="screen">:g/editer/s//editor/g</PRE
></BLOCKQUOTE
></P
><p class="para">has the same effect as:</P
><p class="para"><blockquote class="screen"><pre class="screen">:%s/editer/editor/g</PRE
></BLOCKQUOTE
></P
><p class="para">You can save some typing by using the second form.
It is also possible to combine the <code class="literal">:g</CODE
> command with <code class="literal">:d</CODE
>,
<code class="literal">:mo</CODE
>, <code class="literal">:co</CODE
> and other <kbd class="command">ex</KBD
> commands besides <code class="literal">:s</CODE
>.
As we'll show, you can thus make global deletions, moves, and copies.</P
></DIV
><div class="htmlnav"><p></P
><hr align="LEFT" width="515" title="footer"><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="SECT1" href="ch06_01.htm" webstripperlinkwas="ch06_01.htm" title="6.1 Confirming Substitutions "><img src="../gifs/txtpreva.gif" webstripperlinkwas="../gifs/txtpreva.gif" alt="Previous: 6.1 Confirming Substitutions " border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><a class="book" href="index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/vi/index.htm" title="Learning the vi Editor"><img src="../gifs/txthome.gif" webstripperlinkwas="../gifs/txthome.gif" alt="Learning the vi Editor" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="SECT1" href="ch06_03.htm" webstripperlinkwas="ch06_03.htm" title="6.3 Pattern-Matching Rules "><img src="../gifs/txtnexta.gif" webstripperlinkwas="../gifs/txtnexta.gif" alt="Next: 6.3 Pattern-Matching Rules " border="0"></A
></TD
></TR
><tr><td align="LEFT" valign="TOP" width="172">6.1 Confirming Substitutions </TD
><td align="CENTER" valign="TOP" width="171"><a class="index" href="index/idx_0.htm" webstripperlinkwas="index/idx_0.htm" title="Book Index"><img src="../gifs/index.gif" webstripperlinkwas="../gifs/index.gif" alt="Book Index" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172">6.3 Pattern-Matching Rules </TD
></TR
></TABLE
><hr align="LEFT" width="515" title="footer"><img src="../gifs/smnavbar.gif" webstripperlinkwas="../gifs/smnavbar.gif" usemap="#map" border="0" alt="The UNIX CD Bookshelf Navigation"><map name="map"><area shape="RECT" coords="0,0,73,21" href="../index.html" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/index.html" alt="The UNIX CD Bookshelf"><area shape="RECT" coords="74,0,163,21" href="../upt/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/upt/index.htm" alt="UNIX Power Tools"><area shape="RECT" coords="164,0,257,21" href="../unixnut/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/unixnut/index.htm" alt="UNIX in a Nutshell"><area shape="RECT" coords="258,0,321,21" href="index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/vi/index.htm" alt="Learning the vi Editor"><area shape="RECT" coords="322,0,378,21" href="../sedawk/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/sedawk/index.htm" alt="sed &amp; awk"><area shape="RECT" coords="379,0,438,21" href="../ksh/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/ksh/index.htm" alt="Learning the Korn Shell"><area shape="RECT" coords="439,0,514,21" href="../lrnunix/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/lrnunix/index.htm" alt="Learning the UNIX Operating System"></MAP
></DIV
></BODY
></HTML
>

