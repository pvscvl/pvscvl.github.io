<html><head><title>[Chapter 29] 29.6 Counting Lines, Words, and Characters: wc </TITLE
><meta name="DC.title" content="UNIX Power Tools"><meta name="DC.creator" content="Jerry Peek, Tim O'Reilly &amp; Mike Loukides"><meta name="DC.publisher" content="O'Reilly &amp; Associates, Inc."><meta name="DC.date" content="1998-08-04T21:45:06Z"><meta name="DC.type" content="Text.Monograph"><meta name="DC.format" content="text/html" scheme="MIME"><meta name="DC.source" content="1-56592-260-3" scheme="ISBN"><meta name="DC.language" content="en-US"><meta name="generator" content="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><link rev="made" href="mailto:online-books@oreilly.com" title="Online Books Comments"><link rel="up" href="ch29_01.htm" webstripperlinkwas="ch29_01.htm" title="29. Spell Checking, Word Counting, and Textual Analysis"><link rel="prev" href="ch29_05.htm" webstripperlinkwas="ch29_05.htm" title="29.5 Adding Words to ispell's Dictionary "><link rel="next" href="ch29_07.htm" webstripperlinkwas="ch29_07.htm" title="29.7 Count How Many Times Each Word Is Used "></HEAD
><body bgcolor="#FFFFFF" text="#000000"><div class="htmlnav"><h1><img src="gifs/smbanner.gif" webstripperlinkwas="gifs/smbanner.gif" alt="UNIX Power Tools" usemap="#srchmap" border="0"></H1
><map name="srchmap"><area shape="RECT" coords="0,0,466,58" href="index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/upt/index.htm" alt="UNIX Power Tools"><area shape="RECT" coords="467,0,514,18" href="jobjects/fsearch.htm" webstripperlinkwas="jobjects/fsearch.htm" alt="Search this book"></MAP
><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="SECT1" href="ch29_05.htm" webstripperlinkwas="ch29_05.htm" title="29.5 Adding Words to ispell's Dictionary "><img src="../gifs/txtpreva.gif" webstripperlinkwas="../gifs/txtpreva.gif" alt="Previous: 29.5 Adding Words to ispell's Dictionary " border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><b><font face="ARIEL,HELVETICA,HELV,SANSERIF" size="-1">Chapter 29<br>Spell Checking, Word Counting, and Textual Analysis</FONT
></B
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="SECT1" href="ch29_07.htm" webstripperlinkwas="ch29_07.htm" title="29.7 Count How Many Times Each Word Is Used "><img src="../gifs/txtnexta.gif" webstripperlinkwas="../gifs/txtnexta.gif" alt="Next: 29.7 Count How Many Times Each Word Is Used " border="0"></A
></TD
></TR
></TABLE
>&nbsp;<hr align="LEFT" width="515" title="footer"></DIV
><div class="SECT1"><h2 class="sect1"><a class="title" name="UPT-ART-2730">29.6 Counting Lines, Words, and Characters: wc </A
></H2
><p class="para"><a class="indexterm" name="UPT-ART-2730-IX-WORDS-COUNTING"></A
><a class="indexterm" name="UPT-ART-2730-IX-TEXT-COUNTING-ELEMENTS-OF"></A
><a class="indexterm" name="UPT-ART-2730-IX-WC-COMMAND"></A
><a class="indexterm" name="UPT-ART-2730-IX-COUNTING-TEXT-ELEMENTS"></A
><a class="indexterm" name="UPT-ART-2730-IX-LINES-IN-FILES-COUNTING"></A
><a class="indexterm" name="UPT-ART-2730-IX-CHARACTERS-COUNTING"></A
>The <em class="emphasis">wc</EM
> (word count) command counts the number of lines, words, and
characters in the files you specify.
(<span class="link">Like most UNIX utilities (<a class="linkend" href="ch01_30.htm" webstripperlinkwas="ch01_30.htm" title="Redirecting Input and Output ">1.30</A
>)</SPAN
>,
<em class="emphasis">wc</EM
> reads from its standard input
if you don't specify a filename.)
For example, the file <em class="emphasis">letter</EM
> has 120 lines, 734 words, and 4297
characters:</P
><p class="para"><blockquote class="screen"><pre class="screen">% <code class="userinput"><b>wc letter</B
></CODE
>
     120     734    4297 letter</PRE
></BLOCKQUOTE
></P
><p class="para">You can restrict what is counted
by specifying the options <em class="emphasis">-l</EM
> (count lines only), <em class="emphasis">-w</EM
> 
(count words only), and <em class="emphasis">-c</EM
> (count characters only).
For example, you can count the number of lines in a file:</P
><p class="para"><blockquote class="screen"><pre class="screen">% <code class="userinput"><b>wc -l letter</B
></CODE
>
     120 letter</PRE
></BLOCKQUOTE
></P
><p class="para">or you can count the number of files in a directory:</P
><p class="para"><blockquote class="screen"><pre class="screen">% <code class="userinput"><b>cd man_pages</B
></CODE
>
% <code class="userinput"><b>ls | wc -w</B
></CODE
>
     233</PRE
></BLOCKQUOTE
></P
><p class="para">The first example uses a file as input; the second example pipes
the output of an <em class="emphasis">ls</EM
> command to the input of <em class="emphasis">wc</EM
>.
(Be aware that the
<span class="link"><em class="emphasis">-a</EM
> option (<a class="linkend" href="ch16_11.htm" webstripperlinkwas="ch16_11.htm" title="Showing Hidden Files with ls -A and -a ">16.11</A
>)</SPAN
>
makes <em class="emphasis">ls</EM
> list dot files.
If your <em class="emphasis">ls</EM
> command is
<span class="link">aliased (<a class="linkend" href="ch10_02.htm" webstripperlinkwas="ch10_02.htm" title="Aliases for Common Commands ">10.2</A
>)</SPAN
>
to include <em class="emphasis">-a</EM
>
or other options that add words to the normal output&nbsp;- such as the
line <code class="literal">total </CODE
><code class="replaceable"><i>nnn</I
></CODE
> from <em class="emphasis">ls -l</EM
>-then
you may not get the results you want.)</P
><p class="para">The fact that you can pipe the output of a command through <em class="emphasis">wc</EM
> lets you
use <em class="emphasis">wc</EM
> to perform addition and subtraction. For example, I once wrote
a shell script that involved, among other things, splitting files into several 
pieces, and I needed the script to keep track of how many files were
created. (The script ran
<span class="link"><em class="emphasis">csplit</EM
> (<a class="linkend" href="ch35_10.htm" webstripperlinkwas="ch35_10.htm" title="Splitting Files by Context: csplit ">35.10</A
>)</SPAN
>
on each file, producing an arbitrary
number of new files named <em class="emphasis">file.00</EM
>, <em class="emphasis">file.01</EM
>, <em class="emphasis">file.02</EM
>, etc.)
Here's the code I used to solve this problem:</P
><p class="para"><table class="screen.co" border="1"><tr><th valign="TOP"><pre class="calloutlist">
<a class="co" href="ch09_16.htm" webstripperlinkwas="ch09_16.htm" title="9.16 Command Substitution ">`...`</A
> 


<a class="co" href="ch49_06.htm" webstripperlinkwas="ch49_06.htm" title="49.6 Quick Arithmetic with expr ">expr</A
> </PRE
></TH
><td valign="TOP"><pre class="screen">
before=`ls $file* | wc -l`              # count the file
<em class="emphasis">   split the file by running it through csplit</EM
>
after=`ls $file* | wc -l`               # count file plus new splits
num_files=`expr $after - $before`       # evaluate the difference</PRE
></TD
></TR
></TABLE
></P
><p class="para"><a class="indexterm" name="AUTOID-32221"></A
>As another trick, the following command will tell you how many more words
are in <em class="emphasis">new.file</EM
> than in <em class="emphasis">old.file</EM
>:</P
><p class="para"><blockquote class="screen"><pre class="screen">% <code class="userinput"><b>expr `wc -w &lt; new.file`    -    `wc -w &lt; old.file`</B
></CODE
></PRE
></BLOCKQUOTE
></P
><p class="para">[The C and Korn shells have built-in arithmetic commands and don't really need
<em class="emphasis">expr</EM
>-but <em class="emphasis">expr</EM
> works in all shells. <em class="emphasis">-JP</EM
>&nbsp;]&#13;</P
><p class="para">Notice that you should have <em class="emphasis">wc</EM
> read the input files 
by using a <code class="literal">&lt;</CODE
> character. If instead you say:</P
><p class="para"><blockquote class="screen"><pre class="screen">% <code class="userinput"><b>expr `wc -w new.file` - `wc -w old.file`</B
></CODE
></PRE
></BLOCKQUOTE
></P
><p class="para">the filenames will show up in the expressions and produce a syntax error.
[1]</P
><blockquote class="footnote"><p class="para">[1] You could also type <code class="literal">cat new.file | wc -w</CODE
>, but this
involves two commands, so it's
<span class="link">less efficient (<a class="linkend" href="ch13_02.htm" webstripperlinkwas="ch13_02.htm" title="One Argument with a cat Isn't Enough ">13.2</A
>)</SPAN
>.</P
></BLOCKQUOTE
><table class="para.programreference" border="1"><tr><th valign="TOP"><a class="programreference" href="examples/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/upt/examples/index.htm" title="count.it">count.it</A
><br></TH
><td valign="TOP">Taking this concept further, here's a simple shell script to calculate
the differences in word count between two files:<a class="indexterm" name="AUTOID-32245"></A
>&#13;</TD
></TR
></TABLE
><p class="para"><table class="screen.co" border="1"><tr><th valign="TOP"><pre class="calloutlist">
&#13;





<a class="co" href="ch08_06.htm" webstripperlinkwas="ch08_06.htm" title="8.6 Output Command-Line Arguments ">echo</A
> 
&#13;</PRE
></TH
><td valign="TOP"><pre class="screen">
count_1=`wc -w &lt; $1`   # number of words in file 1
count_2=`wc -w &lt; $2`   # number of words in file 2

diff_12=`expr $count_1 - $count_2`   # difference in word count

# if $diff_12 is negative, reverse order and don't show the minus sign:
case &quot;$diff_12&quot; in
-*) echo &quot;$2 has `expr $diff_12 : '-\(.*\)'` more words than $1&quot; ;;
*)  echo &quot;$1 has $diff_12 more words than $2&quot; ;;
esac</PRE
></TD
></TR
></TABLE
></P
><p class="para">If this script were called <em class="emphasis">count.it</EM
>, then you could invoke it like this:</P
><p class="para"><blockquote class="screen"><pre class="screen">% <code class="userinput"><b>count.it draft.2 draft.1</B
></CODE
>
draft.1 has 23 more words than draft.2</PRE
></BLOCKQUOTE
></P
><p class="para">You could modify this script to count lines or characters.</P
><blockquote class="note"><p class="para"><strong>NOTE:</STRONG
> <a class="indexterm" name="AUTOID-32259"></A
>Unless the counts are very large, the output of <em class="emphasis">wc</EM
> will have leading
spaces. This can cause trouble in scripts if you aren't careful.
For instance, in the script above, the command:</P
><p class="para"><blockquote class="screen"><pre class="screen">echo &quot;$1 has $count_1 words&quot;</PRE
></BLOCKQUOTE
></P
><p class="para">might print:</P
><p class="para"><blockquote class="screen"><pre class="screen">draft.2 has       79 words</PRE
></BLOCKQUOTE
></P
><p class="para">See the extra spaces?
Understanding how the shell handles
<span class="link">quoting (<a class="linkend" href="ch08_14.htm" webstripperlinkwas="ch08_14.htm" title="Bourne Shell Quoting ">8.14</A
>)</SPAN
>
will help here.
If you can, let the shell read the <em class="emphasis">wc</EM
> output and remove extra spaces.
For example, without quotes, the shell passes four separate words to
<em class="emphasis">echo</EM
>-and <em class="emphasis">echo</EM
> adds a single space between each word:</P
><p class="para"><blockquote class="screen"><pre class="screen">echo $1 has $count_1 words</PRE
></BLOCKQUOTE
></P
><p class="para">that might print:</P
><p class="para"><blockquote class="screen"><pre class="screen">draft.2 has 79 words</PRE
></BLOCKQUOTE
></P
><p class="para">That's especially important to understand when you use <em class="emphasis">wc</EM
>
with commands like <em class="emphasis">test</EM
> or <em class="emphasis">expr</EM
> which don't expect spaces
in their arguments.
If you can't use the shell to strip out the spaces, delete them by
piping the <em class="emphasis">wc</EM
> output through
<span class="link"><code class="literal">tr&nbsp;-d&nbsp;'&nbsp;'</CODE
> (<a class="linkend" href="ch35_11.htm" webstripperlinkwas="ch35_11.htm" title="Hacking on Characters with tr ">35.11</A
>)</SPAN
>.</P
></BLOCKQUOTE
><p class="para">&#13;Finally, two notes about file size:</P
><ul class="itemizedlist"><li class="listitem"><p class="para"><em class="emphasis">wc -c</EM
> isn't an efficient way to count the characters in large
numbers of files.
<em class="emphasis">wc</EM
> opens and reads each file, which takes time.
The fourth or fifth column of output from <em class="emphasis">ls -l</EM
> (depending on
your version) gives the character count without opening the file.
You can sum <em class="emphasis">ls -l</EM
> counts for multiple files with the<a class="indexterm" name="AUTOID-32293"></A
>
<span class="link"><em class="emphasis">addup</EM
> (<a class="linkend" href="ch49_07.htm" webstripperlinkwas="ch49_07.htm" title="Total a Column with addup ">49.7</A
>)</SPAN
>
command.
For example:</P
><p class="para"><blockquote class="screen"><pre class="screen">% <code class="userinput"><b>ls -l </B
></CODE
><code class="replaceable"><i>files</I
></CODE
><code class="userinput"><b> | addup 4</B
></CODE
>
670518</PRE
></BLOCKQUOTE
></P
><p class="para"></P
></LI
><li class="listitem"><p class="para">Using character counts (as in the item above) doesn't give you the total
disk space used by files.
That's because, in general, each file takes at least one disk block
to store.
The
<span class="link"><em class="emphasis">du</EM
> (<a class="linkend" href="ch24_09.htm" webstripperlinkwas="ch24_09.htm" title="How Much Disk Space? ">24.9</A
>)</SPAN
>
command gives accurate disk usage.</P
></LI
></UL
><a class="indexterm" name="AUTOID-32307"></A
><a class="indexterm" name="AUTOID-32308"></A
><a class="indexterm" name="AUTOID-32309"></A
><a class="indexterm" name="AUTOID-32310"></A
><a class="indexterm" name="AUTOID-32311"></A
><a class="indexterm" name="AUTOID-32312"></A
><div class="sect1info"><p class="SECT1INFO">- <span class="authorinitials">DG</SPAN
>, <span class="authorinitials">JP</SPAN
></P
></DIV
></DIV
><div class="htmlnav"><p></P
><hr align="LEFT" width="515" title="footer"><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="SECT1" href="ch29_05.htm" webstripperlinkwas="ch29_05.htm" title="29.5 Adding Words to ispell's Dictionary "><img src="../gifs/txtpreva.gif" webstripperlinkwas="../gifs/txtpreva.gif" alt="Previous: 29.5 Adding Words to ispell's Dictionary " border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><a class="book" href="index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/upt/index.htm" title="UNIX Power Tools"><img src="../gifs/txthome.gif" webstripperlinkwas="../gifs/txthome.gif" alt="UNIX Power Tools" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="SECT1" href="ch29_07.htm" webstripperlinkwas="ch29_07.htm" title="29.7 Count How Many Times Each Word Is Used "><img src="../gifs/txtnexta.gif" webstripperlinkwas="../gifs/txtnexta.gif" alt="Next: 29.7 Count How Many Times Each Word Is Used " border="0"></A
></TD
></TR
><tr><td align="LEFT" valign="TOP" width="172">29.5 Adding Words to ispell's Dictionary </TD
><td align="CENTER" valign="TOP" width="171"><a class="index" href="index/idx_0.htm" webstripperlinkwas="index/idx_0.htm" title="Book Index"><img src="../gifs/index.gif" webstripperlinkwas="../gifs/index.gif" alt="Book Index" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172">29.7 Count How Many Times Each Word Is Used </TD
></TR
></TABLE
><hr align="LEFT" width="515" title="footer"><img src="../gifs/smnavbar.gif" webstripperlinkwas="../gifs/smnavbar.gif" usemap="#map" border="0" alt="The UNIX CD Bookshelf Navigation"><map name="map"><area shape="RECT" coords="0,0,73,21" href="../index.html" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/index.html" alt="The UNIX CD Bookshelf"><area shape="RECT" coords="74,0,163,21" href="index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/upt/index.htm" alt="UNIX Power Tools"><area shape="RECT" coords="164,0,257,21" href="../unixnut/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/unixnut/index.htm" alt="UNIX in a Nutshell"><area shape="RECT" coords="258,0,321,21" href="../vi/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/vi/index.htm" alt="Learning the vi Editor"><area shape="RECT" coords="322,0,378,21" href="../sedawk/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/sedawk/index.htm" alt="sed &amp; awk"><area shape="RECT" coords="379,0,438,21" href="../ksh/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/ksh/index.htm" alt="Learning the Korn Shell"><area shape="RECT" coords="439,0,514,21" href="../lrnunix/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/lrnunix/index.htm" alt="Learning the UNIX Operating System"></MAP
></DIV
></BODY
></HTML
>
