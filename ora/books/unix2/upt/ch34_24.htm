<html><head><title>[Chapter 34] 34.24 Quick Reference: sed </TITLE
><meta name="DC.title" content="UNIX Power Tools"><meta name="DC.creator" content="Jerry Peek, Tim O'Reilly &amp; Mike Loukides"><meta name="DC.publisher" content="O'Reilly &amp; Associates, Inc."><meta name="DC.date" content="1998-08-04T21:47:38Z"><meta name="DC.type" content="Text.Monograph"><meta name="DC.format" content="text/html" scheme="MIME"><meta name="DC.source" content="1-56592-260-3" scheme="ISBN"><meta name="DC.language" content="en-US"><meta name="generator" content="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><link rev="made" href="mailto:online-books@oreilly.com" title="Online Books Comments"><link rel="up" href="ch34_01.htm" webstripperlinkwas="ch34_01.htm" title="34. The sed Stream Editor"><link rel="prev" href="ch34_23.htm" webstripperlinkwas="ch34_23.htm" title="34.23 sed Newlines, Quoting, and Backslashes in a Shell Script"><link rel="next" href="ch35_01.htm" webstripperlinkwas="ch35_01.htm" title="35. You Can't Quite Call This Editing"></HEAD
><body bgcolor="#FFFFFF" text="#000000"><div class="htmlnav"><h1><img src="gifs/smbanner.gif" webstripperlinkwas="gifs/smbanner.gif" alt="UNIX Power Tools" usemap="#srchmap" border="0"></H1
><map name="srchmap"><area shape="RECT" coords="0,0,466,58" href="index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/upt/index.htm" alt="UNIX Power Tools"><area shape="RECT" coords="467,0,514,18" href="jobjects/fsearch.htm" webstripperlinkwas="jobjects/fsearch.htm" alt="Search this book"></MAP
><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="SECT1" href="ch34_23.htm" webstripperlinkwas="ch34_23.htm" title="34.23 sed Newlines, Quoting, and Backslashes in a Shell Script"><img src="../gifs/txtpreva.gif" webstripperlinkwas="../gifs/txtpreva.gif" alt="Previous: 34.23 sed Newlines, Quoting, and Backslashes in a Shell Script" border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><b><font face="ARIEL,HELVETICA,HELV,SANSERIF" size="-1">Chapter 34<br>The sed Stream Editor</FONT
></B
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="CHAPTER" href="ch35_01.htm" webstripperlinkwas="ch35_01.htm" title="35. You Can't Quite Call This Editing"><img src="../gifs/txtnexta.gif" webstripperlinkwas="../gifs/txtnexta.gif" alt="Next: 35. You Can't Quite Call This Editing" border="0"></A
></TD
></TR
></TABLE
>&nbsp;<hr align="LEFT" width="515" title="footer"></DIV
><div class="SECT1"><h2 class="sect1"><a class="title" name="UPT-ART-2850">34.24 Quick Reference: sed </A
></H2
><p class="para"><a class="indexterm" name="UPT-ART-2850-IX-SED-EDITOR-COMMAND-LIST"></A
>How <em class="emphasis">sed</EM
> operates:</P
><ul class="itemizedlist"><li class="listitem"><p class="para">Each line of input is copied into a pattern space.</P
></LI
><li class="listitem"><p class="para">Editing commands may be given on the command line (if more than one, use
a <em class="emphasis">-e</EM
> option before each command) and/or in script files named after
<em class="emphasis">-f</EM
> options.
All editing commands are applied in order to each line of input.</P
></LI
><li class="listitem"><p class="para">Editing commands are applied to all lines (globally) unless line
addressing restricts the lines affected.</P
></LI
><li class="listitem"><p class="para">If a command changes the input, subsequent command-addresses 
will be applied to the current line in the pattern space, not the original 
input line.</P
></LI
><li class="listitem"><p class="para">The original input file is unchanged; editing commands modify 
a copy of the original input line.
The copy is sent to
<span class="link">standard output (<a class="linkend" href="ch13_01.htm" webstripperlinkwas="ch13_01.htm#UPT-ART-1023" title="Using Standard Input and Output">13.1</A
>)</SPAN
>
unless the <em class="emphasis">-n</EM
> option was used; standard output can be
<span class="link">redirected to a file (<a class="linkend" href="ch13_01.htm" webstripperlinkwas="ch13_01.htm#UPT-ART-1023" title="Using Standard Input and Output">13.1</A
>, <a class="linkend" href="ch34_03.htm" webstripperlinkwas="ch34_03.htm" title="Testing and Using a sed Script: checksed, runsed ">34.3</A
>)</SPAN
>.</P
></LI
></UL
><div class="sect2"><h3 class="sect2"><a class="title" name="UPT-ART-2850-SECT-1.1">34.24.1 Syntax of sed Commands </A
></H3
><p class="para"><em class="emphasis">sed</EM
> commands have the general form:</P
><blockquote class="blockquote"><p class="para">[<code class="replaceable"><i>address</I
></CODE
>][<code class="literal">,</CODE
><code class="replaceable"><i>address</I
></CODE
>][<code class="literal">!</CODE
>]<code class="replaceable"><i>command </I
></CODE
>[<code class="replaceable"><i>arguments</I
></CODE
>]</P
></BLOCKQUOTE
><p class="para"><em class="emphasis">sed</EM
> commands consist of <code class="replaceable"><i>addresses</I
></CODE
> and editing <code class="replaceable"><i>commands</I
></CODE
>.
<code class="replaceable"><i>commands</I
></CODE
> consist of a single letter or symbol; they are
described later, alphabetically and by group.
<code class="replaceable"><i>arguments</I
></CODE
> include the label supplied to <em class="emphasis">b</EM
> or <em class="emphasis">t</EM
>, the
filename supplied to <em class="emphasis">r</EM
> or <em class="emphasis">w</EM
>, and the substitution flags
for <em class="emphasis">s</EM
>.
<code class="replaceable"><i>addresses</I
></CODE
> are described below.
Elements in <code class="literal">[</CODE
>brackets<code class="literal">]</CODE
> are optional; don't type the
brackets.</P
><p class="para">Braces (<code class="literal">{}</CODE
>) are used in <em class="emphasis">sed</EM
> to nest one address inside another or
to apply multiple commands at the same address:</P
><p class="para"><blockquote class="screen"><pre class="screen">[<code class="replaceable"><i>address</I
></CODE
>][<code class="literal">,</CODE
><code class="replaceable"><i>address</I
></CODE
>]{
   <code class="replaceable"><i>command1
   command2</I
></CODE
>
}</PRE
></BLOCKQUOTE
></P
><p class="para">The left curly brace (<code class="literal">{</CODE
>) is a command that starts a group of
other <em class="emphasis">sed</EM
> commands.
The group ends with a right curly brace (<code class="literal">}</CODE
>).
Commands within the braces may be spread across multiple lines, as shown
above.
Or commands may be on the same line, with a semicolon
(<code class="literal">;</CODE
>) after each command (including the last command on a
line)&nbsp;- as in:</P
><blockquote class="blockquote"><p class="para">[<code class="replaceable"><i>address</I
></CODE
>][<code class="literal">,</CODE
><code class="replaceable"><i>address</I
></CODE
>]<code class="literal">{</CODE
><code class="replaceable"><i>command1</I
></CODE
><code class="literal">; </CODE
>...<code class="replaceable"><i>commandN</I
></CODE
><code class="literal">; }</CODE
></P
></BLOCKQUOTE
></DIV
><div class="sect2"><h3 class="sect2"><a class="title" name="UPT-ART-2850-SECT-1.2">34.24.2 Pattern Addressing </A
></H3
><p class="para">A <em class="emphasis">sed</EM
> command can specify zero, one, or two addresses.
An address can be a line number, the symbol <code class="literal">$</CODE
> (for last line),
or a regular expression enclosed in slashes (<code class="literal">/</CODE
><code class="replaceable"><i>pattern</I
></CODE
><code class="literal">/</CODE
>).
Regular expressions are described in <a class="xref" href="ch26_01.htm" webstripperlinkwas="ch26_01.htm" title="Regular Expressions (Pattern Matching)">Chapter 26, Regular Expressions (Pattern Matching)</A
>.
Additionally, <code class="literal">\n</CODE
> can
be used to match any newline in the
pattern space (resulting from the <em class="emphasis">N</EM
> command), but not the
newline at the end of the pattern space.
See article
<a class="xref" href="ch34_04.htm" webstripperlinkwas="ch34_04.htm" title="sed Addressing Basics ">34.4</A
>.</P
><table class="informaltable"><thead class="thead"><tr class="row" valign="TOP"><th class="entry" align="LEFT" rowspan="1" colspan="1">If the command specifies:</TH
><th class="entry" align="LEFT" rowspan="1" colspan="1">Then it is applied to:</TH
></TR
></THEAD
><tbody class="tbody"><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1">No address</TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Each input line.</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1">One address</TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Any line matching the address.  Some commands accept only one address: <em class="emphasis">a</EM
>, <em class="emphasis">i</EM
>, <em class="emphasis">r</EM
>, <em class="emphasis">q</EM
>, and <code class="literal">=</CODE
>.</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1">Two comma-separated addresses</TD
><td class="entry" rowspan="1" colspan="1"><p class="para">First matching line and all succeeding lines up to and including a line matching the second address. Repeat for each matching range in the text.</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1">An address followed by <code class="literal">!</CODE
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">All lines that do <em class="emphasis">not</EM
> match the address.</P
></TD
></TR
></TBODY
></TABLE
><div class="sect3"><h4 class="sect3"><a class="title" name="UPT-ART-2850-SECT-1.2.1">34.24.2.1 Examples </A
></H4
><p class="para">Substitute on all lines (all occurrences):</P
><p class="para"><blockquote class="screen"><pre class="screen">s/xx/yy/g</PRE
></BLOCKQUOTE
></P
><p class="para">Delete lines containing <code class="literal">BSD</CODE
>:</P
><p class="para"><blockquote class="screen"><pre class="screen">/BSD/d</PRE
></BLOCKQUOTE
></P
><p class="para">Print the lines between each pair of
<code class="literal">BEGIN</CODE
> and <code class="literal">END</CODE
>, inclusive:</P
><p class="para"><blockquote class="screen"><pre class="screen">/^BEGIN/,/^END/p</PRE
></BLOCKQUOTE
></P
><p class="para">Delete any line that doesn't contain <code class="literal">SAVE</CODE
>:</P
><p class="para"><blockquote class="screen"><pre class="screen">/SAVE/!d</PRE
></BLOCKQUOTE
></P
><p class="para">Substitute on all lines, except between <code class="literal">BEGIN</CODE
> and <code class="literal">END</CODE
>:</P
><p class="para"><blockquote class="screen"><pre class="screen">/BEGIN/,/END/!s/xx/yy/g</PRE
></BLOCKQUOTE
></P
></DIV
></DIV
><div class="sect2"><h3 class="sect2"><a class="title" name="UPT-ART-2850-SECT-1.3">34.24.3 Alphabetical Summary of sed Commands </A
></H3
><p class="para"></P
><dl class="variablelist"><dt class="term"><code class="literal">#</CODE
></DT
><dd class="listitem"><p class="para">Begin a comment in a <em class="emphasis">sed</EM
> script.
If the first such line is exactly <code class="literal">#n</CODE
>, <em class="emphasis">sed</EM
> sets
its <em class="emphasis">-n</EM
> command-line option.</P
></DD
><dt class="term"><code class="literal">:</CODE
></DT
><dd class="listitem"><p class="para"><code class="literal">:</CODE
><code class="replaceable"><i>label</I
></CODE
></P
><p class="para">Label a line in the script for the transfer of control by <em class="emphasis">b</EM
> or <em class="emphasis">t</EM
>. <code class="replaceable"><i>label</I
></CODE
>
may contain up to seven characters.</P
></DD
><dt class="term"><code class="literal">=</CODE
></DT
><dd class="listitem"><p class="para">[<code class="replaceable"><i>address</I
></CODE
>]<code class="literal">=</CODE
></P
><p class="para">Write to standard output the line number of each line addressed.</P
></DD
><dt class="term"><code class="literal">a</CODE
></DT
><dd class="listitem"><p class="para"><blockquote class="literallayout"><p class="literallayout"><code class="literal">[</CODE
><code class="replaceable"><i>address</I
></CODE
><code class="literal">]a\</CODE
><br><code class="replaceable"><i>text</I
></CODE
></P
></BLOCKQUOTE
></P
><p class="para">Append <code class="replaceable"><i>text</I
></CODE
> following each line matched by
<code class="replaceable"><i>address</I
></CODE
>.
If there is more than one line of <code class="replaceable"><i>text</I
></CODE
>,
all newlines except the last must be &quot;hidden&quot; by preceding
them with a backslash. <code class="replaceable"><i>text</I
></CODE
> will be terminated by the first
newline that is not hidden in this way. <code class="replaceable"><i>text</I
></CODE
> is
not available in the pattern space, and subsequent commands
cannot be applied to it. The results of this command
are sent to standard output when the list of editing commands is finished,
regardless of what happens to the current line in the pattern space.
(There's an example in article
<a class="xref" href="ch43_22.htm" webstripperlinkwas="ch43_22.htm" title="Converting Text Files to PostScript ">43.22</A
>,
among others.)</P
><p class="para"><em class="emphasis">Example</EM
></P
><p class="para"><blockquote class="screen"><pre class="screen">$a\
This goes after the last line in the file\
(marked by $). This text is escaped at the\
end of each line, except for the last one.</PRE
></BLOCKQUOTE
><a class="indexterm" name="AUTOID-39560"></A
></P
></DD
><dt class="term"><code class="literal">b</CODE
></DT
><dd class="listitem"><p class="para"><code class="literal">[</CODE
><code class="replaceable"><i>address1</I
></CODE
><code class="literal">][,</CODE
><code class="replaceable"><i>address2</I
></CODE
>]<code class="literal">b[</CODE
><code class="replaceable"><i>label</I
></CODE
><code class="literal">]</CODE
></P
><p class="para">Transfer control unconditionally to <code class="literal">:</CODE
><code class="replaceable"><i>label</I
></CODE
> elsewhere in script.
That is, the command following
the <code class="replaceable"><i>label</I
></CODE
> is the next command applied to the current line.
If no <code class="replaceable"><i>label</I
></CODE
> is specified, control falls through
to the end of the script, so no more commands are applied
to the current line.  See articles <a class="xref" href="ch34_19.htm" webstripperlinkwas="ch34_19.htm" title="Making Edits Everywhere Except... ">34.19</A
> and
<a class="xref" href="ch34_17.htm" webstripperlinkwas="ch34_17.htm" title="Searching for Patterns Split Across Lines ">34.17</A
>.</P
><p class="para"><em class="emphasis">Example</EM
></P
><p class="para"><blockquote class="screen"><pre class="screen"># Ignore tbl tables; resume script after TE:
/^\.TS/,/^\.TE/b</PRE
></BLOCKQUOTE
></P
><p class="para"></P
></DD
><dt class="term"><code class="literal">c</CODE
></DT
><dd class="listitem"><p class="para"><blockquote class="literallayout"><p class="literallayout"><code class="literal">[</CODE
><code class="replaceable"><i>address1</I
></CODE
>][<code class="literal">,</CODE
><code class="replaceable"><i>address2</I
></CODE
><code class="literal">]c\</CODE
><br><code class="replaceable"><i>text</I
></CODE
></P
></BLOCKQUOTE
></P
><p class="para">Replace the lines selected by the address with <code class="replaceable"><i>text</I
></CODE
>.
When a range of lines is specified, all lines as a group are replaced
by a single copy of <code class="replaceable"><i>text</I
></CODE
>.
The newline following each line of <code class="replaceable"><i>text</I
></CODE
> must be escaped by
a backslash, except the last line.
The contents of the pattern space are, in effect, deleted and
no subsequent editing commands can be applied to it (or <code class="replaceable"><i>text</I
></CODE
>).</P
><p class="para"><em class="emphasis">Example</EM
></P
><p class="para"><blockquote class="screen"><pre class="screen"># Replace first 100 lines in a file:
1,100c\
<i class="lineannotation">...first replacement line</I
>\
<i class="lineannotation">...second replacement line</I
>\
<i class="lineannotation">...</I
>\
<i class="lineannotation">...last replacement line</I
></PRE
></BLOCKQUOTE
></P
><p class="para"></P
></DD
><dt class="term"><code class="literal">d</CODE
></DT
><dd class="listitem"><p class="para"><code class="literal">[</CODE
><code class="replaceable"><i>address1</I
></CODE
><code class="literal">][,</CODE
><code class="replaceable"><i>address2</I
></CODE
><code class="literal">]d</CODE
></P
><p class="para">Delete the addressed line (or lines) from the pattern space. Thus, the 
line is not passed to standard
output. A new line of input is read, and editing resumes with the first
command in the script.
See articles
<a class="xref" href="ch34_04.htm" webstripperlinkwas="ch34_04.htm" title="sed Addressing Basics ">34.4</A
>
and
<a class="xref" href="ch34_18.htm" webstripperlinkwas="ch34_18.htm" title="Multiline Delete ">34.18</A
>.</P
><p class="para"><em class="emphasis">Example</EM
></P
><p class="para"><blockquote class="screen"><pre class="screen"># delete all blank lines:
/^$/d</PRE
></BLOCKQUOTE
></P
></DD
><dt class="term"><code class="literal">D</CODE
></DT
><dd class="listitem"><p class="para">[<code class="replaceable"><i>address1</I
></CODE
>][<code class="literal">,</CODE
><code class="replaceable"><i>address2</I
></CODE
>]<code class="literal">D</CODE
></P
><p class="para">Delete first part (up to embedded newline) of multiline pattern space created
by <em class="emphasis">N</EM
> command and resume editing with first command in
script. If this command empties the pattern space, then a new line
of input is read, as if <em class="emphasis">d</EM
> had been executed.
See article <a class="xref" href="ch34_18.htm" webstripperlinkwas="ch34_18.htm" title="Multiline Delete ">34.18</A
>.</P
><p class="para"><em class="emphasis">Example</EM
></P
><p class="para"><blockquote class="screen"><pre class="screen"># Strip multiple blank lines, leaving only one:
/^$/{
    N
    /^\n$/D
}</PRE
></BLOCKQUOTE
></P
></DD
><dt class="term"><code class="literal">g</CODE
></DT
><dd class="listitem"><p class="para"><code class="literal">[</CODE
><code class="replaceable"><i>address1</I
></CODE
><code class="literal">][,</CODE
><code class="replaceable"><i>address2</I
></CODE
><code class="literal">]g</CODE
></P
><p class="para">Paste the contents of the hold space (see <em class="emphasis">h</EM
> or <em class="emphasis">H</EM
>) back
into the pattern space, wiping out the previous contents of the pattern space.
See articles <a class="xref" href="ch34_13.htm" webstripperlinkwas="ch34_13.htm" title="Hold Space: The Set-Aside Buffer ">34.13</A
> and <a class="xref" href="ch34_16.htm" webstripperlinkwas="ch34_16.htm" title="The Deliberate Scrivener ">34.16</A
>.
The example shows a simple way to copy lines.</P
><p class="para"><em class="emphasis">Example</EM
></P
><p class="para">This script collects all lines containing the word <code class="literal">Item:</CODE
>
and copies them to a place marker later in the file.
The place marker is overwritten.</P
><p class="para"><blockquote class="screen"><pre class="screen">/Item:/H
/&lt;Replace this line with the item list&gt;/g</PRE
></BLOCKQUOTE
></P
><p class="para"></P
></DD
><dt class="term"><code class="literal">G</CODE
></DT
><dd class="listitem"><p class="para">[<code class="replaceable"><i>address1</I
></CODE
>][<code class="literal">,</CODE
><code class="replaceable"><i>address2</I
></CODE
>]<code class="literal">G</CODE
></P
><p class="para">Same as <em class="emphasis">g</EM
>, except that the hold space is pasted below the address
instead of overwriting it.
The example shows a simple way to &quot;cut and paste&quot; lines.
See articles <a class="xref" href="ch34_13.htm" webstripperlinkwas="ch34_13.htm" title="Hold Space: The Set-Aside Buffer ">34.13</A
> and <a class="xref" href="ch34_16.htm" webstripperlinkwas="ch34_16.htm" title="The Deliberate Scrivener ">34.16</A
>.</P
><p class="para"><em class="emphasis">Example</EM
></P
><p class="para">This script collects all lines containing the word <code class="literal">Item:</CODE
>
and moves them after a place marker later in the file.
The original <code class="literal">Item:</CODE
> lines are deleted.</P
><p class="para"><blockquote class="screen"><pre class="screen">/Item:/{
    H
    d
}
/Summary of items:/G</PRE
></BLOCKQUOTE
></P
><p class="para"></P
></DD
><dt class="term"><code class="literal">h</CODE
></DT
><dd class="listitem"><p class="para">[<code class="replaceable"><i>address1</I
></CODE
>][<code class="literal">,</CODE
><code class="replaceable"><i>address2</I
></CODE
>]<code class="literal">h</CODE
>

Copy the pattern space into the hold space, a special temporary buffer.
The previous contents of the hold space are obliterated.
You can use <em class="emphasis">h</EM
> to save a line before editing it.
See articles <a class="xref" href="ch34_13.htm" webstripperlinkwas="ch34_13.htm" title="Hold Space: The Set-Aside Buffer ">34.13</A
> and <a class="xref" href="ch34_16.htm" webstripperlinkwas="ch34_16.htm" title="The Deliberate Scrivener ">34.16</A
>.</P
><p class="para"><em class="emphasis">Example</EM
></P
><p class="para"><blockquote class="screen"><pre class="screen"># Edit a line; print the change; replay the original
/UNIX/{
    h
    s/.* UNIX \(.*\) .*/\1:/
    p
    x
}</PRE
></BLOCKQUOTE
></P
><p class="para"><em class="emphasis">Sample input:</EM
></P
><p class="para"><blockquote class="screen"><pre class="screen">This describes the UNIX ls command.
This describes the UNIX cp command.</PRE
></BLOCKQUOTE
></P
><p class="para"><em class="emphasis">Sample output:</EM
></P
><p class="para"><blockquote class="screen"><pre class="screen">ls:
This describes the UNIX ls command.
cp:
This describes the UNIX cp command.</PRE
></BLOCKQUOTE
></P
><p class="para">&#13;</P
></DD
><dt class="term"><code class="literal">H</CODE
></DT
><dd class="listitem"><p class="para">[<code class="replaceable"><i>address1</I
></CODE
>][<code class="literal">,</CODE
><code class="replaceable"><i>address2</I
></CODE
>]<code class="literal">H</CODE
></P
><p class="para">Append the contents of the pattern space (preceded by a newline)
to the contents of the hold space. Even if the hold space is empty,
<em class="emphasis">H</EM
> still appends a newline. <em class="emphasis">H</EM
> is like an incremental copy.
See examples under <em class="emphasis">g</EM
> and <em class="emphasis">G</EM
>,
also articles
<a class="xref" href="ch34_13.htm" webstripperlinkwas="ch34_13.htm" title="Hold Space: The Set-Aside Buffer ">34.13</A
>
and
<a class="xref" href="ch34_16.htm" webstripperlinkwas="ch34_16.htm" title="The Deliberate Scrivener ">34.16</A
>.&#13;</P
></DD
><dt class="term"><code class="literal">i</CODE
></DT
><dd class="listitem"><p class="para"><blockquote class="literallayout"><p class="literallayout"><code class="literal">[</CODE
><code class="replaceable"><i>address</I
></CODE
><code class="literal">]i\</CODE
><br><code class="replaceable"><i>text</I
></CODE
> </P
></BLOCKQUOTE
>
Insert <code class="replaceable"><i>text</I
></CODE
> before each line matched by <code class="replaceable"><i>address</I
></CODE
>.
(See <em class="emphasis">a</EM
> for details on <code class="replaceable"><i>text</I
></CODE
>.)
Article
<a class="xref" href="ch43_20.htm" webstripperlinkwas="ch43_20.htm" title="Displaying a troff Macro Definition ">43.20</A
>
shows a script that uses <em class="emphasis">i</EM
>.</P
><p class="para"><em class="emphasis">Example</EM
></P
><p class="para"><blockquote class="screen"><pre class="screen">/Item 1/i\
The five items are listed below:</PRE
></BLOCKQUOTE
></P
><p class="para"></P
></DD
><dt class="term"><code class="literal">l</CODE
></DT
><dd class="listitem"><p class="para">[<code class="replaceable"><i>address1</I
></CODE
>][<code class="literal">,</CODE
><code class="replaceable"><i>address2</I
></CODE
>]<code class="literal">l</CODE
></P
><p class="para">List the contents of the pattern space, showing non-printing
characters as
<span class="link">ASCII codes (<a class="linkend" href="ch51_03.htm" webstripperlinkwas="ch51_03.htm" title="ASCII Characters: Listing and Getting Values ">51.3</A
>, <a class="linkend" href="ch25_07.htm" webstripperlinkwas="ch25_07.htm" title="Show Non-Printing Characters with cat -v or od -c ">25.7</A
>)</SPAN
>.
Long lines are wrapped.</P
></DD
><dt class="term"><code class="literal">n</CODE
></DT
><dd class="listitem"><p class="para">[<code class="replaceable"><i>address1</I
></CODE
>][<code class="literal">,</CODE
><code class="replaceable"><i>address2</I
></CODE
>]<code class="literal">n</CODE
></P
><p class="para">Read next line of input into pattern space. The current line is sent to
standard output, and the next line becomes the current line.
Control passes to the command following <em class="emphasis">n</EM
> instead of resuming at the top
of the script.</P
><p class="para"><em class="emphasis">Example</EM
></P
><p class="para">In the
<span class="link"><em class="emphasis">ms</EM
> macros (<a class="linkend" href="ch43_14.htm" webstripperlinkwas="ch43_14.htm" title="nroff/troff and Macro Packages ">43.14</A
>)</SPAN
>,
a section header occurs on the line
below an <code class="literal">.NH</CODE
> macro. To print all lines of header text, invoke this
script with <em class="emphasis">sed -n</EM
>:</P
><p class="para"><blockquote class="screen"><pre class="screen">/^\.NH/{
    n
    p
}<a class="indexterm" name="AUTOID-39783"></A
></PRE
></BLOCKQUOTE
></P
><p class="para"></P
></DD
><dt class="term"><code class="literal">N</CODE
></DT
><dd class="listitem"><p class="para">[<code class="replaceable"><i>address1</I
></CODE
>][<code class="literal">,</CODE
><code class="replaceable"><i>address2</I
></CODE
>]<code class="literal">N</CODE
></P
><p class="para">Append next input line to contents of pattern space; the two lines are
separated by an embedded newline.
(This command is designed to allow pattern matches across two
lines.) Using <code class="literal">\n</CODE
> to match the embedded newline, you can match
patterns across multiple lines. See example under <em class="emphasis">D</EM
>, also article
<a class="xref" href="ch34_15.htm" webstripperlinkwas="ch34_15.htm" title="Making Edits Across Line Boundaries ">34.15</A
>.</P
><p class="para"><em class="emphasis">Examples</EM
></P
><p class="para">Like previous example, but print <code class="literal">.NH</CODE
> line as well as header title:</P
><p class="para"><blockquote class="screen"><pre class="screen">/^\.NH/{
    N
    p
}</PRE
></BLOCKQUOTE
></P
><p class="para">Join two lines (replace newline with space):</P
><p class="para"><blockquote class="screen"><pre class="screen">/^\.NH/{
    N
    s/\n/ /
    p
}</PRE
></BLOCKQUOTE
></P
></DD
><dt class="term"><code class="literal">p</CODE
></DT
><dd class="listitem"><p class="para">[<code class="replaceable"><i>address1</I
></CODE
>][<code class="literal">,</CODE
><code class="replaceable"><i>address2</I
></CODE
>]<code class="literal">p</CODE
></P
><p class="para">Print the addressed line(s). Unless the <em class="emphasis">-n</EM
> command-line
option is used, this command will cause duplicate lines to be
output. Also, it is typically used before commands that
change flow control (<em class="emphasis">d</EM
>, <em class="emphasis">N</EM
>, <em class="emphasis">b</EM
>) and that might
prevent the current line from being output.
See examples under <em class="emphasis">h</EM
>, <em class="emphasis">n</EM
>, and <em class="emphasis">N</EM
>.</P
></DD
><dt class="term"><code class="literal">P</CODE
></DT
><dd class="listitem"><p class="para">[<code class="replaceable"><i>address1</I
></CODE
>][<code class="literal">,</CODE
><code class="replaceable"><i>address2</I
></CODE
>]<code class="literal">P</CODE
></P
><p class="para">Print first part (up to embedded newline) of multiline pattern created
by <em class="emphasis">N</EM
> command. Same as <em class="emphasis">p</EM
> if <em class="emphasis">N</EM
> has 
not been applied to a line.</P
><p class="para"><em class="emphasis">Example</EM
></P
><p class="para">The following script prints each line containing <code class="replaceable"><i>word</I
></CODE
>
and also the line before it:</P
><p class="para"><blockquote class="screen"><pre class="screen">N
/<code class="replaceable"><i>word</I
></CODE
>/P
D</PRE
></BLOCKQUOTE
></P
><p class="para"></P
></DD
><dt class="term"><code class="literal">q</CODE
></DT
><dd class="listitem"><p class="para">[<code class="replaceable"><i>address</I
></CODE
>]<code class="literal">q</CODE
><a class="indexterm" name="AUTOID-39854"></A
></P
><p class="para">Quit when <code class="replaceable"><i>address</I
></CODE
> is encountered. The addressed line is first
written to output (if default output is not suppressed),
along with any text appended to it by 
previous <em class="emphasis">a</EM
> or <em class="emphasis">r</EM
> commands.
See articles <a class="xref" href="ch34_21.htm" webstripperlinkwas="ch34_21.htm" title="Uses of the sed Quit Command ">34.21</A
> and
<a class="xref" href="ch34_22.htm" webstripperlinkwas="ch34_22.htm" title="Dangers of the sed Quit Command ">34.22</A
>.</P
><p class="para"><em class="emphasis">Example</EM
></P
><p class="para">Delete everything after the addressed line:</P
><p class="para"><blockquote class="screen"><pre class="screen">/Garbled text follows:/q</PRE
></BLOCKQUOTE
></P
><p class="para">&#13;Print only the first 50 lines of a file:</P
><p class="para"><blockquote class="screen"><pre class="screen">50q</PRE
></BLOCKQUOTE
></P
></DD
><dt class="term"><code class="literal">r</CODE
></DT
><dd class="listitem"><p class="para">[<code class="replaceable"><i>address</I
></CODE
>]<code class="literal">r </CODE
><code class="replaceable"><i>file</I
></CODE
></P
><p class="para">Read contents of <code class="replaceable"><i>file</I
></CODE
> and append after the contents of the
pattern space.
Exactly one space must be put between the <code class="literal">r</CODE
> and <code class="replaceable"><i>file</I
></CODE
>.</P
><p class="para"><em class="emphasis">Example</EM
></P
><p class="para"><blockquote class="screen"><pre class="screen">/The list of items follows:/r item_file</PRE
></BLOCKQUOTE
></P
></DD
><dt class="term"><code class="literal">s</CODE
></DT
><dd class="listitem"><p class="para">[<code class="replaceable"><i>address1</I
></CODE
>][<code class="literal">,</CODE
><code class="replaceable"><i>address2</I
></CODE
>]<code class="literal">s/</CODE
><code class="replaceable"><i>pattern</I
></CODE
><code class="literal">/</CODE
><code class="replaceable"><i>replacement</I
></CODE
><code class="literal">/</CODE
>[<code class="replaceable"><i>flags</I
></CODE
>]</P
><p class="para">Substitute <code class="replaceable"><i>replacement</I
></CODE
> for <code class="replaceable"><i>pattern</I
></CODE
> on each addressed line.
If pattern addresses are used, the pattern <code class="literal">//</CODE
> represents the last
pattern address specified.
The following flags can be specified:

<dl class="variablelist"><dt class="term"><code class="replaceable"><i>n</I
></CODE
></DT
><dd class="listitem"><p class="para">Replace <code class="replaceable"><i>n</I
></CODE
>th instance of <code class="literal">/</CODE
><code class="replaceable"><i>pattern</I
></CODE
><code class="literal">/</CODE
> on each addressed line.
<code class="replaceable"><i>n</I
></CODE
> is any number in the range 1 to 512 (default is 1).
See article
<a class="xref" href="ch34_11.htm" webstripperlinkwas="ch34_11.htm" title="Search &amp; Replacement: One Match Among Many ">34.11</A
>.</P
></DD
><dt class="term"><code class="literal">g</CODE
></DT
><dd class="listitem"><p class="para">Replace all instances of <code class="literal">/</CODE
><code class="replaceable"><i>pattern</I
></CODE
><code class="literal">/</CODE
> on each addressed line, not
just the first instance.</P
></DD
><dt class="term"><code class="literal">p</CODE
></DT
><dd class="listitem"><p class="para">Print the line if a successful substitution is done. If several
successful substitutions are done, multiple copies of the line will be
printed.
Often used in scripts with the
<span class="link"><em class="emphasis">-n</EM
> command-line option (<a class="linkend" href="ch34_02.htm" webstripperlinkwas="ch34_02.htm" title="Invoking sed ">34.2</A
>)</SPAN
>.</P
></DD
><dt class="term"><code class="literal">w&nbsp;</CODE
><code class="replaceable"><i>file</I
></CODE
></DT
><dd class="listitem"><p class="para">Write the line to a <code class="replaceable"><i>file</I
></CODE
> if a replacement was done. A maximum
of ten different files can be opened in a script.
See articles <a class="xref" href="ch34_07.htm" webstripperlinkwas="ch34_07.htm" title="Delimiting a Regular Expression ">34.7</A
> 
through <a class="xref" href="ch34_10.htm" webstripperlinkwas="ch34_10.htm" title="Referencing Portions of a Search String ">34.10</A
>.</P
><p class="para"><em class="emphasis">Examples</EM
></P
><p class="para">Here are some short, commented scripts:</P
><p class="para"><blockquote class="screen"><pre class="screen"># Change third and fourth quote to ( and ):
/function/{
    s/&quot;/)/4
    s/&quot;/(/3
}

# Remove all quotes on a given line:
/Title/s/&quot;//g

# Remove first colon or all quotes; print resulting lines:
s/://p
s/&quot;//gp

# Change first &quot;if&quot; but leave &quot;ifdef&quot; alone:
/ifdef/!s/if/   if/</PRE
></BLOCKQUOTE
></P
><p class="para"></P
></DD
></DL
></P
></DD
><dt class="term"><code class="literal">t</CODE
></DT
><dd class="listitem"><p class="para">[<code class="replaceable"><i>address1</I
></CODE
>][<code class="literal">,</CODE
><code class="replaceable"><i>address2</I
></CODE
>]<code class="literal">t </CODE
>[<code class="replaceable"><i>label</I
></CODE
>]</P
><p class="para">Test if any substitutions have been made on addressed lines,
and if so, branch to line marked by <code class="literal">:</CODE
><code class="replaceable"><i>label</I
></CODE
>.
(See <em class="emphasis">b</EM
> and <code class="literal">:</CODE
>.) If
<code class="replaceable"><i>label</I
></CODE
> is not specified, control falls through to bottom of script.
See article
<a class="xref" href="ch34_20.htm" webstripperlinkwas="ch34_20.htm" title="The sed Test Command ">34.20</A
>.</P
><p class="para">The <em class="emphasis">t</EM
> command can be used like a
<span class="link"><em class="emphasis">case</EM
> statement (<a class="linkend" href="ch44_05.htm" webstripperlinkwas="ch44_05.htm" title="Test String Values with Bourne Shell case ">44.5</A
>)</SPAN
>
in the Bourne shell.
You test each case: when it's true, you exit the construct.</P
><p class="para"><em class="emphasis">Example</EM
></P
><p class="para">Suppose you want to fill empty fields of a database. You have this:</P
><p class="para"><blockquote class="screen"><pre class="screen">ID: 1   Name: greg   Rate: 45
ID: 2   Name: dale
ID: 3</PRE
></BLOCKQUOTE
></P
><p class="para">You want this:</P
><p class="para"><blockquote class="screen"><pre class="screen">ID: 1   Name: greg   Rate: 45   Phone: ??
ID: 2   Name: dale   Rate: ??   Phone: ??
ID: 3   Name: ????   Rate: ??   Phone: ??</PRE
></BLOCKQUOTE
></P
><p class="para">You need to test the number of fields already there.
Here's the script (fields are tab-separated):</P
><p class="para"><blockquote class="screen"><pre class="screen">/ID/{
    s/ID: .* Name: .* Rate: .*/&amp;   Phone: ??/p
    t
    s/ID: .* Name: .*/&amp;   Rate: ??   Phone: ??/p
    t
    s/ID: .*/&amp;   Name: ??     Rate: ??   Phone: ??/p
}</PRE
></BLOCKQUOTE
></P
><p class="para"></P
></DD
><dt class="term"><code class="literal">w</CODE
></DT
><dd class="listitem"><p class="para">[<code class="replaceable"><i>address1</I
></CODE
>][<code class="literal">,</CODE
><code class="replaceable"><i>address2</I
></CODE
>]<code class="literal">w </CODE
><code class="replaceable"><i>file</I
></CODE
></P
><p class="para">Append, contents of pattern space to <code class="replaceable"><i>file</I
></CODE
>. This action 
occurs when the command is encountered rather than when the pattern space is
output. Exactly one space
must separate the <code class="literal">w</CODE
> and <code class="replaceable"><i>file</I
></CODE
>.
A maximum of ten different files can be opened in a script.
This command will create the file if it does not exist; if the file
exists, its contents will be overwritten each time the script
is executed. Multiple write commands that direct output to the
same file append to the end of the file.</P
><p class="para"><em class="emphasis">Example</EM
></P
><p class="para"><blockquote class="screen"><pre class="screen"># Store tbl and eqn blocks in a file:
/^\.TS/,/^\.TE/w troff_stuff
/^\.EQ/,/^\.EN/w troff_stuff</PRE
></BLOCKQUOTE
></P
><p class="para"></P
></DD
><dt class="term"><code class="literal">x</CODE
></DT
><dd class="listitem"><p class="para">[<code class="replaceable"><i>address1</I
></CODE
>][<code class="literal">,</CODE
><code class="replaceable"><i>address2</I
></CODE
>]<code class="literal">x</CODE
></P
><p class="para">Exchange contents of the pattern space with the contents of the
hold space.
For examples, see <em class="emphasis">h</EM
> and articles
<a class="xref" href="ch34_13.htm" webstripperlinkwas="ch34_13.htm" title="Hold Space: The Set-Aside Buffer ">34.13</A
>
and
<a class="xref" href="ch34_16.htm" webstripperlinkwas="ch34_16.htm" title="The Deliberate Scrivener ">34.16</A
>.&#13;</P
></DD
><dt class="term"><code class="literal">y</CODE
></DT
><dd class="listitem"><p class="para">[<code class="replaceable"><i>address1</I
></CODE
>][<code class="literal">,</CODE
><code class="replaceable"><i>address2</I
></CODE
>]<code class="literal">y/</CODE
><code class="replaceable"><i>abc</I
></CODE
><code class="literal">/</CODE
><code class="replaceable"><i>xyz</I
></CODE
><code class="literal">/</CODE
></P
><p class="para"><a class="indexterm" name="AUTOID-40026"></A
>Translate characters. Change every instance of <code class="replaceable"><i>a</I
></CODE
>
to <code class="replaceable"><i>x</I
></CODE
>, <code class="replaceable"><i>b</I
></CODE
> to <code class="replaceable"><i>y</I
></CODE
>, <code class="replaceable"><i>c</I
></CODE
> to <code class="replaceable"><i>z</I
></CODE
>, etc.
See articles
<a class="xref" href="ch34_12.htm" webstripperlinkwas="ch34_12.htm" title="Transformations on Text ">34.12</A
>
and
<a class="xref" href="ch34_14.htm" webstripperlinkwas="ch34_14.htm" title="Transforming Part of a Line ">34.14</A
>.</P
><p class="para"><em class="emphasis">Example</EM
></P
><p class="para"><blockquote class="screen"><pre class="screen"># Change item 1, 2, 3 to Item A, B, C ...
/^item [1-9]/y/i123456789/IABCDEFGHI/</PRE
></BLOCKQUOTE
></P
></DD
></DL
><a class="indexterm" name="AUTOID-40041"></A
><a class="indexterm" name="AUTOID-40042"></A
><a class="indexterm" name="AUTOID-40046"></A
></DIV
><div class="sect1info"><p class="SECT1INFO">- <span class="authorinitials">DG</SPAN
> <span class="bibliomisc">from O'Reilly &amp; Associates' <cite class="citetitle">UNIX in a Nutshell (SVR4/Solaris)</CITE
></SPAN
></P
></DIV
></DIV
><div class="htmlnav"><p></P
><hr align="LEFT" width="515" title="footer"><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="SECT1" href="ch34_23.htm" webstripperlinkwas="ch34_23.htm" title="34.23 sed Newlines, Quoting, and Backslashes in a Shell Script"><img src="../gifs/txtpreva.gif" webstripperlinkwas="../gifs/txtpreva.gif" alt="Previous: 34.23 sed Newlines, Quoting, and Backslashes in a Shell Script" border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><a class="book" href="index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/upt/index.htm" title="UNIX Power Tools"><img src="../gifs/txthome.gif" webstripperlinkwas="../gifs/txthome.gif" alt="UNIX Power Tools" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="CHAPTER" href="ch35_01.htm" webstripperlinkwas="ch35_01.htm" title="35. You Can't Quite Call This Editing"><img src="../gifs/txtnexta.gif" webstripperlinkwas="../gifs/txtnexta.gif" alt="Next: 35. You Can't Quite Call This Editing" border="0"></A
></TD
></TR
><tr><td align="LEFT" valign="TOP" width="172">34.23 sed Newlines, Quoting, and Backslashes in a Shell Script</TD
><td align="CENTER" valign="TOP" width="171"><a class="index" href="index/idx_0.htm" webstripperlinkwas="index/idx_0.htm" title="Book Index"><img src="../gifs/index.gif" webstripperlinkwas="../gifs/index.gif" alt="Book Index" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172">35. You Can't Quite Call This Editing</TD
></TR
></TABLE
><hr align="LEFT" width="515" title="footer"><img src="../gifs/smnavbar.gif" webstripperlinkwas="../gifs/smnavbar.gif" usemap="#map" border="0" alt="The UNIX CD Bookshelf Navigation"><map name="map"><area shape="RECT" coords="0,0,73,21" href="../index.html" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/index.html" alt="The UNIX CD Bookshelf"><area shape="RECT" coords="74,0,163,21" href="index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/upt/index.htm" alt="UNIX Power Tools"><area shape="RECT" coords="164,0,257,21" href="../unixnut/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/unixnut/index.htm" alt="UNIX in a Nutshell"><area shape="RECT" coords="258,0,321,21" href="../vi/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/vi/index.htm" alt="Learning the vi Editor"><area shape="RECT" coords="322,0,378,21" href="../sedawk/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/sedawk/index.htm" alt="sed &amp; awk"><area shape="RECT" coords="379,0,438,21" href="../ksh/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/ksh/index.htm" alt="Learning the Korn Shell"><area shape="RECT" coords="439,0,514,21" href="../lrnunix/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/lrnunix/index.htm" alt="Learning the UNIX Operating System"></MAP
></DIV
></BODY
></HTML
>
