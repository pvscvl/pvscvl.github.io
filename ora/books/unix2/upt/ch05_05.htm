<html><head><title>[Chapter 5] 5.5 Querying Your Terminal Type: qterm </TITLE
><meta name="DC.title" content="UNIX Power Tools"><meta name="DC.creator" content="Jerry Peek, Tim O'Reilly &amp; Mike Loukides"><meta name="DC.publisher" content="O'Reilly &amp; Associates, Inc."><meta name="DC.date" content="1998-08-04T21:33:03Z"><meta name="DC.type" content="Text.Monograph"><meta name="DC.format" content="text/html" scheme="MIME"><meta name="DC.source" content="1-56592-260-3" scheme="ISBN"><meta name="DC.language" content="en-US"><meta name="generator" content="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><link rev="made" href="mailto:online-books@oreilly.com" title="Online Books Comments"><link rel="up" href="ch05_01.htm" webstripperlinkwas="ch05_01.htm" title="5. Setting Up Your Terminal"><link rel="prev" href="ch05_04.htm" webstripperlinkwas="ch05_04.htm" title="5.4 Setting the TERMCAP Variable with tset "><link rel="next" href="ch05_06.htm" webstripperlinkwas="ch05_06.htm" title="5.6 Checklist: Terminal Hangs When I Log In "></HEAD
><body bgcolor="#FFFFFF" text="#000000"><div class="htmlnav"><h1><img src="gifs/smbanner.gif" webstripperlinkwas="gifs/smbanner.gif" alt="UNIX Power Tools" usemap="#srchmap" border="0"></H1
><map name="srchmap"><area shape="RECT" coords="0,0,466,58" href="index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/upt/index.htm" alt="UNIX Power Tools"><area shape="RECT" coords="467,0,514,18" href="jobjects/fsearch.htm" webstripperlinkwas="jobjects/fsearch.htm" alt="Search this book"></MAP
><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="SECT1" href="ch05_04.htm" webstripperlinkwas="ch05_04.htm" title="5.4 Setting the TERMCAP Variable with tset "><img src="../gifs/txtpreva.gif" webstripperlinkwas="../gifs/txtpreva.gif" alt="Previous: 5.4 Setting the TERMCAP Variable with tset " border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><b><font face="ARIEL,HELVETICA,HELV,SANSERIF" size="-1">Chapter 5<br>Setting Up Your Terminal</FONT
></B
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="SECT1" href="ch05_06.htm" webstripperlinkwas="ch05_06.htm" title="5.6 Checklist: Terminal Hangs When I Log In "><img src="../gifs/txtnexta.gif" webstripperlinkwas="../gifs/txtnexta.gif" alt="Next: 5.6 Checklist: Terminal Hangs When I Log In " border="0"></A
></TD
></TR
></TABLE
>&nbsp;<hr align="LEFT" width="515" title="footer"></DIV
><div class="SECT1"><h2 class="sect1"><a class="title" name="UPT-ART-9013">5.5 Querying Your Terminal Type: qterm </A
></H2
><p class="para"><span class="link"><em class="emphasis">tset</EM
> (<a class="linkend" href="ch05_03.htm" webstripperlinkwas="ch05_03.htm" title="Setting the Terminal Type When You Log In ">5.3</A
>)</SPAN
><a class="indexterm" name="AUTOID-5062"></A
>
is a powerful tool to use if you often log in at different terminals.
You can use <em class="emphasis">tset</EM
> to prompt you with a default terminal type,
giving you the opportunity to specify a new terminal
type when you log in:</P
><p class="para"><blockquote class="screen"><pre class="screen">TERM = (vt100)</PRE
></BLOCKQUOTE
></P
><p class="para">A problem with <em class="emphasis">tset</EM
>, however, is that it requires you to know 
your terminal type.
You might log in at a new terminal and have no
idea what to set the terminal type to.
Or your terminal might be
configured to emulate another terminal type, without your knowledge.
New users in particular tend to be confused by the <em class="emphasis">tset</EM
> prompt.</P
><table class="para.programreference" border="1"><tr><th valign="TOP"><a class="programreference" href="examples/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/upt/examples/index.htm" title="qterm">qterm</A
><br></TH
><td valign="TOP"><a class="indexterm" name="AUTOID-5071"></A
>As an alternative, try Michael Cooper's <em class="emphasis">qterm</EM
> program on our Power Tools
disc.

<em class="emphasis">qterm</EM
> 
sends the terminal a test string and determines what sort of terminal
you're using based on how the terminal responds.
Using <em class="emphasis">qterm</EM
>, you can make sure you always use the correct
terminal type by placing the following line in your <em class="emphasis">.login</EM
>:</TD
></TR
></TABLE
><p class="para"><table class="screen.co" border="1"><tr><th valign="TOP"><pre class="calloutlist">
<a class="co" href="ch09_16.htm" webstripperlinkwas="ch09_16.htm" title="9.16 Command Substitution ">`...`</A
> </PRE
></TH
><td valign="TOP"><pre class="screen">
setenv TERM `qterm`</PRE
></TD
></TR
></TABLE
></P
><p class="para">or in <em class="emphasis">.profile</EM
>:</P
><p class="para"><blockquote class="screen"><pre class="screen">TERM=`qterm`;export TERM</PRE
></BLOCKQUOTE
></P
><p class="para">The advantage of <em class="emphasis">qterm</EM
> is that it sets the terminal type
without your intervention.
You don't need to know what your
terminal type is, it just gets set automatically.</P
><p class="para"><em class="emphasis">qterm</EM
> works by sending the terminal a query string and
returning the terminal type depending on the terminal's response.
<em class="emphasis">qterm</EM
> is configured using a listing of responses and the
terminals they correspond to.
By default, <em class="emphasis">qterm</EM
> looks 
for the listings in a systemwide location, such as 
<em class="emphasis">/usr/usc/lib/qtermtab</EM
> or <em class="emphasis">/usr/local/lib/qtermtab</EM
>.
In addition, you can call <em class="emphasis">qterm</EM
> with the <em class="emphasis">+usrtab</EM
>
option, so that it will look for a file called <em class="emphasis">.qtermtab</EM
>
in your home directory.  </P
><p class="para"><a class="indexterm" name="AUTOID-5097"></A
>The string used to query the terminal is usually ESC&nbsp;Z.
The sample <em class="emphasis">qtermtab</EM
> file distributed with <em class="emphasis">qterm</EM
> 
defines the responses several different terminals 
give for that string:</P
><p class="para"><blockquote class="screen"><pre class="screen">#
# QtermTab - Query terminal table for qterm.
#
#SendStr ReceiveStr         TermName       FullTermName
#
^[Z     ^[[?1;0c            vt100          Base vt100
^[Z     ^[[?1;1c            vt100          vt100 with STP
^[Z     ^[[?1;2c            vt100          ANSI/VT100 Clone
   ...
^[Z     ^[/K                h29            Zenith z29 in zenith mode
^[Z     ^[/Z                vt52           Generic vt52
^[Z     ^[[0n               vt100          AT&amp;T UNIX PC 7300</PRE
></BLOCKQUOTE
></P
><p class="para">If your terminal isn't listed here, you can just add it.
To find
out your terminal's response to the query string, just
echo ESC&nbsp;Z
to your terminal and see what the response is.
For example, I 
logged in from my Macintosh terminal emulator at home and found that
<em class="emphasis">qterm</EM
> didn't recognize my terminal type:</P
><p class="para"><blockquote class="screen"><pre class="screen">% <code class="userinput"><b>qterm</B
></CODE
>
Terminal NOT recognized - defaults to &quot;vt100&quot;.
vt100</PRE
></BLOCKQUOTE
></P
><p class="para"><em class="emphasis">qterm</EM
> defaults to the right terminal description, but I'd still
rather define my own entry.
I find out my terminal's response to the
ESC&nbsp;Z string:</P
><p class="para"><table class="screen.co" border="1"><tr><th valign="TOP"><pre class="calloutlist">
<a class="co" href="ch08_06.htm" webstripperlinkwas="ch08_06.htm" title="8.6 Output Command-Line Arguments ">echo</A
> &#13;</PRE
></TH
><td valign="TOP"><pre class="screen">
% <code class="userinput"><b>echo &quot;^[Z&quot;</B
></CODE
>
^[[E;Y|</PRE
></TD
></TR
></TABLE
></P
><p class="para">(Note that ESC prints as <code class="literal">^[</CODE
>.)
Then I add the entry to my
<em class="emphasis">qterm</EM
> description file:</P
><p class="para"><blockquote class="screen"><pre class="screen">^[Z         ^[[E;Y|         vt100       Macintosh terminal emulator</PRE
></BLOCKQUOTE
></P
><p class="para">Now when I run <em class="emphasis">qterm</EM
>, the terminal is recognized:</P
><p class="para"><blockquote class="screen"><pre class="screen">% <code class="userinput"><b>qterm</B
></CODE
>
Terminal recognized as vt100 (Macintosh terminal emulator)
vt100</PRE
></BLOCKQUOTE
></P
><p class="para">The string <code class="literal">Terminal</CODE
> <code class="literal">recognized</CODE
> <code class="literal">as</CODE
> <code class="literal">...</CODE
>
is sent to
<span class="link">standard error (<a class="linkend" href="ch13_01.htm" webstripperlinkwas="ch13_01.htm#UPT-ART-1023" title="Using Standard Input and Output">13.1</A
>)</SPAN
>;
only the terminal type itself is sent to
<span class="link">standard output (<a class="linkend" href="ch13_01.htm" webstripperlinkwas="ch13_01.htm#UPT-ART-1023" title="Using Standard Input and Output">13.1</A
>)</SPAN
>.
So if you
use the following command line:</P
><p class="para"><blockquote class="screen"><pre class="screen">% <code class="userinput"><b>setenv TERM `qterm`</B
></CODE
>
Terminal recognized as vt100 (Macintosh terminal emulator)</PRE
></BLOCKQUOTE
></P
><p class="para">the TERM variable is set correctly:</P
><p class="para"><blockquote class="screen"><pre class="screen">% <code class="userinput"><b>echo $TERM</B
></CODE
>
vt100</PRE
></BLOCKQUOTE
></P
><p class="para">Now for the caveat: 
<em class="emphasis">qterm</EM
>'s results are only as accurate as the <em class="emphasis">qtermtab</EM
> file. 
Not all terminals respond to the ESC&nbsp;Z string, and you may not be
able to find a string that it does respond uniquely to.
And some
terminals do uncanny imitations of others.
For example, I'm 
currently using an
<span class="link"><em class="emphasis">xterm</EM
> (<a class="linkend" href="ch01_31.htm" webstripperlinkwas="ch01_31.htm" title="The X Window System ">1.31</A
>)</SPAN
>
window, but <em class="emphasis">qterm</EM
>
thinks I'm using a <em class="emphasis">vt100</EM
>:</P
><p class="para"><blockquote class="screen"><pre class="screen">% <code class="userinput"><b>echo $TERM</B
></CODE
>
xterm
% <code class="userinput"><b>qterm</B
></CODE
>
Terminal recognized as vt100 (ANSI/VT100 Clone)
vt100</PRE
></BLOCKQUOTE
></P
><p class="para"><a class="indexterm" name="AUTOID-5150"></A
>As a hack, you can just edit your <em class="emphasis">.qtermtab</EM
> file. 
For example, I could edit my <em class="emphasis">.qtermtab</EM
> so the
<code class="literal">^[[?1;2c</CODE
> response is mapped to <em class="emphasis">xterm</EM
>:</P
><p class="para"><blockquote class="screen"><pre class="screen">#^[Z     ^[[?1;2c            vt100          ANSI/VT100 Clone
^[Z     ^[[?1;2c            xterm          xterm window</PRE
></BLOCKQUOTE
></P
><p class="para">And then call <em class="emphasis">qterm</EM
> with the <em class="emphasis">+usrtab</EM
> command-line option:</P
><p class="para"><blockquote class="screen"><pre class="screen">setenv TERM `qterm +usrtab`</PRE
></BLOCKQUOTE
></P
><div class="sect1info"><p class="SECT1INFO">- <span class="authorinitials">LM</SPAN
></P
></DIV
></DIV
><div class="htmlnav"><p></P
><hr align="LEFT" width="515" title="footer"><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="SECT1" href="ch05_04.htm" webstripperlinkwas="ch05_04.htm" title="5.4 Setting the TERMCAP Variable with tset "><img src="../gifs/txtpreva.gif" webstripperlinkwas="../gifs/txtpreva.gif" alt="Previous: 5.4 Setting the TERMCAP Variable with tset " border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><a class="book" href="index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/upt/index.htm" title="UNIX Power Tools"><img src="../gifs/txthome.gif" webstripperlinkwas="../gifs/txthome.gif" alt="UNIX Power Tools" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="SECT1" href="ch05_06.htm" webstripperlinkwas="ch05_06.htm" title="5.6 Checklist: Terminal Hangs When I Log In "><img src="../gifs/txtnexta.gif" webstripperlinkwas="../gifs/txtnexta.gif" alt="Next: 5.6 Checklist: Terminal Hangs When I Log In " border="0"></A
></TD
></TR
><tr><td align="LEFT" valign="TOP" width="172">5.4 Setting the TERMCAP Variable with tset </TD
><td align="CENTER" valign="TOP" width="171"><a class="index" href="index/idx_0.htm" webstripperlinkwas="index/idx_0.htm" title="Book Index"><img src="../gifs/index.gif" webstripperlinkwas="../gifs/index.gif" alt="Book Index" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172">5.6 Checklist: Terminal Hangs When I Log In </TD
></TR
></TABLE
><hr align="LEFT" width="515" title="footer"><img src="../gifs/smnavbar.gif" webstripperlinkwas="../gifs/smnavbar.gif" usemap="#map" border="0" alt="The UNIX CD Bookshelf Navigation"><map name="map"><area shape="RECT" coords="0,0,73,21" href="../index.html" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/index.html" alt="The UNIX CD Bookshelf"><area shape="RECT" coords="74,0,163,21" href="index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/upt/index.htm" alt="UNIX Power Tools"><area shape="RECT" coords="164,0,257,21" href="../unixnut/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/unixnut/index.htm" alt="UNIX in a Nutshell"><area shape="RECT" coords="258,0,321,21" href="../vi/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/vi/index.htm" alt="Learning the vi Editor"><area shape="RECT" coords="322,0,378,21" href="../sedawk/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/sedawk/index.htm" alt="sed &amp; awk"><area shape="RECT" coords="379,0,438,21" href="../ksh/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/ksh/index.htm" alt="Learning the Korn Shell"><area shape="RECT" coords="439,0,514,21" href="../lrnunix/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/lrnunix/index.htm" alt="Learning the UNIX Operating System"></MAP
></DIV
></BODY
></HTML
>
