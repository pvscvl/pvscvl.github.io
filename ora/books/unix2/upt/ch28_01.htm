<html><head><title>[Chapter 28] Comparing Files</TITLE
><meta name="DC.title" content="UNIX Power Tools"><meta name="DC.creator" content="Jerry Peek, Tim O'Reilly &amp; Mike Loukides"><meta name="DC.publisher" content="O'Reilly &amp; Associates, Inc."><meta name="DC.date" content="1998-08-04T21:44:41Z"><meta name="DC.type" content="Text.Monograph"><meta name="DC.format" content="text/html" scheme="MIME"><meta name="DC.source" content="1-56592-260-3" scheme="ISBN"><meta name="DC.language" content="en-US"><meta name="generator" content="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><link rev="made" href="mailto:online-books@oreilly.com" title="Online Books Comments"><link rel="up" href="part04.htm" webstripperlinkwas="part04.htm" title="IV. Looking Inside Files "><link rel="prev" href="ch27_20.htm" webstripperlinkwas="ch27_20.htm" title="27.20 A Highlighting grep "><link rel="next" href="ch28_02.htm" webstripperlinkwas="ch28_02.htm" title="28.2 Comparing Three Different Versions with diff3 "></HEAD
><body bgcolor="#FFFFFF" text="#000000"><div class="htmlnav"><h1><img src="gifs/smbanner.gif" webstripperlinkwas="gifs/smbanner.gif" alt="UNIX Power Tools" usemap="#srchmap" border="0"></H1
><map name="srchmap"><area shape="RECT" coords="0,0,466,58" href="index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/upt/index.htm" alt="UNIX Power Tools"><area shape="RECT" coords="467,0,514,18" href="jobjects/fsearch.htm" webstripperlinkwas="jobjects/fsearch.htm" alt="Search this book"></MAP
><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="SECT1" href="ch27_20.htm" webstripperlinkwas="ch27_20.htm" title="27.20 A Highlighting grep "><img src="../gifs/txtpreva.gif" webstripperlinkwas="../gifs/txtpreva.gif" alt="Previous: 27.20 A Highlighting grep " border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><b><font face="ARIEL,HELVETICA,HELV,SANSERIF" size="-1">Chapter 28</FONT
></B
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="SECT1" href="ch28_02.htm" webstripperlinkwas="ch28_02.htm" title="28.2 Comparing Three Different Versions with diff3 "><img src="../gifs/txtnexta.gif" webstripperlinkwas="../gifs/txtnexta.gif" alt="Next: 28.2 Comparing Three Different Versions with diff3 " border="0"></A
></TD
></TR
></TABLE
>&nbsp;<hr align="LEFT" width="515" title="footer"></DIV
><div class="CHAPTER"><h1 class="chapter"><a class="title" name="UPT-CHP-28">28. Comparing Files</A
></H1
><div class="htmltoc"><p><b>Contents:</B
><br><a class="sect1" href="#UPT-ART-2680" title="28.1 Checking Differences with diff ">Checking Differences with diff </A
><br><a class="sect1" href="ch28_02.htm" webstripperlinkwas="ch28_02.htm" title="28.2 Comparing Three Different Versions with diff3 ">Comparing Three Different Versions with diff3 </A
><br><a class="sect1" href="ch28_03.htm" webstripperlinkwas="ch28_03.htm" title="28.3 Context diffs ">Context diffs </A
><br><a class="sect1" href="ch28_04.htm" webstripperlinkwas="ch28_04.htm" title="28.4 Side-by-Side diffs: sdiff ">Side-by-Side diffs: sdiff </A
><br><a class="sect1" href="ch28_05.htm" webstripperlinkwas="ch28_05.htm" title="28.5 Comparing Files Alongside One Another ">Comparing Files Alongside One Another </A
><br><a class="sect1" href="ch28_06.htm" webstripperlinkwas="ch28_06.htm" title="28.6 Choosing Sides with sdiff ">Choosing Sides with sdiff </A
><br><a class="sect1" href="ch28_07.htm" webstripperlinkwas="ch28_07.htm" title="28.7 diff for Very Long Files: bdiff ">diff for Very Long Files: bdiff </A
><br><a class="sect1" href="ch28_08.htm" webstripperlinkwas="ch28_08.htm" title="28.8 More Friendly diff Output ">More Friendly diff Output </A
><br><a class="sect1" href="ch28_09.htm" webstripperlinkwas="ch28_09.htm" title="28.9 ex Scripts Built by diff ">ex Scripts Built by diff </A
><br><a class="sect1" href="ch28_10.htm" webstripperlinkwas="ch28_10.htm" title="28.10 Problems with diff and Tabstops ">Problems with diff and Tabstops </A
><br><a class="sect1" href="ch28_11.htm" webstripperlinkwas="ch28_11.htm" title="28.11 cmp and diff ">cmp and diff </A
><br><a class="sect1" href="ch28_12.htm" webstripperlinkwas="ch28_12.htm" title="28.12 Comparing Two Files with comm ">Comparing Two Files with comm </A
><br><a class="sect1" href="ch28_13.htm" webstripperlinkwas="ch28_13.htm" title="28.13 make Isn't Just for Programmers! ">make Isn't Just for Programmers! </A
><br><a class="sect1" href="ch28_14.htm" webstripperlinkwas="ch28_14.htm" title="28.14 Even More Uses for make ">Even More Uses for make </A
><br><a class="sect1" href="ch28_15.htm" webstripperlinkwas="ch28_15.htm" title="28.15 Show Changes in a troff File with diffmk ">Show Changes in a troff File with diffmk </A
></P
><p></P
></DIV
><div class="sect1"><h2 class="sect1"><a class="title" name="UPT-ART-2680">28.1 Checking Differences with diff </A
></H2
><table class="para.programreference" border="1"><tr><th valign="TOP"><a class="programreference" href="examples/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/upt/examples/index.htm" title="diff">diff</A
><br></TH
><td valign="TOP"><a class="indexterm" name="AUTOID-30971"></A
><a class="indexterm" name="AUTOID-30975"></A
><a class="indexterm" name="AUTOID-30979"></A
>
The <em class="emphasis">diff</EM
> command displays different versions of lines that are found when
comparing two files.
(There's also a GNU version on the CD-ROM.)
It prints a message that uses <em class="emphasis">ed</EM
>-like notation (<em class="emphasis">a</EM
> for append,
<em class="emphasis">c</EM
> for change, and <em class="emphasis">d</EM
> for delete) to describe
how a set of lines has changed.
This is followed by the lines themselves.
The <code class="literal">&lt;</CODE
> character precedes lines from the first file and <code class="literal">&gt;</CODE
>
precedes lines from the second file.</TD
></TR
></TABLE
><p class="para">Let's create an example to explain the output produced by <em class="emphasis">diff</EM
>. Look at the contents of three sample files:</P
><table class="informaltable"><thead class="thead"><tr class="row" valign="TOP"><th class="entry" align="LEFT" rowspan="1" colspan="1">test1</TH
><th class="entry" align="LEFT" rowspan="1" colspan="1">test2</TH
><th class="entry" align="LEFT" rowspan="1" colspan="1">test3</TH
></TR
></THEAD
><tbody class="tbody"><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1">apples</TD
><td class="entry" rowspan="1" colspan="1">apples</TD
><td class="entry" rowspan="1" colspan="1">oranges</TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1">oranges</TD
><td class="entry" rowspan="1" colspan="1">oranges</TD
><td class="entry" rowspan="1" colspan="1">walnuts</TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1">walnuts</TD
><td class="entry" rowspan="1" colspan="1">grapes</TD
><td class="entry" rowspan="1" colspan="1">chestnuts</TD
></TR
></TBODY
></TABLE
><p class="para">When you run <em class="emphasis">diff</EM
> on <em class="emphasis">test1</EM
> and <em class="emphasis">test2</EM
>, the following output
is produced:</P
><p class="para"><blockquote class="screen"><pre class="screen">$ <code class="userinput"><b>diff test1 test2</B
></CODE
>
3c3
&lt; walnuts
--
&gt; grapes</PRE
></BLOCKQUOTE
></P
><p class="para"><a class="indexterm" name="AUTOID-31019"></A
>The <em class="emphasis">diff</EM
> command displays the only line that differs between the two files.
To understand the report, remember that <em class="emphasis">diff</EM
> is prescriptive, describing
what changes
need to be made to the first file to make it the same as the second file.
This report specifies that only the third line is affected,
exchanging <code class="literal">walnuts</CODE
> for <code class="literal">grapes</CODE
>.
This is more apparent if you use the <em class="emphasis">-e</EM
> option, which produces an
editing script that can be submitted to <em class="emphasis">ed</EM
>, the UNIX line editor.
(You must
<span class="link">redirect standard output (<a class="linkend" href="ch13_01.htm" webstripperlinkwas="ch13_01.htm#UPT-ART-1023" title="Using Standard Input and Output">13.1</A
>)</SPAN
>
to capture this script in a file.)</P
><p class="para"><blockquote class="screen"><pre class="screen">$ <code class="userinput"><b>diff -e test1 test2</B
></CODE
>
3c

grapes
.</PRE
></BLOCKQUOTE
></P
><p class="para">This script, if run on <em class="emphasis">test1</EM
>, will bring <em class="emphasis">test1</EM
> into agreement with
<em class="emphasis">test2</EM
>.
(Article
<a class="xref" href="ch28_09.htm" webstripperlinkwas="ch28_09.htm" title="ex Scripts Built by diff ">28.9</A
>
describes how to get <em class="emphasis">ed</EM
> to execute this script.)</P
><p class="para">If you compare the first and third files, you find more differences:</P
><p class="para"><blockquote class="screen"><pre class="screen">$ <code class="userinput"><b>diff test1 test3</B
></CODE
>
1dO
&lt; apples
3a3
&gt; chestnuts</PRE
></BLOCKQUOTE
></P
><p class="para">To make <em class="emphasis">test1</EM
> the same as <em class="emphasis">test3</EM
>, you'd have to delete the first line
(apples) and append the third line from <em class="emphasis">test3</EM
> after the third line
in <em class="emphasis">test1</EM
>.
Again, this can be seen more clearly in the editing script produced
by the <em class="emphasis">-e</EM
> option.
Notice that the script specifies editing lines in reverse order;
otherwise, changing the first line would alter all succeeding line numbers.</P
><p class="para"><blockquote class="screen"><pre class="screen">$ <code class="userinput"><b>diff -e test1 test3</B
></CODE
>
3a
chestnuts
.
1d</PRE
></BLOCKQUOTE
></P
><p class="para">So what's this good for?
Here's one example. </P
><p class="para">When working on a document, it is not an uncommon practice to make a copy of
a file and edit the copy rather than the original.
This might be done, for example, if someone other than the writer is
inputing edits from a written copy.
The <em class="emphasis">diff</EM
> command can be used to compare the two versions of a document.
A writer could use it to proof an edited copy against the original.</P
><p class="para"><blockquote class="screen"><pre class="screen">$ <code class="userinput"><b>diff brochure brochure.edits</B
></CODE
>
49c43,44
&lt; environment for program development and communications,
--
&gt; environment for multiprocessing, program development
&gt; and communications, programmers
56c51
&lt; offering even more power and productivity for commericial
--
&gt; offering even more power and productivity for commercial
76c69
&lt; Languages such as FORTRAN, COBOL, Pascal, and C can be
--
&gt; Additional languages such as FORTRAN, COBOL, Pascal, and</PRE
></BLOCKQUOTE
></P
><p class="para">Using <em class="emphasis">diff</EM
> in this manner is a simple way for a writer to examine
changes without reading the entire document.
By redirecting <em class="emphasis">diff</EM
> output to a file, you can keep a
record of changes made to any document.
In fact, just that technique
is used by 
<span class="link">SCCS and RCS (<a class="linkend" href="ch20_12.htm" webstripperlinkwas="ch20_12.htm" title="Protecting Files with SCCS or RCS ">20.12</A
>)</SPAN
>
to manage multiple revisions of source code and documents.</P
><div class="sect1info"><p class="SECT1INFO">- <span class="authorinitials">DD</SPAN
> <span class="bibliomisc">from <cite class="citetitle">UNIX Text Processing</CITE
>, Hayden Books, 1987, Chapter 11</SPAN
></P
></DIV
></DIV
></DIV
><div class="htmlnav"><p></P
><hr align="LEFT" width="515" title="footer"><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="SECT1" href="ch27_20.htm" webstripperlinkwas="ch27_20.htm" title="27.20 A Highlighting grep "><img src="../gifs/txtpreva.gif" webstripperlinkwas="../gifs/txtpreva.gif" alt="Previous: 27.20 A Highlighting grep " border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><a class="book" href="index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/upt/index.htm" title="UNIX Power Tools"><img src="../gifs/txthome.gif" webstripperlinkwas="../gifs/txthome.gif" alt="UNIX Power Tools" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="SECT1" href="ch28_02.htm" webstripperlinkwas="ch28_02.htm" title="28.2 Comparing Three Different Versions with diff3 "><img src="../gifs/txtnexta.gif" webstripperlinkwas="../gifs/txtnexta.gif" alt="Next: 28.2 Comparing Three Different Versions with diff3 " border="0"></A
></TD
></TR
><tr><td align="LEFT" valign="TOP" width="172">27.20 A Highlighting grep </TD
><td align="CENTER" valign="TOP" width="171"><a class="index" href="index/idx_0.htm" webstripperlinkwas="index/idx_0.htm" title="Book Index"><img src="../gifs/index.gif" webstripperlinkwas="../gifs/index.gif" alt="Book Index" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172">28.2 Comparing Three Different Versions with diff3 </TD
></TR
></TABLE
><hr align="LEFT" width="515" title="footer"><img src="../gifs/smnavbar.gif" webstripperlinkwas="../gifs/smnavbar.gif" usemap="#map" border="0" alt="The UNIX CD Bookshelf Navigation"><map name="map"><area shape="RECT" coords="0,0,73,21" href="../index.html" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/index.html" alt="The UNIX CD Bookshelf"><area shape="RECT" coords="74,0,163,21" href="index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/upt/index.htm" alt="UNIX Power Tools"><area shape="RECT" coords="164,0,257,21" href="../unixnut/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/unixnut/index.htm" alt="UNIX in a Nutshell"><area shape="RECT" coords="258,0,321,21" href="../vi/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/vi/index.htm" alt="Learning the vi Editor"><area shape="RECT" coords="322,0,378,21" href="../sedawk/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/sedawk/index.htm" alt="sed &amp; awk"><area shape="RECT" coords="379,0,438,21" href="../ksh/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/ksh/index.htm" alt="Learning the Korn Shell"><area shape="RECT" coords="439,0,514,21" href="../lrnunix/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/lrnunix/index.htm" alt="Learning the UNIX Operating System"></MAP
></DIV
></BODY
></HTML
>
