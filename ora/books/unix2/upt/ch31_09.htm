<html><head><title>[Chapter 31] 31.9 Good Stuff for Your .exrc File </TITLE
><meta name="DC.title" content="UNIX Power Tools"><meta name="DC.creator" content="Jerry Peek, Tim O'Reilly &amp; Mike Loukides"><meta name="DC.publisher" content="O'Reilly &amp; Associates, Inc."><meta name="DC.date" content="1998-08-04T21:46:19Z"><meta name="DC.type" content="Text.Monograph"><meta name="DC.format" content="text/html" scheme="MIME"><meta name="DC.source" content="1-56592-260-3" scheme="ISBN"><meta name="DC.language" content="en-US"><meta name="generator" content="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><link rev="made" href="mailto:online-books@oreilly.com" title="Online Books Comments"><link rel="up" href="ch31_01.htm" webstripperlinkwas="ch31_01.htm" title="31. Creating Custom Commands in vi"><link rel="prev" href="ch31_08.htm" webstripperlinkwas="ch31_08.htm" title="31.8 More Examples of Mapping Keys in vi "><link rel="next" href="ch31_10.htm" webstripperlinkwas="ch31_10.htm" title="31.10 Repeating a vi Keymap "></HEAD
><body bgcolor="#FFFFFF" text="#000000"><div class="htmlnav"><h1><img src="gifs/smbanner.gif" webstripperlinkwas="gifs/smbanner.gif" alt="UNIX Power Tools" usemap="#srchmap" border="0"></H1
><map name="srchmap"><area shape="RECT" coords="0,0,466,58" href="index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/upt/index.htm" alt="UNIX Power Tools"><area shape="RECT" coords="467,0,514,18" href="jobjects/fsearch.htm" webstripperlinkwas="jobjects/fsearch.htm" alt="Search this book"></MAP
><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="SECT1" href="ch31_08.htm" webstripperlinkwas="ch31_08.htm" title="31.8 More Examples of Mapping Keys in vi "><img src="../gifs/txtpreva.gif" webstripperlinkwas="../gifs/txtpreva.gif" alt="Previous: 31.8 More Examples of Mapping Keys in vi " border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><b><font face="ARIEL,HELVETICA,HELV,SANSERIF" size="-1">Chapter 31<br>Creating Custom Commands in vi</FONT
></B
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="SECT1" href="ch31_10.htm" webstripperlinkwas="ch31_10.htm" title="31.10 Repeating a vi Keymap "><img src="../gifs/txtnexta.gif" webstripperlinkwas="../gifs/txtnexta.gif" alt="Next: 31.10 Repeating a vi Keymap " border="0"></A
></TD
></TR
></TABLE
>&nbsp;<hr align="LEFT" width="515" title="footer"></DIV
><div class="SECT1"><h2 class="sect1"><a class="title" name="UPT-ART-0449">31.9 Good Stuff for Your .exrc File </A
></H2
><p class="para">[You probably won't want all of these keymaps and abbreviations.<a class="indexterm" name="UPT-ART-449-IX-EXRC-FILE-EXRC-FILE"></A
>
I always hate to re-map keys unless I really have to-I'd rather
remember the <i class="filename">real</I
> command instead of my special map that
works only from my account.
But not everyone agrees with me.
And I've gotta admit that Tom has some pretty useful-looking customizations
in this file.
Wherever you see <code class="literal">^V</CODE
> in this printout, that means that you type
CTRL-v to
<span class="link"><em class="emphasis">protect the next key from interpretation by </EM
>ex (<a class="linkend" href="ch31_06.htm" webstripperlinkwas="ch31_06.htm" title="Protecting Keys from Interpretation by ex ">31.6</A
>)</SPAN
>.
In that case, the <code class="literal">^V</CODE
> is not stored in the macro.
If you see <i class="filename">two</I
> of them (<code class="literal">^V^V</CODE
>) that sequence will store
an actual CTRL-v in the macro.
The file on the CD-ROM is ready to use: it has the real control
characters stored in it.
Try it!
One more note:
if your fancy hacks to the <i class="filename">.exrc</I
> file don't seem to be working,
watch carefully for error messages just as <i class="filename">vi</I
> starts, before it clears
your screen.
If you can't read them quickly enough, try the tricks in article
<a class="xref" href="ch42_08.htm" webstripperlinkwas="ch42_08.htm" title="Errors Erased Too Soon? Try These Workarounds ">42.8</A
>.
-JP]</P
><p class="para"><table class="screen.co" border="1"><tr><th valign="TOP"><pre class="calloutlist">
&#13;

























<a class="co" href="ch33_04.htm" webstripperlinkwas="ch33_04.htm" title="33.4 Useful ex Commands ">:m</A
> 



<a class="co" href="ch30_04.htm" webstripperlinkwas="ch30_04.htm" title="30.4 Editing Multiple Files with vi ">^^</A
> 


























<a class="co" href="ch26_04.htm" webstripperlinkwas="ch26_04.htm" title="26.4 Using Metacharacters in Regular Expressions ">\&lt;..\&gt;</A
> 





<a class="co" href="ch31_04.htm" webstripperlinkwas="ch31_04.htm" title="31.4 vi @-Functions ">&quot;nDdd`n@n</A
> <a class="co" href="ch30_34.htm" webstripperlinkwas="ch30_34.htm" title="30.34 vi Line Commands vs. Character Commands ">`n</A
> 









<a class="co" href="ch33_04.htm" webstripperlinkwas="ch33_04.htm" title="33.4 Useful ex Commands ">:r!</A
> 


<a class="co" href="ch25_02.htm" webstripperlinkwas="ch25_02.htm" title="25.2 Four Ways to Skin a cat ">cat</A
> <a class="co" href="ch45_20.htm" webstripperlinkwas="ch45_20.htm" title="45.20 Overview: Open Files and File Descriptors ">/dev/tty</A
> 






























<a class="co" href="ch30_22.htm" webstripperlinkwas="ch30_22.htm" title="30.22 Filtering Text Through a UNIX Command ">:%!</A
> 
























<a class="co" href="ch25_04.htm" webstripperlinkwas="ch25_04.htm" title='25.4 The "less&quot; Pager: More than "more&quot;'>less</A
> 



<a class="co" href="ch29_01.htm" webstripperlinkwas="ch29_01.htm" title="29.1 The UNIX spell Command ">spell</A
> 







<a class="co" href="ch30_37.htm" webstripperlinkwas="ch30_37.htm" title="30.37 Neatening Lines ">fmt</A
> 





<a class="co" href="ch41_04.htm" webstripperlinkwas="ch41_04.htm" title="41.4 How UNIX Handles TAB Characters ">expand</A
> 


<a class="co" href="ch34_24.htm" webstripperlinkwas="ch34_24.htm" title="34.24 Quick Reference: sed ">sed</A
> 






<a class="co" href="ch30_31.htm" webstripperlinkwas="ch30_31.htm" title="30.31 vi Word Abbreviation ">ab</A
> 

























&#13;</PRE
></TH
><td valign="TOP"><pre class="screen">
&#13;&quot;   INPUT MACROS that i always want active
&quot;
map! ^Z ^[:stop^M
&quot;   so i can stop in input mode.  note that autowrite is set, so 
map! ^A ^[:stop!^M
&quot;   will stop me without writing.
&quot;
map! ^K ^V^[O
&quot;   lets me do kind of a negative carriage return in input mode.
map! ^V^[^B ^[bi
&quot;   non-destructive ^W
map! ^V^[^F ^[Ea
&quot;   and its inverse
&quot;
&quot;   EMACS Style ARROW MACROS
&quot;
map! ^B ^V^[i
map! ^F ^V^[lli
map! ^A ^V^[I
map! ^E ^V^[A
&quot;
&quot;
&quot;   EXCHANGE MACROS - for exchanging things
&quot;
map v xp
&quot;   exchange current char with next one in edit mode
map V :m+1^M
&quot;   exchange current line with next one in edit mode
map! ^P ^V^[hxpa
&quot;   exchange last typed char with penultimate one in insert mode
map = ^^
&quot;   edit previously edited file
&quot;
&quot;   OTHER MACROS
&quot;
map ^W :w^M
&quot;   write out the file
&quot;
map * i^M^[
&quot;   split line
&quot;
map ^A :stop!^M
&quot;   unconditional stop
map Y y$
&quot;   so Y is analogous to C and D
map ^R ddu
&quot;   single-line redraw
map ^N :n +/^M
&quot;   go to next file in arg list, same position 
&quot;   useful for &quot;vi +/string file1 file2 file3&quot;
&quot;
&quot;
&quot;   META MACROS, all begin with meta-key '\' ; more later in file
&quot;
map ^V^I  \
&quot;   so can use both ^I <i class="filename">[tab -</I
><em class="emphasis">JP </EM
><i class="filename">]</I
> and \ for meta-key
&quot;
map \/ dePo/\&lt;^V^[pA\&gt;^V^[&quot;wdd@w
&quot;   find current word, uses w buffer
&quot;
&quot;
&quot;   INVERT WORD CASE - V is like W, v is like w.  3V is ok, only to EOL.
&quot;   uses both register n and mark n.
map \v ywmno^[P:s/./\~/g^M0&quot;nDdd`n@n
&quot;   abc -&gt; ABC    ABC-&gt;abc
map \V yWmno^[P:s/./\~/g^M0&quot;nDdd`n@n
&quot;   abc.xyz -&gt; ABC.XYZ    ABC.XYZ-&gt;abc.xyz
&quot;
&quot;
&quot;   EXECUTION MACROS - these two are for executing existing lines.
&quot;
map \@ ^V^[&quot;mdd@m
&quot;   execute line as a straight vi command (buffer m, use @@ to repeat)
map \! 0i:r!^V^[&quot;ndd@n
&quot;   execute line as :r! command (buffer n, use @@ to repeat)
&quot;
map \t :r!cat /dev/tty^M
&quot;   read in stuff from X put buffer [in X window system <em class="emphasis">-JP</EM
> ]
&quot;
&quot;
&quot;   BLOCK MACROS - these help when dealing with C blocks
&quot;
map! ^O ^V^V^V{^M^V^V^V} ^V^[O^T
&quot;   this will begin a block, leaving in insert mode
map! ^] ^V^[/^V^V^V}^V^Ma
&quot;   and this will take you past its end, leaving in insert mode
&quot;
&quot;
&quot;
&quot;   LINT MACRO.  deletes all text from &quot;lint output:&quot; and below, (if any)
&quot;   replacing it with lint output in pretty block comment form.  could
&quot;   do sed work myself, but this is faster.  
&quot;
&quot;   the map! is for subsequent map, not by people, 
&quot;   though /^Lo would make sense.
&quot;   this is one of those famous time/space tradeoffs 
&quot;
map! ^Lo lint output
&quot;
&quot;   and now for the real work
map \l Go^M/* ^Lo^M^[/^Lo^MdG:w^Mo/*** ^Lo^[&lt;&lt;
:r!lint -u -lc %^V|sed 's/^/ *  /'^MGo***/^[N
&quot;   <i class="filename">[NOTE: We split the macro above onto two lines for printing.</I
>
&quot;   <i class="filename">Type it on one line in your .exrc file. </I
><em class="emphasis">-JP</EM
> <i class="filename">]</I
>
&quot;
&quot;   indent this for me
&quot;
map \i :%!indent -i4^M
&quot;
&quot;   COMMENTING MACROS - these are actually pretty amazing
&quot;
&quot;   from edit mode, this comments a line [<i class="filename">for the C language </I
><em class="emphasis">-JP</EM
> ]
map ^X ^i/* ^[A */^[^
&quot;
&quot;   and this undoes it
map ^Y :s/\/\* \([^*]*\) \*\//\1^[
&quot;
&quot;   this next one defeats vi's tail-recursion defeatism
&quot;   called by 2 maps following this one 
map! ^N ^V^[:unmap! ^V^V^M^[
&quot;
&quot;   while in insert mode, this will put you &quot;inside&quot; a comment
map! ^X ^V^[:map! ^V^V^M ^V^V^[a^V^V^V^No^[a /*  */^[hhi
&quot;
&quot;   while in edit mode, this begins a block comment - ^N to escape
map \c O/*^M *  ^M*/^[k:map! ^V^V^M ^V^V^M*  ^MA
&quot;
&quot;   and this is for adding more lines to a block comment - ^N to escape
map \o :map! ^V^V^M ^V^V^M*  ^MA
&quot;
&quot;
map _ i_^V^V^V^H^V^[ll
&quot;   this character will now be underlined when less'd, rn'd, etc.
&quot;
&quot;   SPELL MACROS
&quot;
map \s :w^MGo^V^[:$r!spell %^M
&quot;   spell the file, placing errors at bottom, use \n to find
map \n Gdd\/
&quot;   for find next spelling error
&quot;
&quot;
&quot;   FORMATTING MACROS
&quot;
map \P :.,$!fmt -75^M
&quot;   format thru end of document
map \p !}fmt -75^M
&quot;   format paragraph
map \f 1G/--^Mj:.,$!fmt -75^M
&quot;   format message (assumes MH Mail &quot;comp&quot; format)
map \e :%!expand -4^M
&quot;   expand tabs to 4 stops
&quot;
map \r 1G/^-/^[:r!sed -e '1,/^$/d' -e 's/^./&gt; &amp;/' @ ^[/^-/^[j
&quot;   read in @, quoted (for MH replies, who link @ to current file)

map \d :s/$/ $/^M$r 74^V|? ^V^Ms^M^[$xx0
&quot;   split line, like !!fmt but cheaper
&quot;
&quot;<a class="indexterm" name="AUTOID-35508"></A
><a class="indexterm" name="AUTOID-35511"></A
><a class="indexterm" name="AUTOID-35514"></A
>
ab Jan January
ab jan january 
ab Feb February
ab feb february
ab Sep September
ab sep september
ab Oct October
ab oct october
ab Nov November
ab nov november
ab Dec December
ab dec december
ab Xmas Christmas
ab xmas christmas
ab Mon Monday
ab mon monday
ab Tue Tuesday
ab tue tuesday
ab Wed Wednesday
ab wed wednesday
ab Thu Thursday
ab thu thursday
ab Fri Friday
ab fri friday
ab Sat Saturday
ab Sun Sunday
ab Int International
ab info information</PRE
></TD
></TR
></TABLE
></P
><p class="para">[Here's a macro by Greg Ubben that centers your current line:</P
><p class="para"><blockquote class="screen"><pre class="screen">map ^K 80I ^V^[$78hd0^D:s/  / /g^V^M$p</PRE
></BLOCKQUOTE
></P
><p class="para">(<code class="literal">^K</CODE
>, <code class="literal">^V</CODE
>, <code class="literal">^[</CODE
>, and <code class="literal">^M</CODE
> are control characters,
but <code class="literal">^D</CODE
> is <code class="literal">^</CODE
> and <code class="literal">D</CODE
>.)
This centers on an 80-column line.
If any lines are close to 80 characters long now, the macro
will work better with your <em class="emphasis">wrapmargin</EM
> set to 0. <em class="emphasis">-JP</EM
>&nbsp;]<a class="indexterm" name="AUTOID-35531"></A
></P
><div class="sect1info"><p class="SECT1INFO">- <span class="authorinitials">TC</SPAN
></P
></DIV
></DIV
><div class="htmlnav"><p></P
><hr align="LEFT" width="515" title="footer"><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="SECT1" href="ch31_08.htm" webstripperlinkwas="ch31_08.htm" title="31.8 More Examples of Mapping Keys in vi "><img src="../gifs/txtpreva.gif" webstripperlinkwas="../gifs/txtpreva.gif" alt="Previous: 31.8 More Examples of Mapping Keys in vi " border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><a class="book" href="index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/upt/index.htm" title="UNIX Power Tools"><img src="../gifs/txthome.gif" webstripperlinkwas="../gifs/txthome.gif" alt="UNIX Power Tools" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="SECT1" href="ch31_10.htm" webstripperlinkwas="ch31_10.htm" title="31.10 Repeating a vi Keymap "><img src="../gifs/txtnexta.gif" webstripperlinkwas="../gifs/txtnexta.gif" alt="Next: 31.10 Repeating a vi Keymap " border="0"></A
></TD
></TR
><tr><td align="LEFT" valign="TOP" width="172">31.8 More Examples of Mapping Keys in vi </TD
><td align="CENTER" valign="TOP" width="171"><a class="index" href="index/idx_0.htm" webstripperlinkwas="index/idx_0.htm" title="Book Index"><img src="../gifs/index.gif" webstripperlinkwas="../gifs/index.gif" alt="Book Index" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172">31.10 Repeating a vi Keymap </TD
></TR
></TABLE
><hr align="LEFT" width="515" title="footer"><img src="../gifs/smnavbar.gif" webstripperlinkwas="../gifs/smnavbar.gif" usemap="#map" border="0" alt="The UNIX CD Bookshelf Navigation"><map name="map"><area shape="RECT" coords="0,0,73,21" href="../index.html" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/index.html" alt="The UNIX CD Bookshelf"><area shape="RECT" coords="74,0,163,21" href="index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/upt/index.htm" alt="UNIX Power Tools"><area shape="RECT" coords="164,0,257,21" href="../unixnut/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/unixnut/index.htm" alt="UNIX in a Nutshell"><area shape="RECT" coords="258,0,321,21" href="../vi/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/vi/index.htm" alt="Learning the vi Editor"><area shape="RECT" coords="322,0,378,21" href="../sedawk/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/sedawk/index.htm" alt="sed &amp; awk"><area shape="RECT" coords="379,0,438,21" href="../ksh/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/ksh/index.htm" alt="Learning the Korn Shell"><area shape="RECT" coords="439,0,514,21" href="../lrnunix/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/lrnunix/index.htm" alt="Learning the UNIX Operating System"></MAP
></DIV
></BODY
></HTML
>
