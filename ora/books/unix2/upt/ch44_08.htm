<html><head><title>[Chapter 44] 44.8 Test Exit Status with the if Statement </TITLE
><meta name="DC.title" content="UNIX Power Tools"><meta name="DC.creator" content="Jerry Peek, Tim O'Reilly &amp; Mike Loukides"><meta name="DC.publisher" content="O'Reilly &amp; Associates, Inc."><meta name="DC.date" content="1998-08-04T21:53:39Z"><meta name="DC.type" content="Text.Monograph"><meta name="DC.format" content="text/html" scheme="MIME"><meta name="DC.source" content="1-56592-260-3" scheme="ISBN"><meta name="DC.language" content="en-US"><meta name="generator" content="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><link rev="made" href="mailto:online-books@oreilly.com" title="Online Books Comments"><link rel="up" href="ch44_01.htm" webstripperlinkwas="ch44_01.htm" title="44. Shell Programming for the Uninitiated"><link rel="prev" href="ch44_07.htm" webstripperlinkwas="ch44_07.htm" title="44.7 Exit Status of UNIX Processes "><link rel="next" href="ch44_09.htm" webstripperlinkwas="ch44_09.htm" title="44.9 Testing Your Success "></HEAD
><body bgcolor="#FFFFFF" text="#000000"><div class="htmlnav"><h1><img src="gifs/smbanner.gif" webstripperlinkwas="gifs/smbanner.gif" alt="UNIX Power Tools" usemap="#srchmap" border="0"></H1
><map name="srchmap"><area shape="RECT" coords="0,0,466,58" href="index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/upt/index.htm" alt="UNIX Power Tools"><area shape="RECT" coords="467,0,514,18" href="jobjects/fsearch.htm" webstripperlinkwas="jobjects/fsearch.htm" alt="Search this book"></MAP
><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="SECT1" href="ch44_07.htm" webstripperlinkwas="ch44_07.htm" title="44.7 Exit Status of UNIX Processes "><img src="../gifs/txtpreva.gif" webstripperlinkwas="../gifs/txtpreva.gif" alt="Previous: 44.7 Exit Status of UNIX Processes " border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><b><font face="ARIEL,HELVETICA,HELV,SANSERIF" size="-1">Chapter 44<br>Shell Programming for the Uninitiated</FONT
></B
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="SECT1" href="ch44_09.htm" webstripperlinkwas="ch44_09.htm" title="44.9 Testing Your Success "><img src="../gifs/txtnexta.gif" webstripperlinkwas="../gifs/txtnexta.gif" alt="Next: 44.9 Testing Your Success " border="0"></A
></TD
></TR
></TABLE
>&nbsp;<hr align="LEFT" width="515" title="footer"></DIV
><div class="SECT1"><h2 class="sect1"><a class="title" name="UPT-ART-7080">44.8 Test Exit Status with the if Statement </A
></H2
><p class="para"><a class="indexterm" name="AUTOID-50650"></A
><a class="indexterm" name="AUTOID-50653"></A
><a class="indexterm" name="AUTOID-50656"></A
><a class="indexterm" name="AUTOID-50659"></A
><a class="indexterm" name="AUTOID-50662"></A
><a class="indexterm" name="AUTOID-50665"></A
><a class="indexterm" name="AUTOID-50668"></A
>If you are going to write a shell script of any complexity at all, 
you need some way to write &quot;conditional expressions.&quot; Conditional
expressions are nothing more than statements that have a value of
&quot;true&quot; or &quot;false&quot;: like &quot;Have I gotten dressed today?&quot; or &quot;Is it
before 5 p.m.?&quot; or &quot;Does the file <em class="emphasis">indata</EM
> exist?&quot; or &quot;Is the value
of <code class="literal">$aardvark</CODE
> greater than 60?&quot;</P
><p class="para"><a class="indexterm" name="AUTOID-50674"></A
><a class="indexterm" name="AUTOID-50676"></A
><a class="indexterm" name="AUTOID-50679"></A
>The UNIX shell is a complete programming language. Therefore, it
allows you to write &quot;if&quot; statements with conditional expressions&nbsp;- just
like C, Basic, Pascal, or any other language. Conditional expressions
can also be used in several other situations; but most obviously,
they're the basis for any sort of <em class="emphasis">if</EM
> statement. Here's the
syntax of an <em class="emphasis">if</EM
> statement for the Bourne shell:</P
><p class="para"><blockquote class="screen"><pre class="screen">if <code class="replaceable"><i>conditional</I
></CODE
>
then
    # do this if <code class="replaceable"><i>conditional</I
></CODE
> returns a zero (&quot;true&quot;) status
    <code class="replaceable"><i>one-or-more-commands</I
></CODE
>
else
    # do this if <code class="replaceable"><i>conditional</I
></CODE
> returns non-zero (&quot;false&quot;) status
    <code class="replaceable"><i>one-or-more-commands</I
></CODE
>
fi</PRE
></BLOCKQUOTE
></P
><p class="para"><a class="indexterm" name="AUTOID-50691"></A
><a class="indexterm" name="AUTOID-50694"></A
><a class="indexterm" name="AUTOID-50697"></A
><a class="indexterm" name="AUTOID-50700"></A
><a class="indexterm" name="AUTOID-50703"></A
><a class="indexterm" name="AUTOID-50706"></A
>You can omit the <em class="emphasis">else</EM
> and the block of code following it.
However, you can't omit the <em class="emphasis">then</EM
> or the <em class="emphasis">fi</EM
>. If you want to omit the
<em class="emphasis">then</EM
> (i.e., if you want to do something special when
<em class="emphasis">condition</EM
> is false, but nothing when it is true), write the
statement like this:</P
><p class="para"><blockquote class="screen"><pre class="screen">if <code class="replaceable"><i>conditional</I
></CODE
>
then
    :    # do nothing
else
    # do this if <code class="replaceable"><i>conditional</I
></CODE
> returns non-zero (&quot;false&quot;) status
    <code class="replaceable"><i>one-or-more-commands</I
></CODE
>
fi</PRE
></BLOCKQUOTE
></P
><p class="para"><a class="indexterm" name="AUTOID-50720"></A
><a class="indexterm" name="AUTOID-50722"></A
><a class="indexterm" name="AUTOID-50725"></A
><a class="indexterm" name="AUTOID-50728"></A
>Note that this uses a special null command, a
<span class="link">colon (<code class="literal">:</CODE
>) (<a class="linkend" href="ch45_09.htm" webstripperlinkwas="ch45_09.htm" title='The Unappreciated Bourne Shell  ":&quot; Operator'>45.9</A
>)</SPAN
>.
There's another, more useful way of expressing the inverse of a
condition (do something if <em class="emphasis">conditional</EM
> is not &quot;true&quot;), the
<span class="link"><code class="literal">||</CODE
> operator (<a class="linkend" href="ch44_09.htm" webstripperlinkwas="ch44_09.htm" title="Testing Your Success ">44.9</A
>)</SPAN
>
(two vertical bars).</P
><p class="para">Don't forget the <em class="emphasis">fi</EM
> terminating the statement. This is a
surprisingly common source of bugs. (At least for me.)</P
><p class="para">Another common debugging problem:
the manual pages that discuss this material imply that you can smash
the <em class="emphasis">if</EM
>, the <em class="emphasis">then</EM
>, and the <em class="emphasis">else</EM
> onto one line.
Well, it's true, but it's not always easy.
Do yourself a favor: write
your <em class="emphasis">if</EM
> statements <em class="emphasis">exactly</EM
> like the one above. You'll
rarely be disappointed, and you may even start writing programs that
work correctly the first time.</P
><p class="para"><a class="indexterm" name="AUTOID-50746"></A
>Here's a real-life example: a shell script named <em class="emphasis">bkedit</EM
> that makes a
backup copy of a file before editing it.
If <em class="emphasis">cp</EM
> returns a zero status, the script edits the file; otherwise, it
prints a message.
(The <code class="literal">$1</CODE
> is replaced with the first filename from the command
line&nbsp;- see article
<a class="xref" href="ch44_15.htm" webstripperlinkwas="ch44_15.htm" title="Handling Command-Line Arguments in Shell Scripts ">44.15</A
>.)</P
><p class="para"><table class="screen.co" border="1"><tr><th valign="TOP"><pre class="calloutlist">
&#13;



<a class="co" href="ch08_06.htm" webstripperlinkwas="ch08_06.htm" title="8.6 Output Command-Line Arguments ">1&gt;&amp;2</A
> &#13;</PRE
></TH
><td valign="TOP"><pre class="screen">
#!/bin/sh
if cp &quot;$1&quot; &quot;$1.bak&quot;
then
    vi &quot;$1&quot;
else
    echo &quot;bkedit quitting: can't make backup?&quot; 1&gt;&amp;2
fi</PRE
></TD
></TR
></TABLE
></P
><p class="para">You can try typing in that shell script and running it.
Or, just type in
the lines (starting with the <code class="literal">if</CODE
>) on a terminal running the
Bourne shell; use a real filename instead of <code class="literal">$1</CODE
>.</P
><p class="para">The <em class="emphasis">if</EM
> statement is often used with a command named
<span class="link"><em class="emphasis">test</EM
> (<a class="linkend" href="ch44_20.htm" webstripperlinkwas="ch44_20.htm" title="test: Testing Files and Strings ">44.20</A
>)</SPAN
>.
The <em class="emphasis">test</EM
> command does a test and returns an exit status of 0 or 1.</P
><div class="sect1info"><p class="SECT1INFO">- <span class="authorinitials">ML</SPAN
>, <span class="authorinitials">JP</SPAN
></P
></DIV
></DIV
><div class="htmlnav"><p></P
><hr align="LEFT" width="515" title="footer"><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="SECT1" href="ch44_07.htm" webstripperlinkwas="ch44_07.htm" title="44.7 Exit Status of UNIX Processes "><img src="../gifs/txtpreva.gif" webstripperlinkwas="../gifs/txtpreva.gif" alt="Previous: 44.7 Exit Status of UNIX Processes " border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><a class="book" href="index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/upt/index.htm" title="UNIX Power Tools"><img src="../gifs/txthome.gif" webstripperlinkwas="../gifs/txthome.gif" alt="UNIX Power Tools" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="SECT1" href="ch44_09.htm" webstripperlinkwas="ch44_09.htm" title="44.9 Testing Your Success "><img src="../gifs/txtnexta.gif" webstripperlinkwas="../gifs/txtnexta.gif" alt="Next: 44.9 Testing Your Success " border="0"></A
></TD
></TR
><tr><td align="LEFT" valign="TOP" width="172">44.7 Exit Status of UNIX Processes </TD
><td align="CENTER" valign="TOP" width="171"><a class="index" href="index/idx_0.htm" webstripperlinkwas="index/idx_0.htm" title="Book Index"><img src="../gifs/index.gif" webstripperlinkwas="../gifs/index.gif" alt="Book Index" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172">44.9 Testing Your Success </TD
></TR
></TABLE
><hr align="LEFT" width="515" title="footer"><img src="../gifs/smnavbar.gif" webstripperlinkwas="../gifs/smnavbar.gif" usemap="#map" border="0" alt="The UNIX CD Bookshelf Navigation"><map name="map"><area shape="RECT" coords="0,0,73,21" href="../index.html" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/index.html" alt="The UNIX CD Bookshelf"><area shape="RECT" coords="74,0,163,21" href="index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/upt/index.htm" alt="UNIX Power Tools"><area shape="RECT" coords="164,0,257,21" href="../unixnut/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/unixnut/index.htm" alt="UNIX in a Nutshell"><area shape="RECT" coords="258,0,321,21" href="../vi/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/vi/index.htm" alt="Learning the vi Editor"><area shape="RECT" coords="322,0,378,21" href="../sedawk/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/sedawk/index.htm" alt="sed &amp; awk"><area shape="RECT" coords="379,0,438,21" href="../ksh/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/ksh/index.htm" alt="Learning the Korn Shell"><area shape="RECT" coords="439,0,514,21" href="../lrnunix/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/lrnunix/index.htm" alt="Learning the UNIX Operating System"></MAP
></DIV
></BODY
></HTML
>
