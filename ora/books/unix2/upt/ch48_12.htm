<html><head><title>[Chapter 48] 48.12 Using index with a Filter </TITLE
><meta name="DC.title" content="UNIX Power Tools"><meta name="DC.creator" content="Jerry Peek, Tim O'Reilly &amp; Mike Loukides"><meta name="DC.publisher" content="O'Reilly &amp; Associates, Inc."><meta name="DC.date" content="1998-10-23T15:55:40Z"><meta name="DC.type" content="Text.Monograph"><meta name="DC.format" content="text/html" scheme="MIME"><meta name="DC.source" content="1-56592-260-3" scheme="ISBN"><meta name="DC.language" content="en-US"><meta name="generator" content="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><link rev="made" href="mailto:online-books@oreilly.com" title="Online Books Comments"><link rel="up" href="ch48_01.htm" webstripperlinkwas="ch48_01.htm" title="48. Office Automation"><link rel="prev" href="ch48_11.htm" webstripperlinkwas="ch48_11.htm" title="48.11 The index Database Program "><link rel="next" href="ch49_01.htm" webstripperlinkwas="ch49_01.htm" title="49. Working with Numbers"></HEAD
><body bgcolor="#FFFFFF" text="#000000"><div class="htmlnav"><h1><img src="gifs/smbanner.gif" webstripperlinkwas="gifs/smbanner.gif" alt="UNIX Power Tools" usemap="#srchmap" border="0"></H1
><map name="srchmap"><area shape="RECT" coords="0,0,466,58" href="index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/upt/index.htm" alt="UNIX Power Tools"><area shape="RECT" coords="467,0,514,18" href="jobjects/fsearch.htm" webstripperlinkwas="jobjects/fsearch.htm" alt="Search this book"></MAP
><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="SECT1" href="ch48_11.htm" webstripperlinkwas="ch48_11.htm" title="48.11 The index Database Program "><img src="../gifs/txtpreva.gif" webstripperlinkwas="../gifs/txtpreva.gif" alt="Previous: 48.11 The index Database Program " border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><b><font face="ARIEL,HELVETICA,HELV,SANSERIF" size="-1">Chapter 48<br>Office Automation</FONT
></B
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="CHAPTER" href="ch49_01.htm" webstripperlinkwas="ch49_01.htm" title="49. Working with Numbers"><img src="../gifs/txtnexta.gif" webstripperlinkwas="../gifs/txtnexta.gif" alt="Next: 49. Working with Numbers" border="0"></A
></TD
></TR
></TABLE
>&nbsp;<hr align="LEFT" width="515" title="footer"></DIV
><div class="SECT1"><h2 class="sect1"><a class="title" name="UPT-ART-9028">48.12 Using index with a Filter </A
></H2
><p class="para"><a class="indexterm" name="AUTOID-58388"></A
><a class="indexterm" name="AUTOID-58391"></A
>A particularly useful feature of the
<span class="link"><em class="emphasis">index</EM
> (<a class="linkend" href="ch48_11.htm" webstripperlinkwas="ch48_11.htm" title="The index Database Program ">48.11</A
>)</SPAN
>
program is that you can use
the <em class="emphasis">-f</EM
> option to filter
the output. 
When a filter is used, the <em class="emphasis">index</EM
> program produces output in 
TAB-separated columns.
Instead of listing each matching entry individually,
the field titles are shown at the top, and each entry then appears
underneath, displayed horizontally, with TABs between fields:</P
><p class="para"><blockquote class="screen"><pre class="screen">% <code class="userinput"><b>index -f 'sed s/Mui/Mud/' addresses Peter</B
></CODE
>
NAME    TITLE   ORGANIZATION    STREET ADDRESS  CITY    STATE   ...
Henry K Smith           Peter Johnson &amp; Associates      324 Bur ...
Peter Mud       International Sales Manager     O'Reilly and As ...
Peter L. Loos   President       Introspective Solutions, Inc.   ...</PRE
></BLOCKQUOTE
></P
><p class="para"><a class="indexterm" name="AUTOID-58402"></A
>The TAB-separated fields don't line up properly on your screen, but
they make it convenient to manipulate columns using
<span class="link"><em class="emphasis">cut</EM
> (<a class="linkend" href="ch35_14.htm" webstripperlinkwas="ch35_14.htm" title="Cutting Columns or Fields with cut ">35.14</A
>)</SPAN
>,
<span class="link"><em class="emphasis">awk</EM
> (<a class="linkend" href="ch33_11.htm" webstripperlinkwas="ch33_11.htm" title="Quick Reference: awk ">33.11</A
>)</SPAN
>,
or
<span class="link"><em class="emphasis">perl</EM
> (<a class="linkend" href="ch37_01.htm" webstripperlinkwas="ch37_01.htm#UPT-ART-5560" title="What We Do and Don't Tell You About Perl ">37.1</A
>)</SPAN
>.
For example, you can
use the <em class="emphasis">cut</EM
> command as your filter to limit the output to a few
significant fields:</P
><p class="para"><blockquote class="screen"><pre class="screen">% <code class="userinput"><b>index -f 'cut -f1,8,10' addresses '.'</B
></CODE
>
NAME    VOICE PHONE NUMBER      EMAIL ADDRESS
Henry K Smith   617-555-1212    henry@pja
Paul S. Spencer        617-693-1111    paul@lotus.com
Peter Mui       800-998-9938    peter@ora.com</PRE
></BLOCKQUOTE
></P
><p class="para">(We use <code class="literal">'.'</CODE
> as the search string to match all entries.)</P
><p class="para"><a class="indexterm" name="AUTOID-58418"></A
><a class="indexterm" name="AUTOID-58421"></A
><a class="indexterm" name="AUTOID-58423"></A
>For your convenience, you can write up a shell script as a filter
and place it in your <em class="emphasis">$HOME/.index</EM
> directory with a <em class="emphasis">.fmt</EM
>
suffix.
This feature comes in useful for particularly complicated filter
programs.
For example, if you want
to be able to read the output of the previous
example properly, you can try using
<em class="emphasis">awk</EM
> as shown in article
<a class="xref" href="ch35_22.htm" webstripperlinkwas="ch35_22.htm" title="Straightening Jagged Columns ">35.22</A
>,
or you can just use
<span class="link"><em class="emphasis">tbl</EM
> (<a class="linkend" href="ch43_15.htm" webstripperlinkwas="ch43_15.htm" title="From a Source File to the Printer ">43.15</A
>)</SPAN
>
and
<span class="link"><em class="emphasis">nroff</EM
> (<a class="linkend" href="ch43_13.htm" webstripperlinkwas="ch43_13.htm" title="The Text Formatters nroff, troff, ditroff, ... ">43.13</A
>)</SPAN
>.
To do this in a single step, try writing a filter
[Linda is a great typist; she uses
<span class="link"><code class="literal">cat&nbsp;&gt;&gt;</CODE
> (<a class="linkend" href="ch25_02.htm" webstripperlinkwas="ch25_02.htm" title="Four Ways to Skin a cat ">25.2</A
>)</SPAN
>
to write short shell scripts (and show the script at the same time).
A text editor like
Emacs or <em class="emphasis">vi</EM
> will do fine, too, of course. -<em class="emphasis">JP</EM
>&nbsp;]:</P
><p class="para"><table class="screen.co" border="1"><tr><th valign="TOP"><pre class="calloutlist">
<a class="co" href="ch14_11.htm" webstripperlinkwas="ch14_11.htm" title="14.11 Finding (Anyone's) Home Directory, Quickly ">~</A
> 


<a class="co" href="ch01_05.htm" webstripperlinkwas="ch01_05.htm" title="1.5 Anyone Can Program the Shell ">chmod +x</A
> 



&#13;</PRE
></TH
><td valign="TOP"><pre class="screen">
&#13;% <code class="userinput"><b>cat &gt;&gt; /.index/printinfo.fmt
#! /bin/sh
cut -f1,8,10 | sed '
1i\
.TS\
l l l.
$a\
.TE' | tbl | nroff | col</B
></CODE
>
<kbd class="keycap">[CTRL-d]</KBD
>
% <code class="userinput"><b>chmod +x ~/.index/printinfo.fmt</B
></CODE
>
% <code class="userinput"><b>index -f printinfo addresses '.'</B
></CODE
>
NAME                VOICE PHONE NUMBER   EMAIL ADDRESS
Henry K Smith       617-555-1212         henry@pja
Paul S. Spencer     617-693-1111         paul@lotus.com
Peter Mui           800-998-9938         peter@ora.com</PRE
></TD
></TR
></TABLE
></P
><div class="sect1info"><p class="SECT1INFO">- <span class="authorinitials">LM</SPAN
></P
></DIV
></DIV
><div class="htmlnav"><p></P
><hr align="LEFT" width="515" title="footer"><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="SECT1" href="ch48_11.htm" webstripperlinkwas="ch48_11.htm" title="48.11 The index Database Program "><img src="../gifs/txtpreva.gif" webstripperlinkwas="../gifs/txtpreva.gif" alt="Previous: 48.11 The index Database Program " border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><a class="book" href="index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/upt/index.htm" title="UNIX Power Tools"><img src="../gifs/txthome.gif" webstripperlinkwas="../gifs/txthome.gif" alt="UNIX Power Tools" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="CHAPTER" href="ch49_01.htm" webstripperlinkwas="ch49_01.htm" title="49. Working with Numbers"><img src="../gifs/txtnexta.gif" webstripperlinkwas="../gifs/txtnexta.gif" alt="Next: 49. Working with Numbers" border="0"></A
></TD
></TR
><tr><td align="LEFT" valign="TOP" width="172">48.11 The index Database Program </TD
><td align="CENTER" valign="TOP" width="171"><a class="index" href="index/idx_0.htm" webstripperlinkwas="index/idx_0.htm" title="Book Index"><img src="../gifs/index.gif" webstripperlinkwas="../gifs/index.gif" alt="Book Index" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172">49. Working with Numbers</TD
></TR
></TABLE
><hr align="LEFT" width="515" title="footer"><img src="../gifs/smnavbar.gif" webstripperlinkwas="../gifs/smnavbar.gif" usemap="#map" border="0" alt="The UNIX CD Bookshelf Navigation"><map name="map"><area shape="RECT" coords="0,0,73,21" href="../index.html" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/index.html" alt="The UNIX CD Bookshelf"><area shape="RECT" coords="74,0,163,21" href="index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/upt/index.htm" alt="UNIX Power Tools"><area shape="RECT" coords="164,0,257,21" href="../unixnut/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/unixnut/index.htm" alt="UNIX in a Nutshell"><area shape="RECT" coords="258,0,321,21" href="../vi/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/vi/index.htm" alt="Learning the vi Editor"><area shape="RECT" coords="322,0,378,21" href="../sedawk/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/sedawk/index.htm" alt="sed &amp; awk"><area shape="RECT" coords="379,0,438,21" href="../ksh/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/ksh/index.htm" alt="Learning the Korn Shell"><area shape="RECT" coords="439,0,514,21" href="../lrnunix/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/lrnunix/index.htm" alt="Learning the UNIX Operating System"></MAP
></DIV
></BODY
></HTML
>
