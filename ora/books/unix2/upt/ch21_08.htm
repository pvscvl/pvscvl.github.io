<html><head><title>[Chapter 21] 21.8 The MAILCHECK and mail Variables Check More than Mail</TITLE
><meta name="DC.title" content="UNIX Power Tools"><meta name="DC.creator" content="Jerry Peek, Tim O'Reilly &amp; Mike Loukides"><meta name="DC.publisher" content="O'Reilly &amp; Associates, Inc."><meta name="DC.date" content="1998-08-04T21:40:08Z"><meta name="DC.type" content="Text.Monograph"><meta name="DC.format" content="text/html" scheme="MIME"><meta name="DC.source" content="1-56592-260-3" scheme="ISBN"><meta name="DC.language" content="en-US"><meta name="generator" content="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><link rev="made" href="mailto:online-books@oreilly.com" title="Online Books Comments"><link rel="up" href="ch21_01.htm" webstripperlinkwas="ch21_01.htm" title="21. More About Managing Files"><link rel="prev" href="ch21_07.htm" webstripperlinkwas="ch21_07.htm" title="21.7 Setting File Modification Time with touch "><link rel="next" href="ch21_09.htm" webstripperlinkwas="ch21_09.htm" title="21.9 Keep File Printouts Up-to-Date Automatically with make"></HEAD
><body bgcolor="#FFFFFF" text="#000000"><div class="htmlnav"><h1><img src="gifs/smbanner.gif" webstripperlinkwas="gifs/smbanner.gif" alt="UNIX Power Tools" usemap="#srchmap" border="0"></H1
><map name="srchmap"><area shape="RECT" coords="0,0,466,58" href="index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/upt/index.htm" alt="UNIX Power Tools"><area shape="RECT" coords="467,0,514,18" href="jobjects/fsearch.htm" webstripperlinkwas="jobjects/fsearch.htm" alt="Search this book"></MAP
><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="SECT1" href="ch21_07.htm" webstripperlinkwas="ch21_07.htm" title="21.7 Setting File Modification Time with touch "><img src="../gifs/txtpreva.gif" webstripperlinkwas="../gifs/txtpreva.gif" alt="Previous: 21.7 Setting File Modification Time with touch " border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><b><font face="ARIEL,HELVETICA,HELV,SANSERIF" size="-1">Chapter 21<br>More About Managing Files</FONT
></B
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="SECT1" href="ch21_09.htm" webstripperlinkwas="ch21_09.htm" title="21.9 Keep File Printouts Up-to-Date Automatically with make"><img src="../gifs/txtnexta.gif" webstripperlinkwas="../gifs/txtnexta.gif" alt="Next: 21.9 Keep File Printouts Up-to-Date Automatically with make" border="0"></A
></TD
></TR
></TABLE
>&nbsp;<hr align="LEFT" width="515" title="footer"></DIV
><div class="SECT1"><h2 class="sect1"><a class="title" name="UPT-ART-1220">21.8 The MAILCHECK and mail Variables Check More than Mail</A
></H2
><p class="para"><a class="indexterm" name="AUTOID-23296"></A
>Depending on how your system is set up, you may notice that it
periodically says something like <code class="literal">You have new mail</CODE
>.
When you run your
<span class="link">mail program (<a class="linkend" href="ch01_33.htm" webstripperlinkwas="ch01_33.htm" title="UNIX Networking and Communications ">1.33</A
>)</SPAN
>,
the mail will be waiting for you in your mailbox.
You can also use this feature to check for changes
in several mailboxes, as well as changes in files and directories that don't
hold mail&nbsp;- more about that in a minute.</P
><div class="sect2"><h3 class="sect2"><a class="title" name="UPT-ART-1220-SECT-1.1">21.8.1 For C Shell Users </A
></H3
><p class="para"><a class="indexterm" name="AUTOID-23304"></A
>If you use the C shell, this feature is controlled
by the <em class="emphasis">mail</EM
> shell variable (usually set in your
<span class="link"><em class="emphasis">.cshrc</EM
> file (<a class="linkend" href="ch02_03.htm" webstripperlinkwas="ch02_03.htm" title="What Goes in Shell Setup Files? ">2.3</A
>)</SPAN
>).</P
><p class="para">The shell normally checks your mailbox every five minutes.
However, you can set a different interval at the start of
the list. For example, the command below tells the shell to check
my mailbox every 60 seconds:</P
><p class="para"><blockquote class="screen"><pre class="screen">% <code class="userinput"><b>set mail=(60 /usr/spool/mail/mikel)</B
></CODE
></PRE
></BLOCKQUOTE
></P
><p class="para">Note that the exact filename depends upon how your mail system is
set up.
For example, many systems use <em class="emphasis">/usr/mail</EM
> instead of <em class="emphasis">/usr/spool/mail</EM
>.
Checking for mail takes time and can delay your prompt on busy systems.
Don't set a short interval unless you need to.</P
><div class="sect3"><h4 class="sect3"><a class="title" name="UPT-ART-1220-SECT-1.1.1">21.8.1.1 Multiple Mailboxes </A
></H4
><p class="para"><a class="indexterm" name="AUTOID-23320"></A
><a class="indexterm" name="AUTOID-23323"></A
>Many users need to watch more than one mailbox. For example, I need
to watch <em class="emphasis">/usr/spool/mail/mikel</EM
>; but if I'm responsible for
product support, and my company maintains a special mail ID for
support questions, I might also want to watch
<em class="emphasis">/usr/spool/mail/prodsupport</EM
>. To do this, we set the <em class="emphasis">mail</EM
>
variable so that it's a list of important files and directories:</P
><p class="para"><blockquote class="screen"><pre class="screen">% <code class="userinput"><b>set mail=(/usr/spool/mail/mikel /usr/spool/mail/prodsupport)</B
></CODE
></PRE
></BLOCKQUOTE
></P
><p class="para">&#13;When the list has more than one file, the shell will tell you which file
has changed with a message like <code class="literal">new mail in /usr/spool/mail/prodsupport</CODE
>.</P
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="UPT-ART-1220-SECT-1.1.2">21.8.1.2 Watching Other Files </A
></H4
><p class="para"><a class="indexterm" name="AUTOID-23337"></A
>All <em class="emphasis">mail</EM
> is doing is looking to see whether or not the file has
changed; it doesn't know that it's looking at a &quot;mail&quot; file.
Therefore, you can use it to watch anything you want; your list 
can even include directories. For example, let's say that
you're running a program that 
periodically writes to the file
<em class="emphasis">/home/los/mikel/radio/log.out</EM
>. Then you can set <em class="emphasis">mail</EM
> as
follows:</P
><p class="para"><blockquote class="screen"><pre class="screen">% <code class="userinput"><b>set mail=(/home/los/mikel/radio/log.out </B
></CODE
><code class="replaceable"><i>other-files</I
></CODE
><code class="userinput"><b>)</B
></CODE
></PRE
></BLOCKQUOTE
></P
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="UPT-ART-1220-SECT-1.1.3">21.8.1.3 Watching Directories </A
></H4
><p class="para"><a class="indexterm" name="AUTOID-23351"></A
>Watching a directory is
the same as watching a file; you'll be notified whenever the directory
changes (whenever a file is
added or deleted in the directory). So let's modify our previous example
slightly; let's say that your reports are named
<em class="emphasis">/home/los/mikel/radio/log/</EM
><code class="replaceable"><i>date</I
></CODE
>, where the <em class="emphasis">date</EM
>
indicates when the report was created. Every report thus generates a
new file. In this case, you'd want to watch the log directory for the
creation of new files.</P
><p class="para"><blockquote class="screen"><pre class="screen">% <code class="userinput"><b>set mail=(/home/los/mikel/radio/log </B
></CODE
><code class="replaceable"><i>other-files</I
></CODE
><code class="userinput"><b>)</B
></CODE
></PRE
></BLOCKQUOTE
></P
><p class="para">Here's another example. Let's say that you suspect someone is using
<span class="link">UUCP (<a class="linkend" href="ch01_33.htm" webstripperlinkwas="ch01_33.htm" title="UNIX Networking and Communications ">1.33</A
>)</SPAN
>
to send company secrets to a system named <em class="emphasis">somewhere</EM
>.
You want to watch this systems's UUCP traffic very carefully. To do
so, you can tell the shell to inform you whenever the logfile changes:</P
><p class="para"><blockquote class="screen"><pre class="screen">% <code class="userinput"><b>set mail=(5 /usr/spool/uucp/.Log/uucico/somewhere)</B
></CODE
></PRE
></BLOCKQUOTE
></P
><p class="para">We've told the shell to check the log every five seconds because,
given that we suspect security problems, we want to get our reports
immediately.</P
><p class="para">If the directory you're watching is actually a
<span class="link">symbolic link (<a class="linkend" href="ch18_04.htm" webstripperlinkwas="ch18_04.htm" title="More About Links ">18.4</A
>)</SPAN
>
to another
directory,
be sure to check the actual directory and not the link.<a class="indexterm" name="AUTOID-23371"></A
><a class="indexterm" name="AUTOID-23373"></A
>
The
<span class="link"><em class="emphasis">sl</EM
> (<a class="linkend" href="ch18_08.htm" webstripperlinkwas="ch18_08.htm" title="Showing the Actual Filenames for Symbolic Links ">18.8</A
>)</SPAN
>
script is handy for this&nbsp;- or you can use
<span class="link"><em class="emphasis">ls -ld</EM
> (<a class="linkend" href="ch16_08.htm" webstripperlinkwas="ch16_08.htm" title="The ls -d Option ">16.8</A
>)</SPAN
>:</P
><p class="para"><blockquote class="screen"><pre class="screen">% <code class="userinput"><b>ls -ld /usr/local/logs</B
></CODE
>
lrwxrwxrwx  1 root    15 Jul 10  1990 /usr/local/logs -&gt; /foo/bar/logs
% <code class="userinput"><b>ls -ld /foo/bar/logs</B
></CODE
>
drwxrwxr-x  2 root  512 Aug 10 12:20 /foo/bar/logs
% <code class="userinput"><b>set mail=(/foo/bar/logs)</B
></CODE
></PRE
></BLOCKQUOTE
></P
></DIV
></DIV
><div class="sect2"><h3 class="sect2"><a class="title" name="UPT-ART-1220-SECT-1.2">21.8.2 For Bourne Shell Users </A
></H3
><p class="para"><a class="indexterm" name="AUTOID-23388"></A
>Now, let's assume that you're a Bourne shell user, and go through
everything once more. The Bourne shell uses three variables to
control mail notification.
(These are usually set in users'
<span class="link"><em class="emphasis">.profile</EM
> (<a class="linkend" href="ch02_02.htm" webstripperlinkwas="ch02_02.htm" title="Shell Setup Files-Which, Where, and Why ">2.2</A
>)</SPAN
>
files.
To make them work in
<span class="link">subshells (<a class="linkend" href="ch38_04.htm" webstripperlinkwas="ch38_04.htm" title="Subshells ">38.4</A
>)</SPAN
>,
<span class="link"><em class="emphasis">export</EM
> (<a class="linkend" href="ch06_01.htm" webstripperlinkwas="ch06_01.htm#UPT-ART-1170" title="What Environment Variables Are Good For ">6.1</A
>)</SPAN
>
the variables.)
We'll assume that you read the C shell
description already given, and move a bit faster.</P
><p class="para">First, if you want to check only one file or directory, set the
variable <em class="emphasis">MAIL</EM
> accordingly.</P
><p class="para"><blockquote class="screen"><pre class="screen">$ <code class="userinput"><b>MAIL=/usr/spool/mail/mikel</B
></CODE
>
$ <code class="userinput"><b>export MAIL</B
></CODE
></PRE
></BLOCKQUOTE
></P
><blockquote class="note"><p class="para"><strong>NOTE:</STRONG
> The next three features don't work on some Bourne shells.</P
></BLOCKQUOTE
><p class="para">By default, the Bourne shell checks every ten minutes.<a class="indexterm" name="AUTOID-23405"></A
>
To check at some other interval, set the variable <em class="emphasis">MAILCHECK</EM
> to your
new interval, in seconds: for example, the command below tells the
shell to check every 55 seconds:</P
><p class="para"><blockquote class="screen"><pre class="screen">$ <code class="userinput"><b>MAILCHECK=55</B
></CODE
></PRE
></BLOCKQUOTE
></P
><p class="para">&#13;One useful trick: if you set <em class="emphasis">MAILCHECK</EM
> to 0, the shell will check
whenever it prints the &quot;primary&quot; prompt (by default, <code class="literal">$</CODE
>).
In other
words, it will check after each command.
This may be slow on busy systems.</P
><p class="para"><a class="indexterm" name="AUTOID-23415"></A
>If you want to watch several files, use the <em class="emphasis">MAILPATH</EM
> variable. Its
value must be a list of file or directory names, separated by colons.
For example:</P
><p class="para"><blockquote class="screen"><pre class="screen">$ <code class="userinput"><b>MAILPATH=/usr/spool/mail/mikel:/usr/spool/mail/prodsupport</B
></CODE
></PRE
></BLOCKQUOTE
></P
><p class="para">If <em class="emphasis">MAILPATH</EM
> is set, the shell will ignore the <em class="emphasis">MAIL</EM
>
variable. You can't use both.</P
><p class="para">Normally,
the Bourne shell prints <code class="literal">you have mail</CODE
> whenever any file that it's
watching changes. However, 
if you follow a filename
in <em class="emphasis">MAILPATH</EM
> with a percent sign (<code class="literal">%</CODE
>) and a message,
the shell will print
the message whenever the file changes. For example, let's have the shell
print <code class="literal">you have mail</CODE
> when mail comes in and
<code class="literal">New log!</CODE
> when a log file changes:</P
><p class="para"><blockquote class="screen"><pre class="screen">$ <code class="userinput"><b>MAILPATH=/usr/spool/mail/mikel:/home/mikel/Z/log%&quot;New log!&quot;</B
></CODE
></PRE
></BLOCKQUOTE
></P
><p class="para">You can create a different message for every file that you care about.
Note that the Korn shell and <em class="emphasis">bash</EM
> use <code class="literal">?</CODE
> (a question mark)
instead of the <code class="literal">%</CODE
> before each message.</P
></DIV
><div class="sect1info"><p class="SECT1INFO">- <span class="authorinitials">ML</SPAN
></P
></DIV
></DIV
><div class="htmlnav"><p></P
><hr align="LEFT" width="515" title="footer"><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="SECT1" href="ch21_07.htm" webstripperlinkwas="ch21_07.htm" title="21.7 Setting File Modification Time with touch "><img src="../gifs/txtpreva.gif" webstripperlinkwas="../gifs/txtpreva.gif" alt="Previous: 21.7 Setting File Modification Time with touch " border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><a class="book" href="index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/upt/index.htm" title="UNIX Power Tools"><img src="../gifs/txthome.gif" webstripperlinkwas="../gifs/txthome.gif" alt="UNIX Power Tools" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="SECT1" href="ch21_09.htm" webstripperlinkwas="ch21_09.htm" title="21.9 Keep File Printouts Up-to-Date Automatically with make"><img src="../gifs/txtnexta.gif" webstripperlinkwas="../gifs/txtnexta.gif" alt="Next: 21.9 Keep File Printouts Up-to-Date Automatically with make" border="0"></A
></TD
></TR
><tr><td align="LEFT" valign="TOP" width="172">21.7 Setting File Modification Time with touch </TD
><td align="CENTER" valign="TOP" width="171"><a class="index" href="index/idx_0.htm" webstripperlinkwas="index/idx_0.htm" title="Book Index"><img src="../gifs/index.gif" webstripperlinkwas="../gifs/index.gif" alt="Book Index" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172">21.9 Keep File Printouts Up-to-Date Automatically with make</TD
></TR
></TABLE
><hr align="LEFT" width="515" title="footer"><img src="../gifs/smnavbar.gif" webstripperlinkwas="../gifs/smnavbar.gif" usemap="#map" border="0" alt="The UNIX CD Bookshelf Navigation"><map name="map"><area shape="RECT" coords="0,0,73,21" href="../index.html" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/index.htm" alt="The UNIX CD Bookshelf"><area shape="RECT" coords="74,0,163,21" href="index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/upt/index.htm" alt="UNIX Power Tools"><area shape="RECT" coords="164,0,257,21" href="../unixnut/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/unixnut/index.htm" alt="UNIX in a Nutshell"><area shape="RECT" coords="258,0,321,21" href="../vi/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/vi/index.htm" alt="Learning the vi Editor"><area shape="RECT" coords="322,0,378,21" href="../sedawk/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/sedawk/index.htm" alt="sed &amp; awk"><area shape="RECT" coords="379,0,438,21" href="../ksh/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/ksh/index.htm" alt="Learning the Korn Shell"><area shape="RECT" coords="439,0,514,21" href="../lrnunix/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/lrnunix/index.htm" alt="Learning the UNIX Operating System"></MAP
></DIV
></BODY
></HTML
>
