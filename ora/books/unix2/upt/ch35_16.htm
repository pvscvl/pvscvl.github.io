<html><head><title>[Chapter 35] 35.16 Make Columns Automatically with cols </TITLE
><meta name="DC.title" content="UNIX Power Tools"><meta name="DC.creator" content="Jerry Peek, Tim O'Reilly &amp; Mike Loukides"><meta name="DC.publisher" content="O'Reilly &amp; Associates, Inc."><meta name="DC.date" content="1998-08-04T21:48:18Z"><meta name="DC.type" content="Text.Monograph"><meta name="DC.format" content="text/html" scheme="MIME"><meta name="DC.source" content="1-56592-260-3" scheme="ISBN"><meta name="DC.language" content="en-US"><meta name="generator" content="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><link rev="made" href="mailto:online-books@oreilly.com" title="Online Books Comments"><link rel="up" href="ch35_01.htm" webstripperlinkwas="ch35_01.htm" title="35. You Can't Quite Call This Editing"><link rel="prev" href="ch35_15.htm" webstripperlinkwas="ch35_15.htm" title="35.15 Cutting Columns with colrm "><link rel="next" href="ch35_17.htm" webstripperlinkwas="ch35_17.htm" title="35.17 Making Text in Columns with pr "></HEAD
><body bgcolor="#FFFFFF" text="#000000"><div class="htmlnav"><h1><img src="gifs/smbanner.gif" webstripperlinkwas="gifs/smbanner.gif" alt="UNIX Power Tools" usemap="#srchmap" border="0"></H1
><map name="srchmap"><area shape="RECT" coords="0,0,466,58" href="index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/upt/index.htm" alt="UNIX Power Tools"><area shape="RECT" coords="467,0,514,18" href="jobjects/fsearch.htm" webstripperlinkwas="jobjects/fsearch.htm" alt="Search this book"></MAP
><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="SECT1" href="ch35_15.htm" webstripperlinkwas="ch35_15.htm" title="35.15 Cutting Columns with colrm "><img src="../gifs/txtpreva.gif" webstripperlinkwas="../gifs/txtpreva.gif" alt="Previous: 35.15 Cutting Columns with colrm " border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><b><font face="ARIEL,HELVETICA,HELV,SANSERIF" size="-1">Chapter 35<br>You Can't Quite Call This Editing</FONT
></B
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="SECT1" href="ch35_17.htm" webstripperlinkwas="ch35_17.htm" title="35.17 Making Text in Columns with pr "><img src="../gifs/txtnexta.gif" webstripperlinkwas="../gifs/txtnexta.gif" alt="Next: 35.17 Making Text in Columns with pr " border="0"></A
></TD
></TR
></TABLE
>&nbsp;<hr align="LEFT" width="515" title="footer"></DIV
><div class="SECT1"><h2 class="sect1"><a class="title" name="UPT-ART-4240">35.16 Make Columns Automatically with cols </A
></H2
><table class="para.programreference" border="1"><tr><th valign="TOP"><a class="programreference" href="examples/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/upt/examples/index.htm" title="cols">cols</A
><br></TH
><td valign="TOP">&#13;If the output from some program runs down the left-hand side of
your screen and takes more than one screen to display,
you can pipe the program output to a
<span class="link">pager (<a class="linkend" href="ch25_03.htm" webstripperlinkwas="ch25_03.htm" title="Using more to Page Through Files ">25.3</A
>, <a class="linkend" href="ch25_04.htm" webstripperlinkwas="ch25_04.htm" title='The "less&quot; Pager: More than "more&quot;'>25.4</A
>)</SPAN
>.
If the lines of text are short, you can see more of that text on the screen
at once by reformatting the text into columns.
The <em class="emphasis">pr</EM
> command can
<span class="link">make columns (<a class="linkend" href="ch35_17.htm" webstripperlinkwas="ch35_17.htm" title="Making Text in Columns with pr ">35.17</A
>)</SPAN
>.
But it's not easy to use if you want the input text to be ordered down
a column instead of across columns.
And it's tough to use if you want as many columns as will fit across
your screen&nbsp;- you have to find the widest piece of data before you can
figure each column's width.</TD
></TR
></TABLE
><p class="para">Some UNIX systems have a program specifically for making data into
columns&nbsp;- but many don't.
The <em class="emphasis">cols</EM
> script takes care of that.
It reads your text, finds the widest piece, and chooses <em class="emphasis">pr</EM
> options
to make as many columns as will fit on the screen.
<em class="emphasis">cols</EM
> also has seven other names-
<span class="link">links (<a class="linkend" href="ch18_03.htm" webstripperlinkwas="ch18_03.htm" title="Files with Two or More Names">18.3</A
>)</SPAN
>
named <em class="emphasis">c2</EM
>, <em class="emphasis">c3</EM
>, <em class="emphasis">c4</EM
>, <em class="emphasis">c5</EM
>, <em class="emphasis">c6</EM
>, <em class="emphasis">c7</EM
>, and
<em class="emphasis">c8</EM
>-that make output in 2, 3, 4, 5, 6, 7, or 8 columns.
If you call the script with one of those names, it will fill the screen
with that number of columns.</P
><p class="para">For example, to list misspelled words in columns:</P
><p class="para"><blockquote class="screen"><pre class="screen">% <code class="userinput"><b>spell somefile | cols</B
></CODE
>
word1   word2   word3   word4   word5   word6   word7   word8
word9   word10  word11  word12  word13  word14  word15  word16</PRE
></BLOCKQUOTE
></P
><p class="para">By default, like the example above,
<em class="emphasis">cols</EM
> and the others order the input words across the screen; that's
the fastest way.
If you need output going down each column, use the <em class="emphasis">-d</EM
> option.
Then the scripts will calculate column length and order items down the screen:</P
><p class="para"><blockquote class="screen"><pre class="screen">% <code class="userinput"><b>spell somefile | cols -d</B
></CODE
>
word1   word3   word5   word7   word9   word11  word13  word15
word2   word4   word6   word8   word10  word12  word14  word16</PRE
></BLOCKQUOTE
></P
><p class="para">The script will read from files you name; otherwise it reads standard input.
It figures your screen width from the <em class="emphasis">COLUMNS</EM
> environment variable
if it's set; otherwise, it calls
<span class="link"><em class="emphasis">tcap</EM
> (<a class="linkend" href="ch41_10.htm" webstripperlinkwas="ch41_10.htm" title="Using terminfo Capabilities in Shell Programs ">41.10</A
>)</SPAN
>
to read your <em class="emphasis">termcap</EM
>.
(On <em class="emphasis">terminfo</EM
> systems, use
<span class="link"><em class="emphasis">tput</EM
> (<a class="linkend" href="ch41_10.htm" webstripperlinkwas="ch41_10.htm" title="Using terminfo Capabilities in Shell Programs ">41.10</A
>)</SPAN
>
instead of <em class="emphasis">tcap</EM
>.)
If you use a windowing system with adjustable-width windows, the script
could be hacked to check the output of <em class="emphasis">stty&nbsp;size</EM
> or
<span class="link"><em class="emphasis">stty&nbsp;-g</EM
> (<a class="linkend" href="ch42_04.htm" webstripperlinkwas="ch42_04.htm" title="Checklist for Resetting a Messed Up Terminal ">42.4</A
>)</SPAN
>.</P
><p class="para">A few programming details:
the number of columns, <em class="emphasis">nc</EM
>, is taken from the script name
(<em class="emphasis">c</EM
><b class="emphasis.bold">2</B
>, etc.)-or, if you call <em class="emphasis">cols</EM
>,
the script uses
<span class="link"><em class="emphasis">awk</EM
> (<a class="linkend" href="ch33_11.htm" webstripperlinkwas="ch33_11.htm" title="Quick Reference: awk ">33.11</A
>)</SPAN
>
to find the longest input line and calculate the number of columns.
(A
<span class="link"><em class="emphasis">case</EM
> statement (<a class="linkend" href="ch44_05.htm" webstripperlinkwas="ch44_05.htm" title="Test String Values with Bourne Shell case ">44.5</A
>)</SPAN
>
tests
<span class="link"><code class="literal">$0</CODE
> (<a class="linkend" href="ch44_22.htm" webstripperlinkwas="ch44_22.htm" title="Finding a Program Name; Multiple Program Names ">44.22</A
>)</SPAN
>
to decide.)
<span class="link"><em class="emphasis">expr</EM
> (<a class="linkend" href="ch45_28.htm" webstripperlinkwas="ch45_28.htm" title="Quick Reference: expr ">45.28</A
>)</SPAN
>
does other calculations.
Without the <em class="emphasis">-d</EM
> flag, the <em class="emphasis">pr</EM
> command line for making the
columns is simple:</P
><p class="para"><blockquote class="screen"><pre class="screen">pr -$nc -t -w$width -l1 $temp</PRE
></BLOCKQUOTE
></P
><p class="para">The <code class="literal">$temp</CODE
> file holds the input text.
With <em class="emphasis">-d</EM
>, the command line is more complicated.
It uses
<span class="link"><em class="emphasis">wc -l</EM
> (<a class="linkend" href="ch29_06.htm" webstripperlinkwas="ch29_06.htm" title="Counting Lines, Words, and Characters: wc ">29.6</A
>)</SPAN
>
to count the number of input lines, then <em class="emphasis">expr</EM
>
to divide by the number of columns and add 1:</P
><p class="para"><blockquote class="screen"><pre class="screen">pr -$nc -t -w$width -l`expr \( \`wc -l &lt; $temp\` / $nc \) + 1` $temp</PRE
></BLOCKQUOTE
></P
><p class="para">&#13;The
<span class="link">escaped backquotes (<code class="literal">\`</CODE
>) (<a class="linkend" href="ch45_31.htm" webstripperlinkwas="ch45_31.htm" title="Nested Command Substitution ">45.31</A
>)</SPAN
>
mean that
<code class="literal">wc&nbsp;-l&nbsp;&lt;&nbsp;$temp</CODE
>
will run first.
The line count from <em class="emphasis">wc</EM
> will be substituted onto the <em class="emphasis">expr</EM
> command
line.
The result from <em class="emphasis">expr</EM
> will be glued after the <code class="literal">-l</CODE
> to complete
the <em class="emphasis">pr</EM
> page length option.
If you don't like condensing the command line that much, you can move the
<em class="emphasis">wc</EM
> and <em class="emphasis">expr</EM
> commands to other lines and pass the values with
shell variables.</P
><p class="para">You can install this script from the CD-ROM
or from the
<span class="link">online archive (<a class="linkend" href="ch52_07.htm" webstripperlinkwas="ch52_07.htm" title="Other Ways to Get the Software ">52.7</A
>)</SPAN
>.
If you get it from the archive,
ask tar to install <em class="emphasis">cols</EM
> and its seven other links:</P
><p class="para"><blockquote class="screen"><pre class="screen">% <code class="userinput"><b>tar xvf </B
></CODE
><code class="replaceable"><i>archive.tar</I
></CODE
><code class="userinput"><b> cols c2 c3 c4 c5 c6 c7 c8</B
></CODE
>
x cols, 2160 bytes, 5 tape blocks
c2 linked to cols
c3 linked to cols
   ...</PRE
></BLOCKQUOTE
></P
><div class="sect1info"><p class="SECT1INFO">- <span class="authorinitials">JP</SPAN
></P
></DIV
></DIV
><div class="htmlnav"><p></P
><hr align="LEFT" width="515" title="footer"><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="SECT1" href="ch35_15.htm" webstripperlinkwas="ch35_15.htm" title="35.15 Cutting Columns with colrm "><img src="../gifs/txtpreva.gif" webstripperlinkwas="../gifs/txtpreva.gif" alt="Previous: 35.15 Cutting Columns with colrm " border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><a class="book" href="index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/upt/index.htm" title="UNIX Power Tools"><img src="../gifs/txthome.gif" webstripperlinkwas="../gifs/txthome.gif" alt="UNIX Power Tools" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="SECT1" href="ch35_17.htm" webstripperlinkwas="ch35_17.htm" title="35.17 Making Text in Columns with pr "><img src="../gifs/txtnexta.gif" webstripperlinkwas="../gifs/txtnexta.gif" alt="Next: 35.17 Making Text in Columns with pr " border="0"></A
></TD
></TR
><tr><td align="LEFT" valign="TOP" width="172">35.15 Cutting Columns with colrm </TD
><td align="CENTER" valign="TOP" width="171"><a class="index" href="index/idx_0.htm" webstripperlinkwas="index/idx_0.htm" title="Book Index"><img src="../gifs/index.gif" webstripperlinkwas="../gifs/index.gif" alt="Book Index" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172">35.17 Making Text in Columns with pr </TD
></TR
></TABLE
><hr align="LEFT" width="515" title="footer"><img src="../gifs/smnavbar.gif" webstripperlinkwas="../gifs/smnavbar.gif" usemap="#map" border="0" alt="The UNIX CD Bookshelf Navigation"><map name="map"><area shape="RECT" coords="0,0,73,21" href="../index.html" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/index.html" alt="The UNIX CD Bookshelf"><area shape="RECT" coords="74,0,163,21" href="index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/upt/index.htm" alt="UNIX Power Tools"><area shape="RECT" coords="164,0,257,21" href="../unixnut/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/unixnut/index.htm" alt="UNIX in a Nutshell"><area shape="RECT" coords="258,0,321,21" href="../vi/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/vi/index.htm" alt="Learning the vi Editor"><area shape="RECT" coords="322,0,378,21" href="../sedawk/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/sedawk/index.htm" alt="sed &amp; awk"><area shape="RECT" coords="379,0,438,21" href="../ksh/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/ksh/index.htm" alt="Learning the Korn Shell"><area shape="RECT" coords="439,0,514,21" href="../lrnunix/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/lrnunix/index.htm" alt="Learning the UNIX Operating System"></MAP
></DIV
></BODY
></HTML
>
