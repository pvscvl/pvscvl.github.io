<html><head><title>[Chapter 42] 42.5 Checklist: Screen Size Messed Up? </TITLE
><meta name="DC.title" content="UNIX Power Tools"><meta name="DC.creator" content="Jerry Peek, Tim O'Reilly &amp; Mike Loukides"><meta name="DC.publisher" content="O'Reilly &amp; Associates, Inc."><meta name="DC.date" content="1998-08-04T21:52:29Z"><meta name="DC.type" content="Text.Monograph"><meta name="DC.format" content="text/html" scheme="MIME"><meta name="DC.source" content="1-56592-260-3" scheme="ISBN"><meta name="DC.language" content="en-US"><meta name="generator" content="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><link rev="made" href="mailto:online-books@oreilly.com" title="Online Books Comments"><link rel="up" href="ch42_01.htm" webstripperlinkwas="ch42_01.htm" title="42. Problems with Terminals"><link rel="prev" href="ch42_04.htm" webstripperlinkwas="ch42_04.htm" title="42.4 Checklist for Resetting a Messed Up Terminal "><link rel="next" href="ch42_06.htm" webstripperlinkwas="ch42_06.htm" title="42.6 Screen Size Testing Files "></HEAD
><body bgcolor="#FFFFFF" text="#000000"><div class="htmlnav"><h1><img src="gifs/smbanner.gif" webstripperlinkwas="gifs/smbanner.gif" alt="UNIX Power Tools" usemap="#srchmap" border="0"></H1
><map name="srchmap"><area shape="RECT" coords="0,0,466,58" href="index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/upt/index.htm" alt="UNIX Power Tools"><area shape="RECT" coords="467,0,514,18" href="jobjects/fsearch.htm" webstripperlinkwas="jobjects/fsearch.htm" alt="Search this book"></MAP
><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="SECT1" href="ch42_04.htm" webstripperlinkwas="ch42_04.htm" title="42.4 Checklist for Resetting a Messed Up Terminal "><img src="../gifs/txtpreva.gif" webstripperlinkwas="../gifs/txtpreva.gif" alt="Previous: 42.4 Checklist for Resetting a Messed Up Terminal " border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><b><font face="ARIEL,HELVETICA,HELV,SANSERIF" size="-1">Chapter 42<br>Problems with Terminals</FONT
></B
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="SECT1" href="ch42_06.htm" webstripperlinkwas="ch42_06.htm" title="42.6 Screen Size Testing Files "><img src="../gifs/txtnexta.gif" webstripperlinkwas="../gifs/txtnexta.gif" alt="Next: 42.6 Screen Size Testing Files " border="0"></A
></TD
></TR
></TABLE
>&nbsp;<hr align="LEFT" width="515" title="footer"></DIV
><div class="SECT1"><h2 class="sect1"><a class="title" name="UPT-ART-0092">42.5 Checklist: Screen Size Messed Up? </A
></H2
><p class="para"><a class="indexterm" name="AUTOID-46951"></A
>The
<span class="link">termcap and terminfo (<a class="linkend" href="ch05_02.htm" webstripperlinkwas="ch05_02.htm" title="The Idea of a Terminal Database ">5.2</A
>)</SPAN
>
systems used to be the only place where the size of your terminal screen
(number of lines and characters) was set.
These days, screen-oriented commands like <em class="emphasis">vi</EM
> and <em class="emphasis">more</EM
>
on most UNIXes need to work with window systems.
Users can shrink or stretch
their windows without changing the <em class="emphasis">termcap</EM
> or <em class="emphasis">terminfo</EM
> definition.
Depending on the command and version of UNIX you're using, you can run
into window-size problems even if you aren't using a window system.</P
><p class="para">Window systems don't cause all the problems though.
&quot;Classic&quot; problems, such as files with lines that are longer than the
terminal is wide, were around before UNIX did windows.</P
><p class="para">Here's a checklist of things to try.
Once you figure out what's wrong and how to fix it on your terminal and
version of UNIX, you'll probably be able to fix problems with other programs
you run.</P
><ul class="itemizedlist"><li class="listitem"><p class="para"><a class="indexterm" name="AUTOID-46964"></A
>Displaying or editing a file with lines longer than the screen is wide
can cause strange problems if everything isn't set up right.
There are two places that may try to split a line into pieces when it thinks
that the line is too long.
The problem, of course, is when these don't work together or one of them
has a wrong idea about the line length:</P
><ul class="itemizedlist"><li class="listitem"><p class="para">Your terminal or window may be set to autowrap lines that would cross
the right edge: The line is broken and the rest is shown beginning at the
left margin on the next line below.</P
></LI
><li class="listitem"><p class="para">If you use a screen-oriented program like <em class="emphasis">vi</EM
> or <em class="emphasis">more</EM
>, they
may wrap long lines.
The <em class="emphasis">termcap</EM
> and <em class="emphasis">terminfo</EM
> definitions tell screen-oriented programs
whether to wrap lines.
(For more information, see O'Reilly &amp; Associates' <em class="emphasis">termcap &amp; terminfo</EM
>.)</P
></LI
></UL
><p class="para">To find out what your terminal is doing, display a file with long lines like
<span class="link"><em class="emphasis">longlines</EM
> (<a class="linkend" href="ch42_06.htm" webstripperlinkwas="ch42_06.htm" title="Screen Size Testing Files ">42.6</A
>)</SPAN
>.
The
<span class="link"><em class="emphasis">cat</EM
> (<a class="linkend" href="ch25_02.htm" webstripperlinkwas="ch25_02.htm" title="Four Ways to Skin a cat ">25.2</A
>)</SPAN
>
and
<span class="link"><em class="emphasis">head</EM
> (<a class="linkend" href="ch25_20.htm" webstripperlinkwas="ch25_20.htm" title="Printing the Top of a File ">25.20</A
>)</SPAN
>
programs don't use <em class="emphasis">termcap</EM
> or <em class="emphasis">terminfo</EM
>-they spit the
file directly to your screen.
So, for example, a single 200-character line from <em class="emphasis">longlines</EM
> should be
shown as three lines on an 80-column screen.
You shouldn't lose any of the characters at either side.
Two lines would look like this:</P
><p class="para"><blockquote class="screen"><pre class="screen">% <code class="userinput"><b>head -2 longlines</B
></CODE
>
1  45678901234567890123456789012345678901234567890123456789012345678901234567890
12345678901234567890123456789012345678901234567890123456789012345678901234567890
1234567890123456789012345678901234567890
2  45678901234567890123456789012345678901234567890123456789012345678901234567890
12345678901234567890123456789012345678901234567890123456789012345678901234567890
1234567890123456789012345678901234567890</PRE
></BLOCKQUOTE
></P
><p class="para"><a class="indexterm" name="AUTOID-46991"></A
><a class="indexterm" name="AUTOID-46993"></A
>If you see only two &quot;chopped&quot; lines, your terminal isn't wrapping lines.
You may want to go into its setup mode and enable line-wrapping.
If you do though, be sure that your termcap/terminfo definition lists
the terminal as autowrapping.
If your terminal autowraps but the <em class="emphasis">termcap/terminfo</EM
> definition doesn't
say that, screen-oriented applications may try to wrap lines for you.
Exactly what happens depends on the application you're using and your
terminal.
One common problem is that the screen may look double-spaced&nbsp;- each part of a
single long line that's &quot;wrapped&quot; has a blank line after it.
For instance, the <em class="emphasis">longlines</EM
> file might look like this:</P
><p class="para"><blockquote class="screen"><pre class="screen">1  4567890123456789012345678901234567890123456789012345678901234567890123
1234567890123456789012345678901234567890123456789012345678901234567890123
1234567890123456789012345678901234567890
   ...</PRE
></BLOCKQUOTE
></P
><p class="para">In that case, both the terminal and the application are probably trying
to wrap the lines for you.
Usually, then, the application won't know exactly how many lines your
terminal is displaying and will send twice as many lines as your screen
can show.
What a mess!
Try to use another value of the
<span class="link"><em class="emphasis">TERM</EM
> (<a class="linkend" href="ch05_10.htm" webstripperlinkwas="ch05_10.htm" title="Finding What Terminal Names You Can Use ">5.10</A
>)</SPAN
>
environment variable that defines your terminal as autowrapping.
These can have names that end with <em class="emphasis">am</EM
> or <em class="emphasis">aw</EM
>, like <em class="emphasis">vt100aw</EM
>.
Or, if you want to dig in, it's not too hard to adapt your own
<em class="emphasis">termcap</EM
> or <em class="emphasis">terminfo</EM
> definition from the standard system file.
For more information, see article
<a class="xref" href="ch41_11.htm" webstripperlinkwas="ch41_11.htm" title="How termcap and terminfo Describe Terminals ">41.11</A
>
or O'Reilly &amp; Associates' <em class="emphasis">termcap &amp; terminfo</EM
>.</P
></LI
><li class="listitem"><p class="para">Your screen can be mixed up when a full-screen application-a pager like
<em class="emphasis">pg</EM
>, for example&nbsp;- is displaying the standard output of some program.
The program writes some messages to its standard error.
These extra lines aren't counted by the application, but they show on
your screen.<a class="indexterm" name="AUTOID-47012"></A
><a class="indexterm" name="AUTOID-47014"></A
>
If the application has a redraw screen command like 
CTRL-l
you may be able to get a fresh copy of the lines from
standard output.
Or, you can
<span class="link">pipe both <em class="emphasis">stdout</EM
> and <em class="emphasis">stderr</EM
> to the pager (<a class="linkend" href="ch13_04.htm" webstripperlinkwas="ch13_04.htm" title="Problems Piping to a Pager ">13.4</A
>)</SPAN
>.</P
></LI
><li class="listitem"><p class="para"><a class="indexterm" name="AUTOID-47021"></A
><a class="indexterm" name="AUTOID-47025"></A
><a class="indexterm" name="AUTOID-47027"></A
>Some applications let you set their screen size in a configuration file
or environment variable.
For example, Berkeley
<span class="link"><em class="emphasis">mail</EM
> (<em class="emphasis">mailx</EM
> (<a class="linkend" href="ch01_33.htm" webstripperlinkwas="ch01_33.htm" title="UNIX Networking and Communications ">1.33</A
>)</SPAN
>
on System V) has a <em class="emphasis">screen</EM
>
variable that might be set in its
<em class="emphasis">.mailrc</EM
>
file or in a system file like <em class="emphasis">/usr/lib/Mail.rc</EM
>.
The <em class="emphasis">vi</EM
> editor has a <em class="emphasis">window</EM
> variable that might be set in your
<span class="link"><em class="emphasis">.exrc</EM
> (<a class="linkend" href="ch04_09.htm" webstripperlinkwas="ch04_09.htm" title="Setting Up vi with the .exrc File ">4.9</A
>)</SPAN
>
file.</P
><p class="para">Unless you set those variables correctly for all the terminals you use,
you'll usually be better off to let the application set its own window size.</P
></LI
><li class="listitem"><p class="para"><a class="indexterm" name="AUTOID-47043"></A
>Your version of UNIX may keep the screen size as part of the device
settings.
To find out, type the command:</P
><p class="para"><blockquote class="screen"><pre class="screen">% <code class="userinput"><b>stty size</B
></CODE
>
24 80</PRE
></BLOCKQUOTE
></P
><p class="para"><a class="indexterm" name="AUTOID-47049"></A
>(If that doesn't work, try <em class="emphasis">stty&nbsp;-a</EM
>; look for <code class="literal">rows</CODE
>&nbsp;<code class="literal">=</CODE
>
and <code class="literal">columns</CODE
>&nbsp;<code class="literal">=</CODE
> in the output.)
The command shows that UNIX
thinks your screen has 24 lines and 80 columns.
Or, the screen size may be stored in environment variables called <em class="emphasis">COLUMNS</EM
>
and <em class="emphasis">LINES</EM
>:</P
><p class="para"><table class="screen.co" border="1"><tr><th valign="TOP"><pre class="calloutlist">
<a class="co" href="ch06_01.htm" webstripperlinkwas="ch06_01.htm" title="6.1 What Environment Variables Are Good For ">env</A
> <a class="co" href="ch27_05.htm" webstripperlinkwas="ch27_05.htm" title="27.5 Extended Searching for Text with egrep ">egrep</A
> 
&#13;</PRE
></TH
><td valign="TOP"><pre class="screen">
% <code class="userinput"><b>env</B
></CODE
><code class="userinput"><b> | </B
></CODE
><code class="userinput"><b>egrep</B
></CODE
><code class="userinput"><b> '(COLUMNS|LINES)='</B
></CODE
>
COLUMNS=80
LINES=24</PRE
></TD
></TR
></TABLE
></P
><p class="para">If the current settings don't match your
<span class="link">screen size (<a class="linkend" href="ch42_06.htm" webstripperlinkwas="ch42_06.htm" title="Screen Size Testing Files ">42.6</A
>)</SPAN
>
you can change the screen size settings.
See the suggestions below.</P
></LI
><li class="listitem"><p class="para"><a class="indexterm" name="AUTOID-47071"></A
><a class="indexterm" name="AUTOID-47074"></A
>If UNIX doesn't know your screen size and your system has the <em class="emphasis">stty size</EM
>
command, you can use <em class="emphasis">stty</EM
> to change the settings.
For example, if your window has 43 rows and 80 columns, type:</P
><p class="para"><blockquote class="screen"><pre class="screen">% <code class="userinput"><b>stty rows 43 columns 80</B
></CODE
></PRE
></BLOCKQUOTE
></P
><p class="para">If applications are using the <em class="emphasis">COLUMNS</EM
> and <em class="emphasis">LINES</EM
> environment
variables, just
<span class="link">reset them (<a class="linkend" href="ch06_01.htm" webstripperlinkwas="ch06_01.htm#UPT-ART-1170" title="What Environment Variables Are Good For ">6.1</A
>)</SPAN
>.</P
><blockquote class="note"><p class="para"><strong>NOTE:</STRONG
> Any jobs that are stopped or in the background when you change the screen size
may not work anymore because they'll still have the old window size.
If that's a problem, quit and restart the applications or send them a
<em class="emphasis">SIGWINCH</EM
> signal (below).</P
></BLOCKQUOTE
><p class="para"></P
></LI
><li class="listitem"><p class="para"><a class="indexterm" name="AUTOID-47093"></A
>If you're running <em class="emphasis">xterm</EM
> in the
<span class="link">X Window System (<a class="linkend" href="ch01_31.htm" webstripperlinkwas="ch01_31.htm" title="The X Window System ">1.31</A
>)</SPAN
>,
use <em class="emphasis">resize</EM
>.
It asks your <em class="emphasis">xterm</EM
> to report (silently) on how big the window is now,
then it resets the <em class="emphasis">stty</EM
> parameters or environment variables,
depending on which your system needs.
When it sets environment variables, <em class="emphasis">resize</EM
> needs to give commands
to the shell.
In the C shell, type:</P
><p class="para"><table class="screen.co" border="1"><tr><th valign="TOP"><pre class="calloutlist">
<a class="co" href="ch08_10.htm" webstripperlinkwas="ch08_10.htm" title="8.10 eval: When You Need Another Chance ">eval</A
> </PRE
></TH
><td valign="TOP"><pre class="screen">
% <code class="userinput"><b>set noglob; </B
></CODE
><code class="userinput"><b>eval</B
></CODE
><code class="userinput"><b> `resize`</B
></CODE
></PRE
></TD
></TR
></TABLE
></P
><p class="para">(You don't need to use
<span class="link"><code class="literal">unset noglob</CODE
> (<a class="linkend" href="ch06_09.htm" webstripperlinkwas="ch06_09.htm" title="Special C Shell Variables ">6.9</A
>)</SPAN
>
because <em class="emphasis">resize</EM
> outputs that command.)
In the Bourne shell, </P
><p class="para"><blockquote class="screen"><pre class="screen">$ <code class="userinput"><b>eval `resize`</B
></CODE
></PRE
></BLOCKQUOTE
></P
><p class="para">Both of these are easier to use if you define an
<span class="link">alias (<a class="linkend" href="ch10_02.htm" webstripperlinkwas="ch10_02.htm" title="Aliases for Common Commands ">10.2</A
>)</SPAN
>
or a
<span class="link">shell function (<a class="linkend" href="ch10_09.htm" webstripperlinkwas="ch10_09.htm" title="Shell Functions ">10.9</A
>)</SPAN
>
named something like <em class="emphasis">rs</EM
>:</P
><p class="para"><blockquote class="screen"><pre class="screen">alias rs 'set noglob; eval `resize`'
rs() { eval `/usr/bin/X11/resize`; }</PRE
></BLOCKQUOTE
></P
><p class="para"></P
></LI
><li class="listitem"><p class="para"><a class="indexterm" name="AUTOID-47123"></A
>In UNIXes that store the window size as part of the device settings (not
in environment variables), here's another thing you can do.
First, use <em class="emphasis">stty</EM
> to set the right sizes (see above).
Then send a <em class="emphasis">SIGWINCH</EM
> (window changed) signal to the shell and/or job
that has a wrong idea of the window size:</P
><p class="para"><blockquote class="screen"><pre class="screen">% <code class="userinput"><b>kill -WINCH $$</B
></CODE
>    <i class="lineannotation">Send signal to the shell</I
>
% <code class="userinput"><b>kill -WINCH %1</B
></CODE
>    <i class="lineannotation">Send signal to job 1</I
></PRE
></BLOCKQUOTE
></P
><p class="para"></P
></LI
><li class="listitem"><p class="para">In some window systems, you can make your window a little taller or shorter.
That will reset things.</P
></LI
><li class="listitem"><p class="para"><a class="indexterm" name="AUTOID-47138"></A
>You're using the
<span class="link"><em class="emphasis">telnet</EM
> (<a class="linkend" href="ch01_33.htm" webstripperlinkwas="ch01_33.htm" title="UNIX Networking and Communications ">1.33</A
>)</SPAN
>
command to log in to a remote machine.
You didn't have trouble with the window size on your local
machine&nbsp;- what's wrong?
<em class="emphasis">telnet</EM
> probably didn't pass your correct window size to the
remote host.
If both the local and remote machines support
<span class="link"><em class="emphasis">rlogin</EM
> (<a class="linkend" href="ch01_33.htm" webstripperlinkwas="ch01_33.htm" title="UNIX Networking and Communications ">1.33</A
>)</SPAN
>,
use it instead.
Otherwise, use one of the tips above to set the window size on the
remote system.</P
></LI
></UL
><div class="sect1info"><p class="SECT1INFO">- <span class="authorinitials">JP</SPAN
></P
></DIV
></DIV
><div class="htmlnav"><p></P
><hr align="LEFT" width="515" title="footer"><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="SECT1" href="ch42_04.htm" webstripperlinkwas="ch42_04.htm" title="42.4 Checklist for Resetting a Messed Up Terminal "><img src="../gifs/txtpreva.gif" webstripperlinkwas="../gifs/txtpreva.gif" alt="Previous: 42.4 Checklist for Resetting a Messed Up Terminal " border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><a class="book" href="index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/upt/index.htm" title="UNIX Power Tools"><img src="../gifs/txthome.gif" webstripperlinkwas="../gifs/txthome.gif" alt="UNIX Power Tools" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="SECT1" href="ch42_06.htm" webstripperlinkwas="ch42_06.htm" title="42.6 Screen Size Testing Files "><img src="../gifs/txtnexta.gif" webstripperlinkwas="../gifs/txtnexta.gif" alt="Next: 42.6 Screen Size Testing Files " border="0"></A
></TD
></TR
><tr><td align="LEFT" valign="TOP" width="172">42.4 Checklist for Resetting a Messed Up Terminal </TD
><td align="CENTER" valign="TOP" width="171"><a class="index" href="index/idx_0.htm" webstripperlinkwas="index/idx_0.htm" title="Book Index"><img src="../gifs/index.gif" webstripperlinkwas="../gifs/index.gif" alt="Book Index" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172">42.6 Screen Size Testing Files </TD
></TR
></TABLE
><hr align="LEFT" width="515" title="footer"><img src="../gifs/smnavbar.gif" webstripperlinkwas="../gifs/smnavbar.gif" usemap="#map" border="0" alt="The UNIX CD Bookshelf Navigation"><map name="map"><area shape="RECT" coords="0,0,73,21" href="../index.html" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/index.html" alt="The UNIX CD Bookshelf"><area shape="RECT" coords="74,0,163,21" href="index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/upt/index.htm" alt="UNIX Power Tools"><area shape="RECT" coords="164,0,257,21" href="../unixnut/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/unixnut/index.htm" alt="UNIX in a Nutshell"><area shape="RECT" coords="258,0,321,21" href="../vi/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/vi/index.htm" alt="Learning the vi Editor"><area shape="RECT" coords="322,0,378,21" href="../sedawk/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/sedawk/index.htm" alt="sed &amp; awk"><area shape="RECT" coords="379,0,438,21" href="../ksh/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/ksh/index.htm" alt="Learning the Korn Shell"><area shape="RECT" coords="439,0,514,21" href="../lrnunix/index.htm" webstripperlinkwas="http://www.ms.itb.ac.id/buku/unix-bookshelf/lrnunix/index.htm" alt="Learning the UNIX Operating System"></MAP
></DIV
></BODY
></HTML
>
