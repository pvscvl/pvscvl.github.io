<html><head>
<title>[Chapter 5] 5.2 Linux Kernel Configuration </TITLE>
<meta name="DC.title" content="TCP/IP Network Administration"><meta name="DC.creator" content="Craig Hunt"><meta name="DC.publisher" content="O'Reilly &amp; Associates, Inc."><meta name="DC.date" content="1999-02-04T01:33:20Z"><meta name="DC.type" content="Text.Monograph"><meta name="DC.format" content="text/html" scheme="MIME"><meta name="DC.source" content="1-56592-322-7" scheme="ISBN"><meta name="DC.language" content="en-US"><meta name="generator" content="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><link rev="made" href="mailto:online-books@oreilly.com" title="Online Books Comments"><link rel="up" href="ch05_01.htm" title="5. Basic Configuration "><link rel="prev" href="ch05_01.htm" title="5.1 Kernel Configuration "><link rel="next" href="ch05_03.htm#TCP2-CH-5-SECT-3.1.1" title="5.3 The BSD Kernel Configuration File "></HEAD
><body bgcolor="#FFFFFF" text="#000000"><div class="htmlnav"><h1><img src="gifs/smbanner.gif" alt="TCP/IP Network Administration" usemap="#srchmap" border="0"></H1
><map name=index.html"srchmap"><area shape="RECT" coords="0,0,466,65" href="index.htm" alt="TCP/IP Network Administration"><area shape="RECT" coords="467,0,514,18" href="../search/tsrch.htm" alt="Search this book"></MAP
><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="SECT1" href="ch05_01.htm" title="5.1 Kernel Configuration "><img src="../gifs/txtpreva.gif" alt="Previous: 5.1 Kernel Configuration " border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><b><font face="ARIEL,HELVETICA,HELV,SANSERIF" size="-1">Chapter 5<br>Basic Configuration </FONT
></B
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="SECT1" href="ch05_03.htm#TCP2-CH-5-SECT-3.1.1" title="5.3 The BSD Kernel Configuration File "><img src="../gifs/txtnexta.gif" alt="Next: 5.3 The BSD Kernel Configuration File " border="0"></A
></TD
></TR
></TABLE
>&nbsp;<hr align="LEFT" width="515" title="footer"></DIV
><div class="SECT1"><h2 class="sect1"><a class="title" name="TCP2-CH-5-SECT-2">5.2 Linux Kernel Configuration </A
></H2
><p class="para"><a class="indexterm" name="TCP2-CH-5-IX-LINUX-SYSTEMS-KERNEL-CONFIGURATION"></A
><a class="indexterm" name="TCP2-CH-5-IX-MAKE-CONFIG-COMMAND"></A
>The Linux kernel is a C program compiled and installed by <b class="emphasis.bold">make</B
>.<a class="indexterm" name="AUTOID-4960"></A
>
The <b class="emphasis.bold">make config</B
> command customizes the kernel configuration and
generates the files (including the Makefile) needed to compile and
link the kernel. On Linux systems, the kernel source directory is
<em class="emphasis">/usr/src/linux</EM
>.<a class="indexterm" name="AUTOID-4964"></A
><a class="indexterm" name="AUTOID-4967"></A
>
To start the configuration process, change
to the source directory and run <b class="emphasis.bold">make config</B
>:</P
><p class="para"><blockquote class="screen"><pre class="screen"># cd /usr/src/linux
# make config</PRE
></BLOCKQUOTE
></P
><p class="para">The <b class="emphasis.bold">make config</B
> command asks many questions about your
system configuration. Some of these are directly related to network
configuration.

The first network configuration question is:</P
><p class="para"><blockquote class="screen"><pre class="screen">Networking support (CONFIG_NET) [Y/n/?]</PRE
></BLOCKQUOTE
></P
><p class="para">Answer &quot;yes&quot; (y), which is the default. Networking support
is necessary
for all of the TCP/IP networking features that we will request later in
the configuration. Even if you don't run TCP/IP, you should answer &quot;yes&quot;
to this question. Basic network support is essential to many services.</P
><p class="para">The <b class="emphasis.bold">make config</B
> command asks several more general configuration
questions before returning to the topic of networking. When it does, it
has many networking questions to ask. The example below is an excerpt
from the actual configuration of the Linux 2.0 kernel on a Slackware
96 system.
[2]</P
><blockquote class="footnote"><p class="para">[2] The configuration questions change with every new kernel. Refer to
your system's documentation for the latest information.</P
></BLOCKQUOTE
><p class="para"><blockquote class="screen"><pre class="screen">Network firewalls (CONFIG_FIREWALL) [N/y/?] 
Network aliasing (CONFIG_NET_ALIAS) [N/y/?] 
TCP/IP networking (CONFIG_INET) [Y/n/?] 
IP: forwarding/gatewaying (CONFIG_IP_FORWARD) [N/y/?] 
IP: multicasting (CONFIG_IP_MULTICAST) [N/y/?] 
IP: accounting (CONFIG_IP_ACCT) [N/y/?] 
IP: PC/TCP compatibility mode (CONFIG_INET_PCTCP) [N/y/?] 
IP: Reverse ARP (CONFIG_INET_RARP) [N/y/m/?] 
IP: Disable Path MTU Discovery (normally enabled)
     (CONFIG_NO_PATH_MTU_DISCOVERY) [N/y/?] 
IP: Drop source routed frames (CONFIG_IP_NOSR) [Y/n/?] 
IP: Allow large windows (not recommended if &lt;16Mb of memory)
     (CONFIG_SKB_LARGE) [Y/n/?] 
Network device support (CONFIG_NETDEVICES) [Y/n/?] 
Dummy net driver support (CONFIG_DUMMY) [N/y/m/?] 
EQL (serial line load balancing) support (CONFIG_EQUALIZER) [N/y/m/?] 
PLIP (parallel port) support (CONFIG_PLIP) [N/y/m/?] 
PPP (point-to-point) support (CONFIG_PPP) [Y/m/n/?] 
SLIP (serial line) support (CONFIG_SLIP) [Y/m/n/?] 
 CSLIP compressed headers (CONFIG_SLIP_COMPRESSED) [Y/n/?] 
 Keepalive and linefill (CONFIG_SLIP_SMART) [N/y/?] 
 Six bit SLIP encapsulation (CONFIG_SLIP_MODE_SLIP6) [N/y/?] 
Radio network interfaces (CONFIG_NET_RADIO) [N/y/?] 
Ethernet (10 or 100Mbit) (CONFIG_NET_ETHERNET) [Y/n/?] 
3COM cards (CONFIG_NET_VENDOR_3COM) [Y/n/?] 
3c501 support (CONFIG_EL1) [N/y/m/?] 
3c503 support (CONFIG_EL2) [N/y/m/?] 
3c509/3c579 support (CONFIG_EL3) [Y/m/n/?] 
3c590 series (592/595/597) &quot;Vortex&quot; support (CONFIG_VORTEX) [N/y/m/?] 
AMD LANCE and PCnet (AT1500 and NE2100) support (CONFIG_LANCE) [N/y/?] 
Western Digital/SMC cards (CONFIG_NET_VENDOR_SMC) [N/y/?] 
Other ISA cards (CONFIG_NET_ISA) [N/y/?] 
EISA, VLB, PCI and on board controllers (CONFIG_NET_EISA) [N/y/?] 
Pocket and portable adaptors (CONFIG_NET_POCKET) [N/y/?] 
Token Ring driver support (CONFIG_TR) [N/y/?] 
ARCnet support (CONFIG_ARCNET) [N/y/m/?] 
ISDN support (CONFIG_ISDN) [N/y/m/?]</PRE
></BLOCKQUOTE
></P
><p class="para">Each configuration option is either enabled by entering a &quot;y&quot; for &quot;yes&quot;, or
disabled with an &quot;n&quot; for &quot;no&quot;. &quot;m&quot; for &quot;module&quot; is an alternative method
for enabling some features. Features that are available as dynamically
loadable modules list &quot;m&quot; as a possible response. If &quot;m&quot; is selected,
the dynamically loadable module is loaded the first time a call is made
to the kernel that requires the module. If &quot;y&quot; is selected for a feature,
the code that supports that feature is compiled directly into the kernel.
The default setting of each option is indicated by the uppercase letter
in the square brackets at the end of the option line. For example, [Y,n] 
indicates an option that is enabled by default. Here, we list each
option and its purpose:</P
><dl class="variablelist"><dt class="term">CONFIG_FIREWALL</DT
><dd class="listitem"><p class="para">Adds the kernel support necessary to make this system a firewall.<a class="indexterm" name="AUTOID-4989"></A
>
Enable this only if the Linux system will be your firewall. The full
firewall installation requires additional software outside the kernel.
See <a class="xref" href="ch12_01.htm" title="Network Security ">Chapter 12, <cite class="chapter">Network Security </CITE
></A
>, for a discussion of firewalls.
[3]</P
><blockquote class="footnote"><p class="para">[3] Building a firewall is beyond the scope of this book. See <em class="emphasis">Building
Internet Firewalls</EM
>, by Brent Chapman and Elizabeth Zwicky (O'Reilly &amp;
Associates), for a full treatment of the subject.</P
></BLOCKQUOTE
></DD
><dt class="term">CONFIG_NET_ALIAS</DT
><dd class="listitem"><p class="para">Adds the kernel support necessary for address translation.<a class="indexterm" name="AUTOID-5000"></A
>
Use this
feature only if you have a private internal network number and a
different network address for external communications. If you do,
internal addresses must be translated to valid external addresses
whenever connections are made to the outside world, but it is likely
that the translation will be done by your router or firewall. You should 
select &quot;yes&quot; only in the rare circumstance that the Linux box must do 
the translation; otherwise, select &quot;no&quot;. See <a class="xref" href="ch04_01.htm" title="Getting Started ">Chapter 4, <cite class="chapter">Getting Started </CITE
></A
>, for a discussion
of private network numbers and address translation.</P
></DD
><dt class="term">CONFIG_INET</DT
><dd class="listitem"><p class="para">Adds TCP/IP networking to the kernel. This is an absolute must!</P
></DD
><dt class="term">CONFIG_IP_FORWARD</DT
><dd class="listitem"><p class="para">Determines whether or not the system forwards IP datagrams.<a class="indexterm" name="AUTOID-5012"></A
>
This feature
must be enabled if the Linux system is an IP router. On Linux host
systems, this feature is disabled, which is the default. Select &quot;no&quot;
unless this box is a router.</P
></DD
><dt class="term">CONFIG_IP_MULTICAST</DT
><dd class="listitem"><p class="para">Adds multicast support<a class="indexterm" name="AUTOID-5019"></A
>
to the kernel. Enable this to use multicast
applications such as MBONE<a class="indexterm" name="AUTOID-5022"></A
><a class="indexterm" name="AUTOID-5024"></A
>
or Internet Talk Radio. Not sure if you
need multicasting? Select &quot;yes&quot;.  You never know what applications you
will add later.</P
></DD
><dt class="term">CONFIG_IP_ACCT</DT
><dd class="listitem"><p class="para">Adds code to count the bytes in incoming and outgoing traffic on a
per-port/pre-address basis. This could be useful for monitoring system<a class="indexterm" name="AUTOID-5030"></A
><a class="indexterm" name="AUTOID-5033"></A
>
usage, particularly in a commercial environment where usage is billed back
to the originator. Additional application software would be needed to make
this useful. Select &quot;no&quot; unless you plan to keep close tabs on usage.</P
></DD
><dt class="term">CONFIG_INET_PCTCP</DT
><dd class="listitem"><p class="para">Handles an incompatibility problem<a class="indexterm" name="AUTOID-5039"></A
>
with older versions of FTP software's
PC/TCP. Use if you have clients who run the old PC/TCP software
on PCs.</P
></DD
><dt class="term">CONFIG_INET_RARP</DT
><dd class="listitem"><p class="para">Adds support for Reverse Address Resolution Protocol (RARP)<a class="indexterm" name="AUTOID-5045"></A
>
to the kernel.
Enable this if you plan to use RARP on your network. Not sure? Use &quot;m&quot;
to select the loadable module<a class="indexterm" name="AUTOID-5047"></A
>
that can be used when your system needs it.
See <a class="xref" href="ch03_01.htm" title="Network Services">Chapter 3, <cite class="chapter">Network Services</CITE
></A
>, for a description of RARP and <a class="xref" href="ch09_01.htm" title="Configuring Network Servers ">Chapter 9, <cite class="chapter">Configuring Network Servers </CITE
></A
> for information
on configuring a RARP server.</P
></DD
><dt class="term">CONFIG_NO_PATH_MTU_DISCOVERY</DT
><dd class="listitem"><p class="para">Removes path MTU discovery code<a class="indexterm" name="AUTOID-5055"></A
>
from the kernel. (Beware of the double
negative! A &quot;y&quot; [yes] disables MTU discovery and an &quot;n&quot; [no] enables
it.) Select &quot;no&quot;. Path MTU discovery is a technique that attempts
to determine the smallest maximum transmission unit (MTU)<a class="indexterm" name="AUTOID-5057"></A
>
along the entire path from a source to a destination. That MTU is then used for
subsequent transmissions to avoid datagram fragmentation.<a class="indexterm" name="AUTOID-5060"></A
>
See <a class="xref" href="ch01_01.htm" title="Overview of TCP/IP">Chapter 1, <cite class="chapter">Overview of TCP/IP</CITE
></A
>, for a description of fragmentation.</P
></DD
><dt class="term">CONFIG_IP_NOSR</DT
><dd class="listitem"><p class="para">Determines whether the system accepts source-routed datagrams.
Source routing<a class="indexterm" name="AUTOID-5068"></A
>
allows the source of the datagram to specify the
routers that are used to deliver the packet. Source routes are used
to force packets to travel over a specific path; for example, to test
the routers in a path or to avoid a high-cost link. However, the
problem with source routes is that they are used by <em class="emphasis">spoofers</EM
>.<a class="indexterm" name="AUTOID-5071"></A
><a class="indexterm" name="AUTOID-5074"></A
>
Spoofers are network intruders who pretend to be a system they
are not. For example, a spoofer might pretend to be a computer on one
of your enterprise subnets.<a class="indexterm" name="AUTOID-5076"></A
>
By using source routing, the spoofer could
cause your system to route packets off of your enterprise net that you
thought were going to a local system. Enabling  CONFIG_IP_NOSR makes it
impossible for a spoofer to use source routes against you. Select &quot;yes&quot;
unless you are positive that you must use source routes.</P
></DD
><dt class="term">CONFIG_SKB_LARGE</DT
><dd class="listitem"><p class="para">Sets whether or not the system will use a large transmission window size.<a class="indexterm" name="AUTOID-5083"></A
><a class="indexterm" name="AUTOID-5085"></A
>
Large windows improve network performance at the cost of additional
buffer space. Large windows can be disabled to save memory on systems
with less than 16MB of RAM. See <a class="xref" href="ch01_01.htm" title="Overview of TCP/IP">Chapter 1</A
> for a description of the
TCP transmission window.</P
></DD
><dt class="term">CONFIG_NETDEVICES</DT
><dd class="listitem"><p class="para"><a class="indexterm" name="AUTOID-5092"></A
>Adds the general support required for network hardware devices.
Always answer &quot;yes&quot;, which is the default, to this question. It is
required before configuring your Ethernet card.</P
></DD
><dt class="term">CONFIG_DUMMY</DT
><dd class="listitem"><p class="para">Enables support for a dummy interface.<a class="indexterm" name="AUTOID-5099"></A
>
An IP address can be assigned to
the dummy interface even if the system has no network interface hardware.
This is sometimes used by people who want to work on TCP/IP configuration
even though they don't have a network connection. If you have a network,
select &quot;no&quot;.</P
></DD
><dt class="term">CONFIG_EQUALIZER</DT
><dd class="listitem"><p class="para">Adds support for using multiple serial lines<a class="indexterm" name="AUTOID-5105"></A
>
simultaneously. Using this
feature, it is possible to have more than one physical PPP link
established between the local host and the remote server. The system load
balances between the links and attempts to treat them as a single logical
network connection. This is a technique for increasing the bandwidth<a class="indexterm" name="AUTOID-5109"></A
>
simply by adding additional modems and phone lines. The systems at
both ends must support serial line load balancing<a class="indexterm" name="AUTOID-5112"></A
><a class="indexterm" name="AUTOID-5116"></A
>
and they must do so
in exactly the same way. This option is used only when both systems are
Linux systems connected by multiple serial lines. Otherwise, select &quot;no&quot;.</P
></DD
><dt class="term">CONFIG_PLIP</DT
><dd class="listitem"><p class="para">Adds Parallel Line IP<a class="indexterm" name="AUTOID-5122"></A
><a class="indexterm" name="AUTOID-5124"></A
>
to the kernel. PLIP is a version of SLIP that
runs over the parallel printer port using a special crossover cable.
This protocol is intended for transferring data between two co-located
PCs, as the cable should be only 1 or 2 meters long. This has very
limited applicability.</P
></DD
><dt class="term">CONFIG_PPP</DT
><dd class="listitem"><p class="para">Adds the Point-to-Point Protocol (PPP)<a class="indexterm" name="AUTOID-5130"></A
>
to the kernel. PPP is the
TCP/IP standard protocol for communicating over serial lines. Select
&quot;yes&quot; if your system will use a modem connection for TCP/IP. <a class="xref" href="ch06_01.htm" title="Configuring the Interface ">Chapter 6, <cite class="chapter">Configuring the Interface </CITE
></A
>,
covers the configuration of this important protocol in detail.</P
></DD
><dt class="term">CONFIG_SLIP</DT
><dd class="listitem"><p class="para">Adds the Serial Line IP (SLIP)<a class="indexterm" name="AUTOID-5137"></A
>
to the kernel. SLIP is an older TCP/IP
protocol once widely used for communicating over serial lines. Chapter
6 covers SLIP configuration in detail.</P
></DD
><dt class="term">CONFIG_SLIP_COMPRESSED</DT
><dd class="listitem"><p class="para"><a class="indexterm" name="TCP2-CH-5-IX-HEADERS-COMPRESSING"></A
>Adds support for Van Jacobsen header compression<a class="indexterm" name="AUTOID-5146"></A
>
to the kernel.
Packet headers add a large amount of overhead when communicating over 
low-speed serial lines. Header compression greatly reduces this overhead.
The systems at both ends of the serial link must use header compression
for it to work. Most systems that run SLIP do use header compression.<a class="indexterm" name="AUTOID-5148"></A
></P
></DD
><dt class="term">CONFIG_SLIP_SMART</DT
><dd class="listitem"><p class="para">Adds support for <em class="emphasis">keepalives</EM
><a class="indexterm" name="AUTOID-5154"></A
>
to the kernel. Some servers drop a
connection or timeout<a class="indexterm" name="AUTOID-5156"></A
>
a route if the route or connection appears unused.
Use is determined by whether or not traffic is coming in over the link.
Keepalives are periodic transmissions sent for the explicit purpose of
generating traffic on a link so that it is not dropped as an inactive
line. The use of keepalives is discouraged. Most networks are
busy enough as it is!</P
></DD
><dt class="term">CONFIG_SLIP_MODE_SLIP6</DT
><dd class="listitem"><p class="para">Adds support for running SLIP over 6-bit serial lines.<a class="indexterm" name="AUTOID-5162"></A
>
Normally a modem and line are configured for 8-bit, no-parity to run SLIP or
PPP. This feature allows SLIP to be run in an environment that can not support
8-bit transmissions. This is non-standard and rarely used. The systems
at both ends of the link must support this protocol for it to work.</P
></DD
><dt class="term">CONFIG_NET_ETHERNET</DT
><dd class="listitem"><p class="para">Adds support for Ethernet hardware to the kernel. You need this for
your Ethernet LAN.<a class="indexterm" name="AUTOID-5168"></A
></P
></DD
></DL
><p class="para">The remaining questions allow you to select your network hardware.
A large number of Ethernet cards are supported by Linux. In the sample,
we selected the 3COM 3C509 card. The <b class="emphasis.bold">make config</B
> command also
allows us to select ARCnet,<a class="indexterm" name="AUTOID-5173"></A
><a class="indexterm" name="AUTOID-5175"></A
>
token ring, or ISDN interfaces.<a class="indexterm" name="AUTOID-5178"></A
>
Some hosts
use no specific network hardware. Instead, they run SLIP or PPP over a serial
port as their sole network connection. Select the hardware appropriate
for your system.</P
><p class="para">After <b class="emphasis.bold">make config</B
> asks questions about the network
configuration, it goes on to ask about several other aspects of the
system configuration. Next, it tells you to do a <b class="emphasis.bold">make dep; make clean</B
>
to build the dependencies and clean
up the odds and ends. When the makes are complete, you are ready
to compile the kernel. The <b class="emphasis.bold">make zImage</B
> command<a class="indexterm" name="AUTOID-5184"></A
>
builds a 
compressed kernel and puts it in the
<em class="emphasis">/usr/src/linux/i386/boot</EM
> directory.
[4]
Simply copy the new kernel file, <em class="emphasis">zImage</EM
>, to <em class="emphasis">/vmlinuz</EM
> and
you're ready to run.</P
><blockquote class="footnote"><p class="para">[4] Most Linux systems use a compressed kernel that is automatically decompressed
during the system boot.</P
></BLOCKQUOTE
><p class="para">Linux's list of network configuration options is as long lists
for UNIX kernel configuration. Linux is yin to the Solaris yang.
Linux permits the system administrator to configure everything, while
Solaris configures everything for the administrator. BSD kernel
configuration lies somewhere between these two extremes.<a class="indexterm" name="AUTOID-5192"></A
><a class="indexterm" name="AUTOID-5193"></A
></P
></DIV
><div class="htmlnav"><p></P
><hr align="LEFT" width="515" title="footer"><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="SECT1" href="ch05_01.htm" title="5.1 Kernel Configuration "><img src="../gifs/txtpreva.gif" alt="Previous: 5.1 Kernel Configuration " border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><a class="book" href="index.htm" title="TCP/IP Network Administration"><img src="../gifs/txthome.gif" alt="TCP/IP Network Administration" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="SECT1" href="ch05_03.htm#TCP2-CH-5-SECT-3.1.1" title="5.3 The BSD Kernel Configuration File "><img src="../gifs/txtnexta.gif" alt="Next: 5.3 The BSD Kernel Configuration File " border="0"></A
></TD
></TR
><tr><td align="LEFT" valign="TOP" width="172">5.1 Kernel Configuration </TD
><td align="CENTER" valign="TOP" width="171"><a class="index" href="index/idx_0.htm" title="Book Index"><img src="../gifs/index.gif" alt="Book Index" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172">5.3 The BSD Kernel Configuration File </TD
></TR
></TABLE
><hr align="LEFT" width="515" title="footer"><p class="nav"><font size="-1">[ <a href="../index.htm" title="The Networking CD Bookshelf">Library Home</A
> | <a href="../dnsbind/index.htm" title="DNS &amp; BIND">DNS &amp; BIND</A
> | <a href="index.htm" title="TCP/IP Network Administration">TCP/IP</A
> | <a href="../sendmail/index.htm" title="sendmail">sendmail</A
> | <a href="../smdref/index.htm" title="sendmail Desktop Reference">sendmail Reference</A
> | <a href="../firewall/index.htm" title="Building Internet Firewalls">Firewalls</A
> | <a href="../puis/index.htm" title="Practical UNIX &amp; Internet Security">Practical Security</A
> ]</FONT
></P
></DIV
></BODY
></HTML
>
