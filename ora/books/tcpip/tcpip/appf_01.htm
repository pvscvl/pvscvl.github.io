<html><head>
<title>[Appendix F] Selected TCP/IP Headers</TITLE>
<meta name="DC.title" content="TCP/IP Network Administration"><meta name="DC.creator" content="Craig Hunt"><meta name="DC.publisher" content="O'Reilly &amp; Associates, Inc."><meta name="DC.date" content="1999-02-04T01:46:31Z"><meta name="DC.type" content="Text.Monograph"><meta name="DC.format" content="text/html" scheme="MIME"><meta name="DC.source" content="1-56592-322-7" scheme="ISBN"><meta name="DC.language" content="en-US"><meta name="generator" content="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><link rev="made" href="mailto:online-books@oreilly.com" title="Online Books Comments"><link rel="up" href="index.htm" title="TCP/IP Network Administration"><link rel="prev" href="appe_05.htm" title="E.5 Sample Configurations"><link rel="next" href="appf_02.htm" title="F.2 TCP Segment Header"></HEAD
><body bgcolor="#FFFFFF" text="#000000"><div class="htmlnav"><h1><img src="gifs/smbanner.gif" alt="TCP/IP Network Administration" usemap="#srchmap" border="0"></H1
><map name=index.html"srchmap"><area shape="RECT" coords="0,0,466,65" href="index.htm" alt="TCP/IP Network Administration"><area shape="RECT" coords="467,0,514,18" href="../search/tsrch.htm" alt="Search this book"></MAP
><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="SECT1" href="appe_05.htm" title="E.5 Sample Configurations"><img src="../gifs/txtpreva.gif" alt="Previous: E.5 Sample Configurations" border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><b><font face="ARIEL,HELVETICA,HELV,SANSERIF" size="-1">Appendix F</FONT
></B
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="SECT1" href="appf_02.htm" title="F.2 TCP Segment Header"><img src="../gifs/txtnexta.gif" alt="Next: F.2 TCP Segment Header" border="0"></A
></TD
></TR
></TABLE
>&nbsp;<hr align="LEFT" width="515" title="footer"></DIV
><div class="APPENDIX"><h1 class="appendix"><a class="title" name="TCP2-AP-6">F. Selected TCP/IP Headers</A
></H1
><div class="htmltoc"><p><b>Contents:</B
><br><a class="SECT1" href="#TCP2-AP-6-SECT-1" title="F.1 IP Datagram Header">IP Datagram Header</A
><br><a class="SECT1" href="appf_02.htm" title="F.2 TCP Segment Header">TCP Segment Header</A
><br><a class="SECT1" href="appf_03.htm" title="F.3 ICMP Parameter Problem Message Header">ICMP Parameter Problem Message Header</A
></P
><p></P
></DIV
><p class="para"><a class="indexterm" name="TCP2-AP-6-IX-TCP-IP-PROTOCOL-SELECTED-HEADERS"></A
>In <a class="xref" href="ch11_01.htm" title="Troubleshooting TCP/IP ">Chapter 11, <cite class="chapter">Troubleshooting TCP/IP </CITE
></A
>,  several references are
made to specific TCP/IP headers. Those headers are documented here. 
This is not an exhaustive list of headers; only the headers
used in the troubleshooting examples in <a class="xref" href="ch11_01.htm" title="Troubleshooting TCP/IP ">Chapter 11</A
> are covered:</P
><ul class="itemizedlist"><li class="listitem"><p class="para">IP Datagram Header, as defined in RFC 791, <em class="emphasis">Internet
Protocol</EM
></P
></LI
><li class="listitem"><p class="para">TCP Segment Header, as defined in RFC 793, <em class="emphasis">Transmission Control
Protocol</EM
></P
></LI
><li class="listitem"><p class="para">ICMP Parameter Problem Message Header, as defined in RFC 792,
<em class="emphasis">Internet Control Message Protocol</EM
></P
></LI
></UL
><p class="para">Each header is presented using an excerpt from the RFC that defines the
header. These are not exact quotes; the excerpts have been slightly edited to
better fit this text. However, we still want to emphasize the
importance of using primary sources for troubleshooting protocol
problems. These headers are provided here to help you follow the
examples in <a class="xref" href="ch11_01.htm" title="Troubleshooting TCP/IP ">Chapter 11</A
>. For real troubleshooting, use the real RFCs.
You can obtain your own copies of the RFCs by following the
instructions in <a class="xref" href="ch13_01.htm" title="Internet Information Resources ">Chapter 13, <cite class="chapter">Internet Information Resources </CITE
></A
>.</P
><div class="sect1"><h2 class="sect1"><a class="title" name="TCP2-AP-6-SECT-1">F.1 IP Datagram Header</A
></H2
><p class="para"><a class="indexterm" name="AUTOID-29202"></A
>This description is taken from pages 11 to 15 of RFC 791,
<em class="emphasis">Internet Protocol</EM
>, by Jon
Postel, Information Sciences Institute, University of Southern
California.</P
><p class="para"><blockquote class="screen"><pre class="screen">Internet Header Format
                                    
    0                   1                   2                   3   
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |Version|  IHL  |Type of Service|          Total Length         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |         Identification        |Flags|      Fragment Offset    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |  Time to Live |    Protocol   |         Header Checksum       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                       Source Address                          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                    Destination Address                        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                    Options                    |    Padding    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

  Version:  4 bits

    The Version field indicates the format of the internet header. 
    This document describes version 4.

  IHL:  4 bits

    Internet Header Length is the length of the internet header in 32
    bit words.  The minimum value for a correct header is 5.

  Type of Service:  8 bits

    The Type of Service indication the quality of service desired.
    The meaning of the bits is explained below.

      Bits 0-2:  Precedence.
      Bit    3:  0 = Normal Delay,      1 = Low Delay.
      Bits   4:  0 = Normal Throughput, 1 = High Throughput.
      Bits   5:  0 = Normal Reliability 1 = High Reliability.
      Bit  6-7:  Reserved for Future Use.

         0     1     2     3     4     5     6     7
      +-----+-----+-----+-----+-----+-----+-----+-----+
      |                 |     |     |     |     |     |
      |   PRECEDENCE    |  D  |  T  |  R  |  0  |  0  |
      |                 |     |     |     |     |     |
      +-----+-----+-----+-----+-----+-----+-----+-----+

        Precedence

          111 - Network Control
          110 - Internetwork Control
          101 - CRITIC/ECP
          100 - Flash Override
          011 - Flash
          010 - Immediate
          001 - Priority
          000 - Routine

  Total Length:  16 bits

    Total Length is the length of the datagram, measured in octets 
    (bytes), including internet header and data.

  Identification:  16 bits

    An identifying value assigned by the sender to aid in assembling
    the fragments of a datagram.

  Flags:  3 bits

    Various Control Flags.  The Flag bits are explained below:

      Bit 0: reserved, must be zero
      Bit 1: (DF) 0 = May Fragment,  1 = Don't Fragment.
      Bit 2: (MF) 0 = Last Fragment, 1 = More Fragments.

          0   1   2
        +---+---+---+
        |   | D | M |
        | 0 | F | F |
        +---+---+---+

  Fragment Offset:  13 bits

    This field indicates where in the datagram this fragment belongs.
    The fragment offset is measured in units of 8 octets (64 bits).
    The first fragment has offset zero.

  Time to Live:  8 bits

    This field indicates the maximum time the datagram is allowed to
    remain in the internet system. 

  Protocol:  8 bits

    This field indicates the Transport Layer protocol that the data
    portion of this datagram is passed to.  The values for various
    protocols are specified in the &quot;Assigned Numbers&quot; RFC.

  Header Checksum:  16 bits

    A checksum on the header only.  Since some header fields change
    (e.g., time to live), this is recomputed and verified at each
    point that the internet header is processed.  The checksum
    algorithm is:

      The checksum field is the 16 bit one's complement of the one's
      complement sum of all 16 bit words in the header.  For purposes
      of computing the checksum, the value of the checksum field is
      zero.

  Source Address:  32 bits

    The source IP address.  See <a class="xref" href="ch02_01.htm" title="Delivering the Data">Chapter 2, <cite class="chapter">Delivering the Data</CITE
></A
>, for a
    description of IP addresses.

  Destination Address:  32 bits

    The destination IP address.  See <a class="xref" href="ch02_01.htm" title="Delivering the Data">Chapter 2</A
> for a description of IP
    addresses.

  Options:  variable

    The options may or may not appear in datagrams, but they must be
    implemented by all IP modules (host and gateways).  No options
    were used in any of the datagrams examined in <a class="xref" href="ch11_01.htm" title="Troubleshooting TCP/IP ">Chapter 11</A
>.</PRE
></BLOCKQUOTE
></P
></DIV
></DIV
><div class="htmlnav"><p></P
><hr align="LEFT" width="515" title="footer"><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="SECT1" href="appe_05.htm" title="E.5 Sample Configurations"><img src="../gifs/txtpreva.gif" alt="Previous: E.5 Sample Configurations" border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><a class="book" href="index.htm" title="TCP/IP Network Administration"><img src="../gifs/txthome.gif" alt="TCP/IP Network Administration" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="SECT1" href="appf_02.htm" title="F.2 TCP Segment Header"><img src="../gifs/txtnexta.gif" alt="Next: F.2 TCP Segment Header" border="0"></A
></TD
></TR
><tr><td align="LEFT" valign="TOP" width="172">E.5 Sample Configurations</TD
><td align="CENTER" valign="TOP" width="171"><a class="index" href="index/idx_0.htm" title="Book Index"><img src="../gifs/index.gif" alt="Book Index" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172">F.2 TCP Segment Header</TD
></TR
></TABLE
><hr align="LEFT" width="515" title="footer"><p class="nav"><font size="-1">[ <a href="../index.htm" title="The Networking CD Bookshelf">Library Home</A
> | <a href="../dnsbind/index.htm" title="DNS &amp; BIND">DNS &amp; BIND</A
> | <a href="index.htm" title="TCP/IP Network Administration">TCP/IP</A
> | <a href="../sendmail/index.htm" title="sendmail">sendmail</A
> | <a href="../smdref/index.htm" title="sendmail Desktop Reference">sendmail Reference</A
> | <a href="../firewall/index.htm" title="Building Internet Firewalls">Firewalls</A
> | <a href="../puis/index.htm" title="Practical UNIX &amp; Internet Security">Practical Security</A
> ]</FONT
></P
></DIV
></BODY
></HTML
>
