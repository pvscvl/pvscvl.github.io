<html><head>
<title>[Chapter 34] 34.8 Alphabetized Reference</TITLE>
<meta name="DC.title" content="sendmail"><meta name="DC.creator" content="Bryan Costales &amp; Eric Allman"><meta name="DC.publisher" content="O'Reilly &amp; Associates, Inc."><meta name="DC.date" content="1999-01-06T21:09:50Z"><meta name="DC.type" content="Text.Monograph"><meta name="DC.format" content="text/html" scheme="MIME"><meta name="DC.source" content="1-56592-222-0" scheme="ISBN"><meta name="DC.language" content="en-US"><meta name="generator" content="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><link rev="made" href="mailto:online-books@oreilly.com" title="Online Books Comments"><link rel="up" href="ch34_01.htm" title="34. Options"><link rel="prev" href="ch34_07.htm" title="34.7 Pitfalls"><link rel="next" href="ch35_01.htm" title="35. Headers"></HEAD
><body bgcolor="#FFFFFF" text="#000000"><div class="htmlnav"><h1><img src="gifs/smbanner.gif" alt="sendmail" usemap="#srchmap" border="0"></H1
><map name=index.html"srchmap"><area shape="RECT" coords="0,0,466,65" href="index.htm" alt="sendmail"><area shape="RECT" coords="467,0,514,18" href="../search/ssrch.htm" alt="Search this book"></MAP
><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="SECT1" href="ch34_07.htm" title="34.7 Pitfalls"><img src="../gifs/txtpreva.gif" alt="Previous: 34.7 Pitfalls" border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><b><font face="ARIEL,HELVETICA,HELV,SANSERIF" size="-1">Chapter 34<br>Options</FONT
></B
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="CHAPTER" href="ch35_01.htm" title="35. Headers"><img src="../gifs/txtnexta.gif" alt="Next: 35. Headers" border="0"></A
></TD
></TR
></TABLE
>&nbsp;<hr align="LEFT" width="515" title="footer"></DIV
><div class="SECT1"><h2 class="sect1"><a class="title" name="SML2-CH-34-SECT-8">34.8 Alphabetized Reference</A
></H2
><p class="para">In the following sections we present all the options that are currently available
for V8 <em class="emphasis">sendmail</EM
>.
They are in alphanumeric order sorted by the multicharacter name.
The multicharacter name appears at the left of each major section header.
If an old single-character name exists, it is displayed parenthetically
to the right of the multicharacter name.
In a few cases, multicharacter names have replaced macros.
In those instances the macro is displayed nonparenthetically.</P
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-1">34.8.1 AliasFile (A)</A
></H3
><p class="refpurpose">Define the aliases file location</P
>(All versions)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-41853"></A
>The <code class="literal">AliasFile</CODE
> (<code class="literal">A</CODE
>) option must be declared for
<em class="emphasis">sendmail</EM
> to do aliasing.
If you omit this option, <em class="emphasis">sendmail</EM
> may silently assume that
you do not want to do aliasing at all.
There is no default compiled into <em class="emphasis">sendmail</EM
> for the location
of the <em class="emphasis">aliases</EM
> file.
[4]
For V8 <em class="emphasis">m4</EM
> configurations an appropriate default will be defined
based on your operating system.</P
><blockquote class="footnote"><p class="para">[4] Beginning with V8.7, a switched-services file
(see <a class="xref" href="#SML2-CH-34-SECT-8-61" title="">Section 34.8.61</A
>) may cause aliases to be found
in NIS or other services and may completely ignore
alias files altogether.</P
></BLOCKQUOTE
><p class="para">If you specify a file that doesn't exist (such as <em class="emphasis">/et/aliases</EM
>
if you really meant <em class="emphasis">/etc/aliases</EM
>) 
or one that is unreadable, <em class="emphasis">sendmail</EM
> complains, for
example with</P
><p class="para"><blockquote class="screen"><pre class="screen">Can't open /et/aliases</PRE
></BLOCKQUOTE
></P
><p class="para">This is a nonfatal error. The <em class="emphasis">sendmail</EM
> program prints it
and continues to run but assumes that it shouldn't do aliasing.</P
><p class="para">The forms of the <code class="literal">AliasFile</CODE
> (<code class="literal">A</CODE
>) option are as follows:</P
><p class="para"><blockquote class="screen"><pre class="screen">OA<code class="replaceable"><i>location                        </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (old form)</I
>
-oA<code class="replaceable"><i>location                       </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (old form)</I
>
O AliasFile=<code class="replaceable"><i>location              </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (beginning with V8.7)</I
>
-OAliasFile=<code class="replaceable"><i>location              </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.7)</I
>
define(`ALIAS_FILE',`<code class="replaceable"><i>location</I
></CODE
>')   <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The <code class="replaceable"><i>location</I
></CODE
> is an argument of type string and
can be an absolute or a relative pathname. A relative
path (such as <em class="emphasis">../aliases</EM
>) can be used for testing but should
<em class="emphasis">never</EM
> be used in the production version of your <em class="emphasis">sendmail.cf</EM
>
file. To do so opens a security hole. Such a path is interpreted
by <em class="emphasis">sendmail</EM
> as relative to the queue directory.</P
><p class="para">This option can be used to change the name of the
<em class="emphasis">aliases</EM
> file (a possible consideration for security). If you
change the location or name of the <em class="emphasis">aliases</EM
> file, be aware
that other programs (such as <em class="emphasis">emacs</EM
> and Sun's <em class="emphasis">nis</EM
> services)
may cease to work properly.</P
><p class="para">Note that with the <em class="emphasis">m4</EM
> technique the only way to eliminate the default
alias file declaration (and thus to eliminate all <em class="emphasis">aliases</EM
>
support) is to <code class="literal">undefine</CODE
> ALIAS_FILE like this:</P
><p class="para"><blockquote class="screen"><pre class="screen">undefine(`ALIAS_FILE')</PRE
></BLOCKQUOTE
></P
><p class="para">The <em class="emphasis">sendmail</EM
> program also
allows you to use several alias databases simultaneously.
They are listed with the <code class="literal">AliasFile</CODE
> (<code class="literal">A</CODE
>) option as, for example,
like this:</P
><p class="para"><blockquote class="screen"><pre class="screen">O AliasFile=/etc/aliases/users,/etc/aliases/maillists</PRE
></BLOCKQUOTE
></P
><p class="para">In this case, <em class="emphasis">sendmail</EM
> will look up an alias first in the database
<em class="emphasis">/etc/aliases/users</EM
>. If it is not found, <em class="emphasis">sendmail</EM
> will then
look in <em class="emphasis">/etc/aliases/maillists</EM
>. The number of simultaneous alias
files is limited to MAXALIASDB (see <a class="xref" href="ch18_08.htm" title="">Section 18.8.19, MAX...</A
>) as defined in <em class="emphasis">conf.h</EM
> (by default
12). The <code class="literal">-bi</CODE
> command-line switch will rebuild all alias databases
in the order listed in this <code class="literal">AliasFile</CODE
> (<code class="literal">A</CODE
>) option. Multiple declarations lines
may appear in the file, each adding an alias database to the list:</P
><p class="para"><blockquote class="screen"><pre class="screen">O AliasFile=/etc/aliases/users     # aliases local users first
O AliasFile=/etc/aliases/maillists # then mailing lists
O AliasFile=/etc/aliases/retired   # then retired accounts</PRE
></BLOCKQUOTE
></P
><p class="para">Duplicates are not detected. Therefore the following causes <em class="emphasis">/etc/aliases</EM
>
to be searched and rebuilt twice each time:</P
><p class="para"><blockquote class="screen"><pre class="screen">O AliasFile=/etc/aliases
O AliasFile=/etc/aliases</PRE
></BLOCKQUOTE
></P
><p class="para">Multiple alias files may similarly be specified on the command line with
the <code class="literal">-o</CODE
> switch. But be aware that any alias files that are declared in the
command line
cause all the configuration file alias declarations to be ignored.</P
><p class="para">In addition to the name of alias databases, <em class="emphasis">sendmail</EM
> also allows
you to specify the class of each. The class is the same as the
classes that are available for the <code class="literal">K</CODE
> configuration command 
(see <a class="xref" href="ch33_03.htm#SML2-CH-33-SECT-3-4-2" title="The K Configuration Command">Section 33.3, "The K Configuration Command"</A
>).
The class prefixes the name, and the two are separated by a colon:</P
><p class="para"><blockquote class="screen"><pre class="screen">O AliasFile=nis:mail.aliases</PRE
></BLOCKQUOTE
></P
><p class="para">This example tells <em class="emphasis">sendmail</EM
> to look up aliases in the <em class="emphasis">nis</EM
> class
(the <code class="literal">nis</CODE
>) database called <code class="literal">mail.aliases</CODE
>. The class
can include switches that mean the same thing as those allowed for
the <code class="literal">K</CODE
> configuration command. </P
><p class="para">&#13;For example:</P
><p class="para"><blockquote class="screen"><pre class="screen">O AliasFile=nis:-N mail.aliases</PRE
></BLOCKQUOTE
></P
><p class="para">Here, the <code class="literal">-N</CODE
> class switch causes lookups to include a trailing
null byte with each key.
[5]</P
><blockquote class="footnote"><p class="para">[5] Also see <a class="xref" href="ch24_04.htm#SML2-CH-24-SECT-4-2" title="Duplicate Entries and Automation">Section 24.4.4, "Duplicate Entries and Automation"</A
>, which illustrates the <code class="literal">-A</CODE
>
option switch for appending keys.</P
></BLOCKQUOTE
><p class="para">Under V8.6 <em class="emphasis">sendmail</EM
> the reasonable classes are <em class="emphasis">hash</EM
>,
<em class="emphasis">btree</EM
>, <em class="emphasis">dbm</EM
>, <em class="emphasis">nis</EM
>, and <em class="emphasis">udb</EM
>. 
Under V8.7 <em class="emphasis">sendmail</EM
> this list can also include <em class="emphasis">nisplus</EM
> for
Sun's <em class="emphasis">nisplus</EM
> and <em class="emphasis">hesiod</EM
> for Hesiod support.
(See <a class="xref" href="ch33_03.htm#SML2-CH-33-SECT-3-4-2" title="The class">Section 33.3.2, "The class"</A
> and <a class="xref" href="ch33_03.htm#SML2-CH-33-SECT-3-4-2" title="The switches">Section 33.3.4, "The switches"</A
>.)
But note that it is generally better to use the service-switch
file to select services because it is less confusing.</P
><p class="para">If a class is not a known one and if the <code class="literal">-d27</CODE
> command-line
switch (see <a class="xref" href="ch37_05.htm" title="">Section 37.5.88, -d27.1</A
>) is specified, <em class="emphasis">sendmail</EM
> prints</P
><p class="para"><blockquote class="screen"><pre class="screen">Unknown alias class <code class="replaceable"><i>badclass</I
></CODE
></PRE
></BLOCKQUOTE
></P
><p class="para">If the class is one that cannot support aliasing (as defined
by MCF_ALIASOK in <em class="emphasis">conf.c</EM
>) and if the <code class="literal">-d27</CODE
> command-line
switch is specified, <em class="emphasis">sendmail</EM
> prints:</P
><p class="para"><blockquote class="screen"><pre class="screen">setalias: map class <code class="replaceable"><i>badclass</I
></CODE
> can't handle aliases</PRE
></BLOCKQUOTE
></P
><p class="para">In both cases the <code class="replaceable"><i>badclass</I
></CODE
> is the offending class.
Both errors cause the <code class="literal">AliasFile</CODE
> (<code class="literal">A</CODE
>)
option's alias file declaration to be ignored.</P
><p class="para">Beginning with V8.7 <em class="emphasis">sendmail</EM
>, the declaration and use of
alias files is further complicated
[6]
by the introduction of
switched-services files (see <a class="xref" href="#SML2-CH-34-SECT-8-61" title="">Section 34.8.61</A
>).
If the file defined by the <code class="literal">ServiceSwitchFile</CODE
> option exists,
and if it defines the type and location of alias information, each
alias definition is used just as if it was included in the configuration
file (although the syntax differs). On Solaris, Ultrix, and OSF systems,
switched-service files are supplied by the operating system.
With these you should
beware the silent introduction of unexpected alias services. On other
operating systems you may set up a V8.7 switched-service
file that can be used for aliases if you wish.</P
><blockquote class="footnote"><p class="para">[6] Or simplified, depending on whom you talk to.</P
></BLOCKQUOTE
><p class="para">The <code class="literal">AliasFile</CODE
> (<code class="literal">A</CODE
>) option is not safe.
If specified from the command line,
it may cause <em class="emphasis">sendmail</EM
> to relinquish its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-2">34.8.2 AliasWait (a)</A
></H3
><p class="refpurpose">Wait for aliases file rebuild</P
>(All versions)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-42000"></A
>Whenever <em class="emphasis">sendmail</EM
> rebuilds the <em class="emphasis">aliases</EM
> database, it first 
clears the old database.
It then rebuilds the database and, when done, adds the special
entry <code class="literal">@:@</CODE
>.
Before <em class="emphasis">sendmail</EM
> attempts to use the database,
it first looks in that database for the special entry <code class="literal">@:@</CODE
>
that should be present.
This curious entry is employed because it is one that is always
illegal in an <em class="emphasis">aliases</EM
> file.
If <em class="emphasis">sendmail</EM
> doesn't find that entry 
(whether because a user ran <em class="emphasis">newaliases</EM
>
or because another invocation of sendmail is currently rebuilding it),
it waits 2 seconds for that entry to appear, then checks again.
If the entry is still unavailable, the wait is doubled (up to 
maximum wait of 60 seconds). 
The total time waited (after all the sleeps without success)
is the interval specified by this
<code class="literal">AliasWait</CODE
> (<code class="literal">a</CODE
>) option.</P
><p class="para">When the <code class="literal">@:@</CODE
> appears, <em class="emphasis">sendmail</EM
>
checks to see whether the database
still needs to be rebuilt and rebuilds it if it does.
If the special entry <code class="literal">@:@</CODE
> does not appear after the specified
time and if the <code class="literal">AutoRebuildAliases</CODE
> (<code class="literal">D</CODE
>) option
(see <a class="xref" href="#SML2-CH-34-SECT-8-4" title="">Section 34.8.4</A
>) is set, <em class="emphasis">sendmail</EM
> assumes that some other process
died while that other process was rebuilding the database.
This assumption paves the way for <em class="emphasis">sendmail</EM
>
to go ahead and rebuild the database.
Note that if <code class="literal">AutoRebuildAliases</CODE
> (<code class="literal">D</CODE
>) option is not
set, <em class="emphasis">sendmail</EM
> uses the old information.</P
><p class="para">The forms of the <code class="literal">AliasWait</CODE
> (<code class="literal">a</CODE
>) option are as follows:</P
><p class="para"><blockquote class="screen"><pre class="screen">Oa<code class="replaceable"><i>delay                          </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (old style)</I
>
-oa<code class="replaceable"><i>delay                         </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (old style)</I
>
O AliasWait=<code class="replaceable"><i>delay                </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (beginning with V8.7)</I
>
-OAliasWait=<code class="replaceable"><i>delay                </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.7)</I
>
define(`confALIAS_WAIT',<code class="replaceable"><i>delay</I
></CODE
>)   <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The <code class="replaceable"><i>delay</I
></CODE
> argument is of type <em class="emphasis">time</EM
> 
and, if omitted, defaults to 5 minutes. 
If the entire
<code class="literal">AliasWait</CODE
> (<code class="literal">a</CODE
>) option is omitted 
or if <code class="replaceable"><i>delay</I
></CODE
> is zero or non-numeric,
the database is not automatically rebuilt.
If the unit of time desired is 

omitted, the delay defaults to minutes.
If you use the V8 <em class="emphasis">m4</EM
> configuration, the default for
<code class="literal">confALIAS_WAIT</CODE
> is 10 minutes.</P
><p class="para">The <code class="literal">AliasWait</CODE
> (<code class="literal">a</CODE
>) option is not safe.
If specified from the command line,
it may cause <em class="emphasis">sendmail</EM
> to relinquish its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-3">34.8.3 AllowBogusHELO</A
></H3
><p class="refpurpose">Allow no host with HELO or EHLO</P
>(V8.8 and above)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-42060"></A
><a class="indexterm" name="AUTOID-42062"></A
><a class="indexterm" name="AUTOID-42065"></A
><a class="indexterm" name="AUTOID-42068"></A
><a class="indexterm" name="AUTOID-42070"></A
>Prior to V8.7, <em class="emphasis">sendmail</EM
> would accept without complaint an SMTP HELO command 
(or an EHLO) that omitted the hostname:</P
><p class="para"><blockquote class="screen"><pre class="screen">220-oldsite.uofa.edu  Sendmail 8.6.13/8.6.13 ready at Fri, 31 Dec 1996 08:11:44 -0700
220 ESMTP spoken here
<code class="userinput"><b>HELO</B
></CODE
>
250 oldsite.uofa.edu Hello here.ufa.edu [123.45.67.89], pleased to meet you</PRE
></BLOCKQUOTE
></P
><p class="para">RFC1123, section 5.2.5, specifies that all HELO and EHLO
commands must be followed by a fully qualified hostname.</P
><p class="para"><blockquote class="screen"><pre class="screen">HELO here.uofa.edu
EHLO here.uofa.edu</PRE
></BLOCKQUOTE
></P
><p class="para">Beginning with V8.7, omitting the hostname results in one of the following
errors:</P
><p class="para"><blockquote class="screen"><pre class="screen">501 helo requires domain address
501 ehlo requires domain address</PRE
></BLOCKQUOTE
></P
><p class="para">Note that there is no check to see that the hostname is actually that of
the connecting host unless PICKY_HELO_CHECK is declared when
<em class="emphasis">sendmail</EM
> is compiled(see <a class="xref" href="ch18_08.htm" title="">Section 18.8.35, PICKY...</A
>). Also note
that the hostname that is specified must <em class="emphasis">appear</EM
> to be a correctly formed
hostname. If it is not, the following is printed:</P
><p class="para"><blockquote class="screen"><pre class="screen">501 Invalid domain name</PRE
></BLOCKQUOTE
></P
><p class="para">If you favor forcing other sites to obey the RFCs, don't enable this
option. But note that you may need to enable it if your site accepts connections
from other sites that don't obey the protocols.</P
><p class="para">The <code class="literal">AllowBogusHELO</CODE
> option is used like this:</P
><p class="para"><blockquote class="screen"><pre class="screen">O AllowBogusHELO=<code class="replaceable"><i>bool            </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8.8 and above</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The <code class="replaceable"><i>bool</I
></CODE
> is of type Boolean. If it is absent, the option defaults to
true (do allow the hostname to be omitted). If the entire option declaration
is missing, the default is false (require the hostname to be present).
Note that there is no <em class="emphasis">m4</EM
> shorthand for declaring this option.</P
><p class="para">The <code class="literal">AllowBogusHELO</CODE
> option safe.  Even if it is specified from the command line,
<em class="emphasis">sendmail</EM
> retains its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-4">34.8.4 AutoRebuildAliases (D)</A
></H3
><p class="refpurpose">Auto-rebuild the aliases database</P
>(All versions)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-42110"></A
>The need to rebuild the <em class="emphasis">aliases</EM
> database
is determined by comparing the modification time
of the <em class="emphasis">aliases</EM
> source file, as defined by the 
<code class="literal">AliasFile</CODE
> (<code class="literal">A</CODE
>) option (see <a class="xref" href="#SML2-CH-34-SECT-8-1" title="">Section 34.8.1</A
>),
to the modification time of the corresponding
<em class="emphasis">aliases.pag</EM
> and <em class="emphasis">aliases.dir</EM
>, or <em class="emphasis">aliases.db</EM
>,
database files. If the
source file is newer and if this <code class="literal">AutoRebuild-Aliases</CODE
> (<code class="literal">D</CODE
>)
option is set, <em class="emphasis">sendmail</EM
>
attempts to rebuild the <em class="emphasis">aliases</EM
> database. If
this option is not set, <em class="emphasis">sendmail</EM
> prints the following
warning and uses the information in the old database:</P
><p class="para"><blockquote class="screen"><pre class="screen">Warning: alias database <code class="replaceable"><i>fname</I
></CODE
> out of date</PRE
></BLOCKQUOTE
></P
><p class="para">Here, <code class="replaceable"><i>fname</I
></CODE
> is the name of the source file.
If you set this <code class="literal">AutoRebuildAliases</CODE
> (<code class="literal">D</CODE
>) option, be sure that the
<code class="literal">AliasWait</CODE
> (<code class="literal">a</CODE
>) option (see <a class="xref" href="#SML2-CH-34-SECT-8-2" title="">Section 34.8.2</A
>)
is also declared and given a nonzero time argument.
(File locking, to prevent simultaneous rebuilds, is described under the
<code class="literal">AliasWait</CODE
> (<code class="literal">a</CODE
>) option.)</P
><p class="para">The forms of this <code class="literal">AutoRebuildAliases</CODE
> (<code class="literal">D</CODE
>) option are as follows:</P
><p class="para"><blockquote class="screen"><pre class="screen">OD<code class="replaceable"><i>bool                            </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (old style)</I
>
-oD<code class="replaceable"><i>bool                           </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (old style)</I
>
O AutoRebuildAliases=<code class="replaceable"><i>bool         </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (beginning with V8.7)</I
>
-OAutoRebuildAliases=<code class="replaceable"><i>bool         </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.7)</I
>
define(`confAUTO_REBUILD',<code class="replaceable"><i>bool</I
></CODE
>)   <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">With no argument, <code class="literal">AutoRebuildAliases</CODE
> (<code class="literal">D</CODE
>)
is set to true (the <em class="emphasis">aliases</EM
> database is automatically
rebuilt).
If the entire <code class="literal">AutoRebuildAliases</CODE
> (<code class="literal">D</CODE
>) option 
is missing, it defaults to false (no automatic rebuilds).</P
><p class="para">IDA <em class="emphasis">sendmail</EM
> uses <em class="emphasis">fcntl</EM
>(3) to prevent simultaneous rebuilds.
Old versions of <em class="emphasis">sendmail</EM
> used <em class="emphasis">flock</EM
>(3).
V8 <em class="emphasis">sendmail</EM
> uses either <em class="emphasis">fcntl</EM
>(3) or <em class="emphasis">flock</EM
>(3),
depending on how it was compiled.</P
><p class="para">The <code class="literal">AutoRebuildAliases</CODE
> (<code class="literal">D</CODE
>) option is not safe. 
If specified from the command line,
it may cause <em class="emphasis">sendmail</EM
> to relinquish its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-5">34.8.5 BlankSub (B)</A
></H3
><p class="refpurpose">Set unquoted space replacement</P
>(All versions)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-42179"></A
><a class="indexterm" name="AUTOID-42181"></A
>Some mailer programs have difficulty handling addresses that
contain spaces. Such addresses are both illegal under RFC821
and RFC822 and subject to gross misinterpretation.
For example, the address&#13;</P
><p class="para"><blockquote class="screen"><pre class="screen">John Q Public@wash.dc.gov</PRE
></BLOCKQUOTE
></P
><p class="para">&#13;is viewed by some MUA programs as being composed of three separate
addresses: <code class="literal">John</CODE
>, <code class="literal">Q</CODE
>, and
<code class="literal">Public@wash.dc.gov</CODE
>.
To prevent this misinterpretation, such MUAs usually
either quote the user portion or escape each space with a backslash:&#13;</P
><p class="para"><blockquote class="screen"><pre class="screen">&quot;John Q Public&quot;@wash.dc.gov <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> quoted</I
>
John\ Q\ Public@wash.dc.gov <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> escaped</I
></PRE
></BLOCKQUOTE
></P
><p class="para">&#13;The <code class="literal">BlankSub</CODE
> (<code class="literal">B</CODE
>) option is intended to handle an address that
contains internal spaces, and is <em class="emphasis">neither</EM
> quoted nor escaped.
For <em class="emphasis">sendmail</EM
> a space is any character
defined by the C language library routine <em class="emphasis">isspace</EM
>(3).</P
><p class="para">Most sites use a . (dot or period) or an _ (underscore)
character to replace unquoted space characters. That is, they declare
the <code class="literal">BlankSub</CODE
> (<code class="literal">B</CODE
>) option as one of the following:&#13;</P
><p class="para"><blockquote class="screen"><pre class="screen">OB.
OB_</PRE
></BLOCKQUOTE
></P
><p class="para">&#13;Feeding the address</P
><p class="para"><blockquote class="screen"><pre class="screen">John Q Public@wash.dc.gov</PRE
></BLOCKQUOTE
></P
><p class="para">&#13;through <em class="emphasis">sendmail</EM
> with the option <code class="literal">OB.</CODE
> set yields</P
><p class="para"><blockquote class="screen"><pre class="screen">John.Q.Public@wash.dc.gov</PRE
></BLOCKQUOTE
></P
><p class="para">The forms of the <code class="literal">BlankSub</CODE
> (<code class="literal">B</CODE
>) option are as follows:</P
><p class="para"><blockquote class="screen"><pre class="screen">OB<code class="replaceable"><i>char                         </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (old style)</I
>
-oB<code class="replaceable"><i>char                        </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (old style)</I
>
O BlankSub=<code class="replaceable"><i>char                </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (beginning with V8.7)</I
>
-OBlankSub=<code class="replaceable"><i>char                </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.7)</I
>
define(`confBLANK_SUB',<code class="replaceable"><i>char</I
></CODE
>)   <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The argument <code class="replaceable"><i>char</I
></CODE
> is of type character
and is a single character.
The default, if this option is omitted or if the <code class="replaceable"><i>char</I
></CODE
> 
argument is omitted, is that an unquoted space character is replaced
with a space character (which does nothing to correct the problem at all).
The default for the <em class="emphasis">m4</EM
> technique is the dot (<code class="literal">.</CODE
>) character.</P
><p class="para">Note that old-style addresses are delimited from each other with
spaces rather than commas. Such addresses may be wrongly joined into
a single address if the <code class="replaceable"><i>char</I
></CODE
> is other than a space. Acceptance
of such old-style addresses is determined by the setting of the 
<code class="literal">OldStyleHeaders</CODE
> (<code class="literal">o</CODE
>) option (see <a class="xref" href="#SML2-CH-34-SECT-8-44" title="">Section 34.8.44</A
>).</P
><p class="para">Also note that this <code class="literal">BlankSub</CODE
> (<code class="literal">B</CODE
>) option may also be used when tokenized addresses
are reassembled
(see <a class="xref" href="ch28_02.htm#SML2-CH-28-SECT-2-3" title="Pasting Addresses Back Together">Section 28.2.3, "Pasting Addresses Back Together"</A
>).</P
><p class="para">The <code class="literal">BlankSub</CODE
> (<code class="literal">B</CODE
>) option is not safe.  If specified from the command line,
it may cause <em class="emphasis">sendmail</EM
> to relinquish its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-6">34.8.6 CheckAliases (n)</A
></H3
><p class="refpurpose">Check right-hand side of aliases</P
>(V8.1 and above)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-42255"></A
>Ordinarily, when <em class="emphasis">sendmail</EM
> rebuilds an aliases database
(as defined by the <code class="literal">AliasFile</CODE
> (<code class="literal">A</CODE
>) option, see <a class="xref" href="#SML2-CH-34-SECT-8-1" title="">Section 34.8.1</A
>),
it checks only the addresses to the left of the colon to
make sure they all resolve to a delivery agent that has 
the <code class="literal">F=A</CODE
> flag set (see <a class="xref" href="ch30_08.htm" title="">Section 30.8.12, F=A</A
>).
It is possible to also have
addresses to the right of the colon checked for validity
by setting option <code class="literal">CheckAliases</CODE
> (<code class="literal">n</CODE
>) option to true. </P
><p class="para">The forms of the <code class="literal">CheckAliases</CODE
> (<code class="literal">n</CODE
>) option are as follows:</P
><p class="para"><blockquote class="screen"><pre class="screen">On<code class="replaceable"><i>bool                             </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (old style)</I
>
-on<code class="replaceable"><i>bool                            </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (oldstyle)</I
>
-on                                <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line shorthand</I
>
O CheckAliases=<code class="replaceable"><i>bool                </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (beginning with V8.7)</I
>
-OCheckAliases=<code class="replaceable"><i>bool                </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.7)</I
>
define(`confCHECK_ALIASES',<code class="replaceable"><i>True</I
></CODE
>)   <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The <code class="replaceable"><i>bool</I
></CODE
> is of type Boolean. If it is absent, the option defaults to
true (do check the right-hand side of aliases). If the entire option declaration
is missing, the default is false (don't check the right-hand side of aliases).
The default for the <em class="emphasis">m4</EM
> configuration technique is false.</P
><p class="para">Addresses to the right of the colon are
checked only to be sure they are good addresses. Each is processed
by rule set 3 and then rule set 0 to select a delivery agent. Processing
merely needs to successfully select any non-<code class="literal">#error</CODE
> delivery agent
(see <a class="xref" href="ch30_05.htm#SML2-CH-30-SECT-5-2-1" title="The error Delivery Agent">Section 30.5.2, "The error Delivery Agent"</A
>). 
The <em class="emphasis">sendmail</EM
> program prints and logs the following warning and skips
any address that fails to select a valid delivery agent:</P
><p class="para"><blockquote class="screen"><pre class="screen"><em class="emphasis">address</EM
>... bad address</PRE
></BLOCKQUOTE
></P
><p class="para">If the address selects an <code class="literal">#error</CODE
> delivery agent, the
error text for that error is printed instead:</P
><p class="para"><blockquote class="screen"><pre class="screen"><em class="emphasis">address</EM
>... user address required</PRE
></BLOCKQUOTE
></P
><p class="para">The <code class="literal">CheckAliases</CODE
> (<code class="literal">n</CODE
>) option is further 
described in <a class="xref" href="ch24_05.htm#SML2-CH-24-SECT-5-1" title="Check the Right Side of Aliases">Section 24.5.2, "Check the Right Side of Aliases"</A
>.
This option is safe.  Even if it is specified from the command line,
<em class="emphasis">sendmail</EM
> retains its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-7">34.8.7 CheckpointInterval (C)</A
></H3
><p class="refpurpose">Checkpoint the queue</P
>(V8.1 and above)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-42310"></A
><a class="indexterm" name="AUTOID-42313"></A
>When a single email message is sent to many recipients (those on 
a mailing list, for example),
a single <em class="emphasis">sendmail</EM
> process handles all the recipients.
Should that <em class="emphasis">sendmail</EM
> process die or be killed halfway through
processing, there is no record that the first half was delivered.
As a result, when the queue is later reprocessed, the recipients
in that first half will receive the message a second time.</P
><p class="para">The <code class="literal">CheckpointInterval</CODE
> (<code class="literal">C</CODE
>) option can limit the duplication.
It tells <em class="emphasis">sendmail</EM
> to rewrite (checkpoint) its 
<code class="literal">qf</CODE
> file (which contains the list of recipients; see <a class="xref" href="ch23_02.htm#SML2-CH-23-SECT-2-5" title="The Queue Control File: qf">Section 23.2.5, "The Queue Control File: qf"</A
>)
after each group of a specified number of recipients has been delivered. 
Recipients who have already received mail are deleted from
the list, and that list is rewritten to the <code class="literal">qf</CODE
> file. The forms of the <code class="literal">CheckpointInterval</CODE
> (<code class="literal">C</CODE
>) option are as follows:</P
><p class="para"><blockquote class="screen"><pre class="screen">OC<code class="replaceable"><i>num                                   </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (old style)</I
>
-oC<code class="replaceable"><i>num                                  </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (old style)</I
>
O CheckpointInterval=<code class="replaceable"><i>num                </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (beginning with V8.7)</I
>
-OCheckpointInterval=<code class="replaceable"><i>num                </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.7)</I
>
define(`confCHECKPOINT_INTERVAL','<code class="replaceable"><i>num</I
></CODE
>') <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The <code class="replaceable"><i>num</I
></CODE
> argument is of type numeric and specifies
the number of recipients in each group.
If <code class="replaceable"><i>num</I
></CODE
> is entirely missing, is non-numeric, or is zero, this feature is disabled.
If the entire <code class="literal">CheckpointInterval</CODE
> (<code class="literal">C</CODE
>) option is missing,
the default is 10.
There is a small performance penalty that increases as <code class="replaceable"><i>num</I
></CODE
> 
approaches 1. A good starting value is 4, meaning that at most four people
will get duplicate deliveries. Note that the <code class="literal">F=M</CODE
> flag on local
delivery will try as many recipients as possible before checkpointing,
even if that number is greater than the value of this
<code class="literal">CheckpointInterval</CODE
> option. The <code class="literal">CheckpointInterval</CODE
> (<code class="literal">C</CODE
>) option is safe. Even if it is specified from the command line,
<em class="emphasis">sendmail</EM
> retains its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-8">34.8.8 ClassFactor (z)</A
></H3
><p class="refpurpose">Multiplier for priority increments</P
>(All versions)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-42358"></A
><a class="indexterm" name="AUTOID-42360"></A
><a class="indexterm" name="AUTOID-42364"></A
>The <code class="literal">ClassFactor</CODE
> (<code class="literal">z</CODE
>) option 
specifies a multiplying weight (factor) for a message's precedence
when determining a message's priority.
This option interacts with the <code class="literal">RecipientFactor</CODE
> (<code class="literal">y</CODE
>)
option (see <a class="xref" href="#SML2-CH-34-SECT-8-53" title="">Section 34.8.53</A
>), and both options
are described under that latter option.</P
><p class="para">The forms of the <code class="literal">ClassFactor</CODE
> (<code class="literal">z</CODE
>) option are as follows:</P
><p class="para"><blockquote class="screen"><pre class="screen">Oz<code class="replaceable"><i>factor                                 </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (old form)</I
>
-oz<code class="replaceable"><i>factor                                </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (old form)</I
>
O ClassFactor=<code class="replaceable"><i>factor                     </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (beginning with V8.7)</I
>
-OClassFactor=<code class="replaceable"><i>factor                     </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.7)</I
>
define(`confWORK_CLASS_FACTOR',<code class="replaceable"><i>factor</I
></CODE
>)   <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The argument <code class="replaceable"><i>factor</I
></CODE
> is of type numeric. If that
argument is missing, the default value is zero. If the entire
option is missing, the default value is 1800.
The default for the <em class="emphasis">m4</EM
> technique is to omit this option.</P
><p class="para">The <code class="literal">ClassFactor</CODE
> (<code class="literal">z</CODE
>) option is not safe. 
If specified from the command line,
it may cause <em class="emphasis">sendmail</EM
> to relinquish its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-9">34.8.9 ColonOkInAddr</A
></H3
><p class="refpurpose">Allow colons in addresses</P
>(8.7 and above)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-42402"></A
><a class="indexterm" name="AUTOID-42404"></A
><a class="indexterm" name="AUTOID-42406"></A
><a class="indexterm" name="AUTOID-42408"></A
><a class="indexterm" name="AUTOID-42411"></A
>One possible form of an address is called &quot;list syntax&quot; and
looks like this:</P
><p class="para"><blockquote class="screen"><pre class="screen">group: list;</PRE
></BLOCKQUOTE
></P
><p class="para">Here, <code class="literal">group</CODE
> is the name of a mailing list, and <code class="literal">list</CODE
>
is a list of zero or more addresses to which the message should
be delivered (see <a class="xref" href="ch17_01.htm" title="A rule to handle List:;">Section 17.1.2.1, "A rule to handle List:;"</A
>).
To understand this kind of address, <em class="emphasis">sendmail</EM
> needs to view
the prefix and colon as a comment and the trailing semicolon as a comment.
This is similar to treating everything outside an angle-bracketed
address as a comment:</P
><p class="para"><blockquote class="screen"><pre class="screen">group:  list  ;
group: &lt;list&gt; ;</PRE
></BLOCKQUOTE
></P
><p class="para">For such addresses to be recognizable, it is necessary to prohibit
the use of other addresses that contain colons, 
unless those colons appear inside a part of the
address that is surrounded by angle brackets.
That is, to use list syntax, addresses like the following cannot
be allowed:</P
><p class="para"><blockquote class="screen"><pre class="screen">host:george@wash.dc.gov</PRE
></BLOCKQUOTE
></P
><p class="para">To handle this situation, V8.7 <em class="emphasis">sendmail</EM
> has introduced
the <code class="literal">ColonOkInAddr</CODE
> option. It is used like this:</P
><p class="para"><blockquote class="screen"><pre class="screen">O ColonOkInAddr=<code class="replaceable"><i>bool                  </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file</I
>
-OColonOkInAddr=<code class="replaceable"><i>bool                  </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line</I
>
define(`confCOLON_OK_IN_ADDR',<code class="replaceable"><i>bool</I
></CODE
>)   <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The argument <code class="replaceable"><i>bool</I
></CODE
> is of type Boolean. If it is absent, this
option is true (colons are okay, so list syntax is not recognized).
If this option is entirely omitted or if <code class="replaceable"><i>bool</I
></CODE
> is false,
colons are not okay, so list syntax is recognized.
Note that for version 5 or earlier configuration files (see
<a class="xref" href="ch27_05.htm#SML2-CH-27-SECT-5-1" title="The V Configuration Command">Section 27.5, "The V Configuration Command"</A
> for a description of the <code class="literal">V</CODE
>
configuration command), this option is automatically set to true.
Also note that for <em class="emphasis">m4</EM
> configurations this option is
absent (false) by default.</P
><p class="para">Note that DECnet style addresses (see <a class="xref" href="ch29_04.htm#SML2-CH-29-SECT-4-5" title="Handling Specialty Addresses">Section 29.4.4, "Handling Specialty Addresses"</A
>)
legitimately contain double colons (e.g., <code class="literal">host::user</CODE
>). DECnet
addresses are correctly recognized no matter how
this <code class="literal">ColonOkInAddr</CODE
> option is set.</P
><p class="para">The <code class="literal">ColonOkInAddr</CODE
> option is safe. If it is specified from the command line,
<em class="emphasis">sendmail</EM
> will not relinquish its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-10">34.8.10 ConnectionCacheSize (k)</A
></H3
><p class="refpurpose">Multiple-SMTP connections</P
>(V8.1 and above)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-42458"></A
><a class="indexterm" name="AUTOID-42460"></A
><a class="indexterm" name="AUTOID-42463"></A
>Usually, <em class="emphasis">sendmail</EM
> uses a single autonomous SMTP session
to transmit one email message to another host. It connects to
the other host, transmits the message, and closes the connection.
Although this approach is sufficient for most mail, there are
times when sending multiple messages during a single connection
is preferable. This is called <em class="emphasis">caching</EM
>
connections. </P
><p class="para">When <em class="emphasis">sendmail</EM
> caches a connection, it connects
to the other host and transmits the mail message as usual. But
instead of closing the connection, it keeps the connection open
so that it can transmit additional mail messages without the
additional overhead of opening and closing the connection each time.
The <code class="literal">ConnectionCacheSize</CODE
> (<code class="literal">k</CODE
>)
option of V8 <em class="emphasis">sendmail</EM
> specifies that
open connections to other hosts should be maintained and the maximum
number of those connections.
The forms of the <code class="literal">ConnectionCacheSize</CODE
> (<code class="literal">k</CODE
>) option are as follows:</P
><p class="para"><blockquote class="screen"><pre class="screen">Ok<code class="replaceable"><i>num                               </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (V8.6)</I
>
-ok<code class="replaceable"><i>num                              </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (V8.6)</I
>
O ConnectionCacheSize=<code class="replaceable"><i>num           </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (beginning with V8.7)</I
>
-OConnectionCacheSize=<code class="replaceable"><i>num           </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.7)</I
>
define(`confMCI_CACHE_SIZE',<code class="replaceable"><i>num</I
></CODE
>)    <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">There may be optional whitespace preceding the <code class="replaceable"><i>num</I
></CODE
>.
The <code class="replaceable"><i>num</I
></CODE
> is an integer that specifies
the maximum number of simultaneous connections to keep open.
If <code class="replaceable"><i>num</I
></CODE
> is zero, this caching feature is turned off.
A value of 1 is good for workstations that forward all mail
to a central mail server and is the default that is used if this
option is entirely missing. When configuring with V8's <em class="emphasis">m4</EM
>
technique, the default is 2.
A value of 4 is the maximum for
most machines that forward mail directly over the Internet.
Higher values require that you increase the number of open
files allowed per process at the system level.</P
><p class="para">Caching is of greatest benefit in processing the queue.
V8 <em class="emphasis">sendmail</EM
> automatically adapts to conditions
to avoid caching connections for each invocation of <em class="emphasis">sendmail</EM
>.
Maintenance of an open connection
can delay return to the user's program, for example,
and too many open connections
to a common target host can create a high load on that host.</P
><p class="para">When caching is enabled with this <code class="literal">ConnectionCacheSize</CODE
> (<code class="literal">k</CODE
>) option, the
<code class="literal">ConnectionCacheTimeout</CODE
> (<code class="literal">K</CODE
>) option should also be declared to
set the connection timeout.
The <code class="literal">ConnectionCacheSize</CODE
> (<code class="literal">k</CODE
>) option is not safe.  If specified from the command line,
it may cause <em class="emphasis">sendmail</EM
> to relinquish its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-11">34.8.11 ConnectionCacheTimeout (K)</A
></H3
><p class="refpurpose">Multiple-SMTP time-outs</P
>(V8.1 and above)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-42512"></A
><a class="indexterm" name="AUTOID-42515"></A
><a class="indexterm" name="AUTOID-42517"></A
><a class="indexterm" name="AUTOID-42520"></A
>Maintaining a cached connection to another host (see <a class="xref" href="#SML2-CH-34-SECT-8-10" title="">Section 34.8.10</A
>) imposes a penalty on both the local host and the other host. Each connection means
that the other host is running a forked <em class="emphasis">sendmail</EM
> process
that is doing nothing but waiting for an SMTP QUIT message
to close the connection or for more mail to arrive.
The local host has open sockets that consume system resources.</P
><p class="para">To limit the impact on other hosts, V8 <em class="emphasis">sendmail</EM
> offers
the <code class="literal">ConnectionCacheTimeout</CODE
> (<code class="literal">K</CODE
>) option. This option tells <em class="emphasis">sendmail</EM
> how long
to wait for another mail message before closing the connection.</P
><p class="para">The forms of the <code class="literal">ConnectionCacheTimeout</CODE
> (<code class="literal">K</CODE
>) option are as follows:</P
><p class="para"><blockquote class="screen"><pre class="screen">OK<code class="replaceable"><i>wait                                 </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (V8.6)</I
>
-oK<code class="replaceable"><i>wait                                </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (V8.6)</I
>
O ConnectionCacheTimeout=<code class="replaceable"><i>wait          </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (beginning with V8.7)</I
>
-OConnectionCacheTimeout=<code class="replaceable"><i>wait          </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.7)</I
>
define(`confMCI_CACHE_TIMEOUT',<code class="replaceable"><i>wait</I
></CODE
>)   <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">There may be optional whitespace preceding the
<code class="replaceable"><i>wait</I
></CODE
>. The <code class="replaceable"><i>wait</I
></CODE
> is of type time and specifies
the period to wait before timing out a cached connection.
If this option is entirely missing, the default (for both 
the configuration file and the <em class="emphasis">m4</EM
> configuration technique)
is 300 seconds
(five minutes). When specifying the <code class="replaceable"><i>wait</I
></CODE
>, be sure to
include a trailing <code class="literal">s</CODE
> character. If you don't, the number that
you specify is interpreted by default as a number of minutes.
The <code class="replaceable"><i>wait</I
></CODE
> should never be longer than five minutes.
A value of 0 essentially turns off caching.</P
><p class="para">This <code class="literal">ConnectionCacheTimeout</CODE
> (<code class="literal">K</CODE
>) option has an effect 
only if the <code class="literal">ConnectionCacheSize</CODE
> (<code class="literal">k</CODE
>) option (see
<a class="xref" href="#SML2-CH-34-SECT-8-10" title="">Section 34.8.10</A
>) is also declared. 
The <code class="literal">ConnectionCacheTimeout</CODE
> (<code class="literal">K</CODE
>) option is not safe.  If specified from the command line,
it may cause <em class="emphasis">sendmail</EM
> to relinquish its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-12">34.8.12 ConnectionRateThrottle</A
></H3
><p class="refpurpose">Incoming SMTP connection rate</P
>(V8.8 and above)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-42570"></A
><a class="indexterm" name="AUTOID-42572"></A
><a class="indexterm" name="AUTOID-42575"></A
>Whenever an outside site connects to <em class="emphasis">sendmail</EM
>'s SMTP port, <em class="emphasis">sendmail</EM
>
<em class="emphasis">fork</EM
>(2)s a copy of itself. That copy (the child) processes the incoming
message.  Beginning with V8.8, <em class="emphasis">sendmail</EM
> keeps track of how many child processes
it has spawned to handle incoming connections. The <code class="literal">MaxDaemonChildren</CODE
>
(see <a class="xref" href="#SML2-CH-34-SECT-8-35" title="">Section 34.8.35</A
>) option can be used to reject connections 
when the number of children has exceeded a specified threshold.</P
><p class="para">A different approach is to slow down acceptance of, rather than to reject,
new connections when the number of children becomes too high. 
This allows the <code class="literal">QueueLA</CODE
> (<code class="literal">x</CODE
>) option (see <a class="xref" href="#SML2-CH-34-SECT-8-50" title="">Section 34.8.50</A
>)
and the <code class="literal">RefuseLA</CODE
> (<code class="literal">X</CODE
>) option
(see <a class="xref" href="#SML2-CH-34-SECT-8-54" title="">Section 34.8.54</A
>) to operate properly
even if many incoming connections arrive simultaneously.
You slow incoming connections
with the <code class="literal">ConnectionRateThrottle</CODE
> option:</P
><p class="para"><blockquote class="screen"><pre class="screen">O ConnectionRateThrottle=<code class="replaceable"><i>num                      </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8.8 and above</I
>
define(`confCONNECTION_RATE_THROTTLE', <code class="replaceable"><i>num)       </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 technique</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The <code class="replaceable"><i>num</I
></CODE
> is of type numeric. If it is present and greater than
zero, connections are slowed when more than that number of connections 
arrive within one second.
If <code class="replaceable"><i>num</I
></CODE
> is less than or equal to zero, or absent, no threshold
is enforced. If the entire option is missing, the default becomes zero.
The default for the <em class="emphasis">m4</EM
> technique is to omit this option.</P
><p class="para">To illustrate how the slowdown operates, consider a situation in which
<code class="replaceable"><i>num</I
></CODE
> is set to 3, and 12 connections come in simultaneously.
The first three connections are handled immediately. The next three
are handled after one second. The three after that are handled
after two seconds, and so on. The twelfth connection would
be handled after a delay of three seconds.</P
><p class="para">Note that this option and the <code class="literal">MaxDaemonChildren</CODE
>
option (see <a class="xref" href="#SML2-CH-34-SECT-8-35" title="">Section 34.8.35</A
>) affect incoming connections differently.</P
><p class="para">The <code class="literal">ConnectionRateThrottle</CODE
> option is not safe.  If specified from the command line,
it may cause <em class="emphasis">sendmail</EM
> to relinquish its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-13">34.8.13 DaemonPortOptions (O)</A
></H3
><p class="refpurpose">Options for the daemon</P
>(V8.1 and above)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-42619"></A
><a class="indexterm" name="AUTOID-42621"></A
>The <code class="literal">DaemonPortOptions</CODE
> (<code class="literal">O</CODE
>) option is used to
customize the daemon's SMTP service. The form for this
option is as follows:</P
><p class="para"><blockquote class="screen"><pre class="screen">OO<code class="replaceable"><i>pair,pair,pair                                </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (old form)</I
>
-oO<code class="replaceable"><i>pair,pair,pair                               </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (old form)</I
>
O DaemonPortOptions=<code class="replaceable"><i>pair,pair,pair              </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (beginning with V8.7)</I
>

-ODaemonPortOptions=<code class="replaceable"><i>pair,pair,pair              </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.7)</I
>
define(`confDAEMON_OPTIONS',`<code class="replaceable"><i>pair,pair,pair</I
></CODE
>')   <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The <code class="literal">DaemonPortOptions</CODE
> (<code class="literal">O</CODE
>) is followed by a comma-separated list
of pairs, in which each pair is of the form:</P
><p class="para"><blockquote class="screen"><pre class="screen">key=value</PRE
></BLOCKQUOTE
></P
><p class="para">Only six keys are available, and prior to V8.7 they were case-sensitive.
Prior to V8.7 an unknown key was silently ignored. Now an unknown
key not only is ignored but also causes following error to be printed:</P
><p class="para"><blockquote class="screen"><pre class="screen">DaemonPortOptions unknown parameter &quot;<i class="lineannotation">key</I
>&quot;</PRE
></BLOCKQUOTE
></P
><p class="para">The list of all currently defined <code class="replaceable"><i>key</I
></CODE
>s is shown in 
<a class="xref" href="#SML2-CH-34-TAB-11" title="DaemonPortOptions Option Keywords">Table 34.12</A
>.</P
><table class="table"><caption class="table"><a class="title" name="SML2-CH-34-TAB-11">Table 34.12: DaemonPortOptions Option Keywords</A
></CAPTION
><thead class="thead"><tr class="row" valign="TOP"><th class="entry" align="LEFT" rowspan="1" colspan="1">Key</TH
><th class="entry" align="LEFT" rowspan="1" colspan="1"></TH
><th class="entry" align="LEFT" rowspan="1" colspan="1">Meaning</TH
></TR
></THEAD
><tbody class="tbody"><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1">Addr</TD
><td class="entry" rowspan="1" colspan="1"><a class="xref" href="#SML2-CH-34-SECT-8-13-1" title="DaemonPortOptions=Addr">Section 34.8.13.1, "DaemonPortOptions=Addr"</A
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">The network to accept connection from</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1">Family</TD
><td class="entry" rowspan="1" colspan="1"><a class="xref" href="#SML2-CH-34-SECT-8-13-2" title="DaemonPortOptions=Family">Section 34.8.13.2, "DaemonPortOptions=Family"</A
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">The type network we are connected to</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1">Listen</TD
><td class="entry" rowspan="1" colspan="1"><a class="xref" href="#SML2-CH-34-SECT-8-13-3" title="DaemonPortOptions=Listen">Section 34.8.13.3, "DaemonPortOptions=Listen"</A
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">The size of the <em class="emphasis">listen</EM
>(2) queue</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1">Port</TD
><td class="entry" rowspan="1" colspan="1"><a class="xref" href="#SML2-CH-34-SECT-8-13-4" title="DaemonPortOptions=Port">Section 34.8.13.4, "DaemonPortOptions=Port"</A
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">The port number on which <em class="emphasis">sendmail</EM
> should listen</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1">ReceiveSize</TD
><td class="entry" rowspan="1" colspan="1"><a class="xref" href="#SML2-CH-34-SECT-8-13-5" title="DaemonPortOptions=ReceiveSize">Section 34.8.13.5, "DaemonPortOptions=ReceiveSize"</A
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">The size of the TCP/IP receive buffer</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1">SendSize</TD
><td class="entry" rowspan="1" colspan="1"><a class="xref" href="#SML2-CH-34-SECT-8-13-6" title="DaemonPortOptions=SendSize">Section 34.8.13.6, "DaemonPortOptions=SendSize"</A
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">The size of the TCP/IP send buffer</P
></TD
></TR
></TBODY
></TABLE
><p class="para">Only the first character in each <code class="replaceable"><i>key</I
></CODE
> is recognized,
so a succinct declaration such as the following can be used
to change the port used by the daemon:</P
><p class="para"><blockquote class="screen"><pre class="screen">OOP=26,A=our-net    # Only listen for local mail                 <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> old form</I
>
O DaemonPortOptions=P=26,A=our-net  # Only listen for local mail <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> beginning with V8.7</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The <code class="literal">O</CODE
> option is not safe.  If specified from the command line,
it may cause <em class="emphasis">sendmail</EM
> to relinquish its <em class="emphasis">root</EM
> privilege.&#13;</P
><div class="refsect2"><h4 class="refsect2"><a class="title" name="SML2-CH-34-SECT-8-13-1">34.8.13.1 DaemonPortOptions=Addr</A
></H4
><p class="para">The <code class="literal">Addr</CODE
> key is used to specify the network
to use. The <code class="literal">value</CODE
> is the name
[7]
or IP address of one of your network interfaces:</P
><blockquote class="footnote"><p class="para">[7] Names did not work prior to V8.8 <em class="emphasis">sendmail</EM
>.</P
></BLOCKQUOTE
><p class="para"><blockquote class="screen"><pre class="screen">O DaemonPortOptions=Addr=128.32.204.25     # listen to our internal network only</PRE
></BLOCKQUOTE
></P
><p class="para">If the <code class="literal">Addr</CODE
> pair is omitted, the default network
becomes INADDR_ANY, 
which allows connections from any network.&#13;</P
></DIV
><div class="refsect2"><h4 class="refsect2"><a class="title" name="SML2-CH-34-SECT-8-13-2">34.8.13.2 DaemonPortOptions=Family</A
></H4
><p class="para">The <code class="literal">Family</CODE
> key is used to specify the network family.
The legal possible values are 
<em class="emphasis">inet</EM
> for AF_INET,
<em class="emphasis">iso</EM
> for AF_ISO, 
<em class="emphasis">ns</EM
> for AF_NS, and 
<em class="emphasis">x.25</EM
> for AF_CCITT. </P
><p class="para"><blockquote class="screen"><pre class="screen">O DaemonPortOptions=Family=iso</PRE
></BLOCKQUOTE
></P
><p class="para">Note that only <em class="emphasis">inet</EM
> and <em class="emphasis">iso</EM
> are
currently supported. The default is <em class="emphasis">inet</EM
>.
Also note that <em class="emphasis">inet</EM
> requires NETINET to be defined,
and <em class="emphasis">iso</EM
> requires NETISO to be defined when
<em class="emphasis">sendmail</EM
> is being compiled (see <a class="xref" href="ch18_08.htm" title="">Section 18.8.26, NET...</A
>).&#13;</P
></DIV
><div class="refsect2"><h4 class="refsect2"><a class="title" name="SML2-CH-34-SECT-8-13-3">34.8.13.3 DaemonPortOptions=Listen</A
></H4
><p class="para">When <em class="emphasis">sendmail</EM
> begins to run in <em class="emphasis">daemon</EM
> mode, it
executes a <em class="emphasis">listen</EM
>(2) system call as part of monitoring
its SMTP port for incoming mail. The second argument to
<em class="emphasis">listen</EM
>(2) defines the maximum length to which the incoming
queue of pending connections may grow.  If a connection request
arrives with the queue full, the client will receive an error
that indicates ECONNREFUSED. This <code class="literal">Listen</CODE
> key
is used to change the size of the incoming queue from its
default of 10. If <code class="literal">Listen</CODE
> is less than or equal to zero, 
<em class="emphasis">listen</EM
>(2) will silently set its own default. But note that
some kernels may have built-in defaults of their own, so
setting <code class="literal">Listen</CODE
> may have no effect at all.&#13;</P
></DIV
><div class="refsect2"><h4 class="refsect2"><a class="title" name="SML2-CH-34-SECT-8-13-4">34.8.13.4 DaemonPortOptions=Port</A
></H4
><p class="para">The <code class="literal">Port</CODE
> key is used to specify the service
port on which the daemon should listen. This is
normally the port called <code class="literal">smtp</CODE
>, as defined in
the <em class="emphasis">/etc/services</EM
> file. The value may be either
a services string (such as <code class="literal">smtp</CODE
>) or a
number (such as 25). This key is useful inside domains
that are protected by a firewall. By specifying a
non-standard port, the firewall can communicate
in a more secure manner with the internal network
while still accepting mail on the normal port from
the outside world:</P
><p class="para"><blockquote class="screen"><pre class="screen">O DaemonPortOptions=Port=26</PRE
></BLOCKQUOTE
></P
><p class="para">If this pair is missing, the port defaults to <code class="literal">smtp</CODE
>.&#13;</P
></DIV
><div class="refsect2"><h4 class="refsect2"><a class="title" name="SML2-CH-34-SECT-8-13-5">34.8.13.5 DaemonPortOptions=ReceiveSize</A
></H4
><p class="para">The <code class="literal">ReceiveSize</CODE
> key is used to specify the size of
the TCP/IP receive buffer. 
The value is a size in bytes.
This should not be set unless you are having performance problems.
Slow links (such as 9.6K SL/IP lines) might profit from a setting
of 256, for example:</P
><p class="para"><blockquote class="screen"><pre class="screen">O DaemonPortOptions=ReceiveSize=256</PRE
></BLOCKQUOTE
></P
><p class="para">The default value is set by the system (see <em class="emphasis">setsockopt</EM
>(2)).&#13;</P
></DIV
><div class="refsect2"><h4 class="refsect2"><a class="title" name="SML2-CH-34-SECT-8-13-6">34.8.13.6 DaemonPortOptions=SendSize</A
></H4
><p class="para">The <code class="literal">SendSize</CODE
> key is used to specify the size of the TCP/IP
send buffer.
The value is a size in bytes.
This should not be set unless you are having performance problems.
Slow links (such as 9.6K SL/IP lines) might profit from a setting
of 256, for example:</P
><p class="para"><blockquote class="screen"><pre class="screen">O DaemonPortOptions=SendSize=256</PRE
></BLOCKQUOTE
></P
><p class="para">The default value is set by the system (see <em class="emphasis">setsockopt</EM
>(2)).</P
></DIV
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-14">34.8.14 DefaultCharSet</A
></H3
><p class="refpurpose">Content-Type: character set</P
>(V8.7 and above)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-42783"></A
><a class="indexterm" name="AUTOID-42786"></A
><a class="indexterm" name="AUTOID-42789"></A
><a class="indexterm" name="AUTOID-42792"></A
><a class="indexterm" name="AUTOID-42795"></A
><a class="indexterm" name="AUTOID-42797"></A
>When a mail message is converted from 8 to 7 bits
(see the <code class="literal">EightBitMode</CODE
> (<code class="literal">8</CODE
>)
option in <a class="xref" href="#SML2-CH-34-SECT-8-22" title="">Section 34.8.22</A
>), it is important
that the result look like a MIME message. V8.7 <em class="emphasis">sendmail</EM
> first
outputs the following header if one is not already present:</P
><p class="para"><blockquote class="screen"><pre class="screen">MIME-Version: 1.0</PRE
></BLOCKQUOTE
></P
><p class="para">After that, V8.7 <em class="emphasis">sendmail</EM
> looks for a <code class="literal">Content-Type:</CODE
> header
(see <a class="xref" href="ch35_10.htm" title="">Section 35.10.9, Content-Type:</A
>).
If none is found, the following is inserted, where <code class="replaceable"><i>charset</I
></CODE
>
is the value declared for this option:</P
><p class="para"><blockquote class="screen"><pre class="screen">Content-Type: text/plain; charset=<code class="replaceable"><i>charset</I
></CODE
></PRE
></BLOCKQUOTE
></P
><p class="para">The forms of the <code class="literal">DefaultCharSet</CODE
> option are as follows:</P
><p class="para"><blockquote class="screen"><pre class="screen">O DefaultCharSet=<code class="replaceable"><i>charset</I
></CODE
>                  <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file</I
>
-ODefaultCharSet=<code class="replaceable"><i>charset</I
></CODE
>                  <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line</I
>
define(`confDEF_CHAR_SET',<code class="replaceable"><i>charset</I
></CODE
>)        <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">If <code class="literal">DefaultCharSet</CODE
> is undefined, <code class="replaceable"><i>charset</I
></CODE
>
defaults to the string &quot;unknown-8bit.&quot;
The default for the <em class="emphasis">m4</EM
> technique is to omit this option.</P
><p class="para">Note that if the <code class="literal">C=</CODE
> equate (<a class="xref" href="ch30_04.htm" title="">Section 30.4.2, C=</A
>)
is present for the sender's delivery agent, that
character set supersedes the <code class="literal">DefaultCharSet</CODE
>.</P
><p class="para">The <code class="literal">DefaultCharSet</CODE
> option is safe. If specified from the command line,
<em class="emphasis">sendmail</EM
> will not relinquish its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-15">34.8.15 DefaultUser (g)(u)</A
></H3
><p class="refpurpose">Default delivery agent identity</P
>(All versions)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-42843"></A
><a class="indexterm" name="AUTOID-42846"></A
><a class="indexterm" name="AUTOID-42849"></A
>The <em class="emphasis">sendmail</EM
> program can be run as an <em class="emphasis">suid</EM
> <em class="emphasis">root</EM
> process
(that is, with the permissions of the <em class="emphasis">root</EM
>, no matter who runs it)
or as an ordinary
process, run by an ordinary (nonprivileged) user (that is,
with <em class="emphasis">root</EM
> privilege <em class="emphasis">only</EM
> if it is run by <em class="emphasis">root</EM
>).
When <em class="emphasis">sendmail</EM
> is run so that it has <em class="emphasis">root</EM
>
privilege, it must give up that privilege 

under certain circumstances
to remain secure.
[8]
When it can't set its identity
to that of a real user, <em class="emphasis">sendmail</EM
> sets its <em class="emphasis">gid</EM
> to that specified
by the <code class="literal">g</CODE
> option and its <em class="emphasis">uid</EM
> to that specified by the <code class="literal">u</CODE
>
option. For version 8.7 and above, the
<code class="literal">DefaultUser</CODE
> option sets both the user and group identities.
[9]</P
><blockquote class="footnote"><p class="para">[8] V8 is more security conscious and presumes that it is still <em class="emphasis">root</EM
> even if it
has given up that privilege.</P
><p class="para">[9] In essence, the <code class="literal">g</CODE
> and <code class="literal">u</CODE
> options have been deprecated in favor of 
a single <code class="literal">DefaultUser</CODE
> option, which sets both.</P
></BLOCKQUOTE
><p class="para">When <em class="emphasis">sendmail</EM
> is running with <em class="emphasis">root</EM
> privilege and
when the <code class="literal">F=S</CODE
> delivery agent flag (see <a class="xref" href="ch30_08.htm" title="">Section 30.8.40, F=S</A
>)
is <em class="emphasis">not</EM
> specified, <em class="emphasis">sendmail</EM
>
changes its owner and group identity to that of an ordinary
user in the following circumstances:&#13;</P
><dl class="variablelist"><dt class="term">1.</DT
><dd class="listitem"><p class="para">If the mail message is forwarded because of a user's <em class="emphasis">~/.forward</EM
>
file and if delivery is via a delivery
agent that has the <code class="literal">F=o</CODE
> flag set (see
<a class="xref" href="ch30_08.htm" title="">Section 30.8.33, F=o</A
>), then <em class="emphasis">sendmail</EM
> changes its owner and
group identity to that of the user whose <em class="emphasis">~/.forward</EM
> file was read.&#13;</P
></DD
><dt class="term">2.</DT
><dd class="listitem"><p class="para">Otherwise, if the mail message is being delivered through an
<em class="emphasis">aliases</EM
>(5) file's <code class="literal">:include:</CODE
> mailing list expansion
and if delivery is via a delivery
agent that has the <code class="literal">F=o</CODE
> flag set (see <a class="xref" href="ch30_08.htm" title="">Section 30.8.33</A
>)
or to a file, then <em class="emphasis">sendmail</EM
> changes its owner and
group identity to that of the owner of the file that was
specified by the <code class="literal">:include:</CODE
> line.&#13;</P
></DD
><dt class="term">3.</DT
><dd class="listitem"><p class="para">Otherwise, 
if the sender of the mail message is local
and if delivery is via a delivery
agent that does not have the <code class="literal">F=o</CODE
> flag set (see <a class="xref" href="ch30_08.htm" title="">Section 30.8.33</A
>)
or to a file, then <em class="emphasis">sendmail</EM
> changes its owner and
group identity to that of the sender. If the sender is <em class="emphasis">root</EM
>,
<em class="emphasis">sendmail</EM
> changes its owner and
group identity to that specified by the <code class="literal">DefaultUser</CODE
>
option.&#13;</P
></DD
><dt class="term">4.</DT
><dd class="listitem"><p class="para">Otherwise, <em class="emphasis">sendmail</EM
> changes its owner and
group identity to that specified by the <code class="literal">DefaultUser</CODE
>
option.</P
></DD
></DL
><p class="para">These user and group defaults are ignored
if the delivery agent's <code class="literal">F=</CODE
> equate includes the <code class="literal">S</CODE
> flag
(run as another specified user). 
These user and group defaults are also ignored
for any delivery agent that specifies the <code class="literal">U=</CODE
> equate (see
<a class="xref" href="ch30_04.htm" title="">Section 30.4.13, U=</A
>), which customizes user and group identities
at the individual delivery agent level, but only if the <code class="literal">F=o</CODE
>
equate is not specified.</P
><p class="para">The forms of the <code class="literal">DefaultUser</CODE
> (<code class="literal">u</CODE
>) (<code class="literal">g</CODE
>) option are as follows:</P
><p class="para"><blockquote class="screen"><pre class="screen">Ou<code class="replaceable"><i>uid                               </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> user, configuration file (old form)</I
>
-ou<code class="replaceable"><i>uid                              </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> user, command line (old form)</I
>
Og<code class="replaceable"><i>gid                               </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> group, configuration file (old form)</I
>
-og<code class="replaceable"><i>gid                              </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> group, command line (old form)</I
>
Ou<code class="replaceable"><i>uid:gid                           </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> both, configuration file (beginning with V8.7)</I
>
-ou<code class="replaceable"><i>uid:gid                          </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> both, command line (beginning with V8.7)</I
>
O DefaultUser=<code class="replaceable"><i>uid:gid               </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> both, configuration file (beginning with V8.7)</I
>
-ODefaultUser=<code class="replaceable"><i>uid:gid               </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> both, command line (beginning with V8.7)</I
>
define(`confDEF_USER_ID',<code class="replaceable"><i>uid</I
></CODE
>)       <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> user, V8 m4 configuration</I
>
define(`confDEF_GROUP_ID',<code class="replaceable"><i>gid</I
></CODE
>)      <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> group, V8 m4 configuration (obsolete as of V8.7)</I
>
define(`confDEF_USER_ID',<code class="replaceable"><i>uid:gid</I
></CODE
>)   <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> both, V8 m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The arguments <code class="replaceable"><i>uid</I
></CODE
> and <code class="replaceable"><i>gid</I
></CODE
> are of type numeric. Beginning with
V8 <em class="emphasis">sendmail</EM
>, user or group names can also be text (for example, <code class="literal">nobody</CODE
>).
Beginning with V8.7 <em class="emphasis">sendmail</EM
>, the user definition
with <code class="literal">DefaultUser</CODE
> or <code class="literal">u</CODE
> can specify both user and group.
For example,</P
><p class="para"><blockquote class="screen"><pre class="screen">O DefaultUser=daemon:nogroup</PRE
></BLOCKQUOTE
></P
><p class="para">There may be arbitrary whitespace between the user (<code class="literal">daemon</CODE
>), the
colon,
[10]
and the group (<code class="literal">nogroup</CODE
>). If the group is missing, the
value that is assigned to it varies depending on the nature of the <code class="literal">uid</CODE
>
specification.
If the <code class="literal">uid</CODE
> is a name, the group becomes
the default group of that user as defined in the <em class="emphasis">passwd</EM
>(5) file.
If the <code class="literal">uid</CODE
> is numeric, the value in the group is not changed.
For example, consider this <em class="emphasis">passwd</EM
>(5) file entry,
where the group <code class="literal">12</CODE
> corresponds to the group name <code class="literal">bumgroup</CODE
>:</P
><blockquote class="footnote"><p class="para">[10] The character between the user and group notations can be a colon,
a period, or a forward slash. The colon is recommended.</P
></BLOCKQUOTE
><p class="para"><blockquote class="screen"><pre class="screen">bogus:*:10:12::/:</PRE
></BLOCKQUOTE
></P
><p class="para">Then all the following are equivalent:</P
><p class="para"><blockquote class="screen"><pre class="screen">O DefaultUser=bogus
O DefaultUser=bogus:12
O DefaultUser=bogus:bumgroup</PRE
></BLOCKQUOTE
></P
><table class="informaltable"><tbody class="tbody"><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1"><code class="literal">Og12</CODE
></TD
><td class="entry" rowspan="1" colspan="1"><img src="../chars/lbbcb.gif" alt="[lbbcb]"></TD
><td class="entry" rowspan="1" colspan="1"><em class="emphasis"> taken together </EM
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1"><code class="literal">Ou10</CODE
></TD
><td class="entry" rowspan="1" colspan="1"><img src="../chars/ltbcb.gif" alt="[ltbcb]"></TD
></TR
></TBODY
></TABLE
><p class="para">But the following combination causes the group to reset to 12:</P
><p class="para"><blockquote class="screen"><pre class="screen">Og77
Oubogus</PRE
></BLOCKQUOTE
></P
><p class="para">Under pre-8.7 <em class="emphasis">sendmail</EM
>
a missing argument causes the value 0 to be used for the respective 
user or group identities.
If an entire <code class="literal">u</CODE
> or <code class="literal">g</CODE
> option is
missing, the default value becomes 1 (usually <em class="emphasis">daemon</EM
>). Under
V8.7 <em class="emphasis">sendmail</EM
> the default is -1.
In NFS-mounted environments, safe values for these options are
one less than those of the user <em class="emphasis">nobody</EM
> and the group <em class="emphasis">nogroup</EM
>.</P
><p class="para">For maximum security, you should create a special pseudo-user and
assign that pseudo-user to this option. (See <a class="xref" href="ch22_08.htm#SML2-CH-22-SECT-8-1" title="The DefaultUser option">Section 22.8.3.1, "The DefaultUser option"</A
>
for a more detailed description of this approach.)</P
><p class="para">The <code class="literal">g</CODE
>, <code class="literal">u</CODE
>, and <code class="literal">DefaultUser</CODE
> options are not safe. 
If specified from the command line,
they may cause <em class="emphasis">sendmail</EM
> to relinquish its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-16">34.8.16 DeliveryMode (d)</A
></H3
><p class="refpurpose">Set delivery mode</P
>(All versions)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-43018"></A
>There are four modes that <em class="emphasis">sendmail</EM
> can use for
delivering mail. Three have always been a part 
of <em class="emphasis">sendmail</EM
>: background, interactive, and queue-only.
One is new to V8.7 <em class="emphasis">sendmail</EM
>: deferred.</P
><p class="para">The mode is selected with the <code class="literal">DeliveryMode</CODE
> (<code class="literal">d</CODE
>) option:</P
><p class="para"><blockquote class="screen"><pre class="screen">Od<code class="replaceable"><i>mode                             </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (old form)</I
>
-od<code class="replaceable"><i>mode                            </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (old form)</I
>
O DeliveryMode=<code class="replaceable"><i>mode                </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (beginning with V8.7)</I
>
-ODeliveryMode=<code class="replaceable"><i>mode                </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.7)</I
>
define(`confDELIVERY_MODE',<code class="replaceable"><i>mode</I
></CODE
>)   <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The <code class="replaceable"><i>mode</I
></CODE
> argument is of type character. It is case sensitive (must
be lowercase) and is selected from one of the keywords
shown in
<a class="xref" href="#SML2-CH-34-TAB-12" title="DeliveryMode Option Keywords">Table 34.13</A
>.
Only the first letter of each is recognized, but we 
recommend full words for improved clarity.</P
><table class="table"><caption class="table"><a class="title" name="SML2-CH-34-TAB-12">Table 34.13: DeliveryMode Option Keywords</A
></CAPTION
><thead class="thead"><tr class="row" valign="TOP"><th class="entry" align="LEFT" rowspan="1" colspan="1">Keyword</TH
><th class="entry" align="LEFT" rowspan="1" colspan="1">Description</TH
><th class="entry" align="LEFT" rowspan="1" colspan="1"></TH
></TR
></THEAD
><tbody class="tbody"><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1"><code class="literal">background</CODE
></TD
><td class="entry" rowspan="1" colspan="1"><a class="xref" href="#SML2-CH-34-SECT-8-16-1" title="DeliveryMode=background">Section 34.8.16.1, "DeliveryMode=background"</A
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Background (asynchronous) delivery</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1"><code class="literal">deferred</CODE
></TD
><td class="entry" rowspan="1" colspan="1"><a class="xref" href="#SML2-CH-34-SECT-8-16-2" title="DeliveryMode=deferred">Section 34.8.16.2, "DeliveryMode=deferred"</A
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Deferred (held as is) delivery (beginning with V8.7)</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1"><code class="literal">interactive</CODE
></TD
><td class="entry" rowspan="1" colspan="1"><a class="xref" href="#SML2-CH-34-SECT-8-16-3" title="DeliveryMode=interactive">Section 34.8.16.3, "DeliveryMode=interactive"</A
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Interactive (synchronous) delivery</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1"><code class="literal">queueonly</CODE
></TD
><td class="entry" rowspan="1" colspan="1"><a class="xref" href="#SML2-CH-34-SECT-8-16-4" title="DeliveryMode=queueonly">Section 34.8.16.4, "DeliveryMode=queueonly"</A
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Queued (held but processed) delivery</P
></TD
></TR
></TBODY
></TABLE
><p class="para">If the <code class="literal">mode</CODE
> argument is missing,
this option defaults to the <code class="literal">i</CODE
> or interactive mode.
If the entire <code class="literal">DeliveryMode</CODE
> (<code class="literal">d</CODE
>) option is missing, 
V8 <em class="emphasis">sendmail</EM
> then defaults to background mode,
but old <em class="emphasis">sendmail</EM
> behaves unpredictably;
consequently, this option should be considered mandatory. 
The default for a V8 <em class="emphasis">m4</EM
> configuration is also background.</P
><p class="para">If the mode character is other than one of the first lowercase letters shown in
<a class="xref" href="#SML2-CH-34-TAB-12" title="DeliveryMode Option Keywords">Table 34.13</A
>
<em class="emphasis">sendmail</EM
> will print and log the following error
and will immediately exit with an exit value of EX_USAGE
as defined in <em class="emphasis">&lt;sysexits.h&gt;</EM
>:</P
><p class="para"><blockquote class="screen"><pre class="screen">Unknown delivery mode <code class="replaceable"><i>char</I
></CODE
></PRE
></BLOCKQUOTE
></P
><p class="para">Queue-only and deferred modes are only available if 
QUEUE was defined when <em class="emphasis">sendmail</EM
> was
compiled (see <a class="xref" href="ch18_08.htm" title="">Section 18.8.37, QUEUE</A
>). If QUEUE was not
defined and one of these two modes is selected, <em class="emphasis">sendmail</EM
>
will print and log the following:</P
><p class="para"><blockquote class="screen"><pre class="screen">need QUEUE to set -odqueue or -oddefer</PRE
></BLOCKQUOTE
></P
><p class="para">The <code class="literal">DeliveryMode</CODE
> (<code class="literal">d</CODE
>) option is safe.  Even if it is specified from the command line,
<em class="emphasis">sendmail</EM
> retains its <em class="emphasis">root</EM
> privilege.&#13;</P
><div class="refsect2"><h4 class="refsect2"><a class="title" name="SML2-CH-34-SECT-8-16-1">34.8.16.1 DeliveryMode=background</A
></H4
><p class="para">Background mode&nbsp;- intended primarily
[11]
for use in the configuration file&nbsp;- allows <em class="emphasis">sendmail</EM
> 
to run <em class="emphasis">asynchronously</EM
>.
This means that once <em class="emphasis">sendmail</EM
> has gathered the entire message
and verified that the recipient is deliverable,
it will <em class="emphasis">fork</EM
>(3) a copy of itself and exit. The copy, running
in the background (asynchronously), will then handle the delivery. 
From the user's point
of view, this mode allows the mail interface program to act
as though it sent the message nearly instantaneously.&#13;</P
><blockquote class="footnote"><p class="para">[11] A sending program (MUA) might need to use background
mode on the command line (<code class="literal">db</CODE
>) if the
message is urgent and if the default in <em class="emphasis">sendmail</EM
>'s configuration
file is to queue all messages (with <code class="literal">q</CODE
> mode). </P
></BLOCKQUOTE
></DIV
><div class="refsect2"><h4 class="refsect2"><a class="title" name="SML2-CH-34-SECT-8-16-2">34.8.16.2 DeliveryMode=deferred</A
></H4
><p class="para">Deferred mode&nbsp;- for use in either the command line or the configuration
file&nbsp;- is much like queue-only mode except that all database lookups,
including DNS,
are deferred until the actual queue run. Deferred mode (new with V8.7)
is preferred
for dial-on-demand sites (typically, modem-based SL/IP or PPP
connections). As in queue-only mode, all mail is queued for
later delivery, but with deferred mode, code inside <em class="emphasis">sendmail</EM
> that
would ordinarily interact with DNS is suppressed. This prevents
the modem from being dialed and connections from being established every
time mail is queued.&#13;</P
></DIV
><div class="refsect2"><h4 class="refsect2"><a class="title" name="SML2-CH-34-SECT-8-16-3">34.8.16.3 DeliveryMode=interactive</A
></H4
><p class="para">Interactive mode&nbsp;- intended for use from the command
line&nbsp;- causes <em class="emphasis">sendmail</EM
> to run <em class="emphasis">synchronously</EM
>.
This mode is useful primarily for debugging mail problems.
Instead of going into the background with <em class="emphasis">fork</EM
>(3), it runs
in the foreground (synchronously). In this mode, error messages are printed
back to the controlling terminal rather than being mailed to
the user as bounced mail. The <code class="literal">-v</CODE
> command-line switch (see <a class="xref" href="ch36_07.htm" title="">Section 36.7.41</A
>)
automatically sets the mode to interactive.&#13;</P
></DIV
><div class="refsect2"><h4 class="refsect2"><a class="title" name="SML2-CH-34-SECT-8-16-4">34.8.16.4 DeliveryMode=queueonly</A
></H4
><p class="para">Queue-only mode&nbsp;- for use in either the command line or the configuration
file&nbsp;- causes
<em class="emphasis">sendmail</EM
> to synchronously queue mail.
Queue-only mode is useful at sites that have huge amounts
of UUCP mail or Usenet news batch feeds or when delivering to
low priority addresses such as mailing lists.
Queuing has the beneficial effect of serializing delivery through
queue runs, and it reduces the load on a machine that many parallel
backgrounded <em class="emphasis">sendmail</EM
> processes can cause.
Queue-only mode is typically supplied as a command-line option to 
<em class="emphasis">sendmail</EM
> by the <em class="emphasis">uuxqt</EM
>(8) program.
When queue-only mode is selected, all mail is
queued for delivery, and none is actually delivered. A separate run
of <em class="emphasis">sendmail</EM
> with its <code class="literal">-q</CODE
> command-line switch 
(see <a class="xref" href="ch23_06.htm#SML2-CH-23-SECT-6-1" title="Periodically with -q">Section 23.6.1, "Periodically with -q"</A
>) is needed to actually process the queue. 
Note that addresses can still be looked up with DNS as a part
of the queueing process. Consequently, queue-only mode is probably not
suitable for dial-on-demand sites.</P
></DIV
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-17">34.8.17 DialDelay</A
></H3
><p class="refpurpose">Connect failure retry time</P
>(V8.7 and above)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-43146"></A
><a class="indexterm" name="AUTOID-43148"></A
>Many Internet providers allow small sites (such as home machines) to
dial up when there is a demand for network traffic to flow. Such connections
are usually of short duration and use the PPP or SL/IP protocols.
A problem can arise when this
dial-up-on-demand is instigated by <em class="emphasis">sendmail</EM
>.
[12]
The process of negotiating a dial-up connection can take so long
that <em class="emphasis">sendmail</EM
> will have its attempt to <em class="emphasis">connect</EM
>(2) fail.
(See also the <code class="literal">connect</CODE
> keyword for the <code class="literal">Timeout</CODE
>
option in <a class="xref" href="#SML2-CH-34-SECT-8-70-2" title="Timeout.connect">Section 34.8.70.2</A
>).
To remedy this situation, V8.7 <em class="emphasis">sendmail</EM
> offers the
<code class="literal">DialDelay</CODE
> option. It is declared like this:</P
><blockquote class="footnote"><p class="para">[12] Or by any other network-oriented program, such as FTP or Mosaic.</P
></BLOCKQUOTE
><p class="para"><blockquote class="screen"><pre class="screen">O DialDelay=<code class="replaceable"><i>delay              </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file</I
>
-ODialDelay=<code class="replaceable"><i>delay              </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line</I
>
define(`confDIAL_DELAY',<code class="replaceable"><i>delay) </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The argument <code class="replaceable"><i>delay</I
></CODE
> is of type time.
If this option is entirely omitted or if <code class="replaceable"><i>delay</I
></CODE
> is omitted,
the default is then zero and no delay is enabled.
The default for the <em class="emphasis">m4</EM
> configuration technique is also zero. If the unit
of time is omitted from the time declaration, the default is seconds.</P
><p class="para">If <code class="replaceable"><i>delay</I
></CODE
> is nonzero and <em class="emphasis">sendmail</EM
> has its
initial <em class="emphasis">connect</EM
>(2) fail, it will <em class="emphasis">sleep</EM
>(3) for
<code class="replaceable"><i>delay</I
></CODE
> seconds and then try to <em class="emphasis">connect</EM
>(2) again.
Note that <em class="emphasis">sendmail</EM
> tries a second time only once, so
the <code class="replaceable"><i>delay</I
></CODE
> should be large enough to accommodate your
anticipated worst-case delay.
On the other hand, care should be taken to
avoid excessively long delays that can make <em class="emphasis">sendmail</EM
>
appear to hang. No check is made by <em class="emphasis">sendmail</EM
> for absurdly large values
given to <code class="replaceable"><i>delay</I
></CODE
>.</P
><p class="para">The <code class="literal">DialDelay</CODE
> option is safe. If it is specified from the command line,
<em class="emphasis">sendmail</EM
> will not relinquish its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-18">34.8.18 DontExpandCnames</A
></H3
><p class="refpurpose">Prevent CNAME expansion</P
>(V8.7 and above)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-43196"></A
><a class="indexterm" name="AUTOID-43198"></A
>Ordinarily, the <code class="literal">$[</CODE
> and <code class="literal">$]</CODE
> operators (see <a class="xref" href="ch28_06.htm#SML2-CH-28-SECT-6-4" title="Canonicalize Hostname: $[ and $]">Section 28.6.6, "Canonicalize Hostname: $[ and $]"</A
>)
cause the enclosed hostname to be looked up with DNS and
replaced with the canonical name for that host. The canonical
name is the A DNS record. For example, consider
these DNS records:</P
><p class="para"><blockquote class="screen"><pre class="screen">here.us.edu.    IN     A     123.45.67.89
ftp.us.edu.     IN     CNAME here.us.edu.</PRE
></BLOCKQUOTE
></P
><p class="para">If the address <em class="emphasis">ftp.us.edu</EM
> is fed to the <code class="literal">$[</CODE
> and <code class="literal">$]</CODE
> 
operators in the RHS of a rule:</P
><p class="para"><blockquote class="screen"><pre class="screen">R...      $[ $1 $]</PRE
></BLOCKQUOTE
></P
><p class="para">then the rewritten result of passing <em class="emphasis">ftp.us.edu</EM
> as <code class="literal">$1</CODE
>
will be the A record name <em class="emphasis">here.us.edu</EM
>.
This behavior is correct under RFC822 and RFC1123,
but the IETF is currently moving toward a change.</P
><p class="para">Sometimes it is important for the CNAME to appear in email
headers as the canonical name. One example might be that of an FTP
service moving from one machine to another during a transition phase.
In that case, outgoing mail should appear to be from <em class="emphasis">ftp.us.edu</EM
>,
because the records will change after the move, and we
want to maintain the ability to reply to such mail.</P
><p class="para"><blockquote class="screen"><pre class="screen">here.us.edu.    IN     A     123.45.67.89     <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> retired and gone</I
>
ftp.us.edu.     IN     CNAME <code class="userinput"><b>there.us.edu.</B
></CODE
>
<code class="userinput"><b>there.us.edu</B
></CODE
>.   IN     A     123.45.67.90</PRE
></BLOCKQUOTE
></P
><p class="para">Another possibility might be that of a mobile host (a workstation
that plugs into different networks and thus has different A
records over time):</P
><p class="para"><blockquote class="screen"><pre class="screen">mobile.us.edu.    IN     CNAME monday.dc.gov.
monday.dc.gov.    IN     A     12.34.56.78
tuesday.foo.com.  IN     A     23.45.67.89</PRE
></BLOCKQUOTE
></P
><p class="para">Whenever this workstation is plugged in, its CNAME
record is changed to point to the A record of the day:
<em class="emphasis">monday.dc.gov</EM
> on Monday and <em class="emphasis">tuesday.foo.com</EM
>
on Tuesday. But no matter what its A record happens to be,
outgoing mail should look as though it came from <em class="emphasis">mobile.us.edu</EM
>.</P
><p class="para">The <code class="literal">DontExpandCnames</CODE
> option causes <em class="emphasis">sendmail</EM
> to accept
CNAME records as canonical. It is intended for use on
sending hosts with special CNAME needs and should not
be enabled without good reason. It is declared like this:</P
><p class="para"><blockquote class="screen"><pre class="screen">O DontExpandCnames=<code class="replaceable"><i>bool			  </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (V8.7)</I
>
-ODontExpandCnames=<code class="replaceable"><i>bool			  </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (V8.7)</I
>
define(`confDONT_EXPAND_CNAMES',<code class="replaceable"><i>bool</I
></CODE
>)	  <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The argument <code class="replaceable"><i>bool</I
></CODE
> is of type Boolean. If <code class="replaceable"><i>bool</I
></CODE
>
is missing, the default is true (use the CNAME).
If the entire <code class="literal">DontExpandCnames</CODE
> option is missing,
the default is false (convert CNAMEs to A records).</P
><p class="para">The <code class="literal">DontExpandCnames</CODE
> option is not safe.
If specified from the command line,
it may cause <em class="emphasis">sendmail</EM
> to relinquish its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-19">34.8.19 DontInitGroups</A
></H3
><p class="refpurpose">Don't use initgroups(3)</P
>(V8.7 and above)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-43256"></A
><a class="indexterm" name="AUTOID-43258"></A
>Just before executing any delivery agent (including the <code class="literal">*include*</CODE
>
delivery agent) and just before opening a <em class="emphasis">~/.forward</EM
> file, <em class="emphasis">sendmail</EM
> sets its
group and user identities as appropriate.
To illustrate, consider the <code class="literal">U=</CODE
> equate (see <a class="xref" href="ch30_04.htm" title="">Section 30.4.13</A
>).
If the <code class="literal">fax</CODE
> delivery agent has the <code class="literal">U=</CODE
> equate set like this:</P
><p class="para"><blockquote class="screen"><pre class="screen">U=fax:fax</PRE
></BLOCKQUOTE
></P
><p class="para">its <code class="literal">A=</CODE
> program will be executed by the user <em class="emphasis">fax</EM
> who
is in the group <em class="emphasis">fax</EM
>. In addition, <em class="emphasis">sendmail</EM
> calls
the <em class="emphasis">initgroups</EM
>(3) system call to expand the list of
groups to which the user belongs. In the case of <em class="emphasis">fax</EM
>,
it may also belong to the groups <em class="emphasis">faxadm</EM
> and <em class="emphasis">faxusers</EM
>.
The total result is that <em class="emphasis">fax</EM
> can execute, read, and
write any files that have the appropriate group permissions
set for any of the groups <em class="emphasis">fax</EM
>, <em class="emphasis">faxadm</EM
>, and <em class="emphasis">faxusers</EM
>.</P
><p class="para">This versatility, however, has a price. As group files get huge
or as <em class="emphasis">nis</EM
>, <em class="emphasis">nisplus</EM
>, or <em class="emphasis">hesiod</EM
> services become
slow (probably because they are also large), the <em class="emphasis">initgroups</EM
>(3)
call can start to adversely affect <em class="emphasis">sendmail</EM
>'s performance.</P
><p class="para">When performance is a concern, the <em class="emphasis">DontInitGroups</EM
> option can be
used to disable <em class="emphasis">initgroups</EM
>(3):</P
><p class="para"><blockquote class="screen"><pre class="screen">O DontInitGroups=<code class="replaceable"><i>bool    </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file</I
>
-ODontInitGroups=<code class="replaceable"><i>bool    </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line</I
>
define(`confDONT_INIT_GROUPS',<code class="replaceable"><i>bool</I
></CODE
>)   <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The argument <code class="replaceable"><i>bool</I
></CODE
> is of type Boolean. If it is missing, the
default value is true &nbsp;- don't call <em class="emphasis">initgroups</EM
>(3).
If the entire option is missing, the default value is false
&nbsp;- do call <em class="emphasis">initgroups</EM
>(3).
See <a class="xref" href="ch18_08.htm" title="">Section 18.8.31, NO-GROUP-SET</A
> for a discussion of how NO_GROUP_SET
determines whether or not this option also affects the <em class="emphasis">getgrgid</EM
>(3) system call.</P
><p class="para">The <code class="literal">DontInitGroups</CODE
> option is not safe as of V8.8.4.  Even if
it is specified from the command line, may cause
<em class="emphasis">sendmail</EM
> to relinquish its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-20">34.8.20 DontPruneRoutes (R)</A
></H3
><p class="refpurpose">Don't prune route addresses</P
>(V8.1 and above)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-43317"></A
><a class="indexterm" name="AUTOID-43319"></A
><a class="indexterm" name="AUTOID-43322"></A
><a class="indexterm" name="AUTOID-43325"></A
><a class="indexterm" name="AUTOID-43327"></A
>One form of address is called a <em class="emphasis">route address</EM
>, because it specifies
a route (sequence of hosts) through which the message should be
delivered. For example:</P
><p class="para"><blockquote class="screen"><pre class="screen">@hostA,@hostB:user@hostC</PRE
></BLOCKQUOTE
></P
><p class="para">&#13;This address specifies that the message should first go to
<code class="literal">hostA</CODE
>, then from <code class="literal">hostA</CODE
> to <code class="literal">hostB</CODE
>, and
finally from <code class="literal">hostB</CODE
> to <code class="literal">hostC</CODE
> for delivery
to <code class="literal">user</CODE
>.
[13]</P
><blockquote class="footnote"><p class="para">[13] Also see how route addresses are handled in rules in 
<a class="xref" href="ch29_04.htm#SML2-CH-29-SECT-4-5" title="Handling Routing Addresses">Section 29.4.3, "Handling Routing Addresses"</A
>
and the <code class="literal">F=d</CODE
> delivery agent flag in <a class="xref" href="ch30_08.htm" title="">Section 30.8.16, F=d</A
>).</P
></BLOCKQUOTE
><p class="para">RFC1123, in Section 5.3.3, specifies that delivery agents
should always try to eliminate source routing when they are able.
V8 <em class="emphasis">sendmail</EM
> takes an address like the above and
checks to see whether it can connect to <code class="literal">hostC</CODE
> directly.
If it can, it rewrites the address like this:</P
><p class="para"><blockquote class="screen"><pre class="screen">user@hostC</PRE
></BLOCKQUOTE
></P
><p class="para">This is called &quot;pruning route addresses.&quot;
There may be times when such pruning is inappropriate. Internal
networks, for example, may be set up to encourage manual specification
of a route through a high-speed network. If left to its own,
<em class="emphasis">sendmail</EM
> always tosses the route and tries to connect
directly.</P
><p class="para">The <code class="literal">DontPruneRoutes</CODE
> (<code class="literal">R</CODE
>) option causes <em class="emphasis">sendmail</EM
> to never prune route
addresses. 
The forms of this option are as follows:</P
><p class="para"><blockquote class="screen"><pre class="screen">OR<code class="replaceable"><i>bool                                          </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (old form)</I
>
-oR<code class="replaceable"><i>bool                                         </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (old form)</I
>
O DontPruneRoutes=<code class="replaceable"><i>bool                          </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (beginning with V8.7)</I
>
-ODontPruneRoutes=<code class="replaceable"><i>bool                          </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.7)</I
>
define(`confDONT_PRUNE_ROUTES',`<code class="replaceable"><i>bool</I
></CODE
>')          <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The argument <code class="replaceable"><i>bool</I
></CODE
> is of type Boolean. If it is missing, the
default value is true
(nothing special is done with route addresses).
If the entire <code class="literal">R</CODE
> option is missing, the default becomes
false
(route addresses are pruned).
With the V8 <em class="emphasis">m4</EM
> configuration technique the default is false.</P
><p class="para">The <code class="literal">DontPruneRoutes</CODE
> (<code class="literal">R</CODE
>) option is
not safe.  If specified from the command line,
it may cause <em class="emphasis">sendmail</EM
> to relinquish its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-21">34.8.21 DoubleBounceAddress</A
></H3
><p class="refpurpose">Errors when sending errors</P
>(V8.8 and above)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-43385"></A
><a class="indexterm" name="AUTOID-43387"></A
><a class="indexterm" name="AUTOID-43390"></A
><a class="indexterm" name="AUTOID-43393"></A
>Ordinarily, when <em class="emphasis">sendmail</EM
> sends error notification
mail, it expects that error notification to be successfully delivered.
Upon occasion, error mail itself will bounce or fail too. This is called
a &quot;double-bounce&quot; situation.
Prior to V8.8, <em class="emphasis">sendmail</EM
> would notify <code class="literal">postmaster</CODE
> if
error notification failed.
But this might not be the best solution in all cases. Consider, for example,
a site that has a sitewide postmaster and several departmental postmasters.
In such situations, double-bounce mail should probably go to the sitewide
postmaster.</P
><p class="para">Beginning with V8.8 <em class="emphasis">sendmail</EM
>, the <code class="literal">DoubleBounceAddress</CODE
>
option can be used to define who gets double-bounce mail:</P
><p class="para"><blockquote class="screen"><pre class="screen">O DoubleBounceAddress=<code class="replaceable"><i>addr                      </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (beginning with V8.8)</I
>
-ODoubleBounceAddress=<code class="replaceable"><i>addr                      </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.8)</I
>
define(`confDOUBLE_BOUNCE_ADDRESS',`<code class="replaceable"><i>addr</I
></CODE
>')      <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">Here, <code class="replaceable"><i>addr</I
></CODE
> is of type string and is a comma-separated list of 
one or more email addresses. If <code class="replaceable"><i>addr</I
></CODE
> is missing, the 
following error is printed and the option is ignored:</P
><p class="para"><blockquote class="screen"><pre class="screen">readcf: option DoubleBounceAddress: value required</PRE
></BLOCKQUOTE
></P
><p class="para">If the entire option is missing, the default
becomes <code class="literal">postmaster</CODE
>. If <em class="emphasis">sendmail</EM
> is unable to
send double-bounce mail to <code class="literal">addr</CODE
>, it logs the following
error:</P
><p class="para"><blockquote class="screen"><pre class="screen">cannot parse <code class="replaceable"><i>addr</I
></CODE
></PRE
></BLOCKQUOTE
></P
><p class="para">The <code class="literal">DoubleBounceAddress</CODE
> option is not safe.
If specified from the command line,
it may cause <em class="emphasis">sendmail</EM
> to relinquish its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-22">34.8.22 EightBitMode (8)</A
></H3
><p class="refpurpose">How to convert MIME input</P
>(V8.7 and above)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-43434"></A
><a class="indexterm" name="AUTOID-43436"></A
>The data portion of an email message is transmitted during the DATA
phase of an SMTP transaction. Prior to V8.6 the data were presumed
to be 7-bit. That is, the high (8th) bit of every byte of the
message could be cleared (reset or made zero) with no change in the
meaning of that data.
With the advent of ESMTP and MIME, it became possible for <em class="emphasis">sendmail</EM
>
to receive data for which the preservation of the 8th bit is important.</P
><p class="para">There are two kinds of 8-bit data. Data that arrive with the high bit
set and for which no notification was given are called &quot;unlabeled&quot;
8-bit data. Data for which notification <em class="emphasis">was</EM
> given (using
8BITMIME in the ESMTP session
or with the <code class="literal">-B8BITMIME</CODE
> command-line switch, see <a class="xref" href="ch36_07.htm" title="">Section 36.7.1, -B</A
>,
or with a <code class="literal">MIME-Version:</CODE
> header in the message, see <a class="xref" href="ch35_10.htm" title="">Section 35.10.21, MIME-Version:</A
>) 
are called &quot;labeled.&quot;</P
><p class="para">The <code class="literal">EightBitMode</CODE
> (<code class="literal">8</CODE
>) option tells <em class="emphasis">sendmail</EM
> how
to treat incoming unlabeled
8-bit data. The forms of this option are as follows:</P
><p class="para"><blockquote class="screen"><pre class="screen">O8<code class="replaceable"><i>key                                  </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (V8,6)</I
>
-o8<code class="replaceable"><i>key                                 </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (V8,6)</I
>
O EightBitMode=<code class="replaceable"><i>key                     </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (beginning with V8.7)</I
>
-OEightBitMode=<code class="replaceable"><i>key                     </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.7)</I
>
define(`confEIGHT_BIT_HANDLING',<code class="replaceable"><i>key</I
></CODE
>)   <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The <code class="replaceable"><i>key</I
></CODE
> is mandatory and must be selected from one of those
shown in
<a class="xref" href="#SML2-CH-34-TAB-13" title="EightBitMode Option Characters">Table 34.14</A
>.
If the <code class="replaceable"><i>key</I
></CODE
> is missing or if <code class="replaceable"><i>key</I
></CODE
> is not
one of those listed, <em class="emphasis">sendmail</EM
> will print the following
error and ignore the option:</P
><p class="para"><blockquote class="screen"><pre class="screen">Unknown 8-bit mode <code class="replaceable"><i>char</I
></CODE
></PRE
></BLOCKQUOTE
></P
><p class="para">Only the first character of the <code class="replaceable"><i>key</I
></CODE
> is recognized, but we still recommend
that the full word be used for clarity.</P
><table class="table"><caption class="table"><a class="title" name="SML2-CH-34-TAB-13">Table 34.14: EightBitMode Option Characters</A
></CAPTION
><thead class="thead"><tr class="row" valign="TOP"><th class="entry" align="LEFT" rowspan="1" colspan="1">Key</TH
><th class="entry" align="LEFT" rowspan="1" colspan="1"></TH
><th class="entry" align="LEFT" rowspan="1" colspan="1">Meaning</TH
></TR
></THEAD
><tbody class="tbody"><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1">mimify</TD
><td class="entry" rowspan="1" colspan="1"><a class="xref" href="#SML2-CH-34-SECT-8-22-1" title="EightBitMode=mimefy">Section 34.8.22.1, "EightBitMode=mimefy"</A
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Do any necessary conversion of 8BITMIME to 7-bit</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1">pass</TD
><td class="entry" rowspan="1" colspan="1"><a class="xref" href="#SML2-CH-34-SECT-8-22-2" title="EightBitMode=pass">Section 34.8.22.2, "EightBitMode=pass"</A
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Pass unlabeled 8-bit input through as is</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1">strict</TD
><td class="entry" rowspan="1" colspan="1"><a class="xref" href="#SML2-CH-34-SECT-8-22-3" title="EightBitMode=strict">Section 34.8.22.3, "EightBitMode=strict"</A
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Reject unlabeled 8-bit input</P
></TD
></TR
></TBODY
></TABLE
><p class="para">If the entire <code class="literal">EightBitMode</CODE
> (<code class="literal">8</CODE
>) option is missing,
the default becomes <code class="literal">p</CODE
> (pass
8-bit and convert MIME). If you configure with V8's <em class="emphasis">m4</EM
> technique,
the default is also <code class="literal">p</CODE
>.</P
><p class="para">Depending on the <code class="replaceable"><i>key</I
></CODE
> selected and the nature of incoming mail, any of
several error messages may be generated:</P
><p class="para"><blockquote class="screen"><pre class="screen">Eight bit data not allowed
Cannot send 8-bit data to 7-bit destination
<em class="emphasis">host</EM
> does not support 8BITMIME</PRE
></BLOCKQUOTE
></P
><p class="para">Conversion from 8 to 7 bit is complex. First, <em class="emphasis">sendmail</EM
> looks for
a MIME <code class="literal">Content-Type:</CODE
> header. If the header is found, <em class="emphasis">sendmail</EM
>
looks for and, if found,
uses a MIME <code class="literal">boundary</CODE
> definition to delimit conversion.
[14]
If more than 1/4 of a section has the high bit set after reading
at least 4 kilobytes of data, <em class="emphasis">sendmail</EM
> presumes base64 encoding
[15]
and inserts the following MIME header into the data stream:</P
><blockquote class="footnote"><p class="para">[14] A boundary is used only for <code class="literal">multipart</CODE
> messages.</P
><p class="para">[15] Also see the <code class="literal">$=q</CODE
> class (<a class="xref" href="ch32_05.htm" title="">Section 32.5.5, $=q</A
>)
for a way to require quoted-printable encoding.</P
></BLOCKQUOTE
><p class="para"><blockquote class="screen"><pre class="screen">Content-Transfer-Encoding: base64</PRE
></BLOCKQUOTE
></P
><p class="para">Base64 encoding converts 8-bit data into a stream of 6-bit bytes
that contain universally readable text. 
Base64 is described in RFC1521.</P
><p class="para">If less than 1/4 of the data that were scanned have the high bit set
or if the type in the <code class="literal">Content-Type:</CODE
> header is listed in <code class="literal">$=q</CODE
>
(<a class="xref" href="ch32_05.htm" title="">Section 32.5.5</A
>),
the data are converted from 8 to 7 bit by using Quoted-Printable encoding,
and the following MIME header is inserted into the stream:</P
><p class="para"><blockquote class="screen"><pre class="screen">Content-Transfer-Encoding: quoted-printable</PRE
></BLOCKQUOTE
></P
><p class="para">Under Quoted-Printable encoding, ASCII control characters
(in the range 0x00 through 0x20), the tab character, the &quot;=&quot;
character, and all characters with the high bit set
are converted.
First an &quot;=&quot; character is output, then the
character is converted to an ASCII representation of its 

hexadecimal value,
and that value is output. For example,</P
><p class="para"><blockquote class="screen"><pre class="screen">0xb9      <i class="lineannotation"><img src="../chars/rarr.gif" alt="-&gt;"> becomes</I
>   =B9</PRE
></BLOCKQUOTE
></P
><p class="para">Under this scheme, the <code class="literal">=</CODE
> character is considered binary and is
encoded as <code class="literal">=3D</CODE
>.
If the <code class="literal">F=3</CODE
> flag (see <a class="xref" href="ch30_08.htm" title="">Section 30.8.2, F=3</A
>) is
set for a selected delivery agent, the characters</P
><p class="para"><blockquote class="screen"><pre class="screen">! &quot; # $ @ \ [ ] ^ ` { | } ~</PRE
></BLOCKQUOTE
></P
><p class="para">are also converted. If <code class="literal">F=3</CODE
> is not set,
those characters are output as is.</P
><p class="para">Lines longer than 72 characters (bytes) are broken with the insertion
of an &quot;=&quot; character and the <code class="literal">E=</CODE
> end-of-line characters defined
for the current delivery agent.
Any lines that end in a whitespace character have that
character converted to quoted-printable even if the line is under 72 characters.
Quoted-printable is described in RFC1521. Where <code class="literal">m</CODE
> (mimefy) may not be appropriate for a given
delivery agent, the <code class="literal">F=8</CODE
> flag (see <a class="xref" href="ch30_08.htm" title="">Section 30.8.5, F=8</A
>) 
can be specified to force <code class="literal">p</CODE
> (pass8bit) behavior.</P
><p class="para">The <code class="literal">EightBitMode</CODE
> (<code class="literal">8</CODE
>) option is safe. Even if it is specified from the command line, 
<em class="emphasis">sendmail</EM
> retains its <em class="emphasis">root</EM
> privilege.</P
><div class="refsect2"><h4 class="refsect2"><a class="title" name="SML2-CH-34-SECT-8-22-1">34.8.22.1 EightBitMode=mimefy</A
></H4
><p class="para">Convert unlabeled 8-bit input to 8BITMIME, and do any necessary
conversion of 8BITMIME to 7-bit.
When running as a daemon receiving mail
via SMTP, advertise the 8BITMIME ESMTP keyword as valid.
This <code class="replaceable"><i>key</I
></CODE
> specifies that your
site will be a full-time MIME installation. Note that compiling
with MIME8TO1=1 (see <a class="xref" href="ch18_08.htm" title="">Section 18.8.22, MIME8TO7</A
>) causes ESMTP
to always advertise 8BITMIME.</P
></DIV
><div class="refsect2"><h4 class="refsect2"><a class="title" name="SML2-CH-34-SECT-8-22-2">34.8.22.2 EightBitMode=pass</A
></H4
><p class="para">Pass unlabeled 8-bit input through as is.  Convert labeled 8BITMIME
input to 7-bit as required by any delivery agent with the <code class="literal">F=7</CODE
>
flag set (see <a class="xref" href="ch30_08.htm" title="">Section 30.8.4, F=7</A
>)
or any SMTP server that does not advertise 8BITMIME. </P
></DIV
><div class="refsect2"><h4 class="refsect2"><a class="title" name="SML2-CH-34-SECT-8-22-3">34.8.22.3 EightBitMode=strict</A
></H4
><p class="para">Reject unlabeled 8-bit input. Convert 8BITMIME to 7-bit as required
by any delivery agent with the <code class="literal">F=7</CODE
> flag set (see <a class="xref" href="ch30_08.htm" title="">Section 30.8.4</A
>)
or any SMTP server that does not advertise 8BITMIME. </P
></DIV
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-23">34.8.23 ErrorHeader (E)</A
></H3
><p class="refpurpose">Set error message header</P
>(V8 and above)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-43579"></A
><a class="indexterm" name="AUTOID-43581"></A
>When a notification of a mail error is sent to the sender, the details
of the error are taken from the text saved in the <code class="literal">xf</CODE
> file
(see <a class="xref" href="ch23_02.htm#SML2-CH-23-SECT-2-5" title="The Transcript File: xf">Section 23.2.7, "The Transcript File: xf"</A
>).
The <code class="literal">ErrorHeader</CODE
> (<code class="literal">E</CODE
>) option, available
only with V8 <em class="emphasis">sendmail</EM
>, allows you to prepend
custom text ahead of that error text.</P
><p class="para">Custom error text is useful for sites that wish to offer
help as part of the error message. For example, one common
kind of error message is notification of an unknown user:</P
><p class="para"><blockquote class="screen"><pre class="screen">--- Transcript of session follows ---
550 smith@wash.dc.gov... User unknown
   --- Unsent message follows ---</PRE
></BLOCKQUOTE
></P
><p class="para">Here, the user <code class="literal">smith</CODE
> is one that is unknown.
A useful error help message for your site to produce might be</P
><p class="para"><blockquote class="screen"><pre class="screen">Common problems:
        User unknown: the user or login name is wrong.
        Host unknown: you mistyped the host part of the address.
   --- Transcript of session follows ---
550 smith@wash.dc.gov... User unknown
   --- Unsent message follows ---</PRE
></BLOCKQUOTE
></P
><p class="para">The forms for the <code class="literal">ErrorHeader</CODE
> (<code class="literal">E</CODE
>) option are as follows:</P
><p class="para"><blockquote class="screen"><pre class="screen">OE<code class="replaceable"><i>text                               </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (V8.6)</I
>
-oE<code class="replaceable"><i>text                              </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (V8.6)</I
>
O ErrorHeader=<code class="replaceable"><i>text                   </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (beginning with V8.7)</I
>
-OErrorHeader=<code class="replaceable"><i>text                   </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.7)</I
>
define(`confERROR_MESSAGE',`<code class="replaceable"><i>text</I
></CODE
>')   <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The argument <code class="replaceable"><i>text</I
></CODE
> is mandatory. If it is missing,
this option is ignored. The <code class="replaceable"><i>text</I
></CODE
> is either the
actual error text that is printed or the name
of a file containing that text. If <code class="replaceable"><i>text</I
></CODE
> begins
with the <code class="literal">/</CODE
> character, it is taken as the
absolute pathname of the file (a relative name is not
possible). 
If the specified file cannot be
opened for reading, this option is silently ignored.</P
><p class="para">Macros may be used in the error text, and they are
expanded as they are printed. For example, the text
might contain</P
><p class="para"><blockquote class="screen"><pre class="screen">For help with $u, try &quot;finger $u&quot;</PRE
></BLOCKQUOTE
></P
><p class="para">which might produce this error message:</P
><p class="para"><blockquote class="screen"><pre class="screen">For help with smith@wash.dc.gov, try &quot;finger smith@wash.dc.gov&quot;
   --- Transcript of session follows ---
550 smith@wash.dc.gov... User unknown
   --- Unsent message follows ---</PRE
></BLOCKQUOTE
></P
><p class="para">The <code class="literal">ErrorHeader</CODE
> (<code class="literal">E</CODE
>) option is not safe.
If specified from the command line,
it may cause <em class="emphasis">sendmail</EM
> to relinquish its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-24">34.8.24 ErrorMode (e)</A
></H3
><p class="refpurpose">Specify mode of error handling</P
>(All versions)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-43635"></A
>The <em class="emphasis">sendmail</EM
> program is flexible in its handling of delivery errors.
By selecting from five possible modes with the 
<code class="literal">ErrorMode</CODE
> (<code class="literal">e</CODE
>) option, you can tailor notification of delivery errors
to suit many needs. </P
><p class="para">This option is intended primarily for use from the command line. If
included in the configuration file, it should be given only the
<code class="literal">p</CODE
> argument, for print mode (the default).</P
><p class="para">The forms of the <code class="literal">ErrorMode</CODE
> (<code class="literal">e</CODE
>) option are as follows:</P
><p class="para"><blockquote class="screen"><pre class="screen">Oe<code class="replaceable"><i>mode                          </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (old form)</I
>
-oe<code class="replaceable"><i>mode                         </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (old form)</I
>
-e<code class="replaceable"><i>mode                          </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command-line shorthand (not recommended)</I
>
O ErrorMode=<code class="replaceable"><i>mode                </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (beginning with V8.7)</I
>
-OErrorMode=<code class="replaceable"><i>mode                </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.7)</I
>
define(`confERROR_MODE',<code class="replaceable"><i>mode</I
></CODE
>)   <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The type of <code class="replaceable"><i>mode</I
></CODE
> is character. If <code class="replaceable"><i>mode</I
></CODE
>
is missing, the default value is <code class="literal">p</CODE
> (for print normally).
Under older versions of <em class="emphasis">sendmail</EM
>, if this <code class="literal">ErrorMode</CODE
> (<code class="literal">e</CODE
>)
option is entirely missing, the default value
for <code class="literal">mode</CODE
> is the C language character constant '<code class="literal">\0</CODE
>'.
Under V8 <em class="emphasis">sendmail</EM
>, the default value in this case is <code class="literal">p</CODE
>.</P
><p class="para">The possible characters for the <code class="replaceable"><i>mode</I
></CODE
> argument are listed
in
<a class="xref" href="#SML2-CH-34-TAB-14" title="ErrorMode Option Modes">Table 34.15</A
>.</P
><table class="table"><caption class="table"><a class="title" name="SML2-CH-34-TAB-14">Table 34.15: ErrorMode Option Modes</A
></CAPTION
><thead class="thead"><tr class="row" valign="TOP"><th class="entry" align="LEFT" rowspan="1" colspan="1">Mode</TH
><th class="entry" align="LEFT" rowspan="1" colspan="1"></TH
><th class="entry" align="LEFT" rowspan="1" colspan="1">Meaning</TH
></TR
></THEAD
><tbody class="tbody"><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1">e</TD
><td class="entry" rowspan="1" colspan="1"><a class="xref" href="#SML2-CH-34-SECT-8-24-1" title="ErrorMode=e">Section 34.8.24.1, "ErrorMode=e"</A
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Like <code class="literal">m</CODE
>, but always exit with a zero exit status</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1">m</TD
><td class="entry" rowspan="1" colspan="1"><a class="xref" href="#SML2-CH-34-SECT-8-24-2" title="ErrorMode=m">Section 34.8.24.2, "ErrorMode=m"</A
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Mail error notification to the sender no matter what</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1">p</TD
><td class="entry" rowspan="1" colspan="1"><a class="xref" href="#SML2-CH-34-SECT-8-24-3" title="ErrorMode=p">Section 34.8.24.3, "ErrorMode=p"</A
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Print error messages (the default)</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1">q</TD
><td class="entry" rowspan="1" colspan="1"><a class="xref" href="#SML2-CH-34-SECT-8-24-4" title="ErrorMode=q">Section 34.8.24.4, "ErrorMode=q"</A
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Remain silent about all delivery errors</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1">w</TD
><td class="entry" rowspan="1" colspan="1"><a class="xref" href="#SML2-CH-34-SECT-8-24-5" title="ErrorMode=w">Section 34.8.24.5, "ErrorMode=w"</A
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Write errors to the sender's terminal screen</P
></TD
></TR
></TBODY
></TABLE
><p class="para">Note that the error-handling mode is automatically set to <code class="literal">m</CODE
>
(for mail errors) in two special circumstances. First, if a mailing
list is being processed and if an owner is found for that list
(see <a class="xref" href="ch25_03.htm" title="Defining a Mailing List Owner">Section 25.3, "Defining a Mailing List Owner"</A
>),
the mode is set to <code class="literal">m</CODE
> to force mail notification to that owner.
Second, if SMTP delivery is to multiple recipients, the mode is
set to <code class="literal">m</CODE
> to force mail notification to the sender.
This latter assumes that multiple recipients qualify as a mailing list.</P
><p class="para">Also note that V8 <em class="emphasis">sendmail</EM
> sets the error-handling mode
to <code class="literal">q</CODE
> (for quiet) when <em class="emphasis">sendmail</EM
> is given the <code class="literal">-bv</CODE
>
(address verification) command line switch. This prevents spurious
error messages from being mailed to root in testing addresses.</P
><p class="para">The <code class="literal">ErrorMode</CODE
> (<code class="literal">e</CODE
>) option is safe.  Even if it is specified from the command line,
<em class="emphasis">sendmail</EM
> retains its <em class="emphasis">root</EM
> privilege.&#13;</P
><div class="refsect2"><h4 class="refsect2"><a class="title" name="SML2-CH-34-SECT-8-24-1">34.8.24.1 ErrorMode=e</A
></H4
><p class="para">Like <code class="literal">m</CODE
>, but always exit with a zero exit status.
This mode is intended for use from the command line.
This <code class="literal">e</CODE
> mode is used by the <em class="emphasis">rmail</EM
>(8) program when
it invokes <em class="emphasis">sendmail</EM
>. On some systems, if <em class="emphasis">sendmail</EM
>
exits with a nonzero value (fails), the <em class="emphasis">uuxqt</EM
>(8) program
sends its own error message. This results in two error messages
being sent, whereas only one should ever be sent. Worse still,
the error message from <em class="emphasis">uuxqt</EM
> may contain a bad address,
one that may itself bounce.&#13;</P
></DIV
><div class="refsect2"><h4 class="refsect2"><a class="title" name="SML2-CH-34-SECT-8-24-2">34.8.24.2 ErrorMode=m</A
></H4
><p class="para">Mail error notification to the sender no matter what. This mode tries
to find the most rational way to return mail. All aliasing is disabled
to prevent loops. Nothing is ever saved to <em class="emphasis">~/dead.letter</EM
>.
This mode is intended for use from the command line.
The <code class="literal">m</CODE
> mode is appropriate for mail generated by an application
that arises from a login but for which no human
is present to monitor messages. One example might be a data-acquisition
system that is manually logged in but is then left to fend for
itself. Similarly, when the user <em class="emphasis">news</EM
> sends articles by mail,
error messages should not be placed in <em class="emphasis">~news/dead.letter</EM
>, where
they may be overlooked; rather, this mode should be used so that
errors are placed in a mail spool file where they can be periodically
monitored.&#13;</P
></DIV
><div class="refsect2"><h4 class="refsect2"><a class="title" name="SML2-CH-34-SECT-8-24-3">34.8.24.3 ErrorMode=p</A
></H4
><p class="para">Print error messages (the default). 
The <em class="emphasis">sendmail</EM
> program
simply tries to save a copy of the failed mail in <em class="emphasis">~/dead.letter</EM
> 
and
prints an error message to its standard output.
If the sender is remote, it sends notification of the problem back
to that sender via email.
If <em class="emphasis">~/dead.letter</EM
> is not writable, a copy
is saved to <em class="emphasis">/usr/tmp/dead.letter</EM
>.
Note that this default path was hard-coded into pre-V8 versions of <em class="emphasis">sendmail</EM
>
as a string constant.  The only way to change it was
by editing <em class="emphasis">savemail.c</EM
>. 
But beginning with V8 <em class="emphasis">sendmail</EM
>, the path
component is defined by the _PATH_VARTMP definition, and that can be
tuned in your <em class="emphasis">Makefile</EM
>  (see <a class="xref" href="ch18_08.htm" title="">Section 18.8.34, PATH...</A
>).
The default for _PATH_VARTMP is <em class="emphasis">/usr/tmp/</EM
>.
The file named <em class="emphasis">dead.letter</EM
> is hard-coded in all versions of
<em class="emphasis">sendmail</EM
>.&#13;</P
></DIV
><div class="refsect2"><h4 class="refsect2"><a class="title" name="SML2-CH-34-SECT-8-24-4">34.8.24.4 ErrorMode=q</A
></H4
><p class="para">Quiet; remain silent about all delivery errors.
If the sender is local, this mode assumes
that the program or person that ran <em class="emphasis">sendmail</EM
> will
give notification of the error.
Mail is not sent, and
<em class="emphasis">~/dead.letter</EM
> is not saved. 
Error information is provided only in the <em class="emphasis">sendmail</EM
> program's
<em class="emphasis">exit</EM
>(2) status (see <a class="xref" href="ch36_05.htm#SML2-CH-36-SECT-5-3" title="sendmail's exit() Status">Section 36.5, "sendmail's exit() Status"</A
>).
This mode is intended for use from the
command line. One possible 

use might be exploding a junk-mail mailing
list with a program that could correctly interpret the exit status.&#13;</P
></DIV
><div class="refsect2"><h4 class="refsect2"><a class="title" name="SML2-CH-34-SECT-8-24-5">34.8.24.5 ErrorMode=w</A
></H4
><p class="para">Write errors to the sender's terminal screen if logged in (similar
to <em class="emphasis">write</EM
>(1)); otherwise, send mail to that user.
First tries to write to <em class="emphasis">stdout</EM
>. If that fails, it reverts
to mail notification.
This mode is intended for use from the command line.
The reason for this mode has been lost to history,
[16]
and it should be considered obsolete.</P
><blockquote class="footnote"><p class="para">[16] According to Eric Allman, &quot;Dubious, someone bugged me for it;
I forget why.&quot;</P
></BLOCKQUOTE
></DIV
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-25">34.8.25 FallbackMXhost (V)</A
></H3
><p class="refpurpose">Fallback MX host</P
>(V8.4 and above)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-43783"></A
><a class="indexterm" name="AUTOID-43785"></A
>At sites with poor (connect on demand, or unreliable) network
connections, SMTP connections may often fail.
In such situations it may not be desirable for each workstation
to queue the mail locally for a later attempt.
Under V8 <em class="emphasis">sendmail</EM
> it is possible to specify a <em class="emphasis">fallback</EM
>
host to which the mail should instead be forwarded. One such
host might be a central mail hub machine.</P
><p class="para">The <code class="literal">FallbackMXhost</CODE
> (<code class="literal">V</CODE
>) option specifies the name of a mail exchanger
machine (MX record) of last resort. It is given an artificially
low priority (high preference number) so that <em class="emphasis">sendmail</EM
>
tries to connect to it only if all other connection attempts
for the target host have failed.</P
><p class="para">Note that this fallback MX host is used only for connection
failures. It is not used if the name server lookup failed.
It is available only for the <code class="literal">[IPC]</CODE
> delivery agent
(see <a class="xref" href="ch30_04.htm" title="$h and other arguments in A=[IPC]">Section 30.4.1.2, "$h and other arguments in A=[IPC]"</A
>). Note that MX lookups are available
only if <em class="emphasis">sendmail</EM
> is compiled with NAMED_BIND defined
(see <a class="xref" href="ch18_08.htm" title="">Section 18.8.23, NAMED-BIND</A
>).</P
><p class="para">The forms of the <code class="literal">FallbackMXhost</CODE
> (<code class="literal">V</CODE
>) option are as follows:</P
><p class="para"><blockquote class="screen"><pre class="screen">OV<code class="replaceable"><i>host                             </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (V8.6)</I
>
-oV<code class="replaceable"><i>host                            </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (V8.6)</I
>
O FallbackMXhost=<code class="replaceable"><i>host              </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (beginning with V8.7)</I
>
-OFallbackMXhost=<code class="replaceable"><i>host              </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.7)</I
>
define(`confFALLBACK_MX',`<code class="replaceable"><i>host</I
></CODE
>')   <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">Here, <code class="replaceable"><i>host</I
></CODE
> is of type string and is the fully qualified
domain name of the fallback host. If <code class="replaceable"><i>host</I
></CODE
> or the entire
option is missing, no fallback MX record is used.
The effect of this option can be seen by using the <code class="literal">/mx</CODE
>
rule-testing command (see <a class="xref" href="ch38_05.htm#SML2-CH-38-SECT-5-3" title="Look Up MX Records with /mx">Section 38.5.2, "Look Up MX Records with /mx"</A
>).</P
><p class="para">The <code class="literal">FallbackMXhost</CODE
> (<code class="literal">V</CODE
>) option is not safe.
If specified from the command line,
it may cause <em class="emphasis">sendmail</EM
> to relinquish its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-26">34.8.26 ForkEachJob (Y)</A
></H3
><p class="refpurpose">Process queue files individually</P
>(All versions)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-43832"></A
><a class="indexterm" name="AUTOID-43834"></A
>On machines with a small amount of memory (such as 3B1s and old
Sun 3s) it is best to limit the size of running processes.
One way to do this is to have the <em class="emphasis">sendmail</EM
> program
<em class="emphasis">fork</EM
>(2) a copy of itself to handle each individual queued message.
The <code class="literal">ForkEachJob</CODE
> (<code class="literal">Y</CODE
>) option can be used to allow those <em class="emphasis">fork</EM
>(2)'s.</P
><p class="para">The forms of the <code class="literal">ForkEachJob</CODE
> (<code class="literal">Y</CODE
>) option are as follows:</P
><p class="para"><blockquote class="screen"><pre class="screen">OY<code class="replaceable"><i>bool                             </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (old style)</I
>
-oY<code class="replaceable"><i>bool                            </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (old style)</I
>
O ForkEachJob=<code class="replaceable"><i>bool                 </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (beginning with V8.7)</I
>
-OForkEachJob=<code class="replaceable"><i>bool                 </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.7)</I
>
define(`confSEPARATE_PROC',<code class="replaceable"><i>bool</I
></CODE
>)   <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The argument <code class="replaceable"><i>bool</I
></CODE
> is of type Boolean. If <code class="replaceable"><i>bool</I
></CODE
>
is missing, the default is true (fork).
The default for the V8 <em class="emphasis">m4</EM
> technique is true.
If the entire <code class="literal">ForkEachJob</CODE
> (<code class="literal">Y</CODE
>) option is missing, the default is false (don't fork).</P
><p class="para">If option <code class="literal">ForkEachJob</CODE
> (<code class="literal">Y</CODE
>) is set (true), there is a <em class="emphasis">fork</EM
>(2) to start
processing of the queue, then another <em class="emphasis">fork</EM
>(2) to process
each message in the queue. If option <code class="literal">ForkEachJob</CODE
> (<code class="literal">Y</CODE
>) is not set (false),
only the initial <em class="emphasis">fork</EM
>(2) takes place, greatly
improving the efficiency of a queue run. For example, a single
process (as with <code class="literal">ForkEachJob</CODE
> (<code class="literal">Y</CODE
>) false) retains information about
down hosts and so does not waste time trying to connect again
for subsequent mail to the same host during the current queue run.
For all modern machines the <code class="literal">ForkEachJob</CODE
> (<code class="literal">Y</CODE
>) option should be false.</P
><p class="para">The <code class="literal">ForkEachJob</CODE
> (<code class="literal">Y</CODE
>) option is not safe.  If specified from the command line,
it may cause <em class="emphasis">sendmail</EM
> to relinquish its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-27">34.8.27 ForwardPath (J)</A
></H3
><p class="refpurpose">Set ~/.forward search path</P
>(V8 and above)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-43888"></A
><a class="indexterm" name="AUTOID-43890"></A
><a class="indexterm" name="AUTOID-43893"></A
>When mail is being delivered to a local user, <em class="emphasis">sendmail</EM
> attempts
to open and read a file in the user's home directory 
called <em class="emphasis">.forward</EM
>.
If that file exists and is readable, the aliases in that file
replace the local username for delivery.</P
><p class="para">Under V8 <em class="emphasis">sendmail</EM
> the <code class="literal">ForwardPath</CODE
> (<code class="literal">J</CODE
>) option is used to define
alternative locations for the user's <em class="emphasis">~/.forward</EM
> file.</P
><p class="para">The forms of the <code class="literal">ForwardPath</CODE
> (<code class="literal">J</CODE
>) option are as follows:</P
><p class="para"><blockquote class="screen"><pre class="screen">OJ<code class="replaceable"><i>path                            </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (V8.6)</I
>
-oJ<code class="replaceable"><i>path                           </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (V8.6)</I
>
O ForwardPath=<code class="replaceable"><i>path                </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (beginning with V8.7)</I
>

-OForwardPath=<code class="replaceable"><i>path                </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.7)</I
>
define(`confFORWARD_PATH',<code class="replaceable"><i>path</I
></CODE
>)   <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The <code class="replaceable"><i>path</I
></CODE
> is a colon-separated list of files.
An attempt is made to
open and read each in turn, from left to right, until one
is successfully read:</P
><p class="para"><blockquote class="screen"><pre class="screen">OJ/var/forward/$u:$z/.forward</PRE
></BLOCKQUOTE
></P
><p class="para">Macros may, and should, be used in the <code class="replaceable"><i>path</I
></CODE
> file locations.
In the above example, <em class="emphasis">sendmail</EM
> first looks in the file
<em class="emphasis">/var/forward/$u</EM
> (where the macro <code class="literal">$u</CODE
> contains the
user's login name; see <a class="xref" href="ch31_10.htm" title="">Section 31.10.36, $u</A
>).
If that file can't be opened for reading,
<em class="emphasis">sendmail</EM
> tries reading <em class="emphasis">$z/.forward</EM
> (where the <code class="literal">$z</CODE
>
macro contains the user's home directory; see <a class="xref" href="ch31_10.htm" title="">Section 31.10.46, $z</A
>).
Other macros of interest are <code class="literal">$w</CODE
> (the local hostname; see <a class="xref" href="ch31_10.htm" title="">Section 31.10.40, $w</A
>),
<code class="literal">$x</CODE
> (the user's full name; see <a class="xref" href="ch31_10.htm" title="">Section 31.10.14, $f</A
>),
<code class="literal">$r</CODE
> (the sending protocol; see <a class="xref" href="ch31_10.htm" title="">Section 31.10.31, $r</A
>),
and <code class="literal">$s</CODE
> (the sending host; see <a class="xref" href="ch31_10.htm" title="">Section 31.10.33, $s</A
>).
The recommended declaration is to use the name of the sending host thus:</P
><p class="para"><blockquote class="screen"><pre class="screen">OJ$z/.forward.$w:$z/.forward</PRE
></BLOCKQUOTE
></P
><p class="para">If the <code class="replaceable"><i>path</I
></CODE
> or the entire option is omitted, the default
is <em class="emphasis">$z/.forward</EM
>. Therefore omitting the <code class="literal">ForwardPath</CODE
> (<code class="literal">J</CODE
>) 
option causes V8 <em class="emphasis">sendmail</EM
> to emulate older versions by looking only
in the <em class="emphasis">~/.forward</EM
> file for user forwarding information.</P
><p class="para">Beginning with V8.7 <em class="emphasis">sendmail</EM
>, the <code class="literal">F=w</CODE
> delivery agent flag
(see <a class="xref" href="ch30_08.htm" title="">Section 30.8.43, F=w</A
>) must 
be set for the recipient's delivery agent, or all forwarding
is skipped. Previously, this was tied to the delivery agent named <code class="literal">local</CODE
>.</P
><p class="para">The <code class="literal">ForwardPath</CODE
> (<code class="literal">J</CODE
>) option is not safe.  If specified from the command line,
it may cause <em class="emphasis">sendmail</EM
> to relinquish its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-28">34.8.28 HelpFile (H)</A
></H3
><p class="refpurpose">Specify location of the help file</P
>(All versions)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-43966"></A
><a class="indexterm" name="AUTOID-43968"></A
>The <em class="emphasis">sendmail</EM
> program implements the SMTP (and ESMTP)
HELP command
by looking up help messages
in a text file. 
Beginning with V8.7 <em class="emphasis">sendmail</EM
>, help messages for the <code class="literal">-bt</CODE
>
rule-testing mode are also looked up in that file.
The location and name of that text file are specified by
using the <code class="literal">HelpFile</CODE
> (<code class="literal">H</CODE
>) option. If the name is the C language value NULL
or if <em class="emphasis">sendmail</EM
> cannot open that file for reading, 
<em class="emphasis">sendmail</EM
> issues the following message and continues:</P
><p class="para"><blockquote class="screen"><pre class="screen">502 HELP not implemented</PRE
></BLOCKQUOTE
></P
><p class="para">The help file is composed of lines of text, separated by tab characters
into two fields per line. The leftmost field is an item for which
help is offered. The rightmost field (the rest of the line) is the
help text to be printed. A few lines in a typical help file might
look like this:</P
><p class="para"><blockquote class="screen"><pre class="screen">.ps 8
rset   RSET
rset          Resets the system.
quit   QUIT
quit          Exit sendmail (SMTP).
verb   VERB
verb          Go into verbose mode.  This sends 0xy responses that are
verb          not RFC821 standard (but should be). They are recognized
verb          by humans and other sendmail implementations.
vrfy   VRFY &lt;recipient&gt;
vrfy          Verify an address.  If you want to see what it aliases
vrfy          to, use EXPN instead.</PRE
></BLOCKQUOTE
></P
><p class="para">For an SMTP request of <code class="literal">help&nbsp;vrfy</CODE
>, 
<em class="emphasis">sendmail</EM
> might produce</P
><p class="para"><blockquote class="screen"><pre class="screen">214-VRFY &lt;recipient&gt;
214-     Verify an address.  If you want to see what it aliases
214-     to, use EXPN instead.
214 End of HELP info</PRE
></BLOCKQUOTE
></P
><p class="para">The forms of the <code class="literal">HelpFile</CODE
> (<code class="literal">H</CODE
>) option are as follows:</P
><p class="para"><blockquote class="screen"><pre class="screen">OH<code class="replaceable"><i>file                       </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (old form)</I
>
-oH<code class="replaceable"><i>file                      </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (old form)</I
>
O HelpFile=<code class="replaceable"><i>file              </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (beginning with V8.7)</I
>
-OHelpFile=<code class="replaceable"><i>file              </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.7)</I
>
define(`HELP_FILE',`<code class="replaceable"><i>file</I
></CODE
>')   <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The argument <code class="replaceable"><i>file</I
></CODE
> is of type string and may be a full or
relative pathname. 
Relative names are always relative to the queue directory.
If <code class="replaceable"><i>file</I
></CODE
> is omitted, then the name of the
help file defaults to <em class="emphasis">sendmail.hf</EM
>. If the entire <code class="literal">H</CODE
>
option is omitted, the name of the help file becomes the C language
value NULL.
The Simple Mail Transfer Protocol (SMTP) is described in
RFC821, 
and Extended SMTP (ESMTP) is described in RFC1869.</P
><p class="para">The <code class="literal">HelpFile</CODE
> (<code class="literal">H</CODE
>) option is not safe.  If specified from the command line,
it may cause <em class="emphasis">sendmail</EM
> to relinquish its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-29">34.8.29 HoldExpensive (c)</A
></H3
><p class="refpurpose">Queue for expensive mailers</P
>(All versions)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-44020"></A
><a class="indexterm" name="AUTOID-44022"></A
><a class="indexterm" name="AUTOID-44024"></A
><a class="indexterm" name="AUTOID-44026"></A
>An <em class="emphasis">expensive mailer</EM
> is a delivery agent that
contains an <code class="literal">e</CODE
> flag in its <code class="literal">F=</CODE
> equate (see <a class="xref" href="ch30_08.htm" title="">Section 30.8.18, F=e</A
>). 
Typically, such delivery agents are associated 
with slow network connections such as SL/IP or with costly networks such as those with high per connect or connection startup rates.
Whatever the reason, the <code class="literal">HoldExpensive</CODE
> (<code class="literal">c</CODE
>) option
allows you to queue all such
mail for later delivery rather than connecting on demand.
(Queuing is described in 
<a class="xref" href="ch23_01.htm" title="The Queue">Chapter 23</A
>.)</P
><p class="para">Note that this option affects only the initial delivery attempt,
not later attempts when the queue is processed. Essentially, all this
option does is to defer delivery until the next time the queue is
processed.</P
><p class="para">The forms of the <code class="literal">HoldExpensive</CODE
> (<code class="literal">c</CODE
>) option are as follows:</P
><p class="para"><blockquote class="screen"><pre class="screen">Oc<code class="replaceable"><i>bool                             </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (old form)</I
>
-oc<code class="replaceable"><i>bool                            </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (old form)</I
>
-c<code class="replaceable"><i>                                 </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command-line shorthand (not recommended)</I
>
O HoldExpensive=<code class="replaceable"><i>bool               </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (beginning with V8.7)</I
>
-OHoldExpensive=<code class="replaceable"><i>bool               </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.7)</I
>
define(`confCON_EXPENSIVE',<code class="replaceable"><i>bool</I
></CODE
>)   <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The argument <code class="replaceable"><i>bool</I
></CODE
> is of type Boolean.
If the <code class="replaceable"><i>bool</I
></CODE
> argument is missing, the default is true (expensive mail
is queued).
If the entire <code class="literal">HoldExpensive</CODE
> (<code class="literal">c</CODE
>)
option is missing, the default value is false (expensive mail
is delivered immediately).</P
><p class="para">The <code class="literal">-v</CODE
> (verbose) command-line switch automatically sets the
<code class="literal">HoldExpensive</CODE
> (<code class="literal">c</CODE
>) option to false.
The <code class="literal">HoldExpensive</CODE
> (<code class="literal">c</CODE
>) option is not safe.
If specified from the command line,
it may cause <em class="emphasis">sendmail</EM
> to relinquish its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-30">34.8.30 HostsFile</A
></H3
><p class="refpurpose">Specify alternate /etc/hosts file</P
>(V8.7 and above)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-44075"></A
><a class="indexterm" name="AUTOID-44077"></A
>When canonifying a host's name, <em class="emphasis">sendmail</EM
> will use
the method described under the <code class="literal">ServiceSwitchFile</CODE
>
option (see <a class="xref" href="#SML2-CH-34-SECT-8-61" title="">Section 34.8.61</A
>). When that method
is <code class="literal">files</CODE
>, <em class="emphasis">sendmail</EM
> parses the <em class="emphasis">/etc/hosts</EM
>
file to find the canonical name. If a different file should be
used on your system, you can specify it with this
<code class="literal">HostsFile</CODE
> option:</P
><p class="para"><blockquote class="screen"><pre class="screen">O HostsFile=<code class="replaceable"><i>path</I
></CODE
>               <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (beginning with V8.7)</I
>
-OHostsFile=<code class="replaceable"><i>path</I
></CODE
>               <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.7)</I
>
define(`confHOSTS_FILE',<code class="replaceable"><i>path</I
></CODE
>)  <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">Here, <code class="replaceable"><i>path</I
></CODE
> is of type string. If <code class="replaceable"><i>path</I
></CODE
> is missing, the name
of the <em class="emphasis">/etc/hosts</EM
> file becomes an empty string. If the entire
option is missing, the default is the value that was given to
_PATH_HOSTS when <em class="emphasis">sendmail</EM
> was compiled (see <a class="xref" href="ch18_08.htm" title="">Section 18.8.34</A
>).
If the <code class="replaceable"><i>path</I
></CODE
> cannot be opened for reading (for any reason
at all), host canonification by this method is silently skipped.</P
><p class="para">One example of a use for the <code class="literal">HostsFile</CODE
> option would be to
use a switched-service file to cause all host lookups to use
DNS first, then files:</P
><p class="para"><blockquote class="screen"><pre class="screen">hosts:    dns files</PRE
></BLOCKQUOTE
></P
><p class="para">In that case you would use a special file to hold information about
internal hosts that are not known to DNS. Such a file might look
like this:</P
><p class="para"><blockquote class="screen"><pre class="screen">123.45.67.89	secret.internal.host.domain</PRE
></BLOCKQUOTE
></P
><p class="para">This special file would be defined with the <code class="literal">HostsFile</CODE
> option.</P
><p class="para">The <code class="literal">HostsFile</CODE
> option is not safe.
If specified from the command line,
it may cause <em class="emphasis">sendmail</EM
> to relinquish its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-31">34.8.31 HostStatusDirectory</A
></H3
><p class="refpurpose">Location of persistent host status</P
>(V8.8 and above)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-44122"></A
>The process of delivering network mail requires that <em class="emphasis">sendmail</EM
>
<em class="emphasis">fork</EM
>(2) so that the child process can handle the queue.
Then, if the <code class="literal">ForkEachJob</CODE
> (<code class="literal">Y</CODE
>) option (see
<a class="xref" href="#SML2-CH-34-SECT-8-26" title="">Section 34.8.26</A
>) is true, each job in the queue has to <em class="emphasis">fork</EM
>(2)
again so that each child-of-a-child can perform each task.
Internally, <em class="emphasis">sendmail</EM
> maintains tables of status information
about network hosts (such as whether the host is up or down or refusing
connections). A problem can arise when multiple queue-processing
children are running. Because they are separate processes, their
separate children lack access to the common pool of host information
that is stored internally by each parent.
[17]</P
><blockquote class="footnote"><p class="para">[17] Also status information from previous queue runs is lost.</P
></BLOCKQUOTE
><p class="para">One solution is to store host status information externally
so that all children can access it.
Inspired by KJS <em class="emphasis">sendmail</EM
>, V8.8 has introduced
the <code class="literal">HostStatusDirectory</CODE
> option. This option both tells
<em class="emphasis">sendmail</EM
> that it should save host status information externally
and defines where that information will be stored on disk.</P
><p class="para">The form for the <code class="literal">HostStatusDirectory</CODE
> option looks like this:</P
><p class="para"><blockquote class="screen"><pre class="screen">O HostStatusDirectory=<code class="replaceable"><i>path                     </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8.8 and above</I
>
define(`confHOST_STATUS_DIRECTORY', `<code class="replaceable"><i>path'</I
></CODE
>)    <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 technique</I
></PRE
></BLOCKQUOTE
></P
><p class="para">Here, <code class="replaceable"><i>path</I
></CODE
> is of type string and, if present, specifies the
base directory under which host status will be stored. This may
be a full or relative path specification. If it is a relative path, it is interpreted
as relative to the queue directory. 
If <code class="replaceable"><i>path</I
></CODE
> is omitted
or if the entire option is omitted, 
the default is that no persistent host information will be saved.
If <code class="replaceable"><i>path</I
></CODE
> does not exist or if it exists and is not a directory, <em class="emphasis">sendmail</EM
>
will then print the following error and will store no persistent host information:</P
><p class="para"><blockquote class="screen"><pre class="screen">Cannot use HostStatusDirectory = <code class="replaceable"><i>path</I
></CODE
>: <i class="lineannotation">reason here</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The form of the information stored and the way files and directories
under this base directory are named are detailed in Appendix <a class="xref" href="appb_01.htm" title="Host Status File Internals">Appendix B, <cite class="appendix">Host Status File Internals</CITE
></A
>.
Note that the status information in this directory can be printed with the
<em class="emphasis">hoststat</EM
>(1) command (see <a class="xref" href="ch36_01.htm" title="hoststat (V8.8 and Above)">Section 36.1.1, "hoststat (V8.8 and Above)"</A
>).
Also note that the <code class="literal">HostStatusDirectory</CODE
> option will not work
if the <code class="literal">ConnectionCacheSize</CODE
> option (see <a class="xref" href="#SML2-CH-34-SECT-8-10" title="">Section 34.8.10</A
>)
is set to zero:</P
><p class="para"><blockquote class="screen"><pre class="screen">Warning: HostStatusDirectory disabled with ConnectionCacheSize = 0</PRE
></BLOCKQUOTE
></P
><p class="para">Note that on machines that send out a great deal of mail, you should probably
compare performance with and without this option enabled and base
your decision to use it on the result.
Also note that this option is required if you wish to also
use the <code class="literal">SingleThreadDelivery</CODE
> option 
(see <a class="xref" href="#SML2-CH-34-SECT-8-64" title="">Section 34.8.64</A
>).</P
><p class="para">Avoid using a directory that is on a <em class="emphasis">tmpfs</EM
> file system (prior
to Sun Solaris 2.5), because file locking is not supported. 
Avoid using a directory that is on an <em class="emphasis">nfs</EM
> file
system, because record locking is unreliable and single-threaded and can add 
extra RPC traffic.</P
><p class="para">The <code class="literal">HostStatusDirectory</CODE
> option is not safe.  If it is specified from the command line,
it may cause <em class="emphasis">sendmail</EM
> to give up its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-32">34.8.32 IgnoreDots (i)</A
></H3
><p class="refpurpose">Ignore leading dots in messages</P
>(All versions)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-44181"></A
><a class="indexterm" name="AUTOID-44183"></A
><a class="indexterm" name="AUTOID-44186"></A
>There are two ways that <em class="emphasis">sendmail</EM
> can detect the end of a mail
message: by noting an end-of-file (EOF) condition or by finding
a line composed of a single dot. According
to the SMTP and ESMTP protocols (RFC821), the end of the mail data is
indicated
by sending a line containing only a period.
The <code class="literal">IgnoreDots</CODE
> (<code class="literal">i</CODE
>) option tells <em class="emphasis">sendmail</EM
> to treat any line that contains
only a single period as ordinary text, not as an end-of-file indicator.</P
><p class="para">This option is used from the command line to prevent <em class="emphasis">sendmail</EM
>
from wrongly thinking that a message is complete when collecting
the message from its standard input. This differs from the correct
behavior when <em class="emphasis">sendmail</EM
> is reading from an SMTP connection.
Over SMTP a lone dot must signal the end of the message.</P
><p class="para">This option is intended for use from the command line.
This option should be used in the configuration file only
for sites that have no SMTP network connections.
But V8 <em class="emphasis">sendmail</EM
> has built-in protection. If this option
is specified in the configuration file, it is automatically forced false for
all SMTP connections.</P
><p class="para">The forms of the <code class="literal">i</CODE
> option are as follows:</P
><p class="para"><blockquote class="screen"><pre class="screen">Oi<code class="replaceable"><i>bool                           </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (old form)</I
>
-oi<code class="replaceable"><i>bool                          </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (old form)</I
>
-i<code class="replaceable"><i>                               </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command-line</I
>
shorthand (deprecated)
O IgnoreDots=<code class="replaceable"><i>bool                </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (beginning with V8.7)</I
>
-OIgnoreDots=<code class="replaceable"><i>bool                </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.7)</I
>
define(`confIGNORE_DOTS',<code class="replaceable"><i>bool</I
></CODE
>)   <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The argument <code class="replaceable"><i>bool</I
></CODE
> is of type Boolean. If <code class="replaceable"><i>bool</I
></CODE
> is
missing, the default value is true (ignore leading dots).
If the <code class="literal">IgnoreDots</CODE
> (<code class="literal">i</CODE
>)
option is entirely omitted, the default is false
(recognize leading dots as special).</P
><p class="para">The <code class="literal">IgnoreDots</CODE
> (<code class="literal">i</CODE
>) option is safe.
Even if it is specified from the command line,
<em class="emphasis">sendmail</EM
> retains its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-33">34.8.33 LogLevel (L)</A
></H3
><p class="refpurpose">Set (increase) logging level</P
>(All versions)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-44232"></A
>The <em class="emphasis">sendmail</EM
> program is able to log
a wide variety of information about what it is doing. There is
no default file for recording information. Instead, <em class="emphasis">sendmail</EM
> sends
all such information via the UNIX <em class="emphasis">syslog</EM
>(3) mechanism.
The disposition of messages by <em class="emphasis">syslog</EM
> is determined by
information in the file <em class="emphasis">/etc/syslog.conf</EM
> 
(see <a class="xref" href="ch26_01.htm" title="Tuning syslog.conf">Section 26.1.2, "Tuning syslog.conf"</A
>).
One common scheme places noncritical
messages <em class="emphasis">/var/log/syslog</EM
> but routes important
messages to <em class="emphasis">/dev/console</EM
> or <em class="emphasis">/var/adm/messages</EM
>.</P
><p class="para">The meaningful values for the logging level, and
their <em class="emphasis">syslog</EM
> priorities, are outlined below.
[18]
Higher logging levels include the
lower logging levels. For example, logging level 2 also causes level
1 messages to be logged. &#13;</P
><blockquote class="footnote"><p class="para">[18] Note that the pre-V8 organization differs
and is not covered in this book.</P
></BLOCKQUOTE
><dl class="variablelist"><dt class="term"><em class="emphasis">0</EM
></DT
><dd class="listitem"><p class="para">Minimal logging. See <a class="xref" href="#SML2-CH-34-SECT-8-33-1" title="What is logged at LogLevel=0">Section 34.8.33.1, "What is logged at LogLevel=0"</A
> for examples
of what is logged at this setting.&#13;</P
></DD
><dt class="term"><em class="emphasis">1</EM
></DT
><dd class="listitem"><p class="para">Serious system failures and security problems logged at LOG_CRIT or LOG_ALERT.&#13;</P
></DD
><dt class="term"><em class="emphasis">2</EM
></DT
><dd class="listitem"><p class="para">Communication failures, (e.g., lost connections or protocol failures) logged at LOG_CRIT.&#13;</P
></DD
><dt class="term"><em class="emphasis">3</EM
></DT
><dd class="listitem"><p class="para">Malformed addresses logged at LOG_NOTICE.
Transient forward/include errors logged at LOG_ERROR.
Connect timeouts logged at LOG_NOTICE.&#13;</P
></DD
><dt class="term"><em class="emphasis">4</EM
></DT
><dd class="listitem"><p class="para">Malformed <code class="literal">qf</CODE
> filenames and minor errors logged at LOG_NOTICE.
Out of date alias databases logged at LOG_INFO.
Connection rejections (via <em class="emphasis">libwrap.a</EM
> or one of the
<code class="literal">check_</CODE
> rule sets) logged at LOG_NOTICE.&#13;</P
></DD
><dt class="term"><em class="emphasis">5</EM
></DT
><dd class="listitem"><p class="para">A record of each message received logged at LOG_INFO.
Envelope cloning logged at LOG_INFO.&#13;</P
></DD
><dt class="term"><em class="emphasis">6</EM
></DT
><dd class="listitem"><p class="para">SMTP VRFY attempts and messages returned to the original
sender logged at LOG_INFO.
The ETRN and EXPN ESMTP commands logged at LOG_INFO.&#13;</P
></DD
><dt class="term"><em class="emphasis">7</EM
></DT
><dd class="listitem"><p class="para">Delivery failures, excluding mail deferred because of the lack of
a resource, logged at LOG_INFO.&#13;</P
></DD
><dt class="term"><em class="emphasis">8</EM
></DT
><dd class="listitem"><p class="para">Successful deliveries logged at LOG_INFO.
Alias database rebuilds logged at LOG_NOTICE.&#13;</P
></DD
><dt class="term"><em class="emphasis">9</EM
></DT
><dd class="listitem"><p class="para">Mail deferred because of a lack of a resource logged at LOG_INFO.&#13;</P
></DD
><dt class="term"><em class="emphasis">10</EM
></DT
><dd class="listitem"><p class="para">Each key as looked up in a database, and the result of
each lookup, logged at LOG_INFO.&#13;</P
></DD
><dt class="term"><em class="emphasis">11</EM
></DT
><dd class="listitem"><p class="para">All <em class="emphasis">nis</EM
> errors logged at LOG_INFO.
The end of processing (job deletion) logged at LOG_INFO.&#13;</P
></DD
><dt class="term"><em class="emphasis">12</EM
></DT
><dd class="listitem"><p class="para">SMTP connects logged at LOG_INFO.&#13;</P
></DD
><dt class="term"><em class="emphasis">13</EM
></DT
><dd class="listitem"><p class="para">Log bad user shells, world-writable files, and other questionable
situations.&#13;</P
></DD
><dt class="term"><em class="emphasis">14</EM
></DT
><dd class="listitem"><p class="para">Connection refusals logged at LOG_INFO.&#13;</P
></DD
><dt class="term"><em class="emphasis">15</EM
></DT
><dd class="listitem"><p class="para">All incoming and outgoing SMTP commands and their
arguments logged at LOG_INFO.&#13;</P
></DD
><dt class="term"><em class="emphasis">16-98</EM
></DT
><dd class="listitem"><p class="para">Debugging information. You'll need the source to understand this
logging. You can <em class="emphasis">grep</EM
>(1) <code class="literal">LogLevel</CODE
> in all the <em class="emphasis">.c</EM
> files
to find interesting things to look for.
These are logged at LOG_DEBUG.</P
></DD
></DL
><p class="para">The forms of the <code class="literal">LogLevel</CODE
> (<code class="literal">L</CODE
>) option are as follows:</P
><p class="para"><blockquote class="screen"><pre class="screen">OL<code class="replaceable"><i>lev                         </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (old form)</I
>
-oL<code class="replaceable"><i>lev                        </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (old form)</I
>
O LogLevel=<code class="replaceable"><i>lev                </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (beginning with V8.7)</I
>
-OLogLevel=<code class="replaceable"><i>lev                </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.7)</I
>
define(`confLOG_LEVEL',<code class="replaceable"><i>lev</I
></CODE
>)   <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The type for <code class="replaceable"><i>lev</I
></CODE
> is numeric and defaults to 0.
For the <em class="emphasis">m4</EM
> technique the default is 9.
Negative values are equivalent to a logging level of 0.</P
><p class="para">Logging is effective only if <em class="emphasis">sendmail</EM
> is compiled with LOG
defined in <em class="emphasis">conf.h</EM
> (see <a class="xref" href="ch18_08.htm" title="">Section 18.8.16, LOG</A
>). The <code class="literal">-d0.1</CODE
>
debugging switch (see <a class="xref" href="ch37_05.htm" title="">Section 37.5.1, -d0.1</A
>) can be used to see if LOG was
defined for your system.</P
><p class="para">The <code class="literal">LogLevel</CODE
> (<code class="literal">L</CODE
>) option is safe.  Even if it is specified from the command line,
<em class="emphasis">sendmail</EM
> retained its <em class="emphasis">root</EM
> privilege. For security
reasons the logging level of V8.6 and above <em class="emphasis">sendmail</EM
>
can be increased from the command line but not decreased.
[19]&#13;</P
><blockquote class="footnote"><p class="para">[19] V8.7.3 <em class="emphasis">sendmail</EM
> was released with the <code class="literal">LogLevel</CODE
> (<code class="literal">L</CODE
>) 
option set as not safe.</P
></BLOCKQUOTE
><div class="refsect2"><h4 class="refsect2"><a class="title" name="SML2-CH-34-SECT-8-33-1">34.8.33.1 What is logged at LogLevel=0</A
></H4
><p class="para">Because of their severe nature, some errors and problems are logged
even though the <code class="literal">LogLevel</CODE
> (<code class="literal">L</CODE
>) option is set to zero.
Specifically,
problems with <code class="literal">$j</CODE
> and <code class="literal">$=w</CODE
> that are checked if
<em class="emphasis">sendmail</EM
> was compiled with XDEBUG defined:</P
><p class="para"><blockquote class="screen"><pre class="screen">daemon process doesn't have $j in $=w; see syslog
daemon process $j lost dot; see syslog</PRE
></BLOCKQUOTE
></P
><p class="para">Failure to find your unqualified hostname or qualified domain:</P
><p class="para"><blockquote class="screen"><pre class="screen">My unqualified host name (<i class="lineannotation">my host name</I
>) unknown
unable to qualify my own domain name (<i class="lineannotation">my host name</I
>) - using short name</PRE
></BLOCKQUOTE
></P
><p class="para">If the daemon was invoked without a full pathname:</P
><p class="para"><blockquote class="screen"><pre class="screen">daemon invoked without full pathname; kill -1 won't work</PRE
></BLOCKQUOTE
></P
><p class="para">&#13;Normal startup of the daemon:</P
><p class="para"><blockquote class="screen"><pre class="screen">starting daemon (<i class="lineannotation">version</I
>): <i class="lineannotation">how</I
></PRE
></BLOCKQUOTE
></P
><p class="para">File descriptor failure if <em class="emphasis">sendmail</EM
> was compiled with XDEBUG defined:</P
><p class="para"><blockquote class="screen"><pre class="screen"><i class="lineannotation">subroutine</I
>: fd <i class="lineannotation">number</I
> not open</PRE
></BLOCKQUOTE
></P
><p class="para">Possible attacks based on a newline in a string:</P
><p class="para"><blockquote class="screen"><pre class="screen">POSSIBLE ATTACK from <i class="lineannotation">address</I
>: newline in string &quot;<i class="lineannotation">string here</I
>&quot;</PRE
></BLOCKQUOTE
></P
><p class="para">Also the states dumped as a result of a SIGUSR1 
(see <a class="xref" href="ch26_03.htm" title="SIGUSR1  Dump States">Section 26.3.3, "SIGUSR1  Dump States"</A
>) are logged, and the output caused
by the <code class="literal">-d91.100</CODE
> switch (see <a class="xref" href="ch37_05.htm" title="">Section 37.5.192, -d91.100</A
>).&#13;</P
></DIV
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-34">34.8.34 MatchGECOS (G)</A
></H3
><p class="refpurpose">Match recipient in gecos field</P
>(V8.1 and above)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-44422"></A
><a class="indexterm" name="AUTOID-44424"></A
>The <em class="emphasis">gecos</EM
> field is the portion of a <em class="emphasis">passwd</EM
>(5) file line that
contains a user's full name. Typical <em class="emphasis">passwd</EM
> file lines are
illustrated below with the <em class="emphasis">gecos</EM
> field of each highlighted in bold type:</P
><p class="para"><blockquote class="screen"><pre class="screen">george:Vnn9x34sEVbCN:101:29:<code class="userinput"><b>George Washington</B
></CODE
>:/usr/george:/bin/csh
bcx:/a88.97eGSx1l:102:5:<code class="userinput"><b>Bill Xavier</B
></CODE
>,,,:/usr/bcx:/bin/csh
tim:Fss9UdQl55cde:103:45:<code class="userinput"><b>&amp; Plenty (Jr)</B
></CODE
>:/usr/tim:/bin/csh</PRE
></BLOCKQUOTE
></P
><p class="para">When <em class="emphasis">sendmail</EM
> attempts to deliver through a delivery agent that
has the <code class="literal">F=w</CODE
> flag set (see <a class="xref" href="ch30_08.htm" title="">Section 30.8.43</A
>)
it looks up the recipient's name in the <em class="emphasis">passwd</EM
> file so
it can locate the user's home directory. That lookup tries
to match the login name, the leftmost field in the <em class="emphasis">passwd</EM
>
file. If <em class="emphasis">sendmail</EM
> has been
compiled with MATCHGECOS defined (see
<a class="xref" href="ch18_08.htm" title="">Section 18.8.18, MATCHGECOS</A
>) and
this
<code class="literal">MatchGECOS</CODE
> (<code class="literal">G</CODE
>) option is true, <em class="emphasis">sendmail</EM
> also 
tries to match the recipient name to the <em class="emphasis">gecos</EM
> field.
[20]</P
><blockquote class="footnote"><p class="para">[20] Note that IDA <em class="emphasis">sendmail</EM
> can be configured to match addresses
in the <em class="emphasis">gecos</EM
> field, but the algorithm it uses differs from
that described here.</P
></BLOCKQUOTE
><p class="para">First, <em class="emphasis">sendmail</EM
> converts any underscore characters in the address
into spaces and, if the <code class="literal">BlankSub</CODE
> (<code class="literal">B</CODE
>) option is set
(see <a class="xref" href="#SML2-CH-34-SECT-8-5" title="">Section 34.8.5</A
>), any
characters that match that space substitution character into
spaces. This makes the recipient name look like a normal full name.</P
><p class="para">Second, <em class="emphasis">sendmail</EM
> normalizes each <em class="emphasis">gecos</EM
> entry by
throwing away everything following and including the first comma, semicolon,
and percent characters. It also converts the <code class="literal">&amp;</CODE
>
to the login name wherever one is found.  If any of the characters</P
><p class="para"><blockquote class="screen"><pre class="screen">&lt; &gt;( ) ' .</PRE
></BLOCKQUOTE
></P
><p class="para">are inside the name, the whole <em class="emphasis">gecos</EM
> name is quoted; otherwise,
it's unquoted.</P
><p class="para">After each <em class="emphasis">gecos</EM
> name is normalized, it is compared in a case-insensitive
manner to the recipient. If they match, the <em class="emphasis">passwd</EM
> entry for that
user is used.</P
><p class="para">This feature allows users to receive mail addressed to their full
name as given in the <em class="emphasis">gecos</EM
> field of the <em class="emphasis">passwd</EM
> file. The usual
form is to replace spaces in the full name with dots or underscores:</P
><p class="para"><blockquote class="screen"><pre class="screen">George_Washington
Bill.Xavier
&quot;Tim_Plenty_(Jr)&quot;</PRE
></BLOCKQUOTE
></P
><p class="para">Full names in <em class="emphasis">gecos</EM
> fields that contain characters with
special meaning to <em class="emphasis">sendmail</EM
>, like the last one above,
must be quoted when used as addresses.</P
><p class="para">You should not enable this option if your
site lets users edit their own <em class="emphasis">gecos</EM
> fields with the
<em class="emphasis">chfn</EM
>(1) program. At best, they can change their name
in a way that can cause mail to start failing. Worse, they
can change their name to match another user's and
begin to capture that other user's mail. Even if the <em class="emphasis">gecos</EM
>
field is secure, you should avoid this option if your <em class="emphasis">passwd</EM
>
file is large. The <em class="emphasis">sendmail</EM
> program performs a sequential
read of the <em class="emphasis">passwd</EM
> file, which could be very slow.</P
><p class="para">The forms of the <code class="literal">MatchGECOS</CODE
> (<code class="literal">G</CODE
>) option are as follows:</P
><p class="para"><blockquote class="screen"><pre class="screen">OG<code class="replaceable"><i>bool                           </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (old form)</I
>
-oG<code class="replaceable"><i>bool                          </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (old form)</I
>
O MatchGECOS=<code class="replaceable"><i>bool                </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (beginning with V8.7)</I
>
-OMatchGECOS=<code class="replaceable"><i>bool                </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.7)</I
>
define(`confMATCH_GECOS',<code class="replaceable"><i>bool</I
></CODE
>)   <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The <code class="literal">MatchGECOS</CODE
> (<code class="literal">G</CODE
>) option is not safe.  If it is specified from the command line,
it may cause <em class="emphasis">sendmail</EM
> to give up its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-35">34.8.35 MaxDaemonChildren</A
></H3
><p class="refpurpose">Maximum forked children</P
>(V8.8 and above)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-44510"></A
><a class="indexterm" name="AUTOID-44512"></A
>The <em class="emphasis">sendmail</EM
> program <em class="emphasis">fork</EM
>(3)'s often. It forks to process each
incoming connection, and it forks to process its queue.</P
><p class="para">You can limit the number of
forked children that <em class="emphasis">sendmail</EM
> produces by defining the
<code class="literal">MaxDaemonChildren</CODE
> option: </P
><p class="para"><blockquote class="screen"><pre class="screen">O MaxDaemonChildren=<code class="replaceable"><i>num                  </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (beginning with V8.7)</I
>
-OMaxDaemonChildren=<code class="replaceable"><i>num                  </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.7)</I
>
define(`confMAX_DAEMON_CHILDREN', `<code class="replaceable"><i>num')   </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 technique</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The <code class="replaceable"><i>num</I
></CODE
> is of type numeric and specifies the maximum number of
forked children that are allowed to exist at any one time.
If <code class="replaceable"><i>num</I
></CODE
> is less than or equal to zero, if it is missing,
or if this entire option is missing, no limit is imposed.
If <code class="replaceable"><i>num</I
></CODE
> is greater than zero,
connections that cause more than that number of
forked children to be created will be rejected. While rejecting more connections,
<em class="emphasis">sendmail</EM
> will change its process title to read</P
><p class="para"><blockquote class="screen"><pre class="screen">rejecting connections: maximum children: <code class="replaceable"><i>num</I
></CODE
></PRE
></BLOCKQUOTE
></P
><p class="para">If <code class="replaceable"><i>num</I
></CODE
> is greater than zero, <em class="emphasis">sendmail</EM
> will also limit
the number of forked children it creates to handle queue runs.</P
><p class="para">Note the <code class="literal">MaxDaemonChildren</CODE
> option should not be set in the configuration
file. If the daemon handling incoming mail has this option set, a 
denial-of-service attack can easily be launched against your machine.
Beginning with V8.8, the <code class="literal">ConnectionRateThrottle</CODE
> option
(see <a class="xref" href="#SML2-CH-34-SECT-8-12" title="">Section 34.8.12</A
>) can be used to slow rapid incoming
connections and can be used with the incoming daemon.</P
><p class="para">The <code class="literal">MaxDaemonChildren</CODE
> option is appropriate for use in certain
queue-processing situations. For example, consider a special
queue that exclusively holds mail for a popular host (say, <em class="emphasis">/var/spool/bigqueue</EM
>).
To handle the outgoing mail, you could run <em class="emphasis">sendmail</EM
>
in queue-processing mode like this:</P
><p class="para"><blockquote class="screen"><pre class="screen">/usr/lib/sendmail -q5m -OMaxDaemonChildren=2 -OQueueDirectory=/var/spool/bigqueue</PRE
></BLOCKQUOTE
></P
><p class="para">Here, the queue is processed once every five minutes. If the number of children were not limited and if the queue were large or the destination host slow,
too many parallel invocations of <em class="emphasis">sendmail</EM
> would be spawned, thus
causing excessive connections to the destination host. By limiting the
number of children with the <code class="literal">MaxDaemonChildren</CODE
> option, you allow
a small, polite amount of parallelism.</P
><p class="para">The <code class="literal">MaxDaemonChildren</CODE
> option is not safe.
If specified from the command line,
it may cause <em class="emphasis">sendmail</EM
> to relinquish its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-36">34.8.36 MaxHopCount (h)</A
></H3
><p class="refpurpose">Set maximum hop count</P
>(All version)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-44563"></A
><a class="indexterm" name="AUTOID-44565"></A
>A <em class="emphasis">hop</EM
> is the transmittal of a mail message from
one machine to another.
[21]
Many hops may be required to deliver a message.
The number of hops is determined by counting the <code class="literal">Received:</CODE
> and
<code class="literal">Via:</CODE
> lines
[22]
in the header of an email message.</P
><blockquote class="footnote"><p class="para">[21] The IP transport protocol also has the concept of hops. A message going from
one machine to another has only one mail hop but may have
many IP hops.</P
><p class="para">[22] Actually, only the headers that are marked with
an H_TRACE flag (see <a class="xref" href="ch35_05.htm#SML2-CH-35-SECT-5-6" title="H_TRACE">Section 35.5.8, "H_TRACE"</A
>) are counted.</P
></BLOCKQUOTE
><p class="para">The <code class="literal">MaxHopCount</CODE
> (<code class="literal">h</CODE
>) option tells <em class="emphasis">sendmail</EM
>
the maximum number of times
a message can be forwarded. When <em class="emphasis">sendmail</EM
>
receives a message via email, it calculates the hop count. If that count
is above the maximum allowed, it bounces the message back
to the sender with the error</P
><p class="para"><blockquote class="screen"><pre class="screen">sendmail: too many hops (17 max)</PRE
></BLOCKQUOTE
></P
><p class="para">In this case, <code class="literal">17</CODE
> is the maximum. Detecting too many
hops is useful in stopping <em class="emphasis">mail loops</EM
>&nbsp;- messages
being forwarded back and forth between two machines.</P
><p class="para">The forms of the <code class="literal">MaxHopCount</CODE
> (<code class="literal">h</CODE
>) option are as follows:</P
><p class="para"><blockquote class="screen"><pre class="screen">Oh<code class="replaceable"><i>hops                       </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (old form)</I
>
-oh<code class="replaceable"><i>hops                      </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (old form)</I
>
O MaxHopCount=<code class="replaceable"><i>hops           </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (beginning with V8.7)</I
>
-OMaxHopCount=<code class="replaceable"><i>hops           </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.7)</I
>
define(`confMAX_HOP',<code class="replaceable"><i>hops</I
></CODE
>)   <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The <code class="replaceable"><i>hops</I
></CODE
> argument is of type numeric.
If <code class="replaceable"><i>hops</I
></CODE
> is missing, the value becomes zero and causes
all mail to fail with the error:</P
><p class="para"><blockquote class="screen"><pre class="screen">sendmail: too many hops (0 max)</PRE
></BLOCKQUOTE
></P
><p class="para">If the entire <code class="literal">MaxHopCount</CODE
> (<code class="literal">h</CODE
>) option is missing, <code class="replaceable"><i>hops</I
></CODE
> defaults to 25.
A good value is 15 or more. This allows mail to follow
a fairly long route through many machines (as it could with UUCP)
but still catches and bounces mail caught in a loop between two machines.</P
><p class="para">In pre-V8 <em class="emphasis">sendmail</EM
> there was no <code class="literal">h</CODE
> option for setting the maximum
number of hops. 
Instead, the number of hops could be limited only by the
compile-time definition of MAXHOP in <em class="emphasis">conf.h</EM
>.
The default definition varied
between 15 for IDA <em class="emphasis">sendmail</EM
> and 30 for V5 and earlier
SunOS <em class="emphasis">sendmail</EM
>.</P
><p class="para">The <code class="literal">MaxHopCount</CODE
> (<code class="literal">h</CODE
>) option should not be confused
with the <code class="literal">-h</CODE
> command-line switch (see <a class="xref" href="ch36_07.htm" title="">Section 36.7.22, -h</A
>).
The <code class="literal">MaxHopCount</CODE
> (<code class="literal">h</CODE
>)
option specifies the maximum number of
hops allowed, whereas the <code class="literal">-h</CODE
> 
command-line switch presets the
(beginning) hop count for a given email message.</P
><p class="para">The <code class="literal">MaxHopCount</CODE
> (<code class="literal">h</CODE
>) option is not safe.  If specified from the command line,
it may cause <em class="emphasis">sendmail</EM
> to relinquish its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-37">34.8.37 MaxMessageSize</A
></H3
><p class="refpurpose">Maximum incoming ESMTP message size</P
>(V8.7 and above)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-44636"></A
><a class="indexterm" name="AUTOID-44638"></A
><a class="indexterm" name="AUTOID-44641"></A
><a class="indexterm" name="AUTOID-44644"></A
><a class="indexterm" name="AUTOID-44646"></A
><a class="indexterm" name="AUTOID-44649"></A
>The SIZE keyword to the ESMTP MAIL command tells V8 <em class="emphasis">sendmail</EM
>
how big an incoming message is in bytes.
If the SIZE keyword is not specified,
<em class="emphasis">sendmail</EM
> assumes that the incoming message 

is zero bytes in size.
V8 <em class="emphasis">sendmail</EM
> can reject a message at this point
if it is larger than a definable maximum message size:</P
><p class="para"><blockquote class="screen"><pre class="screen">Message size exceeds fixed maximum message size (<code class="replaceable"><i>max</I
></CODE
>)</PRE
></BLOCKQUOTE
></P
><p class="para">Here, <code class="replaceable"><i>max</I
></CODE
> is the maximum acceptable size in bytes.
Ordinarily, there no maximum. If you want to define one,
you may do so with the <code class="literal">MaxMessageSize</CODE
> (<code class="literal">b</CODE
>) option:</P
><p class="para"><blockquote class="screen"><pre class="screen">Ob<code class="replaceable"><i>minblocks/maxsize</I
></CODE
>                      <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (beginning with V8.1)</I
>
-ob<code class="replaceable"><i>minblocks/maxsize</I
></CODE
>                     <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.1)</I
>
O MaxMessageSize=<code class="replaceable"><i>maxsize</I
></CODE
>                 <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (beginning with V8.7)</I
>
-OMaxMessageSize=<code class="replaceable"><i>maxsize</I
></CODE
>                 <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.7)</I
>
define(`confMAX_MESSAGE_SIZE',<code class="replaceable"><i>maxsize</I
></CODE
>)   <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">If <code class="replaceable"><i>maxsize</I
></CODE
> is omitted or if this entire option
is omitted,
the default is 0 (for unlimited message sizes). 
For the <em class="emphasis">m4</EM
> configuration the default is <code class="literal">0</CODE
> (unlimited).
Note that the <code class="literal">b</CODE
> option can also set the minimum blocks
free (see <a class="xref" href="#SML2-CH-34-SECT-8-40" title="">Section 34.8.40</A
>).</P
><p class="para">This limit on message size is enforced during the SMTP dialogue.
Later, after a delivery agent has been selected, further limitations
can be imposed by using the <code class="literal">M=</CODE
> delivery agent equate (see <a class="xref" href="ch30_04.htm" title="">Section 30.4.7, M=</A
>).</P
><p class="para">The <code class="literal">MaxMessageSize</CODE
> (<code class="literal">b</CODE
>) option is not safe.
If specified from the command line,
it may cause <em class="emphasis">sendmail</EM
> to relinquish its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-38">34.8.38 MaxQueueRunSize</A
></H3
><p class="refpurpose">Maximum queue messages processed</P
>(V8.7 and above)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-44695"></A
><a class="indexterm" name="AUTOID-44697"></A
>Ordinarily (beginning with V8.6 <em class="emphasis">sendmail</EM
>), there is no
limit to the number of queued messages that can be processed
during a single queue run. If there are more messages than
<em class="emphasis">sendmail</EM
> has allocated memory for, <em class="emphasis">sendmail</EM
> will calmly
allocate more memory. (Previously, there was a fixed limit imposed
at compile time.)</P
><p class="para">Some systems process so much mail that a single queue run can
become unmanageably large&nbsp;- so huge, in fact, that system resources
are strained to the limit with an adverse effect on system performance.
If your site suffers from this problem, beginning with V8.7 
you can set an upper limit on the number of queued messages
to be processed by using the <code class="literal">MaxQueueRunSize</CODE
> option:</P
><p class="para"><blockquote class="screen"><pre class="screen">O MaxQueueRunSize=<code class="replaceable"><i>limit</I
></CODE
>                     <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (beginning with V8.7)</I
>
-OMaxQueueRunSize=<code class="replaceable"><i>limit</I
></CODE
>                     <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.7)</I
>
define(`confMAX_QUEUE_RUN_SIZE',<code class="replaceable"><i>limit</I
></CODE
>)      <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">Here, <code class="replaceable"><i>limit</I
></CODE
> is of type numeric and defines the upper limit
on how many queued messages can be processed during a single queue
run. If <code class="replaceable"><i>limit</I
></CODE
> is less than or equal to zero, if it
is missing, or if the entire option is missing,
no limit is imposed.
The default is to impose no limit.</P
><p class="para">If <code class="literal">MaxQueueRunSize</CODE
> is defined and if that limit is reached while processing
the queue, <em class="emphasis">sendmail</EM
> will log the following message at LOG_ALERT:</P
><p class="para"><blockquote class="screen"><pre class="screen">WorkList for <code class="replaceable"><i>queuedir</I
></CODE
> maxed out at <code class="replaceable"><i>limit</I
></CODE
></PRE
></BLOCKQUOTE
></P
><p class="para">Processing of the queue is described in <a class="xref" href="ch23_05.htm" title="How the Queue Is Processed">Section 23.5, "How the Queue Is Processed"</A
>.
That process can be watched with the <code class="literal">-d41</CODE
> debugging switch (see <a class="xref" href="ch37_05.htm" title="">Section 37.5.144, -d41.1</A
>).</P
><p class="para">The <code class="literal">MaxQueueRunSize</CODE
> option is safe. Even if it is specified from the command line,
<em class="emphasis">sendmail</EM
> retains its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-39">34.8.39 MeToo (m)</A
></H3
><p class="refpurpose">Send to me too</P
>(All versions)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-44739"></A
><a class="indexterm" name="AUTOID-44741"></A
><a class="indexterm" name="AUTOID-44744"></A
>When you send mail to a mailing list that includes your name as a part
of that list, <em class="emphasis">sendmail</EM
> normally excludes you from that mailing.
There are two good reasons for that behavior:</P
><ul class="itemizedlist"><li class="listitem"><p class="para">Since you sent the mail, it is assumed that you already have a copy
of the letter. Most mailing programs have options that allow you
to automatically retain copies of your outgoing mail. The BSD <em class="emphasis">Mail</EM
>
program, for example, has the <em class="emphasis">outfolder</EM
> option.</P
></LI
><li class="listitem"><p class="para">When mail passes through a site that is acting as an exploder for
an outside mailing list, mail loops could be caused by sending a copy
of the message back to the original sender.</P
></LI
></UL
><p class="para">The <code class="literal">MeToo</CODE
> (<code class="literal">m</CODE
>) option overrides this behavior, but it is usually
best to keep it turned off. If individual
users want to be included in mailings to lists that they belong to,
they can set this behavior from their mail-sending programs.
BSD <em class="emphasis">Mail</EM
>, for example, allows you to <code class="literal">set&nbsp;metoo</CODE
> in
your <em class="emphasis">~/.mailrc</EM
> file. This use of <code class="literal">metoo</CODE
> simply causes
<em class="emphasis">Mail</EM
> to invoke <em class="emphasis">sendmail</EM
> with the <code class="literal">-om</CODE
> switch,
thereby setting the <code class="literal">MeToo</CODE
> (<code class="literal">m</CODE
>) option.</P
><p class="para">The forms of the <code class="literal">MeToo</CODE
> (<code class="literal">m</CODE
>) option are as follows:</P
><p class="para"><blockquote class="screen"><pre class="screen">Om<code class="replaceable"><i>bool                      </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (old form)</I
>
-om<code class="replaceable"><i>bool                     </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (old form)</I
>
-m<code class="replaceable"><i>                          </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command-line shorthand</I
>
O MeToo=<code class="replaceable"><i>bool                </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (beginning with V8.7)</I
>
-OMeToo=<code class="replaceable"><i>bool                </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.7)</I
>
define(`confME_TOO',<code class="replaceable"><i>bool</I
></CODE
>)   <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The optional argument <code class="replaceable"><i>bool</I
></CODE
>, when missing, defaults to true (include
the sender).
If this option is entirely missing, it defaults to false (exclude the sender).</P
><p class="para">The <code class="literal">MeToo</CODE
> (<code class="literal">m</CODE
>) option is safe.  Even if it is specified from the command line,
<em class="emphasis">sendmail</EM
> retains its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-40">34.8.40 MinFreeBlocks (b)</A
></H3
><p class="refpurpose">Define minimum free disk blocks</P
>(V8.1 and above)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-44799"></A
><a class="indexterm" name="AUTOID-44801"></A
>The SIZE keyword to the ESMTP MAIL command tells V8 <em class="emphasis">sendmail</EM
>
how big an incoming message is in bytes.
If the SIZE keyword is not specified,
<em class="emphasis">sendmail</EM
> assumes that the incoming message is zero bytes in size.
In either case it calls the subroutine <em class="emphasis">enoughspace</EM
>()
in <em class="emphasis">conf.c</EM
> to see whether enough space is available in
the queue to accept the message. 
Unless <em class="emphasis">sendmail</EM
> is
told otherwise, it assumes it can use 100% of the disk
space in the queue. If SIZE bytes will overfill the queue disk,
<em class="emphasis">sendmail</EM
> prints the following error and rejects the
mail message:</P
><p class="para"><blockquote class="screen"><pre class="screen">Insufficient disk space; try again later</PRE
></BLOCKQUOTE
></P
><p class="para">Note that the SIZE keyword (if received) is just an estimate that allows
oversized mail to be rejected early in the ESMTP dialogue.
V8 <em class="emphasis">sendmail</EM
> still properly diagnoses out-of-space
conditions when it actually reads the message.</P
><p class="para">If using 100% of the disk space is unacceptable, you can
use the <code class="literal">MinFreeBlocks</CODE
> (<code class="literal">b</CODE
>) option to reserve space for other
kinds of files:</P
><p class="para"><blockquote class="screen"><pre class="screen">Ob<code class="replaceable"><i>minblocks/maxsize                             </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (beginning with V8.6)</I
>
-ob<code class="replaceable"><i>minblocks/maxsize                            </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.6)</I
>
O MinFreeBlocks=<code class="replaceable"><i>minblocks                       </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (beginning with V8.7)</I
>
-OMinFreeBlocks=<code class="replaceable"><i>minblocks                       </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.7)</I
>
define(`confMIN_FREE_BLOCKS',<code class="replaceable"><i>minblocks</I
></CODE
>)         <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">Here, <code class="replaceable"><i>minblocks</I
></CODE
> is of type numeric and is
the number of disk blocks you wish to reserve. 
If <code class="replaceable"><i>minblocks</I
></CODE
> is missing or negative or if the
entire option is omitted, no blocks are reserved.
For the V8.6 form of the <code class="literal">b</CODE
> option a
slash is required to separate <code class="replaceable"><i>minblocks</I
></CODE
> from
<code class="replaceable"><i>maxsize</I
></CODE
> (<code class="replaceable"><i>maxsize</I
></CODE
> is described under
the <code class="literal">MaxMessageSize</CODE
> option, <a class="xref" href="#SML2-CH-34-SECT-8-37" title="">Section 34.8.37</A
>).
The default when configuring with the V8 <em class="emphasis">m4</EM
> method is 100.</P
><p class="para">Note that <code class="literal">minblocks</CODE
> are 
reserved only for the ESMTP SIZE keyword to the MAIL command.
No check is made for any other kind of queuing to reserve
space. Consequently, you should reserve a sufficient number of
blocks to satisfy your normal queuing needs.</P
><p class="para">The <code class="literal">MinFreeBlocks</CODE
> (<code class="literal">b</CODE
>) option is not safe.
If specified from the command line,
it may cause <em class="emphasis">sendmail</EM
> to relinquish its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-41">34.8.41 MinQueueAge</A
></H3
><p class="refpurpose">Skip queue file if too young</P
>(V8.7 and above)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-44853"></A
><a class="indexterm" name="AUTOID-44855"></A
>Ordinarily, all messages in the queue are processed whenever
<em class="emphasis">sendmail</EM
> is run in queue-processing mode.
No distinction is made between recently queued messages and messages
that have been in the queue for a long time (other than by priority which
simply orders the processing).</P
><p class="para">Some sites may prefer to process the queue often, say, once every five
minutes. This ensures that all important mail will be delivered promptly 
but can exact a price in degraded performance.
Every time the queue is processed, <em class="emphasis">sendmail</EM
> tries to deliver every
mail message the queue contains, but at many sites there
can be many queued messages that should not be retried
every five minutes.
One way to handle this problem is to set the <code class="literal">MinQueueAge</CODE
> option.
If it is set to <code class="literal">1h</CODE
> (one hour),
every queued message is forced to remain in the queue for a minimum of one
hour, even if the queue is processed more frequently:</P
><p class="para"><blockquote class="screen"><pre class="screen">O MinQueueAge=<code class="replaceable"><i>wait			</I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (beginning with V8.7)</I
>
-OMinQueueAge=<code class="replaceable"><i>wait			</I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.7)</I
>
define(`confMIN_QUEUE_AGE',`<code class="replaceable"><i>wait</I
></CODE
>')		<i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The argument <code class="replaceable"><i>wait</I
></CODE
> is of type time. If <code class="replaceable"><i>wait</I
></CODE
> is
less than or equal to zero or if it is missing, this feature is disabled.
If the units in the time expression are omitted, the default is minutes.
There is no default for the <em class="emphasis">m4</EM
> method.</P
><p class="para">Note that the decision of whether to process or not is <em class="emphasis">not</EM
> based
on the time the message was placed into the queue. It
is instead based on the time the message was last processed from the queue.
This time is stored in the <code class="literal">K</CODE
> line of the <code class="literal">qf</CODE
> file
(see <a class="xref" href="ch23_09.htm" title="">Section 23.9.8, K line</A
>). This minimum is enforced only if the number of
times delivery has been attempted is greater than zero (see the
<code class="literal">qf</CODE
> file's <code class="literal">N</CODE
> line, <a class="xref" href="ch23_09.htm" title="">Section 23.9.10, N line</A
>). This ensures
that the first delivery attempt will be made immediately.</P
><p class="para">The <code class="literal">MinQueueAge</CODE
> option is safe. If specified from the command line,
<em class="emphasis">sendmail</EM
> will not relinquish its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-42">34.8.42 MustQuoteChars</A
></H3
><p class="refpurpose">Quote nonaddress characters</P
>(V8.8 and above)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-44894"></A
><a class="indexterm" name="AUTOID-44896"></A
>All addresses are composed of address information and nonaddress information.
The two most common forms of addresses look like this:</P
><p class="para"><blockquote class="screen"><pre class="screen">address (non-address)
non-address &lt;address&gt;</PRE
></BLOCKQUOTE
></P
><p class="para">Usually, the nonaddress information is a user's full name or something
similar. RFC822 requires that certain characters be quoted if they
appear in the nonaddress part of an address:</P
><p class="para"><blockquote class="screen"><pre class="screen">@ , ; : \ ( ) [ ] . \'</PRE
></BLOCKQUOTE
></P
><p class="para">Nonaddress information inside parentheses is already quoted by those
parentheses. Other nonaddress that contains any of these characters
needs to be quoted with full quotation marks. To illustrate, consider
this address:</P
><p class="para"><blockquote class="screen"><pre class="screen">From: Bob@home &lt;bob@here.uofa.edu&gt;</PRE
></BLOCKQUOTE
></P
><p class="para">Because the nonaddress part <code class="literal">Bob@home</CODE
> contains an <code class="literal">@</CODE
>
character, <em class="emphasis">sendmail</EM
> is required to quote the entire phrase,
thus forming</P
><p class="para"><blockquote class="screen"><pre class="screen">From: &quot;Bob@home&quot; &lt;bob@here.uofa.edu&gt;</PRE
></BLOCKQUOTE
></P
><p class="para">This quoting is automatic and cannot be turned off for the first nine
characters:</P
><p class="para"><blockquote class="screen"><pre class="screen">@ , ; : \ ( ) [ ] . \'
                  <img src="../chars/uarr.gif" alt="-^"> <img src="../chars/uarr.gif" alt="-^">
		<i class="lineannotation">the last two are optional (but are required by RFC822)</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The last two characters are optional (but required by RFC822). All 11 characters
are the default for the <code class="literal">MustQuoteChars</CODE
> option.
If you wish to add characters to the mandatory list of characters that will be quoted, you
may do so with the <code class="literal">MustQuoteChars</CODE
> option:</P
><p class="para"><blockquote class="screen"><pre class="screen">O MustQuoteChars=<code class="replaceable"><i>more            </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8.8 and above</I
>
-OMustQuoteChars=<code class="replaceable"><i>more            </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8.8 and above</I
></PRE
></BLOCKQUOTE
></P
><p class="para">Here, <code class="replaceable"><i>more</I
></CODE
> is of type string and is the list of additional
characters that you wish to see quoted in the nonaddress part of addresses.
The <code class="replaceable"><i>more</I
></CODE
> characters replace the optional characters and append
to the mandatory characters.
If <code class="replaceable"><i>more</I
></CODE
> is missing, the optional characters are dropped.
There is no <em class="emphasis">m4</EM
> shorthand for setting this option.</P
><p class="para">The <code class="literal">MustQuoteChars</CODE
> option is not safe.
If specified from the command line,
it may cause <em class="emphasis">sendmail</EM
> to relinquish its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-43">34.8.43 NoRecipientAction</A
></H3
><p class="refpurpose">Handle no recipients in header</P
>(V8.7 and above)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-44942"></A
><a class="indexterm" name="AUTOID-44944"></A
>The header portion of a mail message must contain at least
one recipient header. Problems
can arise when an MUA produces a recipientless message or
when the only recipients are listed in a <code class="literal">Bcc:</CODE
> header
line. In the past, <em class="emphasis">sendmail</EM
> inserted an <code class="literal">Apparently-To:</CODE
> header<a class="indexterm" name="AUTOID-44950"></A
>
(see <a class="xref" href="ch35_10.htm" title="">Section 35.10.2, Apparently-To:</A
>)
into any message that lacked header recipients. The addresses
in the <code class="literal">Apparently-To:</CODE
> were gleaned from the envelope.</P
><p class="para">Beginning with V8.7 <em class="emphasis">sendmail</EM
>, it is possible
to chose how recipientless headers will be handled. This is
done with the <code class="literal">NoRecipientAction</CODE
> option, which is used like
this:</P
><p class="para"><blockquote class="screen"><pre class="screen">O NoRecipientAction=<code class="replaceable"><i>what              </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (beginning with V8.7)</I
>
-ONoRecipientAction=<code class="replaceable"><i>what              </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.7)</I
>
define(`confNO_RCPT_ACTION',<code class="replaceable"><i>what</I
></CODE
>)     <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">&#13;The argument <code class="replaceable"><i>what</I
></CODE
> is of type string and must be selected from
those shown in
<a class="xref" href="#SML2-CH-34-TAB-15" title="NoRecipientAction Option Keywords">Table 34.16</A
>.
If the <code class="replaceable"><i>what</I
></CODE
> is omitted or if it is other
than one of the possibilities shown, the following error is printed,
and the option is ignored:</P
><p class="para"><blockquote class="screen"><pre class="screen">Invalid NoRecipientAction: <i class="lineannotation">badwhat</I
></PRE
></BLOCKQUOTE
></P
><p class="para">If the entire option is omitted, the default becomes <code class="literal">none</CODE
>.
The default for the <em class="emphasis">m4</EM
> technique is to omit this option.</P
><p class="para">The <code class="replaceable"><i>what</I
></CODE
> is case-insensitive, meaning that <code class="literal">none</CODE
>
and <code class="literal">nOnE</CODE
> are both identical.</P
><table class="table"><caption class="table"><a class="title" name="SML2-CH-34-TAB-15">Table 34.16: NoRecipientAction Option Keywords</A
></CAPTION
><thead class="thead"><tr class="row" valign="TOP"><th class="entry" align="LEFT" rowspan="1" colspan="1">What</TH
><th class="entry" align="LEFT" rowspan="1" colspan="1"></TH
><th class="entry" align="LEFT" rowspan="1" colspan="1">Meaning</TH
></TR
></THEAD
><tbody class="tbody"><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1">add-apparently-to</TD
><td class="entry" rowspan="1" colspan="1"><a class="xref" href="#SML2-CH-34-SECT-8-43-1" title="NoRecipientAction=add-apparently-to">Section 34.8.43.1, "NoRecipientAction=add-apparently-to"</A
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Add an <code class="literal">Apparently-To:</CODE
> header</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1">add-bcc</TD
><td class="entry" rowspan="1" colspan="1"><a class="xref" href="#SML2-CH-34-SECT-8-43-2" title="NoRecipientAction=add-bcc">Section 34.8.43.2, "NoRecipientAction=add-bcc"</A
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Add an empty <code class="literal">Bcc:</CODE
> header</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1">add-to</TD
><td class="entry" rowspan="1" colspan="1"><a class="xref" href="#SML2-CH-34-SECT-8-43-3" title="NoRecipientAction=add-to">Section 34.8.43.3, "NoRecipientAction=add-to"</A
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Add a <code class="literal">To:</CODE
> header</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1">add-to-undisclosed</TD
><td class="entry" rowspan="1" colspan="1"><a class="xref" href="#SML2-CH-34-SECT-8-43-4" title="NoRecipientAction=add-to-undisclosed">Section 34.8.43.4, "NoRecipientAction=add-to-undisclosed"</A
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Add <code class="literal">To: undisclosed-recipients:;</CODE
></P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1">none</TD
><td class="entry" rowspan="1" colspan="1"><a class="xref" href="#SML2-CH-34-SECT-8-43-5" title="NoRecipientAction=none">Section 34.8.43.5, "NoRecipientAction=none"</A
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Pass the message unchanged</P
></TD
></TR
></TBODY
></TABLE
><p class="para">The <code class="literal">NoRecipientAction</CODE
> option is safe. If it is specified from the command line,
<em class="emphasis">sendmail</EM
> will not relinquish its <em class="emphasis">root</EM
> privilege.&#13;</P
><div class="refsect2"><h4 class="refsect2"><a class="title" name="SML2-CH-34-SECT-8-43-1">34.8.43.1 NoRecipientAction=add-apparently-to</A
></H4
><p class="para">Add an <code class="literal">Apparently-To:</CODE
> header. That is, act like pre-V8.7
sendmail. But note that this choice has been deprecated and should not
be used.&#13;</P
></DIV
><div class="refsect2"><h4 class="refsect2"><a class="title" name="SML2-CH-34-SECT-8-43-2">34.8.43.2 NoRecipientAction=add-bcc</A
></H4
><p class="para">Add an empty <code class="literal">Bcc:</CODE
> header. 
This makes the header portion
of the mail message legal under RFC822 but implies
that all recipients originally appeared in <code class="literal">Bcc:</CODE
> header lines.
But be aware that old versions of <em class="emphasis">sendmail</EM
> will strip all
<code class="literal">Bcc:</CODE
> headers, so the next site may add an <code class="literal">Apparently-To:</CODE
>
header and wrongly expose the address.&#13;</P
></DIV
><div class="refsect2"><h4 class="refsect2"><a class="title" name="SML2-CH-34-SECT-8-43-3">34.8.43.3 NoRecipientAction=add-to</A
></H4
><p class="para">Add a <code class="literal">To:</CODE
> header and fill it out with all the recipients
from the envelope. This may be misleading because it can give
a false picture of the intended recipients. It can also cause
<code class="literal">Bcc:</CODE
> header addresses to be mistakenly revealed.
This choice may be appropriate in the command line when <em class="emphasis">sendmail</EM
>
is run from an MUA that routinely omits recipient headers.&#13;</P
></DIV
><div class="refsect2"><h4 class="refsect2"><a class="title" name="SML2-CH-34-SECT-8-43-4">34.8.43.4 NoRecipientAction=add-to-undisclosed</A
></H4
><p class="para">Add a <code class="literal">To:</CODE
> header, but list in it only the address of an
empty, but descriptive, mailing list:</P
><p class="para"><blockquote class="screen"><pre class="screen">To: undisclosed-recipients:;</PRE
></BLOCKQUOTE
></P
><p class="para">This is the recommended setting for use in configuration files.&#13;</P
></DIV
><div class="refsect2"><h4 class="refsect2"><a class="title" name="SML2-CH-34-SECT-8-43-5">34.8.43.5 NoRecipientAction=none</A
></H4
><p class="para">Pass the message unchanged. Currently, this is technically illegal because RFC822
requires at least one recipient header in every mail message. This choice
may be appropriate for naive sites that kick all mail to a smart
host for processing. Note that the IETF is considering
making this legal.</P
></DIV
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-44">34.8.44 OldStyleHeaders (o)</A
></H3
><p class="refpurpose">Allow spaces in recipient lists</P
>(All versions)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-45062"></A
><a class="indexterm" name="AUTOID-45064"></A
><a class="indexterm" name="AUTOID-45067"></A
><a class="indexterm" name="AUTOID-45070"></A
>In pre-RFC821 days, lists of recipients were commonly space-delimited; that is,</P
><p class="para"><blockquote class="screen"><pre class="screen">hans christian andersen</PRE
></BLOCKQUOTE
></P
><p class="para">was considered a list of three mail recipients, rather than a single,
three-part name. Currently, individual recipient names must be
delimited with commas, and internal spaces must be quoted. That is,</P
><p class="para"><blockquote class="screen"><pre class="screen">hans,christian,andersen<i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> three recipients</I
>
&quot;hans christian andersen&quot;<i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> a single three-part name</I
>
hans christian andersen<i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> illegal</I
></PRE
></BLOCKQUOTE
></P
><p class="para">Since some users and some old programs still delimit recipient
lists with spaces, the <code class="literal">OldStyleHeaders</CODE
> (<code class="literal">o</CODE
>)
option can be used to tell <em class="emphasis">sendmail</EM
>
to internally convert those spaces to commas.</P
><p class="para">The forms of the <code class="literal">OldStyleHeaders</CODE
> (<code class="literal">o</CODE
>) option are as follows:</P
><p class="para"><blockquote class="screen"><pre class="screen">Oo<code class="replaceable"><i>bool                                 </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (old form)</I
>
-oo<code class="replaceable"><i>bool                                </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (old form)</I
>
O OldStyleHeaders=<code class="replaceable"><i>bool                 </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (beginning with V8.7)</I
>
-OOldStyleHeaders=<code class="replaceable"><i>bool                 </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.7)</I
>
define(`confOLD_STYLE_HEADERS',<code class="replaceable"><i>bool</I
></CODE
>)   <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The argument <code class="replaceable"><i>bool</I
></CODE
> is of type Boolean. If that
argument is missing, the default value is true, and unquoted spaces
in an address are converted to commas.
The default when configuring with the <em class="emphasis">m4</EM
> technique is true.
If the entire
<code class="literal">OldStyleHeaders</CODE
> (<code class="literal">o</CODE
>) option is missing,
it defaults to false, and unquoted spaces
are converted to the character defined by the <code class="literal">BlankSub</CODE
> (<code class="literal">B</CODE
>) option
(see <a class="xref" href="#SML2-CH-34-SECT-8-5" title="">Section 34.8.5</A
>).</P
><p class="para">The <em class="emphasis">sendmail</EM
> program is somewhat adaptive about commas.
When first examining a list of addresses, it looks to see whether
one of the following four characters appears in that list:</P
><p class="para"><blockquote class="screen"><pre class="screen">, ; &lt; (</PRE
></BLOCKQUOTE
></P
><p class="para">If it finds any of these characters in an address list, it turns off the
<code class="literal">OldStyleHeaders</CODE
> (<code class="literal">o</CODE
>) option for the remainder of the list. You always
want to enable this option in your configuration file. The only
exception might be the unusual situation in which all addresses are normally
comma-separated but some legal addresses contain spaces.</P
><p class="para">Note that comma delimiting allows spaces around recipient
names for clarity. That is, both of the following are equivalent:</P
><p class="para"><blockquote class="screen"><pre class="screen">hans,christian,andersen
hans, christian, andersen</PRE
></BLOCKQUOTE
></P
><p class="para">The <code class="literal">OldStyleHeaders</CODE
> (<code class="literal">o</CODE
>) option is safe.  Even if it is specified from the command line,
<em class="emphasis">sendmail</EM
> retains its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-45">34.8.45 OperatorChars or $o</A
></H3
><p class="refpurpose">Set token separation operators</P
>(V8.7 and above)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-45132"></A
><a class="indexterm" name="AUTOID-45135"></A
><a class="indexterm" name="AUTOID-45137"></A
><a class="indexterm" name="AUTOID-45139"></A
>The <code class="literal">OperatorChars</CODE
> option stores as its value a sequence
of characters, any one of which can be used to separate the components
of an address into tokens (see <a class="xref" href="ch08_03.htm" title="Rule Sets">Section 8.3, "Rule Sets"</A
>).
Prior to V8.7 the <em class="emphasis">$o</EM
> macro fulfilled this role.
Beginning with V8.7, the <code class="literal">OperatorChars</CODE
> option has taken over:</P
><p class="para"><blockquote class="screen"><pre class="screen">Do.:%@!^=/[]                          <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> prior to V8.7</I
>
O OperatorChars=.:%@!^=/[]            <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> beginning with V8.7</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The list of separation operators declared with this option is joined
by <em class="emphasis">sendmail</EM
> to an internal list of hard-coded separation operators:</P
><p class="para"><blockquote class="screen"><pre class="screen">()&lt;&gt;,;\&quot;\r\n</PRE
></BLOCKQUOTE
></P
><p class="para">The combined list is used in tokenizing the workspace for rule-set
processing. The order in which the characters appear in the <code class="literal">OperatorChars</CODE
> option declaration
is arbitrary. The space and tab characters need not be included in
that list because they are always used to separate tokens.</P
><p class="para">Care should be taken in eliminating any given character from this
list. Before doing so, the entire configuration file should be examined in detail
to be sure that no rule requires that character.
The use of the individual characters in addresses is beyond the scope
of this book. The book <em class="emphasis">!%@:: A Directory of Electronic Mail
Addressing and Networks</EM
>, by Donnalyn Frey and Rick Adams (O'Reilly &amp;
Associates, 1993), contains the many forms of addressing in great detail.</P
><p class="para">The <code class="literal">OperatorChars</CODE
> option is used like this:</P
><p class="para"><blockquote class="screen"><pre class="screen">O OperatorChars=<code class="replaceable"><i>text               </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> beginning with V8.7</I
>
define(`confOPERATORS',`<code class="replaceable"><i>text</I
></CODE
>')     <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 technique</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The <code class="replaceable"><i>text</I
></CODE
> is of type <code class="literal">string</CODE
>.
If it is missing and if 
the configuration file version is less than 7, <em class="emphasis">sendmail</EM
> tries to
use the value of the <code class="literal">$o</CODE
> macro. If that macro is also undefined,
a default of &quot;<code class="literal">.:@[]</CODE
>&quot; is used. If <code class="replaceable"><i>text</I
></CODE
> is longer
than 39 characters, it is truncated to 39 characters.
In using the V8 <em class="emphasis">m4</EM
> technique, a default of &quot;<code class="literal">.:%@!^/[]+</CODE
>&quot; is used.</P
><p class="para">The <code class="literal">OperatorChars</CODE
> option is not safe.
If specified from the command line,
it may cause <em class="emphasis">sendmail</EM
> to relinquish its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-46">34.8.46 PostmasterCopy (P)</A
></H3
><p class="refpurpose">Extra copies of postmaster mail</P
>(All versions)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-45187"></A
><a class="indexterm" name="AUTOID-45189"></A
>RFC822, entitled
<em class="emphasis">Standard for the Format of ARPA Internet Text Messages</EM
>,
requires that all sites be set up so that mail addressed to
the special name <em class="emphasis">Postmaster</EM
>
[23]
always be successfully delivered.
This requirement
ensures that notification of mail problems can always be sent
and successfully delivered to the offending site.
[24]
At most sites the name <em class="emphasis">Postmaster</EM
> is an alias to a real
person's name in the <em class="emphasis">aliases</EM
> file.
Mail to <em class="emphasis">Postmaster</EM
> should never be ignored.</P
><blockquote class="footnote"><p class="para">[23] The name <em class="emphasis">Postmaster</EM
> is case-insensitive. That is, <em class="emphasis">POSTMASTER</EM
>,
<em class="emphasis">Postmaster</EM
>, <em class="emphasis">postmaster</EM
>, and even <em class="emphasis">PoStMaStEr</EM
> are
all equivalent.</P
><p class="para">[24] Note that adoption of RFC1648, entitled
<em class="emphasis">Postmaster Convention for X.400 Operations</EM
>,
has extended this concept to include
hosts addressed as <em class="emphasis">user@host.domain</EM
> that
are really X.400 sites masquerading as Internet sites.</P
></BLOCKQUOTE
><p class="para">Ordinarily, notification of locally bounced mail
and other mail problems is sent back (bounced) to the sender of the message.
The local person in the role of <em class="emphasis">Postmaster</EM
> does not get
a copy of local failed mail.</P
><p class="para">The <code class="literal">PostmasterCopy</CODE
> (<code class="literal">P</CODE
>) option tells <em class="emphasis">sendmail</EM
> to send a copy of all failed
mail to another person, often <em class="emphasis">Postmaster</EM
>.
Under V8 and SunOS that copy contains only the failed message's
header. Under other versions of <em class="emphasis">sendmail</EM
> that copy includes
both the header and the body.</P
><p class="para">The forms of the <code class="literal">PostmasterCopy</CODE
> (<code class="literal">P</CODE
>) option are as follows:</P
><p class="para"><blockquote class="screen"><pre class="screen">OP<code class="replaceable"><i>user                              </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (old form)</I
>
-oP<code class="replaceable"><i>user                             </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (old form)</I
>
O PostmasterCopy=<code class="replaceable"><i>user               </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (beginning with V8.7)</I
>
-OPostmasterCopy=<code class="replaceable"><i>user               </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.7)</I
>
define(`confCOPY_ERRORS_TO',<code class="replaceable"><i>user</I
></CODE
>)   <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">&#13;The argument <code class="replaceable"><i>user</I
></CODE
> is of type string. 
If the argument is missing or if the <code class="literal">PostmasterCopy</CODE
> (<code class="literal">P</CODE
>) option is entirely
missing, no extra copy is sent.
The default for the <em class="emphasis">m4</EM
> configuration technique to not send an extra
copy.</P
><p class="para">While debugging a new <em class="emphasis">sendmail.cf</EM
> file, it is wise to
define the <code class="literal">PostmasterCopy</CODE
> (<code class="literal">P</CODE
>) option so that you receive a copy
of all failed mail. Once the configuration file is stable, either
the <code class="literal">PostmasterCopy</CODE
> (<code class="literal">P</CODE
>) option may be removed or the name may be replaced with an alias to a program. Such a program could filter the copies
of error mail so that only serious problems would be seen.</P
><p class="para">Macros used in the <code class="replaceable"><i>user</I
></CODE
> 
argument will be correctly expanded before use.
For example,</P
><p class="para"><blockquote class="screen"><pre class="screen">DHmailhost                                <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> old form</I
>
OPPostmaster@$H                           <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> old form</I
>

D{NOTIFYHOST}mailhost                     <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> beginning with V8.7</I
>
O PostmasterCopy=Postmaster@${NOTIFYHOST} <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> beginning with V8.7</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The <code class="literal">PostmasterCopy</CODE
> (<code class="literal">P</CODE
>) option is not safe.  If specified from the command line,
it may cause <em class="emphasis">sendmail</EM
> to relinquish its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-47">34.8.47 PrivacyOptions (p)</A
></H3
><p class="refpurpose">Increase privacy of the daemon</P
>(V8.1 and above)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-45262"></A
><a class="indexterm" name="AUTOID-45264"></A
><a class="indexterm" name="AUTOID-45267"></A
>The <code class="literal">PrivacyOptions</CODE
> (<code class="literal">p</CODE
>) option is used primarily
as a way to force other sites to adhere to SMTP
conventions, but can also be used to improve security.</P
><p class="para">The forms of the <code class="literal">PrivacyOptions</CODE
> (<code class="literal">p</CODE
>) option are as follows:</P
><p class="para"><blockquote class="screen"><pre class="screen">Op<code class="replaceable"><i>what,...                               </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (old mode)</I
>
-op<code class="replaceable"><i>what,...                              </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (old mode)</I
>
O PrivacyOptions=<code class="replaceable"><i>what,...                </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (beginning with V8.7)</I
>
-OPrivacyOptions=<code class="replaceable"><i>what,...                </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.7)</I
>
define(`confPRIVACY_FLAGS',`<code class="replaceable"><i>what,...</I
></CODE
>')   <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">Multiple <code class="replaceable"><i>what</I
></CODE
> arguments may be listed and must be separated
from one another by commas
(there may be arbitrary spaces around the commas), for example,</P
><p class="para"><blockquote class="screen"><pre class="screen">Op authwarnings, needmailhelo
O PrivacyOptions=authwarnings, needmailhelo</PRE
></BLOCKQUOTE
></P
><p class="para">If this option is entirely
omitted or if no <code class="replaceable"><i>what</I
></CODE
> arguments are listed, the option defaults
to <code class="literal">public</CODE
>.
The default for the <em class="emphasis">m4</EM
> configuration technique is <code class="literal">authwarnings</CODE
>.
The possible <code class="replaceable"><i>what</I
></CODE
> arguments are listed in
<a class="xref" href="#SML2-CH-34-TAB-16" title="PrivacyOptions Option Keywords">Table 34.17</A
>.</P
><table class="table"><caption class="table"><a class="title" name="SML2-CH-34-TAB-16">Table 34.17: PrivacyOptions Option Keywords</A
></CAPTION
><thead class="thead"><tr class="row" valign="TOP"><th class="entry" align="LEFT" rowspan="1" colspan="1">Keyword</TH
><th class="entry" align="LEFT" rowspan="1" colspan="1"></TH
><th class="entry" align="LEFT" rowspan="1" colspan="1">Meaning</TH
></TR
></THEAD
><tbody class="tbody"><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1">authwarnings</TD
><td class="entry" rowspan="1" colspan="1"><a class="xref" href="#SML2-CH-34-SECT-8-47-1" title="&quot;PrivacyOptions=authwarnings">Section 34.8.47.1, "&quot;PrivacyOptions=authwarnings"</A
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Enable <code class="literal">X-Authentication-Warning:</CODE
> headers</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1">goaway</TD
><td class="entry" rowspan="1" colspan="1"><a class="xref" href="#SML2-CH-34-SECT-8-47-2" title="&quot;PrivacyOptions=goaway">Section 34.8.47.2, "&quot;PrivacyOptions=goaway"</A
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Much checking for privacy and security</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1">needexpnhelo</TD
><td class="entry" rowspan="1" colspan="1"><a class="xref" href="#SML2-CH-34-SECT-8-47-3" title="PrivacyOptions=needexpnhelo">Section 34.8.47.3, "PrivacyOptions=needexpnhelo"</A
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Require HELO before EXPN</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1">needmailhelo</TD
><td class="entry" rowspan="1" colspan="1"><a class="xref" href="#SML2-CH-34-SECT-8-47-4" title="PrivacyOptions=needmailhelo">Section 34.8.47.4, "PrivacyOptions=needmailhelo"</A
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Require HELO before MAIL</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1">needvrfyhelo</TD
><td class="entry" rowspan="1" colspan="1"><a class="xref" href="#SML2-CH-34-SECT-8-47-5" title="PrivacyOptions=needvrfyhelo">Section 34.8.47.5, "PrivacyOptions=needvrfyhelo"</A
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Require HELO before VRFY</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1">noexpn</TD
><td class="entry" rowspan="1" colspan="1"><a class="xref" href="#SML2-CH-34-SECT-8-47-6" title="&quot;PrivacyOptions=noexpn">Section 34.8.47.6, "&quot;PrivacyOptions=noexpn"</A
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Disallow all SMTP EXPN commands</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1">noreceipts</TD
><td class="entry" rowspan="1" colspan="1"><a class="xref" href="#SML2-CH-34-SECT-8-47-7" title="&quot;PrivacyOptions=noreceipts">Section 34.8.47.7, "&quot;PrivacyOptions=noreceipts"</A
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Prevent return receipts</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1">novrfy</TD
><td class="entry" rowspan="1" colspan="1"><a class="xref" href="#SML2-CH-34-SECT-8-47-8" title="&quot;PrivacyOptions=novrfy">Section 34.8.47.8, "&quot;PrivacyOptions=novrfy"</A
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Disallow all SMTP VRFY commands</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1">public</TD
><td class="entry" rowspan="1" colspan="1"><a class="xref" href="#SML2-CH-34-SECT-8-47-9" title="PrivacyOptions=public">Section 34.8.47.9, "PrivacyOptions=public"</A
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">No extra checking for privacy or security</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1">restrictmailq</TD
><td class="entry" rowspan="1" colspan="1"><a class="xref" href="#SML2-CH-34-SECT-8-47-10" title="&quot;PrivacyOptions=restrictmailq">Section 34.8.47.10, "&quot;PrivacyOptions=restrictmailq"</A
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Restrict who may run <em class="emphasis">mailq</EM
>(1)</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1">restrictqrun</TD
><td class="entry" rowspan="1" colspan="1"><a class="xref" href="#SML2-CH-34-SECT-8-47-11" title="&quot;PrivacyOptions=restrictqrun">Section 34.8.47.11, "&quot;PrivacyOptions=restrictqrun"</A
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Restrict who processes the queue</P
></TD
></TR
></TBODY
></TABLE
><p class="para">If <code class="replaceable"><i>what</I
></CODE
> is not one of the keywords listed in the table,
<em class="emphasis">sendmail</EM
> prints the following message and 
ignores the unknown word:</P
><p class="para"><blockquote class="screen"><pre class="screen">readcf: Op line: <i class="lineannotation">unknown_word</I
> unrecognized</PRE
></BLOCKQUOTE
></P
><p class="para">Note that <em class="emphasis">sendmail</EM
> checks for nonroot use of the <code class="literal">-C</CODE
> 
(see <a class="xref" href="ch36_07.htm" title="">Section 36.7.15, -C</A
>) and
<code class="literal">-oQ</CODE
> (see <a class="xref" href="#SML2-CH-34-SECT-8-48" title="">Section 34.8.48</A
>) command line switches and
dangerous uses of the <code class="literal">-f</CODE
> (see <a class="xref" href="ch36_07.htm" title="">Section 36.7.21, -f and -r</A
>) command line switch
when the command line is read but does not issue warnings
until after the configuration file is read. That way, the
configuration file determines how <code class="literal">X-Authentication-Warning:</CODE
>
headers will be issued.</P
><p class="para">The <code class="literal">PrivacyOptions</CODE
> (<code class="literal">p</CODE
>) option is safe.  If specified from the command line,
it does not cause <em class="emphasis">sendmail</EM
> to relinquish its <em class="emphasis">root</EM
> privilege.
Because it is really a mask, specifications in the configuration
file or on the command line can only make it more restrictive.&#13;</P
><div class="refsect2"><h4 class="refsect2"><a class="title" name="SML2-CH-34-SECT-8-47-1">34.8.47.1 &quot;PrivacyOptions=authwarnings</A
></H4
><p class="para">Setting <code class="literal">authwarnings</CODE
> causes <em class="emphasis">sendmail</EM
> to insert special
headers into the mail message that advise the recipient of
reasons to suspect that the message may not be authentic.
The general form of this special header is shown at the end of
this paragraph. The possible reasons are listed 
in <a class="xref" href="ch35_01.htm" title="Headers">Chapter 35, <cite class="chapter">Headers</CITE
></A
>
(see <a class="xref" href="ch35_10.htm" title="">Section 35.10.35, X-Authentication-Warning:</A
>). </P
><p class="para"><blockquote class="screen"><pre class="screen">X-Authentication-Warning: <code class="replaceable"><i>ourhost</I
></CODE
>: <code class="replaceable"><i>reason</I
></CODE
></PRE
></BLOCKQUOTE
></P
><p class="para"></P
></DIV
><div class="refsect2"><h4 class="refsect2"><a class="title" name="SML2-CH-34-SECT-8-47-2">34.8.47.2 &quot;PrivacyOptions=goaway</A
></H4
><p class="para">A shorthand way to set all of <code class="literal">authwarnings</CODE
>, <code class="literal">noexpn</CODE
>,
<code class="literal">novrfy</CODE
>, <code class="literal">needmailhelo</CODE
>, <code class="literal">needexpnhelo</CODE
>, and
<code class="literal">needvrfyhelo</CODE
>.&#13;</P
></DIV
><div class="refsect2"><h4 class="refsect2"><a class="title" name="SML2-CH-34-SECT-8-47-3">34.8.47.3 PrivacyOptions=needexpnhelo</A
></H4
><p class="para">The SMTP EXPN command causes <em class="emphasis">sendmail</EM
> to &quot;expand&quot;
a local address and print the result.
If the address is an alias, it shows all
the addresses that result from the alias expansion. If the address
is local, it shows the result of aliasing through a user's <em class="emphasis">~/.forward</EM
>
file. If <code class="literal">needexpnhelo</CODE
> is specified, <em class="emphasis">sendmail</EM
> requires that
the requesting site first introduce itself with an SMTP HELO or ELHO
command. If the requesting site has not done so, <em class="emphasis">sendmail</EM
>
responds with the following message 
rather than providing the requested expansion information:</P
><p class="para"><blockquote class="screen"><pre class="screen">503 I demand that you introduce yourself first</PRE
></BLOCKQUOTE
></P
><p class="para"></P
></DIV
><div class="refsect2"><h4 class="refsect2"><a class="title" name="SML2-CH-34-SECT-8-47-4">34.8.47.4 PrivacyOptions=needmailhelo</A
></H4
><p class="para">The SMTP protocol specifies that the sending site
should issue the HELO or ELHO command to identify
itself before specifying the name of the sender with
the MAIL command. By listing <code class="literal">needmailhelo</CODE
> with
the <code class="literal">PrivacyOptions</CODE
> (<code class="literal">p</CODE
>) option, you cause the following
error to be returned to the sending site in this
situation:</P
><p class="para"><blockquote class="screen"><pre class="screen">503 Polite people say HELO first</PRE
></BLOCKQUOTE
></P
><p class="para">If <code class="literal">needmailhelo</CODE
> is not specified but <code class="literal">authwarnings</CODE
> is specified,
then the following header is added to the message
describing the problem:</P
><p class="para"><blockquote class="screen"><pre class="screen">X-Authentication-Warning: <em class="emphasis">ourself</EM
>: Host <em class="emphasis">they</EM
> didn't use HELO protocol</PRE
></BLOCKQUOTE
></P
><p class="para"></P
></DIV
><div class="refsect2"><h4 class="refsect2"><a class="title" name="SML2-CH-34-SECT-8-47-5">34.8.47.5 PrivacyOptions=needvrfyhelo</A
></H4
><p class="para">The SMTP VRFY command causes <em class="emphasis">sendmail</EM
> to verify that an
address is that of a local user or local alias. Unlike EXPN
above, VRFY does not cause mailing list contents,
the result of aliasing, or the contents of <em class="emphasis">~/.forward</EM
>
files to be displayed.
If <code class="literal">needvrfyhelo</CODE
> is specified, <em class="emphasis">sendmail</EM
> requires that
the requesting site first introduce itself with an SMTP HELO 
or ELHO command. If the requesting site has not done so, <em class="emphasis">sendmail</EM
>
responds with the same message as for <code class="literal">needexpnhelo</CODE
>
above, rather than providing the requested verification information.&#13;</P
></DIV
><div class="refsect2"><h4 class="refsect2"><a class="title" name="SML2-CH-34-SECT-8-47-6">34.8.47.6 &quot;PrivacyOptions=noexpn</A
></H4
><p class="para">Setting <code class="literal">noexpn</CODE
> causes <em class="emphasis">sendmail</EM
> to disallow all SMTP
EXPN commands. In place of information, <em class="emphasis">sendmail</EM
> sends
the following reply to the requesting host:</P
><p class="para"><blockquote class="screen"><pre class="screen">502 That's none of your business            <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> prior to V8.7</I
>
502 Sorry, we do not allow this operation   <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> beginning with V8.7</I
></PRE
></BLOCKQUOTE
></P
><p class="para">Setting <code class="literal">noexpn</CODE
> also causes <em class="emphasis">sendmail</EM
> to reject all SMTP
VERB commands:</P
><p class="para"><blockquote class="screen"><pre class="screen">502 Verbose unavailable</PRE
></BLOCKQUOTE
></P
><p class="para">&#13;Other <em class="emphasis">sendmail</EM
> programs may send VERB if the delivery
agent making the connection has the <code class="literal">F=I</CODE
> flag set 
(see <a class="xref" href="ch30_08.htm" title="">Section 30.8.25, F=I (uppercase i)</A
>).&#13;</P
></DIV
><div class="refsect2"><h4 class="refsect2"><a class="title" name="SML2-CH-34-SECT-8-47-7">34.8.47.7 &quot;PrivacyOptions=noreceipts</A
></H4
><p class="para">Setting <code class="literal">noreceipts</CODE
> causes pre-V8.7 <em class="emphasis">sendmail</EM
> to silently skip
the processing of all <code class="literal">Return-Receipt-To:</CODE
> headers (see
<a class="xref" href="ch35_10.htm" title="">Section 35.10.29, Return-Receipt-To:</A
>).
Beginning with V8.7 <em class="emphasis">sendmail</EM
>, notification of successful delivery
is governed by the NOTIFY keyword (see RFC1891)
to the ESMTP RCPT command:</P
><p class="para"><blockquote class="screen"><pre class="screen">RCPT TO: &lt;<code class="replaceable"><i>address</I
></CODE
>&gt; NOTIFY=SUCCESS</PRE
></BLOCKQUOTE
></P
><p class="para">Setting <code class="literal">noreceipts</CODE
> causes V8.7 <em class="emphasis">sendmail</EM
> to silently skip all 
such requests for notification of successful delivery.&#13;</P
></DIV
><div class="refsect2"><h4 class="refsect2"><a class="title" name="SML2-CH-34-SECT-8-47-8">34.8.47.8 &quot;PrivacyOptions=novrfy</A
></H4
><p class="para">Setting <code class="literal">novrfy</CODE
> causes <em class="emphasis">sendmail</EM
> to disallow all SMTP VRFY
commands. In place of verification, <em class="emphasis">sendmail</EM
> sends the following
reply to the requesting host:</P
><p class="para"><blockquote class="screen"><pre class="screen">252 Who's to say?                                                  <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8.6</I
>
252 Cannot VRFY user; try RCPT to attempt delivery (or try finger) <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8.7</I
></PRE
></BLOCKQUOTE
></P
><p class="para"></P
></DIV
><div class="refsect2"><h4 class="refsect2"><a class="title" name="SML2-CH-34-SECT-8-47-9">34.8.47.9 PrivacyOptions=public</A
></H4
><p class="para">The default for the non-m4 version of the
<code class="literal">PrivacyOptions</CODE
> (<code class="literal">p</CODE
>) option is <code class="literal">public</CODE
>.
This means that there is no extra checking for valid
SMTP syntax and no checking for the security matters.&#13;</P
></DIV
><div class="refsect2"><h4 class="refsect2"><a class="title" name="SML2-CH-34-SECT-8-47-10">34.8.47.10 &quot;PrivacyOptions=restrictmailq</A
></H4
><p class="para">Ordinarily, anyone may examine the mail queue's contents by using
the <em class="emphasis">mailq</EM
>(1) command (see <a class="xref" href="ch23_04.htm" title="Printing the Queue">Section 23.4, "Printing the Queue"</A
>). To restrict who may examine the
queue's contents, specify <code class="literal">restrictmailq</CODE
>. If restricted,
<em class="emphasis">sendmail</EM
> allows only users who are in the same group
as the group ownership of the queue directory to examine the
contents. This allows the queue directory to be fully protected
with mode 0700 yet for selected users to still be able
to see its contents.&#13;</P
></DIV
><div class="refsect2"><h4 class="refsect2"><a class="title" name="SML2-CH-34-SECT-8-47-11">34.8.47.11 &quot;PrivacyOptions=restrictqrun</A
></H4
><p class="para">Ordinarily, anyone may process the queue with the <code class="literal">-q</CODE
>
switch (see <a class="xref" href="ch23_06.htm#SML2-CH-23-SECT-6-1" title="Periodically with -q">Section 23.6.1</A
>).
To limit queue processing to <em class="emphasis">root</EM
> and the owner of the queue directory,
specify <code class="literal">restrictqrun</CODE
>.
If queue processing is restricted, any nonprivileged user who attempts
to process the queue will get this message:</P
><p class="para"><blockquote class="screen"><pre class="screen">You do not have permission to process the queue</PRE
></BLOCKQUOTE
></P
></DIV
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-48">34.8.48 QueueDirectory (Q)</A
></H3
><p class="refpurpose">Location of queue directory</P
>(All versions)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-45527"></A
><a class="indexterm" name="AUTOID-45529"></A
>Mail messages that have not yet been delivered
are stored in the <em class="emphasis">sendmail</EM
> program's queue directory.
The location of that directory is defined by the 
<code class="literal">QueueDirectory</CODE
> (<code class="literal">Q</CODE
>) option.
That location may be a relative pathname (for testing) or an absolute
pathname. If the specified location does not exist, <em class="emphasis">sendmail</EM
>
prints something like the following:</P
><p class="para"><blockquote class="screen"><pre class="screen">cannot chdir(/var/spool/mqueue): No such file or directory</PRE
></BLOCKQUOTE
></P
><p class="para">If the location exists but is not a directory, sendmail
prints something like the following:</P
><p class="para"><blockquote class="screen"><pre class="screen">cannot chdir(/var/spool/mqueue): Not a directory</PRE
></BLOCKQUOTE
></P
><p class="para">In both cases, <em class="emphasis">sendmail</EM
> also logs an error message via
<em class="emphasis">syslog</EM
>(8) if the logging level of the 
<code class="literal">LogLevel</CODE
> (<code class="literal">L</CODE
>) option (see <a class="xref" href="#SML2-CH-34-SECT-8-33" title="">Section 34.8.33</A
>) permits.
In both cases, <em class="emphasis">sendmail</EM
> aborts immediately.</P
><p class="para">The forms of the <code class="literal">QueueDirectory</CODE
> (<code class="literal">Q</CODE
>) option are as follows:</P
><p class="para"><blockquote class="screen"><pre class="screen">OQ<code class="replaceable"><i>path                       </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (old form)</I
>
-oQ<code class="replaceable"><i>path                      </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (old form)</I
>
O QueueDirectory=<code class="replaceable"><i>path        </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (beginning with V8.7)</I
>
-OQueueDirectory=<code class="replaceable"><i>path        </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.7)</I
>
define(`QUEUE_DIR',`<code class="replaceable"><i>path</I
></CODE
>')   <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The <code class="replaceable"><i>path</I
></CODE
> argument is of type string. If it is missing, the
value for <code class="replaceable"><i>path</I
></CODE
> defaults to &quot;mqueue&quot;. 
Relative names for the queue are always relative to the directory
in which <em class="emphasis">sendmail</EM
> was invoked. If the entire <code class="literal">QueueDirectory</CODE
> (<code class="literal">Q</CODE
>)
option is missing, the value for <code class="replaceable"><i>path</I
></CODE
> defaults to the C language
value of NULL, and <em class="emphasis">sendmail</EM
> complains with</P
><p class="para"><blockquote class="screen"><pre class="screen">cannot chdir((null)): Bad file number</PRE
></BLOCKQUOTE
></P
><p class="para">The default in configuring with the <em class="emphasis">m4</EM
> technique varies depending
on your operating system.</P
><p class="para">The <code class="literal">QueueDirectory</CODE
> (<code class="literal">Q</CODE
>) option is not safe.  If specified from the command line,
it may cause <em class="emphasis">sendmail</EM
> to relinquish its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-49">34.8.49 QueueFactor (q)</A
></H3
><p class="refpurpose">Factor for high-load queuing</P
>(All versions)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-45587"></A
><a class="indexterm" name="AUTOID-45590"></A
>When the load average on a machine (the average number of 
processes in the run queue over the last minute)
becomes too high, <em class="emphasis">sendmail</EM
> can compensate
by queuing all mail, rather than delivering it.
The <code class="literal">QueueFactor</CODE
> (<code class="literal">q</CODE
>) option
is used in combination with the <code class="literal">QueueLA</CODE
> (<code class="literal">x</CODE
>) option 
(see <a class="xref" href="#SML2-CH-34-SECT-8-50" title="">Section 34.8.50</A
>)
to calculate the point at which <em class="emphasis">sendmail</EM
> stops delivering.
If the current load average is greater than or equal to the value
given to the <code class="literal">QueueLA</CODE
> (<code class="literal">x</CODE
>) option,
then the following formula is evaluated:</P
><p class="para"><blockquote class="screen"><pre class="screen">msgpri &gt; q / (la - x + 1)</PRE
></BLOCKQUOTE
></P
><p class="para">Here, <code class="literal">q</CODE
> is the value set by this option, <code class="literal">la</CODE
> is
the current load average, and <code class="literal">x</CODE
> is the cutoff load
specified by the <code class="literal">QueueLA</CODE
> (<code class="literal">x</CODE
>) option. If the value yielded by this
calculation is less than or equal to the priority of the current
mail message (<code class="literal">msgpri</CODE
> above), the message
is queued rather than delivered. Priorities are initialized with
the <code class="literal">P</CODE
> <em class="emphasis">sendmail.cf</EM
> command (see <a class="xref" href="ch35_08.htm#SML2-CH-35-SECT-8-1" title="Precedence">Section 35.8, "Precedence"</A
>)
and tuned with the
<code class="literal">RecipientFactor</CODE
> (<code class="literal">y</CODE
>) and 
<code class="literal">ClassFactor</CODE
> (<code class="literal">z</CODE
>) options (see <a class="xref" href="#SML2-CH-34-SECT-8-53" title="">Section 34.8.53</A
>).
As the load average (<code class="literal">la</CODE
>) grows, the value to the right
of the <code class="literal">&gt;</CODE
> becomes smaller, increasing the chance that 
<code class="literal">msgpri</CODE
> will exceed that threshold (so that the
mail will be queued).
Beginning with V8.7 <em class="emphasis">sendmail</EM
>, this relation can be tuned with the
help of the <code class="literal">-d3.30</CODE
> debugging switch (see <a class="xref" href="ch37_05.htm" title="">Section 37.5.18, -d3.30</A
>).</P
><p class="para">The forms of <code class="literal">QueueFactor</CODE
> (<code class="literal">q</CODE
>) option are as follows:</P
><p class="para"><blockquote class="screen"><pre class="screen">Oq<code class="replaceable"><i>fact                            </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (old form)</I
>
-oq<code class="replaceable"><i>fact                           </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (old form)</I
>
O QueueFactor=<code class="replaceable"><i>fact                </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (beginning with V8.7)</I
>
-OQueueFactor=<code class="replaceable"><i>fact                </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.7)</I
>
define(`confQUEUE_FACTOR',<code class="replaceable"><i>fact</I
></CODE
>)   <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The argument <code class="replaceable"><i>fact</I
></CODE
> is of type numeric.
It may be positive, negative, or zero. If <code class="replaceable"><i>fact</I
></CODE
>
is missing, the value defaults to zero. If the entire 
<code class="literal">QueueFactor</CODE
> (<code class="literal">q</CODE
>) option is missing,
the default value given to <code class="replaceable"><i>fact</I
></CODE
> is 
600000 (six hundred thousand). 
The default for the <em class="emphasis">m4</EM
> technique is to omit this option.</P
><p class="para">Note that the load average is effective only if your <em class="emphasis">sendmail</EM
>
binary was compiled with load-average support
(see <a class="xref" href="ch18_08.htm" title="">Section 18.8.14, LA-TYPE</A
>). Use the <code class="literal">-d3.1</CODE
>
debugging switch (<a class="xref" href="ch37_05.htm" title="">Section 37.5.14, -d3.1</A
>) to discover whether your binary 
includes that support.</P
><p class="para">The <code class="literal">QueueFactor</CODE
> (<code class="literal">q</CODE
>) option is not safe.  If specified from the command line,
it may cause <em class="emphasis">sendmail</EM
> to relinquish its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-50">34.8.50 QueueLA (x)</A
></H3
><p class="refpurpose">On high load, queue only</P
>(All versions)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-45664"></A
>The <code class="literal">QueueLA</CODE
> (<code class="literal">x</CODE
>) option specifies the load above which <em class="emphasis">sendmail</EM
>
queues messages rather than delivering them. The <code class="literal">QueueLA</CODE
> (<code class="literal">x</CODE
>) and
<code class="literal">QueueFactor</CODE
> (<code class="literal">q</CODE
>) options interact to determine this cutoff; they are both
covered under the <code class="literal">QueueFactor</CODE
> (<code class="literal">q</CODE
>) option (<a class="xref" href="#SML2-CH-34-SECT-8-49" title="">Section 34.8.49</A
>).</P
><p class="para">The forms of the <code class="literal">QueueLA</CODE
> (<code class="literal">x</CODE
>) option are as follows:</P
><p class="para"><blockquote class="screen"><pre class="screen">Ox<code class="replaceable"><i>load                        </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (old form)</I
>
-ox<code class="replaceable"><i>load                       </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (old form)</I
>
O QueueLA=<code class="replaceable"><i>load                </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (beginning with V8.7)</I
>
-OQueueLA=<code class="replaceable"><i>load                </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.7)</I
>
define(`confQUEUE_LA',<code class="replaceable"><i>load</I
></CODE
>)   <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The optional argument <code class="replaceable"><i>load</I
></CODE
>, of type numeric, defaults to
zero if it is missing. If the entire <code class="literal">QueueLA</CODE
> (<code class="literal">x</CODE
>) option is missing,
the default value given to <code class="replaceable"><i>load</I
></CODE
> is eight.
The default for the <em class="emphasis">m4</EM
> technique is to omit this option.
On newer, faster machines a higher setting may be more appropriate.</P
><p class="para">This <code class="literal">QueueLA</CODE
> (<code class="literal">x</CODE
>) option is effective only if your <em class="emphasis">sendmail</EM
>
binary was compiled with load-average support
(see <a class="xref" href="ch18_08.htm" title="">Section 18.8.14</A
>). You can use the <code class="literal">-d3.1</CODE
>
debugging switch (<a class="xref" href="ch37_05.htm" title="">Section 37.5.14</A
>) to discover whether your binary
includes the necessary support.</P
><p class="para">The <code class="literal">QueueLA</CODE
> (<code class="literal">x</CODE
>) option is not safe.  If specified from the command line,
it may cause <em class="emphasis">sendmail</EM
> to relinquish its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-51">34.8.51 QueueSortOrder</A
></H3
><p class="refpurpose">How to pre-sort the queue</P
>(V8.7 and above)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-45717"></A
><a class="indexterm" name="AUTOID-45719"></A
><a class="indexterm" name="AUTOID-45722"></A
>Prior to V8.7 <em class="emphasis">sendmail</EM
>, mail messages in the queue were
sorted by priority when the queue was processed.
Under V8.7 an enhanced sort can be implemented with the
<code class="literal">QueueSortOrder</CODE
> option:</P
><p class="para"><blockquote class="screen"><pre class="screen">O QueueSortOrder=<code class="replaceable"><i>how                  </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (beginning with V8.7)</I
>
-OQueueSortOrder=<code class="replaceable"><i>how                  </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.7)</I
>
define(`confQUEUE_SORT_ORDER',<code class="replaceable"><i>how</I
></CODE
>)    <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The argument <code class="replaceable"><i>how</I
></CODE
> is of type character.
[25]
It can be 
a <code class="literal">P</CODE
> or <code class="literal">p</CODE
> (for priority), which causes <em class="emphasis">sendmail</EM
>
to emulate its old (sort by priority) behavior. 
It can be an <code class="literal">H</CODE
> or <code class="literal">h</CODE
> (for host), which causes <em class="emphasis">sendmail</EM
>
to perform a new enhanced sort. 
Beginning with V8.8 <em class="emphasis">sendmail</EM
>, it can be <code class="literal">T</CODE
> or <code class="literal">t</CODE
>
(for time), which sorts by submission time.
If any other character is specified or
if <code class="replaceable"><i>how</I
></CODE
> is omitted, the following message is printed and the
option is skipped:</P
><blockquote class="footnote"><p class="para">[25] Of course, we recommend using full words for clarity.</P
></BLOCKQUOTE
><p class="para"><blockquote class="screen"><pre class="screen">Invalid queue sort order &quot;<em class="emphasis">badchar</EM
>&quot;</PRE
></BLOCKQUOTE
></P
><p class="para">If this option is entirely omitted, the default is to sort by <code class="literal">priority</CODE
>.
The default in configuring with the V8 <em class="emphasis">m4</EM
> technique is also <code class="literal">priority</CODE
>.</P
><p class="para">The <code class="literal">QueueSortOrder</CODE
> option is safe. If specified from the command line,
<em class="emphasis">sendmail</EM
> will not relinquish its <em class="emphasis">root</EM
> privilege.&#13;</P
></DIV
><div class="refsect1"><h4 class="refsect1"><a class="title" name="SML2-CH-34-SECT-8-51-1">34.8.51.1 </A
>QueueSortOrder=host</H4
><p class="para">If <code class="replaceable"><i>what</I
></CODE
> is <code class="literal">host</CODE
>, the messages in the queue are first
sorted by recipient host, lock status, and priority. If any message for
a host is locked (currently
being delivered) all the messages for that host are also marked as locked.
Then the queue is sorted again, this time by
lock status (unlocked first), recipient host, and priority.
Delivery attempts after this sort tend to group SMTP connections
to the same host together sequentially.</P
><p class="para">Be careful in sorting by host. If you have a large backlog of
low-priority (batch) mail on a low-speed link to some host
(for example <em class="emphasis">news</EM
>),
you might end up delaying higher-priority mail intended for other hosts.
The host sort is recommended for high-speed links
but is less desirable on low-speed links.&#13;</P
></DIV
><div class="refsect1"><h4 class="refsect1"><a class="title" name="SML2-CH-34-SECT-8-51-2">34.8.51.2 </A
>QueueSortOrder=priority</H4
><p class="para">The method to order a queue run that has been used by <em class="emphasis">sendmail</EM
>
for many years is a simple sort of the message priorities.
A message's priority is found in the <code class="literal">qf</CODE
> file's <code class="literal">P</CODE
>
line (see <a class="xref" href="ch23_09.htm" title="">Section 23.9.11, P line</A
>). The sort is one of cost. That is,
low (less positive) priorities are sorted ahead of high (more positive)
values.&#13;</P
></DIV
><div class="refsect1"><h4 class="refsect1"><a class="title" name="SML2-CH-34-SECT-8-51-3">34.8.51.3 </A
>QueueSortOrder=time (V8.8 and above)</H4
><p class="para">Beginning with V8.8, <em class="emphasis">sendmail</EM
> recognizes the <code class="literal">time</CODE
>
keyword, which causes it to sort based on submission time.
This setting is not intended for use in the configuration file.
Instead, it should be used only from the command line and
in combination with the <code class="literal">-qR</CODE
> command-line switch
(see <a class="xref" href="ch23_06.htm#SML2-CH-23-SECT-6-1" title="Process by identifier/recipient/sender: -q[ISR]">Section 23.6.2.3, "Process by identifier/recipient/sender: -q[ISR]"</A
>).</P
><p class="para">If you wrongly set <code class="literal">time</CODE
> in the configuration file, large jobs
and old jobs will be sorted in with small and new jobs.
This can delay important mail. Also note that there
is no guarantee that mail will be delivered in submission
order unless the <code class="literal">DeliveryMode</CODE
> option
(see <a class="xref" href="#SML2-CH-34-SECT-8-16" title="">Section 34.8.16</A
>) is set to <code class="literal">queue</CODE
> or
<code class="literal">defer</CODE
>.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-52">34.8.52 QueueTimeout (T)</A
></H3
><p class="refpurpose">Limit life of a message in the queue</P
>(deprecated</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-45794"></A
><a class="indexterm" name="AUTOID-45796"></A
><a class="indexterm" name="AUTOID-45799"></A
>When mail cannot be delivered promptly, it
is left in the queue. At intervals specified by
<em class="emphasis">sendmail</EM
>'s <code class="literal">-q</CODE
> command-line switch, redelivery
of that queued mail is attempted. The maximum time
a mail message can remain in the queue before being bounced
as undeliverable is defined by the <code class="literal">T</CODE
> option.
(Note that the <code class="literal">QueueTimeout</CODE
> (<code class="literal">T</CODE
>)
option has been deprecated in favor of the
<code class="literal">Timeout</CODE
> option of V8.7 <em class="emphasis">sendmail</EM
>.)</P
><p class="para">The forms of the <code class="literal">QueueTimeout</CODE
> (<code class="literal">T</CODE
>) option are as follows:</P
><p class="para"><blockquote class="screen"><pre class="screen">OT<code class="replaceable"><i>qtime                               </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (old form)</I
>
-oT<code class="replaceable"><i>qtime                              </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (old form)</I
>
O QueueTimeout=<code class="replaceable"><i>qtime                  </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (deprecated)</I
>
define(`confMESSAGE_TIMEOUT',<code class="replaceable"><i>qtime</I
></CODE
>)   <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The argument <code class="replaceable"><i>qtime</I
></CODE
> is of type time. If this argument
is missing or if the entire <code class="literal">QueueTimeout</CODE
> (<code class="literal">T</CODE
>) option is missing, the value
given to <code class="replaceable"><i>qtime</I
></CODE
> is zero, and no
mail is ever queued.
[26]
The <code class="replaceable"><i>qtime</I
></CODE
> is generally specified as
a number of days, <code class="literal">5d</CODE
> for example. (Incidentally, RFC1123
recommends five days as a minimum.)</P
><blockquote class="footnote"><p class="para">[26] That is, each message is instantly bounced if it cannot be delivered on the first try.</P
></BLOCKQUOTE
><p class="para">All queued mail is timed out on the basis of its creation time compared to
the timeout period specified by the <code class="literal">QueueTimeout</CODE
> (<code class="literal">T</CODE
>) option.
Each queued message has its creation time stored in its <code class="literal">qf</CODE
>
file's <code class="literal">T</CODE
> line (see <a class="xref" href="ch23_09.htm" title="">Section 23.9.15, T line</A
>).
When <em class="emphasis">sendmail</EM
> is run (either as a daemon or by hand)
to process the queue, it gets its timeout period from the value
of the <code class="literal">QueueTimeout</CODE
> (<code class="literal">T</CODE
>) option. As the queue is processed, each message's
creation time is checked to see whether it has timed out on the basis of
the <em class="emphasis">current</EM
> value of the <code class="literal">QueueTimeout</CODE
> (<code class="literal">T</CODE
>) option.
Since the
configuration file is read only once (when <em class="emphasis">sendmail</EM
> first
starts), the timeout period cannot be subsequently changed. There
are only two ways to lengthen the timeout period:
first, by modifying the configuration file's <code class="literal">QueueTimeout</CODE
> (<code class="literal">T</CODE
>) option
(which prior to V8 could involve creating a freeze file) and killing
and restarting <em class="emphasis">sendmail</EM
>; second, by running <em class="emphasis">sendmail</EM
> by hand with
the <code class="literal">-q</CODE
> command-line switch (see <a class="xref" href="ch23_06.htm#SML2-CH-23-SECT-6-1" title="Periodically with -q">Section 23.6.1</A
>) and setting a new timeout
using the <code class="literal">-oT</CODE
><code class="replaceable"><i>timeout</I
></CODE
> command-line switch.</P
><p class="para">Since the creation
time is stored in a queued file's <code class="literal">qf</CODE
> file, messages can theoretically
be rejuvenated (made to appear young again) by simply modifying that entry.
The details of the <code class="literal">qf</CODE
> queue file are presented in <a class="xref" href="ch23_09.htm" title="The qf File Internals">Section 23.9, "The qf File Internals"</A
>.</P
><p class="para">Under V8 <em class="emphasis">sendmail</EM
> the sender can be notified when a message is
delayed.
This feature is enabled by the inclusion of
a second argument following the <code class="replaceable"><i>qtime</I
></CODE
> argument in the
<code class="literal">QueueTimeout</CODE
> (<code class="literal">T</CODE
>) option declaration:</P
><p class="para"><blockquote class="screen"><pre class="screen">OT<code class="replaceable"><i>qtime</I
></CODE
>/<code class="replaceable"><i>notify                     </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (V8.6)</I
>
-oT<code class="replaceable"><i>qtime</I
></CODE
>/<code class="replaceable"><i>notify                    </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (V8.6)</I
>
O QueueTimeout=<code class="replaceable"><i>qtime</I
></CODE
>/<code class="replaceable"><i>notify        </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (V8.7; deprecated)</I
></PRE
></BLOCKQUOTE
></P
><p class="para">If the second argument is present, it must be separated from the
first by a <code class="literal">/</CODE
>. The <code class="literal">notify</CODE
> specifies the amount of time
<em class="emphasis">sendmail</EM
> should wait, after the message is first queued,
before sending notification to the sender that it was delayed.
If <code class="replaceable"><i>notify</I
></CODE
> is missing or longer than <code class="replaceable"><i>qtime</I
></CODE
>,
no warning messages are sent.
If <code class="replaceable"><i>notify</I
></CODE
> is longer than <code class="replaceable"><i>qtime</I
></CODE
>,
no notification is ever sent.</P
><p class="para">Note that this is a crude method compared to the one described under
the <code class="literal">Timeout</CODE
> option in <a class="xref" href="#SML2-CH-34-SECT-8-70" title="">Section 34.8.70</A
>. Beginning with V8.7
<em class="emphasis">sendmail</EM
> and using the
<code class="literal">queuereturn</CODE
> and <code class="literal">queuewarn</CODE
> keywords of that 

option, the <code class="replaceable"><i>qtime</I
></CODE
> and <code class="literal">notify</CODE
> values above can be tuned
on the basis of individual mail message priorities.</P
><p class="para">The <code class="literal">QueueTimeout</CODE
> (<code class="literal">T</CODE
>) option is not safe.  If specified from the command line,
it may cause <em class="emphasis">sendmail</EM
> to relinquish its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-53">34.8.53 RecipientFactor (y)</A
></H3
><p class="refpurpose">Penalize large recipient lists</P
>(All versions)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-45901"></A
><a class="indexterm" name="AUTOID-45903"></A
>Not all messages need to be treated equally.
When sendmail processes the messages in its queue,
it sorts them by priority.
[27]
The priority that is given to a message is calculated once, when it is first
created, and adjusted (incremented or decremented) each time it
is processed in the queue.
Mail with the <em class="emphasis">lowest</EM
> priority number is handled first.
The formula for the initial calculation
is</P
><blockquote class="footnote"><p class="para">[27] See the <code class="literal">QueueSortOrder</CODE
> option, <a class="xref" href="#SML2-CH-34-SECT-8-51" title="">Section 34.8.51</A
>,
for alternative ways to sort.</P
></BLOCKQUOTE
><p class="para"><blockquote class="screen"><pre class="screen">priority = nbytes - (class * z) + (recipients * y)</PRE
></BLOCKQUOTE
></P
><p class="para">The items in this calculation are as follows:&#13;</P
><dl class="variablelist"><dt class="term"><code class="literal">priority</CODE
></DT
><dd class="listitem"><p class="para">Priority of the message when it was first created.&#13;</P
></DD
><dt class="term"><code class="literal">nbytes</CODE
></DT
><dd class="listitem"><p class="para">Number of bytes in the total message, including the
header and body of the message.&#13;</P
></DD
><dt class="term"><code class="literal">class</CODE
></DT
><dd class="listitem"><p class="para">Value given to a message by the <code class="literal">Precedence:</CODE
> line
in the header of the message.
The string following the <code class="literal">Precedence:</CODE
> is usually either
<code class="literal">first-class</CODE
>, <code class="literal">special-delivery</CODE
>, <code class="literal">junk</CODE
>, <code class="literal">bulk</CODE
>,
or <code class="literal">list</CODE
>.
That string
is converted to a numeric value determined by the <code class="literal">P</CODE
> command 
(see <a class="xref" href="ch35_08.htm#SML2-CH-35-SECT-8-1" title="Precedence">Section 35.8</A
>) in the <em class="emphasis">sendmail.cf</EM
> file.&#13;</P
></DD
><dt class="term"><code class="literal">z</CODE
></DT
><dd class="listitem"><p class="para">Value given the <code class="literal">ClassFactor</CODE
> (<code class="literal">z</CODE
>) option (see <a class="xref" href="#SML2-CH-34-SECT-8-8" title="">Section 34.8.8</A
>)
and a weighting factor to adjust the
relative importance of the <code class="literal">class</CODE
>.&#13;</P
></DD
><dt class="term"><code class="literal">recipients</CODE
></DT
><dd class="listitem"><p class="para">Number of recipients to whom the message is addressed. This
number is counted <em class="emphasis">after</EM
> all alias expansion.&#13;</P
></DD
><dt class="term"><code class="literal">y</CODE
></DT
><dd class="listitem"><p class="para">Value given this <code class="literal">RecipientFactor</CODE
> (<code class="literal">y</CODE
>) option and weighting factor to adjust the relative
importance of the number of recipients.</P
></DD
></DL
><p class="para">The forms of the <code class="literal">RecipientFactor</CODE
> (<code class="literal">y</CODE
>) option are as follows:</P
><p class="para"><blockquote class="screen"><pre class="screen">Oy<code class="replaceable"><i>factor                                     </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (old form)</I
>
-oy<code class="replaceable"><i>factor                                    </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (old form)</I
>
O RecipientFactor=<code class="replaceable"><i>factor                     </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (beginning with V8.7)</I
>
-ORecipientFactor=<code class="replaceable"><i>factor                     </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.7)</I
>
define(`confWORK_RECIPIENT_FACTOR',<code class="replaceable"><i>factor</I
></CODE
>)   <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The argument <code class="replaceable"><i>factor</I
></CODE
> is of type numeric. If that
argument is missing, the default value is zero. If the entire <code class="literal">RecipientFactor</CODE
> (<code class="literal">y</CODE
>)
option is missing, the default value is 30000 (thirty thousand).
The default for the <em class="emphasis">m4</EM
> technique is to omit this option.</P
><p class="para">The <code class="literal">RecipientFactor</CODE
> (<code class="literal">y</CODE
>) option is not safe.  If specified from the command line,
it may cause <em class="emphasis">sendmail</EM
> to relinquish its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-54">34.8.54 RefuseLA (X)</A
></H3
><p class="refpurpose">Refuse connections on high load</P
>(All versions)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-45995"></A
><a class="indexterm" name="AUTOID-45997"></A
><a class="indexterm" name="AUTOID-46000"></A
>When the load average on a machine
(the average number of jobs in the run queue over the last minute)
becomes too high, <em class="emphasis">sendmail</EM
> can compensate
by refusing to accept SMTP connections. Some experts consider this a more serious
problem than the queuing caused by the <code class="literal">QueueLA</CODE
> (<code class="literal">x</CODE
>) option (see <a class="xref" href="#SML2-CH-34-SECT-8-50" title="">Section 34.8.50</A
>),
so prior to the introduction of V8.7 <em class="emphasis">sendmail</EM
>, they generally recommended 
that the load specified for this <code class="literal">RefuseLA</CODE
> (<code class="literal">X</CODE
>) option
should be higher.
[28]
Under V8.7 the two options have been decoupled, and
you can now tune them according to your personal philosophy.</P
><blockquote class="footnote"><p class="para">[28] Others take the opposite stand.
Paul Vixie, for one, believes that the <code class="literal">RefuseLA</CODE
> option should be lower
than the <code class="literal">QueueLA</CODE
> option so that you stop accepting mail before you
stop processing it.</P
></BLOCKQUOTE
><p class="para">The forms of the <code class="literal">RefuseLA</CODE
> (<code class="literal">X</CODE
>) option are as follows:</P
><p class="para"><blockquote class="screen"><pre class="screen">OX<code class="replaceable"><i>load                         </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (old form)</I
>
-oX<code class="replaceable"><i>load                        </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (old form)</I
>
O RefuseLA=<code class="replaceable"><i>load                </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (beginning with V8.7)</I
>
-ORefuseLA=<code class="replaceable"><i>load                </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.7)</I
>
define(`confREFUSE_LA',<code class="replaceable"><i>load</I
></CODE
>)   <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The argument <code class="replaceable"><i>load</I
></CODE
> is of type numeric. If <code class="replaceable"><i>load</I
></CODE
>
is missing, the value becomes zero, causing all SMTP connections to be
refused. If the entire <code class="literal">RefuseLA</CODE
> (<code class="literal">X</CODE
>) option is missing,
the  value for the load cutoff defaults to 12. The default for the
<em class="emphasis">m4</EM
> technique is to omit this option.</P
><p class="para">This <code class="literal">RefuseLA</CODE
> (<code class="literal">X</CODE
>) option is effective only if your
<em class="emphasis">sendmail</EM
> binary was compiled with load-average support included
(see <a class="xref" href="ch18_08.htm" title="">Section 18.8.14</A
>). You can use the <code class="literal">-d3.1</CODE
> debugging switch
(see <a class="xref" href="ch37_05.htm" title="">Section 37.5.14</A
>) to discover whether your binary includes the
necessary support.</P
><p class="para">The <code class="literal">RefuseLA</CODE
> (<code class="literal">X</CODE
>) option is not safe.  If specified
from the command line, it may cause <em class="emphasis">sendmail</EM
> to relinquish its
<em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-55">34.8.55 ResolverOptions (I)</A
></H3
><p class="refpurpose">Tune DNS lookups</P
>(All versions)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-46055"></A
><a class="indexterm" name="AUTOID-46057"></A
><a class="indexterm" name="AUTOID-46060"></A
>The <code class="literal">ResolverOptions</CODE
> (<code class="literal">I</CODE
>) allows you to tune the way
DNS lookups are performed:</P
><p class="para"><blockquote class="screen"><pre class="screen">OI<code class="replaceable"><i>bool                              </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (old form)</I
>
-oI<code class="replaceable"><i>bool                             </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (old form)</I
>
-oI<code class="replaceable"><i>&quot;arg ...&quot;                        </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (V8.6)</I
>
OI<code class="replaceable"><i>arg ...                           </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (V8.6)</I
>
O ResolverOptions=<code class="replaceable"><i>&quot;arg ...&quot;         </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (V8.7)</I
>
-OResolverOptions=<code class="replaceable"><i>&quot;arg ...&quot;         </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (V8.7)</I
>
define(`confBIND_OPTS',`<code class="replaceable"><i>arg ...</I
></CODE
>')   <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The <code class="replaceable"><i>arg</I
></CODE
> is one or more arguments that allow you to tune
the behavior of the name server.
The <code class="replaceable"><i>arg</I
></CODE
> arguments are identical to the flags
listed in <em class="emphasis">resolver</EM
>(3), but you omit the <code class="literal">RES_</CODE
> prefix.
For example, RES_DNSRCH is expressed DNSRCH.
A flag may be preceded by a plus or a minus
to enable or disable the corresponding name server option.
If no pluses or minuses appear, the name server option is enabled just
as though a plus was present.
Consider the following:</P
><p class="para"><blockquote class="screen"><pre class="screen">OI+AAONLY -DNSRCH
O ResolverOptions=+AAONLY -DNSRCH</PRE
></BLOCKQUOTE
></P
><p class="para">These turn on the AAONLY name server option
(Authoritative Answers Only) and 
turn off the DNSRCH name server option (search the domain path).
If the <code class="literal">ResolverOptions</CODE
> (<code class="literal">I</CODE
>) option is entirely omitted,
the default is for the DNSRCH, DEFNAMES, and RECURSE name server
options to be enabled and all others to be disabled. Thus, for example,
DNSRCH is always enabled unless you specifically turn it off.</P
><p class="para">Beginning with V8.7 <em class="emphasis">sendmail</EM
>, the special string
<code class="literal">HasWildcardMX</CODE
> can be listed along with the other resolver options:</P
><p class="para"><blockquote class="screen"><pre class="screen">O ResolverOptions=+AAONLY -DNSRCH HasWildcardMX</PRE
></BLOCKQUOTE
></P
><p class="para">This string causes MX lookups to be done with 
RES_QUERY set (provided that
the level of the configuration is 6 or above; see <a class="xref" href="ch27_05.htm#SML2-CH-27-SECT-5-1" title="The V Configuration Command">Section 27.5</A
>); otherwise,
those lookups are done with RES_SEARCH. It also inhibits MX lookups
when getting the canonical name of the local host. It should always be
used if you have a wildcard MX record that matches your local domain.</P
><p class="para">Note that omitting the <code class="literal">ResolverOptions</CODE
> (<code class="literal">I</CODE
>)
option <em class="emphasis">does not</EM
> disable DNS
lookups. To disable DNS under V8.6 <em class="emphasis">sendmail</EM
>,
you must compile a version of <em class="emphasis">sendmail</EM
> with
NAMED_BIND support omitted (see <a class="xref" href="ch18_08.htm" title="">Section 18.8.23</A
>).

Beginning with V8.7 <em class="emphasis">sendmail</EM
>, you can disable use of DNS
via your service-switch file
(see <a class="xref" href="#SML2-CH-34-SECT-8-61" title="">Section 34.8.61</A
>).</P
><p class="para">Under V8 <em class="emphasis">sendmail</EM
>, any Boolean argument
following the <code class="literal">ResolverOptions</CODE
> (<code class="literal">I</CODE
>) is silently ignored. Therefore
an initial <code class="literal">True</CODE
> may be included for compatibility
with previous versions of <em class="emphasis">sendmail</EM
>. Note that under V8 <em class="emphasis">sendmail</EM
>, a <code class="literal">False</CODE
> produces an error
and cannot be used to disable this option.</P
><p class="para"><blockquote class="screen"><pre class="screen">OITrue</PRE
></BLOCKQUOTE
></P
><p class="para">Version 1 configuration files 
(see <a class="xref" href="ch27_05.htm#SML2-CH-27-SECT-5-1" title="The V Configuration Command">Section 27.5</A
>)
cause <em class="emphasis">sendmail</EM
> to disable DNSRCH and DEFNAMES
when doing delivery lookups but leave them on at all other times.
Version 2 and above configuration files cause <em class="emphasis">sendmail</EM
>
to use the resolver options defined by the <code class="literal">ResolverOptions</CODE
> (<code class="literal">I</CODE
>) option, except that it always enables DNSRCH when
doing lookups with the <code class="literal">$[</CODE
> and <code class="literal">$]</CODE
> operators.
Starting with Version 8, <em class="emphasis">sendmail</EM
> defers the decision of whether or not
to use DNS lookups to the <code class="literal">ServiceSwitchFile</CODE
> option (see
<a class="xref" href="#SML2-CH-34-SECT-8-61" title="">Section 34.8.61</A
>). DNS is now only considered
canonical if the <code class="literal">dns</CODE
> service is listed for <code class="literal">hosts</CODE
> in
the <code class="literal">ServiceSwitchFile</CODE
>.</P
><p class="para">Finally, note that an attempt to use this option with a version of
<em class="emphasis">sendmail</EM
> that does not support DNS lookups (see <a class="xref" href="ch18_08.htm" title="">Section 18.8.23</A
>)
will result in this error message:</P
><p class="para"><blockquote class="screen"><pre class="screen">name server (I option) specified but BIND not compiled in</PRE
></BLOCKQUOTE
></P
><p class="para">The <code class="literal">ResolverOptions</CODE
> (<code class="literal">I</CODE
>) option is not safe.  If specified from the command line,
it may cause <em class="emphasis">sendmail</EM
> to relinquish its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-56">34.8.56 RetryFactor (Z)</A
></H3
><p class="refpurpose">Increment per job priority</P
>(All versions)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-46149"></A
><a class="indexterm" name="AUTOID-46151"></A
>When sendmail processes the messages in its queue,
it sorts them by priority and handles those with the <em class="emphasis">lowest</EM
>
(least positive) priority first.</P
><p class="para">The priority of a message is calculated once, using the
<code class="literal">RecipientFactor</CODE
> (<code class="literal">y</CODE
>) (see <a class="xref" href="#SML2-CH-34-SECT-8-53" title="">Section 34.8.53</A
>)
and 
<code class="literal">ClassFactor</CODE
> (<code class="literal">z</CODE
>) (see <a class="xref" href="#SML2-CH-34-SECT-8-8" title="">Section 34.8.8</A
>)
options, when the message is first created,
and it is adjusted, using this <code class="literal">RetryFactor</CODE
> (<code class="literal">Z</CODE
>) option, each time the message
is processed in the queue.</P
><p class="para">Each time a message from the queue fails to be delivered and needs
to be requeued, its priority is adjusted.
That adjustment is made by adding the value of this <code class="literal">RetryFactor</CODE
> (<code class="literal">Z</CODE
>) option.</P
><p class="para">The forms of the <code class="literal">RetryFactor</CODE
> (<code class="literal">Z</CODE
>) option are as follows:</P
><p class="para"><blockquote class="screen"><pre class="screen">OZ<code class="replaceable"><i>inc                                </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (old form)</I
>
-oZ<code class="replaceable"><i>inc                               </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (old form)</I
>
O RetryFactor=<code class="replaceable"><i>inc                    </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (beginning with V8.7)</I
>

-ORetryFactor=<code class="replaceable"><i>inc                    </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.7)</I
>
define(`confWORK_TIME_FACTOR',<code class="replaceable"><i>inc</I
></CODE
>)   <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The argument <code class="replaceable"><i>inc</I
></CODE
> is of type numeric. If <code class="replaceable"><i>inc</I
></CODE
> is
missing, the default value is zero. If the entire <code class="literal">RetryFactor</CODE
> (<code class="literal">Z</CODE
>) option
is missing, the value for <code class="replaceable"><i>inc</I
></CODE
> defaults to
90000 (ninety thousand). 
The default for the <em class="emphasis">m4</EM
> technique is to omit this option.
The increment is performed by adding the value of <code class="replaceable"><i>inc</I
></CODE
>
to the previously stored message priority each time that
message is queued.</P
><p class="para">The <code class="literal">RetryFactor</CODE
> (<code class="literal">Z</CODE
>) option is not safe.  If specified from the command line,
it may cause <em class="emphasis">sendmail</EM
> to relinquish its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-57">34.8.57 RunAsUser</A
></H3
><p class="refpurpose">Run as non-root (on a firewall)</P
>(V8.8 and above)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-46204"></A
><a class="indexterm" name="AUTOID-46206"></A
><a class="indexterm" name="AUTOID-46209"></A
>On firewalls, for reasons of additional security, it is often desirable
to run <em class="emphasis">sendmail</EM
> as a user other than <em class="emphasis">root</EM
>.
Beginning with V8.8 <em class="emphasis">sendmail</EM
>, you can accomplish this
by using the <code class="literal">RunAsUser</CODE
> option: </P
><p class="para"><blockquote class="screen"><pre class="screen">O RunAsUser=<code class="replaceable"><i>user</I
></CODE
>:<code class="replaceable"><i>group                       </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8.8 and above</I
>
-ORunAsUser=<code class="replaceable"><i>user</I
></CODE
>:<code class="replaceable"><i>group                       </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8.8 and above</I
>
define(`confRUN_AS_USER', `<code class="replaceable"><i>user</I
></CODE
>:<code class="replaceable"><i>group</I
></CODE
>')       <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 technique</I
></PRE
></BLOCKQUOTE
></P
><p class="para">Here, <code class="replaceable"><i>user</I
></CODE
> is either the <em class="emphasis">uid</EM
> number of the identity you
want <em class="emphasis">sendmail</EM
> to run under or a symbolic name for that identity.
If a symbolic name is specified and if that name cannot be looked
up in the <em class="emphasis">passwd</EM
>(5) file, <em class="emphasis">sendmail</EM
> prints the following
error:</P
><p class="para"><blockquote class="screen"><pre class="screen">readcf: option RunAsUser: unknown user <i class="lineannotation">bad symbolic name here</I
></PRE
></BLOCKQUOTE
></P
><p class="para">If the symbolic name is found in the <em class="emphasis">passwd</EM
>(5) file, the
<em class="emphasis">uid</EM
> and <em class="emphasis">gid</EM
> that <em class="emphasis">sendmail</EM
> will run under are
set from that file.</P
><p class="para">The <code class="literal">:</CODE
>, if it is present,
[29]
signals to <em class="emphasis">sendmail</EM
> that you also intend to specify
a group identity.</P
><blockquote class="footnote"><p class="para">[29] It can also be a <code class="literal">.</CODE
> or a <code class="literal">/</CODE
> character.</P
></BLOCKQUOTE
><p class="para">The <code class="replaceable"><i>group</I
></CODE
> is either the numeric <em class="emphasis">gid</EM
> that you want
<em class="emphasis">sendmail</EM
> to run as or a symbolic name for a group.
If it is a symbolic name, that name is looked up in
the <em class="emphasis">group</EM
>(5) file. If it is not found in that
file, the following error is printed:</P
><p class="para"><blockquote class="screen"><pre class="screen">readcf: option RunAsUser: unknown group <i class="lineannotation">bad group name here</I
></PRE
></BLOCKQUOTE
></P
><p class="para">If the symbolic name is in that file, <em class="emphasis">sendmail</EM
> will
run under the <em class="emphasis">gid</EM
> found there.</P
><p class="para">The <em class="emphasis">sendmail</EM
> program assumes the identity specified just
after the configuration file is read for all but the
daemon mode. As a daemon, <em class="emphasis">sendmail</EM
> remains <em class="emphasis">root</EM
>
to listen for incoming SMTP connections. Each time
it receives a connection, it validates that connection
(see <a class="xref" href="ch22_04.htm#SML2-CH-22-SECT-4-2" title="Accept/Reject Connections via libwrap.a">Section 22.4.1, "Accept/Reject Connections via libwrap.a"</A
> and <a class="xref" href="ch29_10.htm#SML2-CH-29-SECT-10-1" title="The check_relay Rule Set">Section 29.10.3, "The check_relay Rule Set"</A
>), then
<em class="emphasis">fork</EM
>(2)'s. The child then processes the incoming message.
Immediately after the fork, the child assumes the identity
specified by this <code class="literal">RunAsUser</CODE
> option.</P
><p class="para">Note that running as non-<em class="emphasis">root</EM
> can lead to problems, especially
on machines that do more than simply relay mail between networks.
As non-<em class="emphasis">root</EM
>, <em class="emphasis">sendmail</EM
> may not be able to read some <code class="literal">:include:</CODE
>
files, will certainly not be able to read protected <em class="emphasis">~/.forward</EM
> files,
and won't be able to save messages to the queue, all unless permissions
are relaxed to allow the non-<em class="emphasis">root</EM
> user such access.
This option is intended to be used on a firewall machine. It should
definitely <em class="emphasis">not</EM
> be used on nonfirewall machines.</P
><p class="para">The <code class="literal">RunAsUser</CODE
> option is not safe.
If specified from the command line,
it may cause <em class="emphasis">sendmail</EM
> to relinquish its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-58">34.8.58 SafeFileEnvironment</A
></H3
><p class="refpurpose">Directory for safe file writes</P
>(V8.7 and above)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-46287"></A
><a class="indexterm" name="AUTOID-46290"></A
><a class="indexterm" name="AUTOID-46293"></A
><a class="indexterm" name="AUTOID-46296"></A
>For security it is desirable to control the manner and circumstances
under which messages are delivered to files. Beginning with V8.7
<em class="emphasis">sendmail</EM
> you can enhance the security of writing to files
with the <code class="literal">SafeFileEnvironment</CODE
> option. It is used like this:</P
><p class="para"><blockquote class="screen"><pre class="screen">O SafeFileEnvironment=<code class="replaceable"><i>path              </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (beginning with V8.7)</I
>
-OSafeFileEnvironment=<code class="replaceable"><i>path              </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.7)</I
>
define(`confSAFE_FILE_ENV',<code class="replaceable"><i>path)        </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> m4 configuration (beginning with V8.7)</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The <code class="replaceable"><i>path</I
></CODE
> is of type string and, if present, must
be the full path name of a directory. The default, if either <code class="replaceable"><i>path</I
></CODE
>
or the entire option is missing, is NULL, causing
this feature to be ignored.</P
><p class="para">When preparing to save a message to a file, <em class="emphasis">sendmail</EM
> first
obtains the permissions of that file, if the file exists, and
saves them (see <a class="xref" href="ch24_02.htm#SML2-CH-24-SECT-2-2" title="Delivery to Files">Section 24.2.2, "Delivery to Files"</A
>). The <em class="emphasis">sendmail</EM
>
program uses <em class="emphasis">lstat</EM
>(2) to obtain those permissions if
it was compiled with HASLSTAT defined (see <a class="xref" href="ch18_08.htm" title="">Section 18.8.9, HAS...</A
>).
Otherwise, it uses <em class="emphasis">stat</EM
>(2).</P
><p class="para">Ordinarily, <em class="emphasis">sendmail</EM
> does a <em class="emphasis">chroot</EM
>(2) to the <em class="emphasis">/</EM
>
directory just before it opens the file for writing. If the
<code class="replaceable"><i>path</I
></CODE
> is non-NULL and nonempty, <em class="emphasis">sendmail</EM
>
then precedes that <em class="emphasis">chroot</EM
>(2) with a:</P
><p class="para"><blockquote class="screen"><pre class="screen">chroot(<code class="replaceable"><i>path</I
></CODE
>)</PRE
></BLOCKQUOTE
></P
><p class="para">If the <em class="emphasis">chroot</EM
>(2) fails, <em class="emphasis">sendmail</EM
> prints the
following error and bounces the mail message:</P
><p class="para"><blockquote class="screen"><pre class="screen">mailfile: Cannot chroot(<code class="replaceable"><i>path</I
></CODE
>)</PRE
></BLOCKQUOTE
></P
><p class="para">&#13;If the name of the file begins with <code class="replaceable"><i>path</I
></CODE
>, that prefix
is stripped after the <em class="emphasis">chroot</EM
>(2) and before the <em class="emphasis">fopen</EM
>(3).</P
><p class="para">For example, consider the need to safely store all mail archive
files on the mail hub in a directory called <em class="emphasis">/archives</EM
>.
You would first create this configuration declaration:&#13;</P
><p class="para"><blockquote class="screen"><pre class="screen">O SafeFileEnvironment=/archives</PRE
></BLOCKQUOTE
></P
><p class="para">&#13;Then every file archive notation in the <em class="emphasis">aliases</EM
> database
should be changed to reference this base directory:
[30]&#13;</P
><blockquote class="footnote"><p class="para">[30] This is not strictly necessary. Both <em class="emphasis">/archives/admin/log</EM
> and
<em class="emphasis">/admin/log</EM
> will work equally well. The former, however,
is preferred for clarity.</P
></BLOCKQUOTE
><p class="para"><blockquote class="screen"><pre class="screen">adminlist:   :include:/usr/local/maillists/admin.list,
             /archives/admin/log</PRE
></BLOCKQUOTE
></P
><p class="para">&#13;For safety, <em class="emphasis">sendmail</EM
> will henceforth <em class="emphasis">chroot</EM
>(2) into
the <em class="emphasis">/archives</EM
> directory before delivering to any files.
Note that this <code class="literal">SafeFileEnvironment</CODE
> option affects all
writes to files, so a
user's <em class="emphasis">~/.forward</EM
> entry (such as the following) will become
relative to <em class="emphasis">/archives</EM
> and so may fail depending on
your specific setup:&#13;</P
><p class="para"><blockquote class="screen"><pre class="screen">/u/bill/tmp/incoming     <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> written as /archives/u/bill/tmp/incoming</I
></PRE
></BLOCKQUOTE
></P
><p class="para">&#13;The <code class="literal">SafeFileEnvironment</CODE
> option also causes <em class="emphasis">sendmail</EM
>
to verify that the file that is being written to is a plain file. If it
is anything else, <em class="emphasis">sendmail</EM
> prints the following error
and bounces the messages:&#13;</P
><p class="para"><blockquote class="screen"><pre class="screen">/dev/tty... Can't create output: Error 0</PRE
></BLOCKQUOTE
></P
><p class="para">&#13;Here, an attempt to dump the message to <em class="emphasis">/dev/tty</EM
> failed
because <em class="emphasis">sendmail</EM
> discovered it was a device rather than
an ordinary file. But note that beginning with V8.8, it is
legal to write to the special device named <em class="emphasis">/dev/null</EM
>.</P
><p class="para">The <code class="literal">SafeFileEnvironment</CODE
> option is not safe.
If specified from the command line,
it may cause <em class="emphasis">sendmail</EM
> to relinquish its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-59">34.8.59 SaveFromLine (f)</A
></H3
><p class="refpurpose">Save UNIX-style From lines</P
>(All versions)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-46382"></A
><a class="indexterm" name="AUTOID-46384"></A
>Many UNIX MUAs, as well as some transmittal systems like UUCP,
require that a mail-message header begin with a line that begins
with the five-character sequence &quot;<code class="literal">From&nbsp;</CODE
>&quot;.  All other header lines
must adhere to the RFC822 standard and be delimited with a colon:&#13;</P
><p class="para"><blockquote class="screen"><pre class="screen">From jqp@Washington.DC.gov Fri Jul 26 12:35:25 1991
Return-Path: &lt;jqp@Washington.DC.gov&gt;
Date: Fri, 26 Jul 91 12:35:15 PDT
From: jqp@Washington.DC.gov (John Q Public)</PRE
></BLOCKQUOTE
></P
><p class="para">&#13;If you don't set the <code class="literal">SaveFromLine</CODE
> (<code class="literal">f</CODE
>) option, the first line in the above
example is stripped out by <em class="emphasis">sendmail</EM
>.
The <code class="literal">SaveFromLine</CODE
> (<code class="literal">f</CODE
>) option prevents this, because it
tells <em class="emphasis">sendmail</EM
> to keep header lines
that begin with the five characters &quot;<code class="literal">From&nbsp;</CODE
>&quot;.
But note that it also causes this header to no longer be
recognized as a header.</P
><p class="para">The forms of the <code class="literal">SaveFromLine</CODE
> (<code class="literal">f</CODE
>) option are as follows:</P
><p class="para"><blockquote class="screen"><pre class="screen">Of<code class="replaceable"><i>bool                               </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (old form)</I
>
-of<code class="replaceable"><i>bool                              </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (old form)</I
>
-s<code class="replaceable"><i>                                   </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command-line shorthand (not recommended)</I
>
O SaveFromLine=<code class="replaceable"><i>bool                  </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (beginning with V8.7)</I
>
-OSaveFromLine=<code class="replaceable"><i>bool                  </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.7)</I
>
define(`confSAVE_FROM_LINES',<code class="replaceable"><i>bool</I
></CODE
>)   <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The optional argument <code class="replaceable"><i>bool</I
></CODE
> is of type Boolean. If <code class="replaceable"><i>bool</I
></CODE
>
is missing, this option becomes true (the &quot;<code class="literal">From&nbsp;</CODE
>&quot; line is saved).
If the entire option is missing, it defaults to false (neither save
the &quot;<code class="literal">From&nbsp;</CODE
>&quot; line nor recognize it as a header).</P
><p class="para">The <code class="literal">SaveFromLine</CODE
> (<code class="literal">f</CODE
>) option is not safe.  If specified from the command line,
it may cause <em class="emphasis">sendmail</EM
> to relinquish its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-60">34.8.60 SendMimeErrors (j)</A
></H3
><p class="refpurpose">Return MIME format errors</P
>(V6.57 and above)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-46432"></A
><a class="indexterm" name="AUTOID-46434"></A
><a class="indexterm" name="AUTOID-46437"></A
>MIME (Multipurpose Internet Mail Extensions)
is documented in RFC1341, with addition details in 
RFC1344, RFC1426,
RFC1428, RFC1437, RFC1521, RFC1522,
RFC1523, RFC1556, RFC1563, RFC1641,
RFC1740, RFC1741, and RFC1767.
MIME is a method of incorporating non-ASCII
text (such as images and sounds) in mail messages.</P
><p class="para">When <em class="emphasis">sendmail</EM
> composes an error notification of failed (bounced) mail,
this <code class="literal">SendMimeErrors</CODE
> (<code class="literal">j</CODE
>) option tells <em class="emphasis">sendmail</EM
> to include MIME
format headers in that error notification. MIME format is required for
DSN notification to work (the two go hand in hand). This option
affects only returned (bounced) mail.</P
><p class="para">If the <code class="literal">SendMimeErrors</CODE
> (<code class="literal">j</CODE
>) option is true and if <em class="emphasis">sendmail</EM
> is composing
a returned mail message, the following two headers are added to the header
portion of that message:</P
><p class="para"><blockquote class="screen"><pre class="screen">MIME-Version: 1.0
Content-Type: multipart/report; report-type=delivery-status;
        boundary=<em class="emphasis">magic</EM
></PRE
></BLOCKQUOTE
></P
><p class="para">The version (1.0) of the <code class="literal">MIME-Version:</CODE
> header
(see <a class="xref" href="ch35_10.htm" title="">Section 35.10.21</A
>)
is hard-coded into V8 <em class="emphasis">sendmail</EM
>, so it cannot be changed.
The <code class="literal">Content-Type:</CODE
> is instead <code class="literal">multipart/mixed</CODE
> if
<em class="emphasis">sendmail</EM
> was compiled without DSN support (see <a class="xref" href="ch18_08.htm" title="">Section 18.8.5, DSN</A
>).
The <em class="emphasis">magic</EM
> of <code class="literal">Content-Type:</CODE
>
is a string that is used to separate the
various parts of the message body. The string is formed from
the queue ID, the time, and the hostname. For example:</P
><p class="para"><blockquote class="screen"><pre class="screen">Content-Type: multipart/report; report-type=delivery-status; 
        boundary=AA26662.9306241634/hostname</PRE
></BLOCKQUOTE
></P
><p class="para">Then <em class="emphasis">sendmail</EM
> prefixes the body of the returned message (if there
is one), a line of notification, and this boundary:</P
><p class="para"><blockquote class="screen"><pre class="screen">This is a MIME-encapsulated message

-AA26662.9306241634/hostname
           <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> message body begins here</I
></PRE
></BLOCKQUOTE
></P
><p class="para">Newer MUAs are aware of MIME and can send and receive MIME messages.
Such MUAs understand <code class="literal">MIME-Version:</CODE
> header in a mail message.
Older (non-MIME aware) MUAs ignore that header.</P
><p class="para">Unless you bounce mail to a site that cannot handle MIME,
you should always set this <code class="literal">SendMimeErrors</CODE
> (<code class="literal">j</CODE
>) option
to true.</P
><p class="para">The forms of the <code class="literal">SendMimeErrors</CODE
> (<code class="literal">j</CODE
>) option are as follows:</P
><p class="para"><blockquote class="screen"><pre class="screen">Oj<code class="replaceable"><i>bool                                  </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (V8.6)</I
>
-oj<code class="replaceable"><i>bool                                 </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (V8.6)</I
>
O SendMimeErrors=<code class="replaceable"><i>bool                   </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (V8.7)</I
>
-OSendMimeErrors=<code class="replaceable"><i>bool                   </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (V8.7)</I
>
define(`confMIME_FORMAT_ERRORS',<code class="replaceable"><i>bool</I
></CODE
>)   <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The optional argument <code class="replaceable"><i>bool</I
></CODE
> is of type Boolean. If <code class="replaceable"><i>bool</I
></CODE
>
is missing, this option becomes true (errors are sent in MIME
format).
If the entire option is missing it defaults to false (errors are
sent just as they were before this option was introduced).</P
><p class="para">The <code class="literal">SendMimeErrors</CODE
> (<code class="literal">j</CODE
>) option is safe.  Even if it is specified from the command line,
<em class="emphasis">sendmail</EM
> retains its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-61">34.8.61 ServiceSwitchFile</A
></H3
><p class="refpurpose">Specify file for switched services</P
>(V8.7 and above)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-46505"></A
><a class="indexterm" name="AUTOID-46507"></A
>Some implementations of UNIX recognize that system information
can be found in a variety of places.
On Solaris, for example, hostnames
can be obtained from the <em class="emphasis">/etc/hosts</EM
> file, from <em class="emphasis">nis</EM
>, from <em class="emphasis">nisplus</EM
>,
or from DNS.
Solaris allows the system administrator to choose the order
in which these services are searched with a &quot;service-switch&quot; file.
Other systems, such as Ultrix and DEC OSF/1, have a similar concept,
but some (such as SunOS) use built-in rules
that cannot be changed without the source code.</P
><p class="para">V8.7 <em class="emphasis">sendmail</EM
> uses a system-service switch
if one is available. Otherwise, <em class="emphasis">sendmail</EM
> uses the
service switch defined by this <code class="literal">ServiceSwitchFile</CODE
> option.</P
><p class="para">The form for redefining the switched-services file is as follows:</P
><p class="para"><blockquote class="screen"><pre class="screen">O ServiceSwitchFile=<code class="replaceable"><i>path</I
></CODE
>                 <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (beginning with V8.7)</I
>
-OServiceSwitchFile=<code class="replaceable"><i>path</I
></CODE
>                 <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.7)</I
>
define(`confSERVICE_SWITCH_FILE',<code class="replaceable"><i>path</I
></CODE
>)   <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">If this option is defined on an operating system that <em class="emphasis">does</EM
>
offer a service-switch
(such as Solaris, DEC OSF/1 or Ultrix), it is ignored.
Otherwise, <code class="replaceable"><i>path</I
></CODE
> is used as the full pathname of
the file that is to be used as the service-switch.
If <code class="replaceable"><i>path</I
></CODE
> is omitted, the default is NULL.
If the entire option is omitted, the default is <em class="emphasis">/etc/service.switch</EM
>.
The default for the <em class="emphasis">m4</EM
> technique is to omit this option.</P
><p class="para">The form of each line in that file is</P
><p class="para"><blockquote class="screen"><pre class="screen"><code class="replaceable"><i>service  how how</I
></CODE
></PRE
></BLOCKQUOTE
></P
><p class="para">Here, <code class="replaceable"><i>service</I
></CODE
> is either <code class="literal">hosts</CODE
> (which states how host
names are looked up) <code class="literal">aliases</CODE
> (which states how aliases are
looked up), or <code class="literal">passwd</CODE
> (which states how <em class="emphasis">passwd</EM
>(5) information
is looked up).
For each of these services, there may be one or more <code class="replaceable"><i>how</I
></CODE
> methods (not
all of which make sense with all services).
The <code class="replaceable"><i>service</I
></CODE
> and the <code class="replaceable"><i>hows</I
></CODE
> must be separated from each
other by whitespace.
The possible methods (values for each <code class="replaceable"><i>how</I
></CODE
>) are
<code class="literal">files</CODE
> (the information is in a file or database, such as <em class="emphasis">/etc/hosts</EM
>),
<code class="literal">netinfo</CODE
> (for information on NeXT machines),
<code class="literal">nis</CODE
> (the information is in an <em class="emphasis">nis</EM
> map),
<code class="literal">nisplus</CODE
> (the information is in an <em class="emphasis">nisplus</EM
> map),
<code class="literal">dns</CODE
> (the host information is looked up with DNS), 
or <code class="literal">hesiod</CODE
> (the information is listed with a Hesiod service).
[31]</P
><blockquote class="footnote"><p class="para">[31] Currently, the list is limited to those shown. Future versions of
<em class="emphasis">sendmail</EM
> may offer others.</P
></BLOCKQUOTE
><p class="para">For example, consider the contents of the following <em class="emphasis">/etc/service.switch</EM
> file:</P
><p class="para"><blockquote class="screen"><pre class="screen">aliases nis
passwd nis files
hosts dns</PRE
></BLOCKQUOTE
></P
><p class="para">Here, <em class="emphasis">sendmail</EM
> will look up aliases in the <em class="emphasis">nis</EM
> map <em class="emphasis">mail.aliases</EM
>.
Password information, such as local user login names and full name information
from the <em class="emphasis">gecos</EM
> field, will first be looked up in the <em class="emphasis">nis</EM
>
map <em class="emphasis">passwd.byname</EM
>. If not found there, they will then be looked up in
the file <em class="emphasis">/etc/passwd</EM
>. The last line tells <em class="emphasis">sendmail</EM
>
to look up A and MX records for hosts using the DNS services.</P
><p class="para">The <code class="literal">hosts</CODE
> line can also determine how MX records are
treated (see <a class="xref" href="ch21_02.htm#SML2-CH-21-SECT-2-4" title="Look Up Addresses for Delivery">Section 21.2.3, "Look Up Addresses for Delivery"</A
>).
If &quot;dns&quot; does not appear in that line,
<em class="emphasis">sendmail</EM
> disables lookups of MX records.
If <em class="emphasis">sendmail</EM
> is configured to look up hosts
with <em class="emphasis">nis</EM
> first, then DNS, it will do the MX lookup
in DNS <em class="emphasis">before</EM
> the <em class="emphasis">nis</EM
> lookup.</P
><p class="para">For Solaris, <code class="literal">hosts</CODE
> is looked up with the <em class="emphasis">nsswitch.conf</EM
>(4) service.
For DEC OSF/1 and Ultrix, <code class="literal">hosts</CODE
> is looked up with the
<em class="emphasis">svc.conf</EM
>(5) service.
For all others the file defined by the <code class="literal">ServiceSwitchFile</CODE
> is examined
for a line that begins with the word <code class="literal">hosts</CODE
>. If that line is missing
or if the file doesn't exist,
&quot;dns&quot; is returned by default. But if NAMED_BIND was not defined (see <a class="xref" href="ch18_08.htm" title="">Section 18.8.23</A
>)
when <em class="emphasis">sendmail</EM
> was compiled, the default
returned is &quot;nis&quot; for Solaris and SunOS, and on other systems it is &quot;files.&quot;</P
><p class="para">Note that on systems such as SunOS, a version of <em class="emphasis">gethostbyname</EM
>(3) is still called
that ignores the <em class="emphasis">sendmail</EM
> programs service-switch file. On such systems
you may need to download the source, recompile, and install a version that
works correctly.</P
><p class="para">The <code class="literal">ServiceSwitchFile</CODE
> option is not safe.  If specified from the command line,
it may cause <em class="emphasis">sendmail</EM
> to relinquish its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-62">34.8.62 SevenBitInput (7)</A
></H3
><p class="refpurpose">Force 7-bit input</P
>(V8.1 and above)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-46602"></A
><a class="indexterm" name="AUTOID-46604"></A
>By default, V8 <em class="emphasis">sendmail</EM
> leaves as is all bytes of every mail
message it reads.
This differs from other releases of <em class="emphasis">sendmail</EM
> that always
clear (zero) the high (most-significant) bit.
To make V8 <em class="emphasis">sendmail</EM
> behave like
older versions and always clear the high bit on input, the <code class="literal">SevenBitInput</CODE
> (<code class="literal">7</CODE
>) option
is available:</P
><p class="para"><blockquote class="screen"><pre class="screen">O7<code class="replaceable"><i>bool                               </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (V8.6)</I
>
-o7<code class="replaceable"><i>bool                              </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (V8.6)</I
>
O SevenBitInput=<code class="replaceable"><i>bool                 </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (V8.7 and above)</I
>
-OSevenBitInput=<code class="replaceable"><i>bool                 </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (V8.7 and above)</I
>
define(`confSEVEN_BIT_INPUT',<code class="replaceable"><i>bool</I
></CODE
>)   <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The argument <code class="replaceable"><i>bool</I
></CODE
> is of type Boolean. If <code class="replaceable"><i>bool</I
></CODE
> is
missing, the default value is true (clear the 8th bit). If this option is
omitted entirely, the default is false (the 8th bit is unmodified).
If you configure with V8's <em class="emphasis">m4</EM
> technique, the default for
<code class="literal">confSEVEN_BIT_INPUT</CODE
> is false.</P
><p class="para">Note that this option is temporarily set to false for a single
message if the ESMTP BODY=8BITMIME parameter is
given and is set to true if the BODY=7BIT parameter is
given.</P
><p class="para">Also note that the <code class="literal">SevenBitInput</CODE
> (<code class="literal">7</CODE
>) option affects input only.
The <code class="literal">F=7</CODE
> delivery agent flag (see <a class="xref" href="ch30_08.htm" title="">Section 30.8.4</A
>) can be used to set 7-bit
output on an individual delivery agent basis.</P
><p class="para">The <code class="literal">SevenBitInput</CODE
> (<code class="literal">7</CODE
>) option is safe. If specified from the command line,
<em class="emphasis">sendmail</EM
> will not relinquish its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-63">34.8.63 SingleLineFromHeader</A
></H3
><p class="refpurpose">Strip newlines from From: headers</P
>(V8.8 and above)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-46647"></A
><a class="indexterm" name="AUTOID-46649"></A
><a class="indexterm" name="AUTOID-46651"></A
><a class="indexterm" name="AUTOID-46654"></A
>Lotus Notes' SMTP mail gateway can generate <code class="literal">From:</CODE
> headers
that contain newlines and that contain the address on the second line:</P
><p class="para"><blockquote class="screen"><pre class="screen">From: Full Name
        &lt;address&gt;</PRE
></BLOCKQUOTE
></P
><p class="para">Although this is legal per RFC822, many MUAs mishandle such
headers and are unable to find the address.
If your site suffers from this problem, you may define the <code class="literal">SingleLineFromHeader</CODE
>
option:</P
><p class="para"><blockquote class="screen"><pre class="screen">O SingleLineFromHeader=<code class="replaceable"><i>bool                  </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (V8.8)</I
>
-OSingleLineFromHeader=<code class="replaceable"><i>bool                  </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (V8.8)</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The <code class="replaceable"><i>bool</I
></CODE
> is of type Boolean. If it is true, <em class="emphasis">sendmail</EM
> will convert
all newlines found in a <code class="literal">From:</CODE
> header into space characters.
If it is false, <em class="emphasis">sendmail</EM
> will leave all <code class="literal">From:</CODE
> headers as is.</P
><p class="para">The <code class="literal">SingleLineFromHeader</CODE
> option is safe.  Even if it is specified from the command line,
<em class="emphasis">sendmail</EM
> retains its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-64">34.8.64 SingleThreadDelivery</A
></H3
><p class="refpurpose">Set single threaded delivery</P
>(V8.8 and above)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-46686"></A
><a class="indexterm" name="AUTOID-46688"></A
>Ordinarily, when <em class="emphasis">sendmail</EM
> processes the queue, it pays relatively
little attention to other <em class="emphasis">sendmail</EM
> processes that may be
processing the same queue at the same time.
It locks a single <code class="literal">qf</CODE
> file during delivery so that no other
<em class="emphasis">sendmail</EM
> will attempt delivery of that message at the same time, 
but that is all.
In sending many messages to a single other host, it is possible
for multiple, parallel <em class="emphasis">sendmail</EM
> processes to try to deliver
different messages from that queue to that single host all at once.</P
><p class="para">When accidental parallelism is not desirable, as in just
processing the queue, you may wish
to set up <em class="emphasis">sendmail</EM
> to be single-threaded. This 
ensures that only a single <em class="emphasis">sendmail</EM
>
will ever be delivering to a given host at a given time.
Single-threaded delivery is enabled with the <code class="literal">SingleThreadDelivery</CODE
> option:</P
><p class="para"><blockquote class="screen"><pre class="screen">O SingleThreadDelivery=<code class="replaceable"><i>bool</I
></CODE
>                       <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8.8 and above</I
>
-OSingleThreadDelivery=<code class="replaceable"><i>bool</I
></CODE
>                       <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8.8 and above</I
>
define(`confSINGLE_THREAD_DELIVERY',<code class="replaceable"><i>bool</I
></CODE
>)         <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 technique</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The argument <code class="replaceable"><i>bool</I
></CODE
> is of type Boolean. If it is missing, the
default value is true (deliver single-threaded).
If the entire <code class="literal">SingleThreadDelivery</CODE
> option is missing, the default becomes
false (deliver in parallel).
There is no <em class="emphasis">m4</EM
> shorthand for enabling this option.</P
><p class="para">Note that the <code class="literal">SingleThreadDelivery</CODE
> option will work only if
the <code class="literal">HostStatusDirectory</CODE
> option is also declared
(see <a class="xref" href="#SML2-CH-34-SECT-8-31" title="">Section 34.8.31</A
>).
If it is not, <em class="emphasis">sendmail</EM
> will print the following error and reset the
<code class="literal">SingleThreadDelivery</CODE
> option to false:</P
><p class="para"><blockquote class="screen"><pre class="screen">Warning: HostStatusDirectory required for SingleThreadDelivery</PRE
></BLOCKQUOTE
></P
><p class="para">Also note that the <code class="literal">SingleThreadDelivery</CODE
> option should probably never
be set in the configuration file. To see why, consider an ongoing
queue run to a host that is receiving many messages. If interactive
user mail arrives during that run, the <em class="emphasis">sendmail</EM
> process executed by
the user's MUA may find that it cannot send the message because
it is single-threaded and the other <em class="emphasis">sendmail</EM
> has that host locked.
In that case the user's message will be queued and will 
wait in the queue until the next queue is run.
Even if your site is on the Internet, one large message to a slow
site can cause interactive mail for that site to be wrongly queued.</P
><p class="para">The appropriate use for the <code class="literal">SingleThreadDelivery</CODE
> option is
on the command line when processing the queue. In daemon mode, for
example, these startup commands may be appropriate:</P
><p class="para"><blockquote class="screen"><pre class="screen">/usr/lib/sendmail -bd
/usr/lib/sendmail -OSingleThreadDelivery -q30m</PRE
></BLOCKQUOTE
></P
><p class="para">Note that two <em class="emphasis">sendmail</EM
> programs are started: one to act as
a daemon and the other to periodically process the queue.
Don't combine them when using the <code class="literal">SingleThreadDelivery</CODE
>
option, because incoming (relayed) mail can wrongly affect outgoing mail.</P
><p class="para">The <code class="literal">SingleThreadDelivery</CODE
> option is not safe.  
If specified from the command line,
it may cause <em class="emphasis">sendmail</EM
> to relinquish its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-65">34.8.65 SmtpGreetingMessage or $e</A
></H3
><p class="refpurpose">The SMTP greeting message</P
>(All versions)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-46744"></A
><a class="indexterm" name="AUTOID-46747"></A
><a class="indexterm" name="AUTOID-46749"></A
><a class="indexterm" name="AUTOID-46751"></A
><a class="indexterm" name="AUTOID-46753"></A
>When <em class="emphasis">sendmail</EM
> accepts an incoming SMTP connection
it sends a greeting message to the other host.
This message identifies the local machine and
is the first thing it sends to say it is ready.</P
><p class="para">Prior to V8.7 <em class="emphasis">sendmail</EM
>, this message was declared with the <code class="literal">$e</CODE
>
macro. Beginning with V8.7 <em class="emphasis">sendmail</EM
>, it is declared with the 
<code class="literal">SmtpGreetingMessage</CODE
> option. In both cases the message must
begin with the fully qualified
name of the local host. Usually, that name is stored in <code class="literal">$j</CODE
>.
The minimal definition for both is</P
><p class="para"><blockquote class="screen"><pre class="screen">De$j                           <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8.6 and earlier</I
>
O SmtpGreetingMessage=$j       <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> beginning with V8.7</I
></PRE
></BLOCKQUOTE
></P
><p class="para">Additional information may follow the local hostname.
Any additional information
must be separated from the hostname by at least one space:</P
><p class="para"><blockquote class="screen"><pre class="screen">De$j <code class="replaceable"><i>additional information</I
></CODE
>
    <i class="lineannotation"><img src="../chars/uarr.gif" alt="-^"></I
>
    <i class="lineannotation">at least one space</I
></PRE
></BLOCKQUOTE
></P
><p class="para">Traditionally, that additional information is the name of the
listening program (in our case, always <em class="emphasis">sendmail</EM
>), the version
of that program, and a statement that the program is ready.
For example:</P
><p class="para"><blockquote class="screen"><pre class="screen">De$j Sendmail $v ready at $b                      <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8.6 and earlier</I
>
O SmtpGreetingMessage=$j Sendmail $v ready at $b  <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> beginning with V8.7</I
></PRE
></BLOCKQUOTE
></P
><p class="para">Note that it is not uncommon to see imaginative (and legal) variations
in the additional information:</P
><p class="para"><blockquote class="screen"><pre class="screen">De$j Sun's sendmail.mx is set to go (at $b), let 'er rip!</PRE
></BLOCKQUOTE
></P
><p class="para">Under versions V8.6 and earlier there was no default for this greeting message.
You had to define <code class="literal">$e</CODE
> in every configuration file. Beginning with
V8.7, <em class="emphasis">sendmail</EM
> now checks to see whether the <code class="literal">SmtpGreetingMessage</CODE
>
option was defined and uses that value if it was. Otherwise, it checks
to see whether the level of the configuration
file is 6 or less. If it is and if the <code class="literal">$e</CODE
> macro was defined
it uses that value. Otherwise, it uses the following default:</P
><p class="para"><blockquote class="screen"><pre class="screen">$j Sendmail $v ready at $b</PRE
></BLOCKQUOTE
></P
><p class="para">The forms for the <code class="literal">$e</CODE
> and <code class="literal">SmtpGreetingMessage</CODE
> are as follows:</P
><p class="para"><blockquote class="screen"><pre class="screen">De<code class="replaceable"><i>message</I
></CODE
>                                      <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8.6 and earlier</I
>
O SmtpGreetingMessage=<code class="replaceable"><i>message</I
></CODE
>                  <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (beginning with V8.7)</I
>
-OSmtpGreetingMessage=<code class="replaceable"><i>message</I
></CODE
>                  <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.7)</I
>
define(`confSMTP_LOGIN_MSG',<code class="replaceable"><i>message</I
></CODE
>)           <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 technique</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The <code class="literal">message</CODE
> is of type string and must be present. It must
contain, at minimum, the fully qualified name of the local host.</P
><p class="para">Note that in V8.1 through V8.6, <em class="emphasis">sendmail</EM
> always added the extra line</P
><p class="para"><blockquote class="screen"><pre class="screen">ESMTP spoken here</PRE
></BLOCKQUOTE
></P
><p class="para">to its initial greeting message.
Beginning with V8.7, <em class="emphasis">sendmail</EM
> instead inserts the word &quot;ESMTP&quot;
into the greeting message itself just after the fully qualified hostname.</P
><p class="para">The <code class="literal">SmtpGreetingMessage</CODE
> option is not safe.  If specified from the command line,
it may cause <em class="emphasis">sendmail</EM
> to relinquish its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-66">34.8.66 StatusFile (S)</A
></H3
><p class="refpurpose">Specify statistics file</P
>(All versions)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-46821"></A
><a class="indexterm" name="AUTOID-46824"></A
>At busy and complex mail sites, many different delivery agents are active.
For example, one kind of mail might be routed over the Internet
using the TCP delivery agent, while another might be routed via
the UUCP suite of programs, and yet another might be routed over a DS3 link to a group of research machines. In such circumstances, it
is useful to gather statistical information about the total
use to date of each delivery agent.</P
><p class="para">The <code class="literal">StatusFile</CODE
> (<code class="literal">S</CODE
>) option tells <em class="emphasis">sendmail</EM
> the name
of the file into which it should save those statistics. This
option does <em class="emphasis">not</EM
> cause statistics to be gathered. It merely
specifies the name of the file where they may be saved.
When <em class="emphasis">sendmail</EM
> runs, it
checks for the existence of such a file. If the file exists,
it opens and updates the statistics in the file. If the
file doesn't exist, <em class="emphasis">sendmail</EM
> quietly ignores statistics.
The statistics can be viewed by using the <em class="emphasis">mailstats</EM
>(8)
[32]
program (see <a class="xref" href="ch26_02.htm#SML2-CH-26-SECT-2-2" title="The sendmail.st File">Section 26.2.1, "The sendmail.st File"</A
>).</P
><blockquote class="footnote"><p class="para">[32] If you install V8 <em class="emphasis">sendmail</EM
> over an existing <em class="emphasis">sendmail</EM
> installation,
you need to also install the V8 <em class="emphasis">mailstats</EM
> program.</P
></BLOCKQUOTE
><p class="para">The forms of the <code class="literal">StatusFile</CODE
> (<code class="literal">S</CODE
>) option are as follows:</P
><p class="para"><blockquote class="screen"><pre class="screen">OS<code class="replaceable"><i>path                         </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (old form)</I
>
-oS<code class="replaceable"><i>path                        </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (old form)</I
>
O StatusFile=<code class="replaceable"><i>path              </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (beginning with V8.7)</I
>
-OStatusFile=<code class="replaceable"><i>path              </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.7)</I
>
define(`STATUS_FILE',`<code class="replaceable"><i>path</I
></CODE
>')   <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The optional argument <code class="replaceable"><i>path</I
></CODE
> is of type string. It may be
a relative or a full pathname. The default value for <code class="replaceable"><i>path</I
></CODE
>
is <em class="emphasis">sendmail.st</EM
>. 
Relative names are always relative to the queue directory.
If the entire option is missing, the value
for <code class="literal">path</CODE
> becomes the C language value NULL.
The default in configuring with the V8 <em class="emphasis">m4</EM
> technique varies
depending on your operating system.</P
><p class="para">The <code class="literal">S</CODE
> option is not safe.  If specified from the command line,
it may cause <em class="emphasis">sendmail</EM
> to relinquish its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-67">34.8.67 SuperSafe (s)</A
></H3
><p class="refpurpose">Queue everything just in case</P
>(All versions)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-46873"></A
><a class="indexterm" name="AUTOID-46875"></A
><a class="indexterm" name="AUTOID-46878"></A
><a class="indexterm" name="AUTOID-46881"></A
>At times, such as when calling <em class="emphasis">/bin/mail</EM
> to deliver local
mail, <em class="emphasis">sendmail</EM
> holds an entire message internally while
waiting for that delivery to complete. Clearly, this runs the risk
that the message will be lost if the system crashes at the wrong time.</P
><p class="para">As a safeguard against such rare catastrophes, the 
<code class="literal">SuperSafe</CODE
> (<code class="literal">s</CODE
>) option
can be used to force <em class="emphasis">sendmail</EM
> to queue
every message. The queued copy is left in place
until <em class="emphasis">sendmail</EM
> is sure that delivery was successful.
We recommend that this option always be declared as true.</P
><p class="para">The forms of the <code class="literal">SuperSafe</CODE
> (<code class="literal">s</CODE
>) option are as follows:</P
><p class="para"><blockquote class="screen"><pre class="screen">Os<code class="replaceable"><i>bool                          </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (old form)</I
>
-os<code class="replaceable"><i>bool                         </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (old form)</I
>
O SuperSafe=<code class="replaceable"><i>bool                </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (beginning with V8.7)</I
>
-OSuperSafe=<code class="replaceable"><i>bool                </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.7)</I
>
define(`confSAFE_QUEUE',<code class="replaceable"><i>bool</I
></CODE
>)   <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The argument <code class="replaceable"><i>bool</I
></CODE
> is of type Boolean. If it is missing, the
default value is true (everything is queued).
The default for the V8 <em class="emphasis">m4</EM
> configuration technique is also true.
If the entire <code class="literal">SuperSafe</CODE
> (<code class="literal">s</CODE
>) option is missing, the default becomes
false (no special queuing behavior).</P
><p class="para">The <code class="literal">SuperSafe</CODE
> (<code class="literal">s</CODE
>) option is safe.  Even if it is specified from the command line,
<em class="emphasis">sendmail</EM
> retains its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-68">34.8.68 TempFileMode (F)</A
></H3
><p class="refpurpose">Permissions for temporary files</P
>(All versions)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-46925"></A
><a class="indexterm" name="AUTOID-46927"></A
><a class="indexterm" name="AUTOID-46930"></A
>The <code class="literal">TempFileMode</CODE
> (<code class="literal">F</CODE
>) option tells <em class="emphasis">sendmail</EM
> what mode (file permissions)
to give its temporary files and its freeze file.
[33]
Because the files in the queue contain private email, this option
is usually set to the least permissive level, 0600. On dedicated
mail servers (hub machines), where logins are restricted to mail
managers, you may wish to relax permissions for easier problem
solving.</P
><blockquote class="footnote"><p class="para">[33] V8 <em class="emphasis">sendmail</EM
> no longer supports freeze files.</P
></BLOCKQUOTE
><p class="para">The forms of the <code class="literal">TempFileMode</CODE
> (<code class="literal">F</CODE
>) option are as follows:</P
><p class="para"><blockquote class="screen"><pre class="screen">OF<code class="replaceable"><i>mode                              </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (old mode)</I
>
-oF<code class="replaceable"><i>mode                             </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (old mode)</I
>
O TempFileMode=<code class="replaceable"><i>mode                 </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (beginning with V8.7)</I
>
-OTempFileMode=<code class="replaceable"><i>mode                 </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.7)</I
>
define(`confTEMP_FILE_MODE',<code class="replaceable"><i>mode</I
></CODE
>)   <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The <code class="replaceable"><i>mode</I
></CODE
> is of type octal.
If this option is entirely missing, the default permissions are 0644.
Beware of omitting just the <code class="replaceable"><i>mode</I
></CODE
> argument&nbsp;- if you do,
the permissions become 0000, and <em class="emphasis">sendmail</EM
> may not be able to
read or write its own files.</P
><p class="para">The <code class="literal">TempFileMode</CODE
> (<code class="literal">F</CODE
>) option is not safe.  If specified from the command line,
it may cause <em class="emphasis">sendmail</EM
> to relinquish its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-69">34.8.69 TimeZoneSpec (t)</A
></H3
><p class="refpurpose">Set time zone</P
>(All versions)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-46971"></A
><a class="indexterm" name="AUTOID-46973"></A
>Under System V UNIX, processes must look for the local time zone in
the environment variable <code class="literal">TZ</CODE
>. Because <em class="emphasis">sendmail</EM
>
is often run as an SUID <em class="emphasis">root</EM
> program, it cannot (and should not)
trust its environment variables. Consequently, on System V
machines it is necessary to use the <code class="literal">TimeZoneSpec</CODE
> (<code class="literal">t</CODE
>) option to give
<em class="emphasis">sendmail</EM
> the correct time zone information.</P
><p class="para">The forms for the <code class="literal">TimeZoneSpec</CODE
> (<code class="literal">t</CODE
>) option are as follows:</P
><p class="para"><blockquote class="screen"><pre class="screen">Ot<code class="replaceable"><i>zone                           </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (old mode)</I
>
-ot<code class="replaceable"><i>zone                          </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (old mode)</I
>
O TimeZoneSpec=<code class="replaceable"><i>zone              </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (beginning with V8.7)</I
>
-OTimeZoneSpec=<code class="replaceable"><i>zone              </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.7)</I
>
define(`confTIME_ZONE',`<code class="replaceable"><i>zone</I
></CODE
>')   <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">Here, the <code class="replaceable"><i>zone</I
></CODE
> is of type string and 
is usually three arguments in one:
[34]
the local abbreviation for standard time,
the number of hours the local time differs from GMT,
and the local abbreviation for daylight savings time.
For example, on the
west coast of the United States, you might declare</P
><blockquote class="footnote"><p class="para">[34] This is actually a convention that is not used by all versions of UNIX.
Consult your online documentation to find the correct form for your system.</P
></BLOCKQUOTE
><p class="para"><blockquote class="screen"><pre class="screen">OtPST8PDT                             <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> pre-V8.7 form</I
>
O TimeZoneSpec=PST8PDT                <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> beginning with V8.7</I
></PRE
></BLOCKQUOTE
></P
><p class="para">For pre-V8 <em class="emphasis">sendmail</EM
> on System V, if the <code class="replaceable"><i>zone</I
></CODE
> argument is
omitted or if this entire option is omitted, the default is the value compiled into your C language
library (often the east coast
of the United States, <code class="literal">EST5EDT</CODE
>). For BSD the default is NULL.</P
><p class="para">Beginning with V8 <em class="emphasis">sendmail</EM
>, if the entire <code class="literal">TimeZoneSpec</CODE
> (<code class="literal">t</CODE
>) option
is missing, the default is to unset the TZ environmental variable (use the
system default).
If <code class="replaceable"><i>zone</I
></CODE
> is missing, the
default is to import the TZ variable from the environment.
If <code class="replaceable"><i>zone</I
></CODE
> is present, time zone is set to that specified.</P
><p class="para">The system default varies depending on the operating
system. For BSD UNIX it is the value returned by the <em class="emphasis">gettimeofday</EM
>(3)
call. For SysV UNIX it is whatever was compiled into the C library (usually
New Jersey time).</P
><p class="para">For the <em class="emphasis">m4</EM
> declaration, <code class="literal">zone</CODE
> should be either a literal
USE_SYSTEM, which causes the entire option to be omitted, or a
literal USE_TZ, which causes the option to be declared but
the <code class="literal">zone</CODE
> to be omitted (thus importing the TZ variable
from the calling environment). Otherwise, a time zone declaration is as described above:</P
><p class="para"><blockquote class="screen"><pre class="screen">define(`confTIME_ZONE',`USE_SYSTEM')  <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> use system default</I
>
#O TimeZoneSpec=                      <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> the same </I
>

define(`confTIME_ZONE',`USE_TZ')      <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> use environment TZ</I
>
O TimeZoneSpec=                       <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> the same </I
>

define(`confTIME_ZONE',`EST5EDT')     <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> use EST5EDT</I
>
O TimeZoneSpec=EST5EDT                <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> the same</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The <code class="literal">TimeZoneSpec</CODE
> (<code class="literal">t</CODE
>) option is not safe.  If specified from the command line,
it may cause <em class="emphasis">sendmail</EM
> to relinquish its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-70">34.8.70 Timeout (r)</A
></H3
><p class="refpurpose">Set timeouts</P
>(All versions)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-47042"></A
><a class="indexterm" name="AUTOID-47044"></A
>Many events can take a long time to complete&nbsp;- so long, in fact, that they can cause
<em class="emphasis">sendmail</EM
> to appear to hang if they don't time out. 
For example,
when reading commands or data from a remote SMTP connection,
the other side can be so slow that it becomes
necessary for the local <em class="emphasis">sendmail</EM
> to time out and break
the connection. Similarly, when reading from its standard input,
<em class="emphasis">sendmail</EM
> may find that the program feeding it information
is taking so long that a timeout becomes necessary.</P
><p class="para">The V8 version of the <em class="emphasis">sendmail</EM
> program has introduced
defaults for the amount of time
it waits under various circumstances.
The forms of the <code class="literal">Timeout</CODE
> (<code class="literal">r</CODE
>) option are as follows:</P
><p class="para"><blockquote class="screen"><pre class="screen">Or<code class="replaceable"><i>time                                          </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (old form)</I
>
-or<code class="replaceable"><i>time                                         </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (old form)</I
>
Or<code class="replaceable"><i>keyword=value,...                             </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (V8.1)</I
>
-or<code class="replaceable"><i>keyword=value,...                            </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (V8.1)</I
>
O Timeout=<code class="replaceable"><i>keyword=value,...                     </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (V8.7 and above)</I
>
-OTimeout=<code class="replaceable"><i>keyword=value,...                     </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (V8.7 and above)</I
>
define(`confREAD_TIMEOUT',`<code class="replaceable"><i>keyword=value,...</I
></CODE
>')  <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 configuration (not V8.7 up)</I
></PRE
></BLOCKQUOTE
></P
><p class="para">Prior to V8 <em class="emphasis">sendmail</EM
>, only a single <code class="replaceable"><i>time</I
></CODE
> could be specified, which
set the timeout for all SMTP transactions.
Beginning with V8 <em class="emphasis">sendmail</EM
>, a list of <code class="replaceable"><i>keyword</I
></CODE
> and
<code class="replaceable"><i>value</I
></CODE
> pairs can be specified that individually set a wide 
assortment of timeouts.
The recognized <code class="literal">keyword</CODE
> words are listed in
<a class="xref" href="#SML2-CH-34-TAB-17" title="Timeout Option Keywords">Table 34.18</A
>.
The default and minimum 
<code class="replaceable"><i>value</I
></CODE
> for each in described in the individual section.</P
><table class="table"><caption class="table"><a class="title" name="SML2-CH-34-TAB-17">Table 34.18: Timeout Option Keywords</A
></CAPTION
><thead class="thead"><tr class="row" valign="TOP"><th class="entry" align="LEFT" rowspan="1" colspan="1">Keyword</TH
><th class="entry" align="LEFT" rowspan="1" colspan="1"></TH
><th class="entry" align="LEFT" rowspan="1" colspan="1">Meaning</TH
></TR
></THEAD
><tbody class="tbody"><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1">command</TD
><td class="entry" rowspan="1" colspan="1"><a class="xref" href="#SML2-CH-34-SECT-8-70-1" title="Timeout.command">Section 34.8.70.1</A
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Wait for the next command</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1">connect</TD
><td class="entry" rowspan="1" colspan="1"><a class="xref" href="#SML2-CH-34-SECT-8-70-2" title="Timeout.connect">Section 34.8.70.2</A
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Wait for <em class="emphasis">connect</EM
>(2) to return</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1">datablock</TD
><td class="entry" rowspan="1" colspan="1"><a class="xref" href="#SML2-CH-34-SECT-8-70-3" title="Timeout.datablock">Section 34.8.70.3</A
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Wait for each DATA block read</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1">datafinal</TD
><td class="entry" rowspan="1" colspan="1"><a class="xref" href="#SML2-CH-34-SECT-8-70-4" title="Timeout.datafinal">Section 34.8.70.4</A
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Wait for acknowledgment of final dot</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1">datainit</TD
><td class="entry" rowspan="1" colspan="1"><a class="xref" href="#SML2-CH-34-SECT-8-70-5" title="Timeout.datainit">Section 34.8.70.5</A
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Wait for DATA acknowledgment</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1">fileopen</TD
><td class="entry" rowspan="1" colspan="1"><a class="xref" href="#SML2-CH-34-SECT-8-70-6" title="Timeout.fileopen">Section 34.8.70.6</A
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Wait an NFS file to open (V8.7 and above)</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1">helo</TD
><td class="entry" rowspan="1" colspan="1"><a class="xref" href="#SML2-CH-34-SECT-8-70-7" title="Timeout.helo">Section 34.8.70.7</A
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Wait for HELO or EHLO</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1">hoststatus</TD
><td class="entry" rowspan="1" colspan="1"><a class="xref" href="#SML2-CH-34-SECT-8-70-8" title="Timeout.hoststatus">Section 34.8.70.8</A
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Duration of host status (V8.8 and above)</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1">iconnect</TD
><td class="entry" rowspan="1" colspan="1"><a class="xref" href="#SML2-CH-34-SECT-8-70-9" title="Timeout.iconnect">Section 34.8.70.9</A
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Wait for first <em class="emphasis">connect</EM
>(2) (V8.8 and above)</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1">ident</TD
><td class="entry" rowspan="1" colspan="1"><a class="xref" href="#SML2-CH-34-SECT-8-70-10" title="Timeout.ident">Section 34.8.70.10</A
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Wait for RFC1413 identification protocol</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1">initial</TD
><td class="entry" rowspan="1" colspan="1"><a class="xref" href="#SML2-CH-34-SECT-8-70-11" title="Timeout.initial">Section 34.8.70.11</A
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Wait for initial greeting message</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1">mail</TD
><td class="entry" rowspan="1" colspan="1"><a class="xref" href="#SML2-CH-34-SECT-8-70-12" title="Timeout.mail">Section 34.8.70.12</A
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Wait for MAIL acknowledgment</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1">misc</TD
><td class="entry" rowspan="1" colspan="1"><a class="xref" href="#SML2-CH-34-SECT-8-70-13" title="Timeout.misc">Section 34.8.70.13</A
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Wait for other SMTP commands</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1">queuereturn</TD
><td class="entry" rowspan="1" colspan="1"><a class="xref" href="#SML2-CH-34-SECT-8-70-14" title="Timeout.queuereturn">Section 34.8.70.14</A
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Bounce if still undelivered (V8.7 and above)</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1">queuewarn</TD
><td class="entry" rowspan="1" colspan="1"><a class="xref" href="#SML2-CH-34-SECT-8-70-15" title="Timeout.queuewarn">Section 34.8.70.15</A
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Warn if still undelivered (V8.7 and above)</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1">quit</TD
><td class="entry" rowspan="1" colspan="1"><a class="xref" href="#SML2-CH-34-SECT-8-70-16" title="Timeout.quit">Section 34.8.70.16</A
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Wait for QUIT acknowledgment</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1">rcpt</TD
><td class="entry" rowspan="1" colspan="1"><a class="xref" href="#SML2-CH-34-SECT-8-70-17" title="Timeout.rcpt">Section 34.8.70.17</A
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Wait for RCPT acknowledgment</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1">rset</TD
><td class="entry" rowspan="1" colspan="1"><a class="xref" href="#SML2-CH-34-SECT-8-70-18" title="Timeout.rset">Section 34.8.70.18</A
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Wait for RSET acknowledgment</P
></TD
></TR
></TBODY
></TABLE
><p class="para">&#13;The minimums are not enforced but are rather the minimums recommended
by RFC1123, section 5.3.2.
[35]
The <code class="replaceable"><i>value</I
></CODE
> is of type time.
The default,
if a unit character is omitted, is minutes.
For the <code class="literal">queuewarn</CODE
> and <code class="literal">queuereturn</CODE
> 
keywords, however, the defaults are hours and days, respectively.
Note that some of the default values may seem overly long. This is intentional
because some events can legitimately take a very long time. Consider, for example,
a misconfigured DNS server. If you time out too soon, your performance
will actually decrease because the timeouts will cause retransmits.</P
><blockquote class="footnote"><p class="para">[35] Note that the defaults are intentionally higher than the recommended
minimums. Setting timeouts too low can cause mail to fail unnecessarily.</P
></BLOCKQUOTE
><p class="para">For the V8.7 and above <em class="emphasis">m4</EM
> technique,
each keyword is declared with its corresponding <code class="literal">confTO</CODE
>_ expression.
For example, the keyword <code class="literal">initial</CODE
> is declared like this:</P
><p class="para"><blockquote class="screen"><pre class="screen">define(`confTO_INITIAL',`5m')                  <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The particular <code class="literal">confTO</CODE
>_ expression and its corresponding
default value are listed with each keyword.</P
><p class="para">For compatibility with old configuration files,
if no <code class="replaceable"><i>keyword</I
></CODE
><code class="literal">=</CODE
> is specified,
timeouts for the <code class="literal">mail</CODE
>, <code class="literal">rcpt</CODE
>,
<code class="literal">datainit</CODE
>, <code class="literal">datablock</CODE
>,
<code class="literal">datafinal</CODE
>, and <code class="literal">command</CODE
> keywords 
are set to the indicated value:</P
><p class="para"><blockquote class="screen"><pre class="screen">Or2h              <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> set them to two hours</I
></PRE
></BLOCKQUOTE
></P
><p class="para">An example of the <code class="literal">r</CODE
> option with <code class="replaceable"><i>keyword</I
></CODE
><code class="literal">=</CODE
> pairs
looks like this:</P
><p class="para"><blockquote class="screen"><pre class="screen">Orrcpt=25m,datablock=3h</PRE
></BLOCKQUOTE
></P
><p class="para">With the new V8.7 form of the <code class="literal">Timeout</CODE
> option, individual timeouts
can be listed more attractively like this:</P
><p class="para"><blockquote class="screen"><pre class="screen">O Timeout.rcpt      = 25m
O Timeout.datablock =  3h</PRE
></BLOCKQUOTE
></P
><p class="para">For the above two examples
the timeout for acknowledgment of the SMTP RCPT
command (list a recipient) is 25 minutes and 
the timeout for acknowledgment of receipt of each line
of the mail message is three hours; 
all the others that are not specified
assume the default values.</P
><p class="para">The <code class="literal">Timeout</CODE
> (<code class="literal">r</CODE
>) option is not safe.  If specified from the command line,
it may cause <em class="emphasis">sendmail</EM
> to relinquish its <em class="emphasis">root</EM
> privilege.</P
><div class="refsect2"><h4 class="refsect2"><a class="title" name="SML2-CH-34-SECT-8-70-1">34.8.70.1 Timeout.command</A
></H4
><p class="para">When local <em class="emphasis">sendmail</EM
> is running as an SMTP server,
it acknowledges any SMTP command sent
to it by the other host and then waits for the next command.
The amount of time the local <em class="emphasis">sendmail</EM
>
waits for each command is defined
with the <code class="literal">command</CODE
> keyword. The default is one hour, and
the minimum is specified as five minutes.
The <em class="emphasis">m4</EM
> technique should use <code class="literal">confTO_COMMAND</CODE
> for which
not default is defined.
If a command is not received in time, the local <em class="emphasis">sendmail</EM
>
believes that the connection has hung and shuts it down.&#13;</P
></DIV
><div class="refsect2"><h4 class="refsect2"><a class="title" name="SML2-CH-34-SECT-8-70-2">34.8.70.2 Timeout.connect</A
></H4
><p class="para">When <em class="emphasis">sendmail</EM
> attempts to establish a network connection
to another host, it uses the <em class="emphasis">connect</EM
>(2) system call.
If the connection is going to fail, that system call will
time out after an amount time that varies with the operating
system. With Linux, for example, the timeout is 90 minutes,
whereas for other versions of UNIX it is typically 5 minutes.</P
><p class="para">When the amount of time to wait for a connection to fail is
of concern, you may override the system value with the
<code class="literal">connect</CODE
> keyword to the <code class="literal">Timeout</CODE
> option:
[36]</P
><blockquote class="footnote"><p class="para">[36] Note that you can decrease the system defined timeout, but
you cannot increase it.</P
></BLOCKQUOTE
><p class="para"><blockquote class="screen"><pre class="screen">O Timeout.connect=3m		         <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8.8 and above</I
>
define(`confTO_CONNECT', 3m)	         <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 technique</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The default, if no timeout is specified, is to use the
system imposed timeout. No default is defined for the <em class="emphasis">m4</EM
> technique.</P
><p class="para">Note that if the <em class="emphasis">connect</EM
>(2) call times out, delivery
will be deferred until the next queue run. If you wish the
<em class="emphasis">connect</EM
>(2) to be tried again (as you might for
a dial-on-demand machine), you should investigate the
<code class="literal">DialDelay</CODE
> option (see <a class="xref" href="#SML2-CH-34-SECT-8-17" title="">Section 34.8.17</A
>).&#13;</P
></DIV
><div class="refsect2"><h4 class="refsect2"><a class="title" name="SML2-CH-34-SECT-8-70-3">34.8.70.3 Timeout.datablock</A
></H4
><p class="para">The local <em class="emphasis">sendmail</EM
> then buffers the mail message and sends it to the receiving
site one line at a time. The amount of time that the receiving <em class="emphasis">sendmail</EM
>
waits for a read to complete is set
with the <code class="literal">datablock</CODE
> keyword.
[37]
The default value is one hour, and the specified minimum is three minutes.
The <em class="emphasis">m4</EM
> technique should use <code class="literal">confTO_DATABLOCK</CODE
>, which has no default.&#13;</P
><blockquote class="footnote"><p class="para">[37] The timeout for writes by the sending <em class="emphasis">sendmail</EM
> are timed out on the basis of the number of recipients.</P
></BLOCKQUOTE
></DIV
><div class="refsect2"><h4 class="refsect2"><a class="title" name="SML2-CH-34-SECT-8-70-4">34.8.70.4 Timeout.datafinal</A
></H4
><p class="para">After the entire mail message has been transmitted, the local
<em class="emphasis">sendmail</EM
> sends a lone dot to say that it is done, then
waits for the receiving <em class="emphasis">sendmail</EM
> to acknowledge
acceptance of that dot:</P
><p class="para"><blockquote class="screen"><pre class="screen">250 Mail accepted</PRE
></BLOCKQUOTE
></P
><p class="para">The amount of time that the local <em class="emphasis">sendmail</EM
> waits for acknowledgment
that the mail message was received 
is set with the <code class="literal">datafinal</CODE
> keyword.
The default value is one hour, and the specified minimum is 10 minutes.
The <em class="emphasis">m4</EM
> technique should use <code class="literal">confTO_DATAFINAL</CODE
>, which has no default.
If the value is shorter than the time actually needed
for the receiving site to deliver the message, the local <em class="emphasis">sendmail</EM
>
times out before seeing the &quot;Mail accepted&quot; message when, in fact,
the mail was accepted. This can lead to the local <em class="emphasis">sendmail</EM
>
wrongly attempting to deliver the message later for a second time.&#13;</P
></DIV
><div class="refsect2"><h4 class="refsect2"><a class="title" name="SML2-CH-34-SECT-8-70-5">34.8.70.5 Timeout.datainit</A
></H4
><p class="para">After all the recipients have been specified, the local <em class="emphasis">sendmail</EM
>
declares that it is ready to send the mail message itself.
It issues the SMTP DATA command to the other site:</P
><p class="para"><blockquote class="screen"><pre class="screen">DATA</PRE
></BLOCKQUOTE
></P
><p class="para">The local <em class="emphasis">sendmail</EM
> then waits for acknowledgment, which
looks like this:</P
><p class="para"><blockquote class="screen"><pre class="screen">354 Enter mail, end with &quot;.&quot; on a line by itself</PRE
></BLOCKQUOTE
></P
><p class="para">The amount of time that the local <em class="emphasis">sendmail</EM
> waits for acknowledgment
of its DATA command is set with the <code class="literal">datainit</CODE
> keyword. The default
value is five minutes, and the specified minimum is two minutes.

The <em class="emphasis">m4</EM
> technique should use <code class="literal">confTO_DATAINIT</CODE
>, which has no default.&#13;</P
></DIV
><div class="refsect2"><h4 class="refsect2"><a class="title" name="SML2-CH-34-SECT-8-70-6">34.8.70.6 Timeout.fileopen</A
></H4
><p class="para">If a directory is remotely mounted and the server is down
or not responding, an attempt to open a file in that directory
can hang. Beginning with V8.7, the
<code class="literal">fileopen</CODE
> keyword sets the amount of time
to wait for a remote open to complete.
[38]
The default is zero seconds, which sets no limit.
The <em class="emphasis">m4</EM
> technique should use <code class="literal">confTO_FILEOPEN</CODE
>, which has no default.&#13;</P
><blockquote class="footnote"><p class="para">[38] Note that this works only if the file system is mounted with
the <code class="literal">intr</CODE
> mount option.</P
></BLOCKQUOTE
></DIV
><div class="refsect2"><h4 class="refsect2"><a class="title" name="SML2-CH-34-SECT-8-70-7">34.8.70.7 Timeout.helo</A
></H4
><p class="para">After the greeting, the local <em class="emphasis">sendmail</EM
> sends a HELO (or EHLO to get
ESMTP) message to
identify itself. That message looks something like this:</P
><p class="para"><blockquote class="screen"><pre class="screen">HELO here.us.edu</PRE
></BLOCKQUOTE
></P
><p class="para">The other site then replies with acknowledgment of the local HELO or EHLO:</P
><p class="para"><blockquote class="screen"><pre class="screen">250 there.dc.gov  Hello here.us.edu, pleased to meet you</PRE
></BLOCKQUOTE
></P
><p class="para">The amount of time the local <em class="emphasis">sendmail</EM
> waits for the other
site to acknowledge the local HELO or EHLO is set with the <code class="literal">helo</CODE
> keyword.
The default value is five minutes. There is no specified minimum,
but we recommend no less than five minutes (because some sites use
DNS to validate the hostname).
The <em class="emphasis">m4</EM
> technique should use <code class="literal">confTO_HELO</CODE
>, which has no default.</P
></DIV
><div class="refsect2"><h4 class="refsect2"><a class="title" name="SML2-CH-34-SECT-8-70-8">34.8.70.8 Timeout.hoststatus</A
></H4
><p class="para">When processing the queue, <em class="emphasis">sendmail</EM
> saves the connection status of
each host to which it connects and each host to which it fails to connect. It does this
because an unsuccessful host should not be tried again during
the same queue run. This makes sense when you consider that failures
tend to remain failures for a while.</P
><p class="para">At sites that process huge queues, on the other hand, such behavior may
not be appropriate. If it takes hours (rather than minutes) to process
the queue, the likelihood increases that a previously failed connection
may succeed. For such sites, V8.8 <em class="emphasis">sendmail</EM
> has introduced
the <code class="literal">Timeout.hoststatus</CODE
> option:</P
><p class="para"><blockquote class="screen"><pre class="screen">O Timeout.hoststatus=<code class="replaceable"><i>interval                  	</I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8.8 and above</I
>
-OTimeout.hoststatus=<code class="replaceable"><i>interval			</I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8.8 and above</I
>
define(`confTO_HOSTSTATUS', <code class="replaceable"><i>interval</I
></CODE
>)		<i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 techniqueue</I
></PRE
></BLOCKQUOTE
></P
><p class="para">Here, <code class="replaceable"><i>interval</I
></CODE
> is of type time. 
If <code class="replaceable"><i>interval</I
></CODE
> is present, it specifies the length of time information
about a host will be considered valid.  If a queue run finishes faster than this interval,
it has no effect. But when queue runs take longer than this interval,
a previously down host will be given a second try if it appears in the
queue again.</P
><p class="para">If <code class="replaceable"><i>interval</I
></CODE
> is missing, it is interpreted as zero, and no host
information is ever saved. If the entire option is missing, the default
is 30 minutes.
The <em class="emphasis">m4</EM
> technique should use <code class="literal">confTO_HOSTSTATUS</CODE
>, which has no default.&#13;</P
></DIV
><div class="refsect2"><h4 class="refsect2"><a class="title" name="SML2-CH-34-SECT-8-70-9">34.8.70.9 Timeout.iconnect</A
></H4
><p class="para">When <em class="emphasis">sendmail</EM
> attempts to establish a network connection
to another host, it uses the <em class="emphasis">connect</EM
>(2) system call.
If the connection is going to fail, that system call will
time out after an amount of time that varies with the operating
system. You can override the system timeout with the 

<code class="literal">connect</CODE
> keyword (see <a class="xref" href="#SML2-CH-34-SECT-8-70-2" title="Timeout.connect">Section 34.8.70.2</A
>) 
to the <code class="literal">Timeout</CODE
> option.</P
><p class="para">When outgoing mail is first processed, mail to responsive
hosts should precede mail to sluggish hosts. To understand
why, consider that all mail is processed serially during each queue run.
If a sluggish host precedes all the other hosts in the queue, those
other hosts will not even be tried until the sluggish host finishes
or times out.
With this in mind, the very first time <em class="emphasis">sendmail</EM
> attempts
to deliver a message, it should enforce a shorter <em class="emphasis">connect</EM
>(2)
timeout than it should for latter attempts.</P
><p class="para">Beginning with V8.8 <em class="emphasis">sendmail</EM
>, you can set an initial
<em class="emphasis">connect</EM
>(2) timeout with the <code class="literal">iconnect</CODE
> keyword
to the <code class="literal">Timeout</CODE
> option:</P
><p class="para"><blockquote class="screen"><pre class="screen">O Timeout.iconnect=10s              <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> time out first connection</I
>
O Timeout.connect=3m                <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> time out all others</I
>

define(`confTO_ICONNECT', `10s')    <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> v8 m4 technique</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The default, if no <code class="literal">Timeout.iconnect</CODE
> is specified or if the entire
<code class="literal">Timeout.iconnect</CODE
> option is omitted, is to time out the first connection
the same as the timeout for all connections.
The <em class="emphasis">m4</EM
> technique should use <code class="literal">confTO_ICONNECT</CODE
>, for which there is no default.
The <code class="literal">N</CODE
> line in the <code class="literal">qf</CODE
> file (see <a class="xref" href="ch23_09.htm" title="">Section 23.9.10</A
>)
determines whether this is the first attempt or not. If the value in that line
is zero, this is the first delivery attempt.&#13;</P
></DIV
><div class="refsect2"><h4 class="refsect2"><a class="title" name="SML2-CH-34-SECT-8-70-10">34.8.70.10 Timeout.ident</A
></H4
><p class="para">The <em class="emphasis">sendmail</EM
> daemon queries every outside connecting host with the
RFC1413 identification protocol to record the identity
of the user at the other end who made the connection and to verify
the true name of the remote connecting host.
The default timeout is to wait 30 seconds for a response.
The <code class="literal">ident</CODE
> keyword is used to change this timeout.
If your site accepts mail from PCs running SMTP
software, you may need to
disable this feature.
Some PCs get stuck
when queried with the RFC1413 identification protocol.
If the timeout is zero, the ident protocol is disabled.
The <em class="emphasis">m4</EM
> technique should use <code class="literal">confTO_IDENT</CODE
>, for which there
is no default.&#13;</P
></DIV
><div class="refsect2"><h4 class="refsect2"><a class="title" name="SML2-CH-34-SECT-8-70-11">34.8.70.11 Timeout.initial</A
></H4
><p class="para">The amount of time to wait for the initial greeting message. This
message is printed by the remote site when it first makes
its connection. The greeting message always starts with 220 and
looks something like this:</P
><p class="para"><blockquote class="screen"><pre class="screen">220 there.dc.gov Sendmail 8.1/3x ready at ...</PRE
></BLOCKQUOTE
></P
><p class="para">&#13;The default for the greeting wait and the recommended minimum are both
five minutes.
[39]
The <em class="emphasis">m4</EM
> technique should use <code class="literal">confTO_INITIAL</CODE
>, for which
there is no default.&#13;</P
><blockquote class="footnote"><p class="para">[39] Because DNS name resolution can time out and retry and can actually
take up to five minutes!</P
></BLOCKQUOTE
></DIV
><div class="refsect2"><h4 class="refsect2"><a class="title" name="SML2-CH-34-SECT-8-70-12">34.8.70.12 Timeout.mail</A
></H4
><p class="para">The local <em class="emphasis">sendmail</EM
> next sends the address of the sender (the
envelope sender address) with an SMTP MAIL command:</P
><p class="para"><blockquote class="screen"><pre class="screen">MAIL From:&lt;you@here.us.edu&gt;</PRE
></BLOCKQUOTE
></P
><p class="para">The local <em class="emphasis">sendmail</EM
> then waits for acknowledgment, which
looks like this:</P
><p class="para"><blockquote class="screen"><pre class="screen">250 &lt;you@here.us.edu&gt;... Sender ok</PRE
></BLOCKQUOTE
></P
><p class="para">The amount of time that the local <em class="emphasis">sendmail</EM
> waits for acknowledgment
of its MAIL command is set with the <code class="literal">mail</CODE
> keyword. The default
value is 10 minutes, and the specified minimum is five minutes.
The <em class="emphasis">m4</EM
> technique should use <code class="literal">confTO_MAIL</CODE
>, for which there
is no default.&#13;</P
></DIV
><div class="refsect2"><h4 class="refsect2"><a class="title" name="SML2-CH-34-SECT-8-70-13">34.8.70.13 Timeout.misc</A
></H4
><p class="para">During the course of mail transfer, the local <em class="emphasis">sendmail</EM
> may
issue short miscellaneous commands. Examples are NOOP (which
stands for no operation) and VERB (which tells the other
side to enter verbose mode).
The time that the local <em class="emphasis">sendmail</EM
>
waits for acknowledgment of these miscellaneous commands is defined
with the <code class="literal">misc</CODE
> keyword. The default is two minutes, and
no minimum is specified.
The <em class="emphasis">m4</EM
> technique should use <code class="literal">confTO_MISC</CODE
>, for which there
is no default.&#13;</P
></DIV
><div class="refsect2"><h4 class="refsect2"><a class="title" name="SML2-CH-34-SECT-8-70-14">34.8.70.14 Timeout.queuereturn</A
></H4
><p class="para">That this keyword
determines a mail message's lifetime in the queue. 
Beginning with V8.7, this <code class="literal">queuereturn</CODE
> keyword is used to set the amount
of time a message must wait in the queue before it is bounced as nondeliverable.
Either it can be expressed as an interval of time:</P
><p class="para"><blockquote class="screen"><pre class="screen">O Timeout.queuereturn=5d
O Timeout.queuereturn.*=5d          <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> the same</I
>
define(`confTO_QUEUERETURN',`5d')   <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 technique</I
></PRE
></BLOCKQUOTE
></P
><p class="para">or it can be tuned on the basis of any of three possible levels
of priority that a mail message may have. That is, both of the above
set all three levels to five days, whereas the following tunes each
level to three, five, and six days, respectively:</P
><p class="para"><blockquote class="screen"><pre class="screen">O Timeout.queuereturn.urgent=3d
O Timeout.queuereturn.normal=5d
O Timeout.queuereturn.non-urgent=6d
define(`confTO_QUEUERETURN_URGENT',`3d')       <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 technique</I
>
define(`confTO_QUEUERETURN_NORMAL',`5d')       <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 technique</I
>
define(`confTO_QUEUERETURN_NONURGENT',`6d')    <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 technique</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The default for the <em class="emphasis">m4</EM
> configuration technique is to bounce all messages
that remain in the queue for more than four days.</P
><p class="para">The keywords <code class="literal">urgent</CODE
>, <code class="literal">normal</CODE
>, and <code class="literal">non-urgent</CODE
> correspond to the <code class="literal">Precedence:</CODE
> header from the mail message. When the numeric equivalent of the <code class="literal">Precedence:</CODE
> header as translated from the <code class="literal">P</CODE
> line of the configuration file (see <a class="xref" href="ch35_08.htm#SML2-CH-35-SECT-8-1" title="Precedence">Section 35.8</A
>) is negative, the message is classified as nonurgent. When it is greater than zero, the message is classified as urgent. Otherwise, it is normal.</P
><p class="para">In addition to a message's precedence, a new <code class="literal">Priority:</CODE
>
header is available (see <a class="xref" href="ch35_10.htm" title="">Section 35.10.24, Priority:</A
>)
to specify the message priority and thereby
bypass the value obtained from the <code class="literal">Precedence:</CODE
> header.</P
><p class="para"><blockquote class="screen"><pre class="screen">Priority: urgent
Priority: normal
Priority: non-urgent</PRE
></BLOCKQUOTE
></P
><p class="para">There is currently no way to specify a <code class="literal">Priority:</CODE
>
header's value from the <em class="emphasis">sendmail</EM
> command line.&#13;</P
></DIV
><div class="refsect2"><h4 class="refsect2"><a class="title" name="SML2-CH-34-SECT-8-70-15">34.8.70.15 Timeout.queuewarn</A
></H4
><p class="para">When a message is queued, <em class="emphasis">sendmail</EM
> sends a message to the
sender explaining that the original message could not be
delivered right away and that <em class="emphasis">sendmail</EM
> will keep trying.
Beginning with V8.7, this <code class="literal">queuewarn</CODE
> keyword is used to set the amount
of time a message must wait in the queue before that explanation
is mailed. Either it can be expressed as an interval of time:</P
><p class="para"><blockquote class="screen"><pre class="screen">O Timeout.queuewarn=4d
O Timeout.queuewarn.*=4d          <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> the same</I
>
define(`confTO_QUEUEWARN',`4d')   <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 technique</I
></PRE
></BLOCKQUOTE
></P
><p class="para">or it can be tuned on the basis of any of three possible levels
of priority a mail message may have. That is, both of the above
set all three levels to four days, whereas the following tunes each
level to one, two, and four days, respectively:</P
><p class="para"><blockquote class="screen"><pre class="screen">O Timeout.queuewarn.urgent=1d
O Timeout.queuewarn.normal=2d
O Timeout.queuewarn.non-urgent=4d
define(`confTO_QUEUEWARN_URGENT',`1d')       <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 technique</I
>
define(`confTO_QUEUEWARN_NORMAL',`2d')       <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 technique</I
>
define(`confTO_QUEUEWARN_NONURGENT',`4d')    <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 technique</I
></PRE
></BLOCKQUOTE
></P
><p class="para">&#13;The defaults for the <em class="emphasis">m4</EM
> configuration technique are to send a warning
for normal mail after four hours, for urgent mail after one hour, and
for nonurgent mail after twelve hours.</P
><p class="para">The keywords <code class="literal">urgent</CODE
>, <code class="literal">normal</CODE
>, and <code class="literal">non-urgent</CODE
> correspond to the <code class="literal">Precedence:</CODE
> header from the mail message. When the numeric equivalent of the <code class="literal">Precedence:</CODE
> header as translated from the <code class="literal">P</CODE
> line of the configuration file (see <a class="xref" href="ch35_08.htm#SML2-CH-35-SECT-8-1" title="Precedence">Section 35.8</A
>) is negative, the message is classified as nonurgent. When it is greater than zero, the message is classified as urgent. Otherwise, it is normal.</P
><p class="para">In addition to a message's precedence, a new <code class="literal">Priority:</CODE
>
header is available (see <a class="xref" href="ch35_10.htm" title="">Section 35.10.24</A
>)
to specify the message priority and thereby
bypass the value obtained from the <code class="literal">Precedence:</CODE
> header:</P
><p class="para"><blockquote class="screen"><pre class="screen">Priority: urgent
Priority: normal
Priority: non-urgent</PRE
></BLOCKQUOTE
></P
><p class="para">There is currently no way to specify a <code class="literal">Priority:</CODE
>
header's value from the <em class="emphasis">sendmail</EM
> command line.&#13;</P
></DIV
><div class="refsect2"><h4 class="refsect2"><a class="title" name="SML2-CH-34-SECT-8-70-16">34.8.70.16 Timeout.quit</A
></H4
><p class="para">When the local <em class="emphasis">sendmail</EM
> is finished and wishes to break the
connection, it sends the SMTP QUIT command.</P
><p class="para"><blockquote class="screen"><pre class="screen">QUIT</PRE
></BLOCKQUOTE
></P
><p class="para">The other side acknowledges, and the connection is terminated:</P
><p class="para"><blockquote class="screen"><pre class="screen">221 there.dc.gov delivering mail</PRE
></BLOCKQUOTE
></P
><p class="para">The time the local <em class="emphasis">sendmail</EM
>
waits for acknowledgment of the QUIT command is defined
with the <code class="literal">quit</CODE
> keyword. The default is two minutes, and
no minimum is specified.
The <em class="emphasis">m4</EM
> technique should use <code class="literal">confTO_QUIT</CODE
>, for which there
is no default.&#13;</P
></DIV
><div class="refsect2"><h4 class="refsect2"><a class="title" name="SML2-CH-34-SECT-8-70-17">34.8.70.17 Timeout.rcpt</A
></H4
><p class="para">Next, the local <em class="emphasis">sendmail</EM
> issues one RCPT command to specify
each envelope recipient. One such RCPT line might look like this:</P
><p class="para"><blockquote class="screen"><pre class="screen">RCPT To:&lt;them@there.dc.gov&gt;</PRE
></BLOCKQUOTE
></P
><p class="para">The local <em class="emphasis">sendmail</EM
> then waits for acknowledgment, which
looks like this:</P
><p class="para"><blockquote class="screen"><pre class="screen">250 &lt;them@there.dc.gov&gt;... Recipient ok</PRE
></BLOCKQUOTE
></P
><p class="para">&#13;The amount of time that the local <em class="emphasis">sendmail</EM
> waits for acknowledgment
of each RCPT command is set with the <code class="literal">rcpt</CODE
> keyword. The default
value is one hour,
[40]
and the specified minimum is five minutes.
The <em class="emphasis">m4</EM
> technique should use <code class="literal">confTO_RCPT</CODE
>, for which there
is no default.&#13;</P
><blockquote class="footnote"><p class="para">[40] This timeout should be generously long because a recipient
may be the name of a mailing list and the other side may take
a long time to expand all the names in that list before replying.</P
></BLOCKQUOTE
></DIV
><div class="refsect2"><h4 class="refsect2"><a class="title" name="SML2-CH-34-SECT-8-70-18">34.8.70.18 Timeout.rset</A
></H4
><p class="para">If connection caching is enabled (see option <code class="literal">k</CODE
>),
the local <em class="emphasis">sendmail</EM
> sends
an SMTP RSET command to reset the other side.
The time the local <em class="emphasis">sendmail</EM
>
waits for acknowledgment of the RSET command is defined
with the <code class="literal">rset</CODE
> keyword. The default is five minutes, and
no minimum is specified.
The <em class="emphasis">m4</EM
> technique should use <code class="literal">confTO_RSET</CODE
>, for which there is no default.</P
></DIV
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-71">34.8.71 TryNullMXList (w)</A
></H3
><p class="refpurpose">Use A if no best MX record</P
>(V8.1 and above)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-47540"></A
><a class="indexterm" name="AUTOID-47542"></A
><a class="indexterm" name="AUTOID-47544"></A
>RFC974 says that when mail is being sent from a host
that is an MX record for the receiving host,
all MX records of a preference equal to or greater than the sending
host must be discarded.
In some circumstances this can leave no usable MX records.
In this absence, V8 <em class="emphasis">sendmail</EM
> bases its action on the setting
of its <code class="literal">TryNullMXList</CODE
> (<code class="literal">w</CODE
>) option.</P
><p class="para">The forms of the <code class="literal">TryNullMXList</CODE
> (<code class="literal">w</CODE
>) option are as follows:</P
><p class="para"><blockquote class="screen"><pre class="screen">Ow<code class="replaceable"><i>bool                                </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (V8.6)</I
>
-ow<code class="replaceable"><i>bool                               </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (V8.6)</I
>
O TryNullMXList=<code class="replaceable"><i>bool                  </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (beginning with V8.7)</I
>
-OTryNullMXList=<code class="replaceable"><i>bool                  </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.7)</I
>
define(`confTRY_NULL_MX_LIST',<code class="replaceable"><i>bool</I
></CODE
>)   <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The <code class="literal">bool</CODE
> is of type Boolean.
If it is false, <em class="emphasis">sendmail</EM
> bounces the mail message with 
the following error message:</P
><p class="para"><blockquote class="screen"><pre class="screen">MX list for <i class="lineannotation">otherhost</I
> points back to <i class="lineannotation">thishost</I
></PRE
></BLOCKQUOTE
></P
><p class="para">If it is true, <em class="emphasis">sendmail</EM
> looks to see whether the receiving host has an
A record. If it does, V8 <em class="emphasis">sendmail</EM
> 
tries to deliver the mail message
directly to that host's A record address. If the host doesn't have an A record, 
<em class="emphasis">sendmail</EM
> bounces the message.
See <a class="xref" href="ch21_03.htm#SML2-CH-21-SECT-3-1" title="Ambiguous MX Records">Section 21.3.7, "Ambiguous MX Records"</A
> in <a class="xref" href="ch21_01.htm" title="DNS and sendmail">Chapter 21, <cite class="chapter">DNS and sendmail</CITE
></A
>,
for a full discussion of why one setting may be preferable over the other.
The default with the V8 <em class="emphasis">m4</EM
> configuration technique is false.</P
><p class="para">The <code class="literal">TryNullMXList</CODE
> (<code class="literal">w</CODE
>) option is not safe as of V8.8.4. If it is specified from the command line, may cause <em class="emphasis">sendmail</EM
> to relinquish its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-72">34.8.72 UnixFromLine or $l</A
></H3
><p class="refpurpose">Define the From format</P
>(All versions)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-47592"></A
><a class="indexterm" name="AUTOID-47595"></A
><a class="indexterm" name="AUTOID-47597"></A
>The <code class="literal">UnixFromLine</CODE
> option replaces the pre-V8.7 <code class="literal">$l</CODE
> macro.
It has two functions:</P
><ul class="itemizedlist"><li class="listitem"><p class="para">It defines the look of the five character &quot;<code class="literal">From&nbsp;</CODE
>&quot;  
header line needed by UUCP software.</P
></LI
><li class="listitem"><p class="para">It defines the format of the line that is used to separate one message
from another in a file of many mail messages.</P
></LI
></UL
><p class="para">The forms of the <code class="literal">UnixFromLine</CODE
> option and <code class="literal">$l</CODE
> macro
are as follows:</P
><p class="para"><blockquote class="screen"><pre class="screen">Dl<code class="replaceable"><i>format</I
></CODE
>                           <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (V8.6 and earlier)</I
>
O UnixFromLine=<code class="replaceable"><i>format</I
></CODE
>              <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (beginning with V8.7)</I
>
-OUnixFromLine=<code class="replaceable"><i>format</I
></CODE
>              <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.7)</I
>
define(`confFROM_LINE',`<code class="replaceable"><i>format</I
></CODE
>')   <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The <code class="literal">format</CODE
> is of type string.
Under versions V8.6 and earlier there was no default for <code class="replaceable"><i>format</I
></CODE
>. So
the <code class="literal">$l</CODE
> macro always had to be defined.
Beginning with V8.7, <em class="emphasis">sendmail</EM
> first checks to see if the <code class="literal">UnixFromLine</CODE
>
option was defined and uses that value if it was. Otherwise, it checks
to see whether the level of the configuration
file is 6 or less. If it is and if the <code class="literal">$l</CODE
> macro was defined,
it uses that value. Otherwise, it uses the default</P
><p class="para"><blockquote class="screen"><pre class="screen">From $g  $d</PRE
></BLOCKQUOTE
></P
><p class="para">The <code class="literal">UnixFromLine</CODE
> option is not safe.
If specified from the command line,
it may cause <em class="emphasis">sendmail</EM
> to relinquish its <em class="emphasis">root</EM
> privilege.</P
><div class="refsect2"><h4 class="refsect2"><a class="title" name="SML2-CH-34-SECT-8-72-1">34.8.72.1 UnixFromLine in UUCP software</A
></H4
><p class="para">UUCP software requires all messages to begin with a header line
that looks like</P
><p class="para"><blockquote class="screen"><pre class="screen">From <code class="replaceable"><i>sender</I
></CODE
>  <code class="replaceable"><i>date</I
></CODE
> remote from &lt;<code class="replaceable"><i>host</I
></CODE
>&gt;</PRE
></BLOCKQUOTE
></P
><p class="para">The <em class="emphasis">sendmail</EM
> program prepends such a line to a mail message's
headers if the <code class="literal">F=U</CODE
> flag (see <a class="xref" href="ch30_08.htm" title="">Section 30.8.42, F=U</A
>) 
is set for the delivery agent.
[41]
Prior to V8.7,
if the local machine supports UUCP,
the <code class="literal">l</CODE
> macro must be supplied with
&quot;<code class="literal">From&nbsp;</CODE
>&quot;, <code class="replaceable"><i>sender</I
></CODE
>, and <code class="replaceable"><i>date</I
></CODE
>:</P
><blockquote class="footnote"><p class="para">[41] Prior to V8.7 this
behavior was supported only if UGLYUUCP was defined in <em class="emphasis">conf.h</EM
>
when <em class="emphasis">sendmail</EM
> was compiled.</P
></BLOCKQUOTE
><p class="para"><blockquote class="screen"><pre class="screen">DlFrom $g $d</PRE
></BLOCKQUOTE
></P
><p class="para">The rest of the information is supplied by <em class="emphasis">sendmail</EM
>.</P
></DIV
><div class="refsect2"><h4 class="refsect2"><a class="title" name="SML2-CH-34-SECT-8-72-2">34.8.72.2 UnixFromLine with mail files</A
></H4
><p class="para">Under UNIX, in a file of many mail messages such as a user's mailbox,
lines that begin with the five characters &quot;<code class="literal">From&nbsp;</CODE
>&quot; are
used to separate one message from another. This is a convention that
is not shared by all MUAs. The <em class="emphasis">sendmail</EM
> program
appends mail messages to files under only two circumstances: when
saving failed mail to the user's <em class="emphasis">dead-letter</EM
> file and when
delivering to a local address that begins with the <code class="literal">/</CODE
>
character. In appending messages to files, it uses
the <code class="literal">UnixFromLine</CODE
> (<code class="literal">$l</CODE
>) option
to define the form of the message separator lines.</P
><p class="para">For sites that use the Rand MUA (and that do
not also use UUCP) the <code class="literal">UnixFromLine</CODE
> (<code class="literal">$l</CODE
>) option
can be defined to be four CTRL-A characters:</P
><p class="para"><blockquote class="screen"><pre class="screen">Dl^A^A^A^A
O UnixFromLine=^A^A^A^A</PRE
></BLOCKQUOTE
></P
></DIV
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-73">34.8.73 UnsafeGroupWrites</A
></H3
><p class="refpurpose">Check unsafe group permissions</P
>(V8.8 and above)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-47679"></A
><a class="indexterm" name="AUTOID-47681"></A
><a class="indexterm" name="AUTOID-47684"></A
><a class="indexterm" name="AUTOID-47686"></A
>In processing a <em class="emphasis">~/.forward</EM
> file or a <em class="emphasis">:include:</EM
> file,
a question arises when group or world write permission is enabled.
Should <em class="emphasis">sendmail</EM
> trust the addresses found in such files?
Clearly the answer is &quot;no&quot; when world write permission is enabled.
But what of group write permission?</P
><p class="para">Beginning with V8.8 <em class="emphasis">sendmail</EM
>, the decision of whether or
not to trust group write permission is left to the <code class="literal">UnsafeGroupWrites</CODE
>
option:</P
><p class="para"><blockquote class="screen"><pre class="screen">O UnsafeGroupWrites=<code class="replaceable"><i>bool                 </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (beginning with V8.8)</I
>
-OUnsafeGroupWrites=<code class="replaceable"><i>bool                 </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.8)</I
>
define(`confUNSAFE_GROUP_WRITES',<code class="replaceable"><i>bool</I
></CODE
>)   <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The optional argument <code class="replaceable"><i>bool</I
></CODE
>, when missing, defaults to true (check
for unsafe group write permission).
If this option is entirely missing, it defaults to false
(don't check for unsafe group write permission).</P
><p class="para">With this option set to true, a <em class="emphasis">~/.forward</EM
> file or a <em class="emphasis">:include:</EM
> file
with group or world writability will result in one of these four errors
being logged:</P
><p class="para"><blockquote class="screen"><pre class="screen"><code class="replaceable"><i>filename</I
></CODE
>: group writable forward file, marked unsafe
<code class="replaceable"><i>filename</I
></CODE
>: world writable forward file, marked unsafe
<code class="replaceable"><i>filename</I
></CODE
>: group writable include file, marked unsafe
<code class="replaceable"><i>filename</I
></CODE
>: world writable include file, marked unsafe</PRE
></BLOCKQUOTE
></P
><p class="para">Any address in the file that is a file or a program will
result in a bounce and this message:</P
><p class="para"><blockquote class="screen"><pre class="screen">Address <code class="replaceable"><i>address</I
></CODE
> is unsafe for mailing to programs
Address <code class="replaceable"><i>address</I
></CODE
> is unsafe for mailing to files</PRE
></BLOCKQUOTE
></P
><p class="para">&#13;The <code class="literal">UnsafeGroupWrites</CODE
> option is not safe.  If specified from the command line,
it may cause <em class="emphasis">sendmail</EM
> to relinquish its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-74">34.8.74 UseErrorsTo (l)</A
></H3
><p class="refpurpose">Use Errors-To: for errors</P
>(V8.1 and above)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-47731"></A
><a class="indexterm" name="AUTOID-47733"></A
>Ordinarily, V8 <em class="emphasis">sendmail</EM
> sends notification of failed mail
to the envelope sender. It specifically does not send notification
to the addresses listed in the <code class="literal">Errors-To:</CODE
> header.
It does this because the <code class="literal">Errors-To:</CODE
> header violates RFC1123.
For additional information about the <code class="literal">Errors-To:</CODE
> header,
see <a class="xref" href="ch35_10.htm" title="">Section 35.10.13, Errors-To:</A
>.</P
><p class="para">The <code class="literal">UseErrorsTo</CODE
> (<code class="literal">l</CODE
>) option is available to prevent older versions
of software from failing. When set, it allows error notification
to be sent to the address listed in the <code class="literal">Errors-To:</CODE
> header
in addition to that sent to the envelope sender.</P
><p class="para">The forms of the <code class="literal">UseErrorsTo</CODE
> (<code class="literal">l</CODE
>) option are as follows:</P
><p class="para"><blockquote class="screen"><pre class="screen">Ol<code class="replaceable"><i>bool                             </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (old form)</I
>
-ol<code class="replaceable"><i>bool                            </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (old form)</I
>
O UseErrorsTo=<code class="replaceable"><i>bool                 </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (beginning with V8.7)</I
>
-OUseErrorsTo=<code class="replaceable"><i>bool                 </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.7)</I
>
define(`confUSE_ERRORS_TO',<code class="replaceable"><i>bool</I
></CODE
>)   <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The optional argument <code class="replaceable"><i>bool</I
></CODE
>, when missing, defaults to true (errors
are sent to the <code class="literal">Errors-To:</CODE
> header).
If this option is entirely missing, it defaults to false (the <code class="literal">Errors-To:</CODE
> header
is ignored).</P
><p class="para">The <code class="literal">UseErrorsTo</CODE
> (<code class="literal">l</CODE
>) option is safe.  Even if it is specified from the command line,
<em class="emphasis">sendmail</EM
> retains its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-75">34.8.75 UserDatabaseSpec (U)</A
></H3
><p class="refpurpose">Specify user database</P
>(V8.1 and above)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-47776"></A
><a class="indexterm" name="AUTOID-47778"></A
><a class="indexterm" name="AUTOID-47780"></A
>V8 <em class="emphasis">sendmail</EM
>, if compiled with USERDB defined (see
<a class="xref" href="ch18_08.htm" title="">Section 18.8.54, USERDB</A
>), can use
a special, internally understood database called
the User Database. Addresses that are defined in the User Database can
be looked up and modified after aliasing and before processing
of the user's <em class="emphasis">~/.forward</EM
> file.</P
><p class="para">The workings of this database are
described in <a class="xref" href="ch33_05.htm" title="The User Database">Section 33.5, "The User Database"</A
>.
The <code class="literal">UserDatabaseSpec</CODE
> (<code class="literal">U</CODE
>) option
defines the name and location of the file containing this
User Database information.</P
><p class="para">The forms of the <code class="literal">UserDatabaseSpec</CODE
> (<code class="literal">U</CODE
>) option are as follows:</P
><p class="para"><blockquote class="screen"><pre class="screen">OU<code class="replaceable"><i>path,...                             </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (V8.6)</I
>
-oU<code class="replaceable"><i>path,...                            </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (V8.6)</I
>
O UserDatabaseSpec=<code class="replaceable"><i>path,...            </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (V8.7)</I
>

-OUserDatabaseSpec=<code class="replaceable"><i>path,...            </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (V8.7)</I
>
define(`confUSERDB_SPEC',`<code class="replaceable"><i>path,...</I
></CODE
>')   <i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> V8 m4 configuration</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The argument <code class="replaceable"><i>path,...</I
></CODE
> is of type string and is
a comma- or space-separated list of elements. Those elements
can be database pathnames or other information as described below. 
If <code class="replaceable"><i>path,...</I
></CODE
> is missing
or if the entire option is missing, the user
database is not used. Otherwise, the user database is used, and each
database is accessed in turn, leftmost to rightmost, in the list of paths.
There is no default for the V8 <em class="emphasis">m4</EM
> technique.</P
><p class="para">The elements of <code class="replaceable"><i>path,...</I
></CODE
> can either be pathnames of files
or other methods of lookup depending on the first character of each:&#13;</P
><dl class="variablelist"><dt class="term"><em class="emphasis">/</EM
></DT
><dd class="listitem"><p class="para">A lead slash causes the element to be interpreted as a pathname;
for example, <em class="emphasis">/etc/userdb</EM
>.&#13;</P
></DD
><dt class="term"><em class="emphasis">@</EM
></DT
><dd class="listitem"><p class="para">A leading <code class="literal">@</CODE
> causes a copy of the message for each user
to be forwarded to a specified host. The assumption
is that the other host is in a better position to perform user database
lookups. Such a declaration looks like <em class="emphasis">@dbhost.our.domain</EM
>.
Note that this form of declaration must be last in the list that
constitutes <code class="replaceable"><i>path,...</I
></CODE
> because it always succeeds.&#13;</P
></DD
><dt class="term"><em class="emphasis">h</EM
></DT
><dd class="listitem"><p class="para">Beginning with V8.7,
a leading <code class="literal">h</CODE
> or <code class="literal">H</CODE
> causes <em class="emphasis">sendmail</EM
> to perform
a case-insensitive comparison of
the <code class="replaceable"><i>path</I
></CODE
> to the string &quot;hesiod.&quot; If they match,
user database inquiries are looked up via Hesiod services.</P
></DD
></DL
><p class="para">For example, the following declares two user databases. The first that is used
up will be <em class="emphasis">/etc/userdb</EM
>. If the entry is not found in that
database, it will be forwarded to the host <em class="emphasis">mail.here.us</EM
> for
handling there:</P
><p class="para"><blockquote class="screen"><pre class="screen">O UserDatabaseSpec=/etc/userdb,@mail.here.us</PRE
></BLOCKQUOTE
></P
><p class="para">Any leading character other than those shown above
causes an error message to be printed
and that particular <code class="replaceable"><i>path,...</I
></CODE
> element to be ignored.</P
><p class="para"><blockquote class="screen"><pre class="screen">Unknown UDB spec <i class="lineannotation">badpath</I
></PRE
></BLOCKQUOTE
></P
><p class="para">Note that future releases of <em class="emphasis">sendmail</EM
> may include
additional subfields for each <code class="replaceable"><i>path</I
></CODE
>. These will
look like <code class="literal">:opt=value</CODE
>. Consequently, the <code class="replaceable"><i>path</I
></CODE
>
that you specify should not include the colon character.</P
><p class="para">If UDB_DEFAULT_SPEC is defined in <em class="emphasis">Makefile</EM
> when
<em class="emphasis">sendmail</EM
> is compiled (see <a class="xref" href="ch18_08.htm" title="">Section 18.8.53, UDB-DEFAULT-SPEC</A
>),
that value becomes the default if the <code class="literal">UserDatabaseSpec</CODE
> (<code class="literal">U</CODE
>)
option is missing. If UDB_DEFAULT_SPEC is undefined, the default
becomes NULL and no User Database lookups are performed.</P
><p class="para">The <code class="literal">UserDatabaseSpec</CODE
> (<code class="literal">U</CODE
>) option is not safe.  If specified from the command line,
it may cause <em class="emphasis">sendmail</EM
> to relinquish its <em class="emphasis">root</EM
> privilege.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-76">34.8.76 Verbose</A
></H3
><p class="refpurpose">Run in verbose mode</P
>(v)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-47869"></A
><a class="indexterm" name="AUTOID-47871"></A
>The <em class="emphasis">sendmail</EM
> program offers a verbose
mode of operation.
In this &quot;blow-by-blow&quot; mode a description of all the <em class="emphasis">sendmail</EM
>
program's actions is printed to the standard output. This mode
is valuable in running <em class="emphasis">sendmail</EM
> interactively but useless
in running in daemon mode. Consequently, you should never set this
option in the <em class="emphasis">sendmail.cf</EM
> file. Instead, you should set it
from the command line using the <code class="literal">-v</CODE
> command-line switch.</P
><p class="para">After the <em class="emphasis">sendmail.cf</EM
> file is parsed and the command-line
arguments have been processed, <em class="emphasis">sendmail</EM
> checks to see whether it
is in verbose mode. If it is, it sets the <code class="literal">HoldExpensive</CODE
> (<code class="literal">c</CODE
>) option (don't
connect to expensive mailers; see <a class="xref" href="#SML2-CH-34-SECT-8-29" title="">Section 34.8.29</A
>) to false and sets the 
<code class="literal">DeliveryMode</CODE
> (<code class="literal">d</CODE
>) option
(see <a class="xref" href="#SML2-CH-34-SECT-8-16" title="">Section 34.8.16</A
>) to interactive.</P
><p class="para">The forms of the <code class="literal">Verbose</CODE
> (<code class="literal">v</CODE
>) option are as follows:</P
><p class="para"><blockquote class="screen"><pre class="screen">Ov<code class="replaceable"><i>bool            </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (old form)</I
>
-ov<code class="replaceable"><i>bool           </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (old form)</I
>
-v<code class="replaceable"><i>                </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command-line shorthand</I
>
O Verbose=<code class="replaceable"><i>bool    </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file (beginning with V8.7)</I
>
-OVerbose=<code class="replaceable"><i>bool    </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.7)</I
></PRE
></BLOCKQUOTE
></P
><p class="para">The argument <code class="replaceable"><i>bool</I
></CODE
> is of type Boolean. If it is missing, the
default value is true (be verbose).
If the entire option is missing, the default value is false (be quiet).</P
><p class="para">The <code class="literal">Verbose</CODE
> (<code class="literal">v</CODE
>) option is safe.  When it is specified from the command line,
<em class="emphasis">sendmail</EM
> retains its <em class="emphasis">root</EM
> privilege. 
Note that the <code class="literal">Verbose</CODE
> (<code class="literal">v</CODE
>) option
should <em class="emphasis">never</EM
> be set in the configuration file.</P
></DIV
></BLOCKQUOTE
></DIV
><div class="refentry"><div class="refnamediv"><h3 class="refname"><a class="refname" name="SML2-CH-34-SECT-8-77">34.8.77 (M)</A
></H3
><p class="refpurpose">Define a macro</P
>(Obsolete as of V8.7)</DIV
><blockquote><div class="refsect1"><p class="para"><a class="indexterm" name="AUTOID-47920"></A
><a class="indexterm" name="AUTOID-47922"></A
><a class="indexterm" name="AUTOID-47926"></A
>The <code class="literal">M</CODE
> option is used to set or change a defined macro's value.
Although this option is allowed in the <em class="emphasis">sendmail.cf</EM
> file, it is
exclusively intended for use from the command line.
Macros that are defined in the command line <em class="emphasis">will not</EM
> override the values
of those same macros defined in the configuration file.</P
><p class="para">The forms of the <code class="literal">M</CODE
> option are as follows:</P
><p class="para"><blockquote class="screen"><pre class="screen">OM<code class="replaceable"><i>Xvalue    </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> configuration file</I
>
-oM<code class="replaceable"><i>Xvalue   </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (old obsolete form)</I
>
-M<code class="replaceable"><i>Xvalue    </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> command line (beginning with V8.7)</I
>
D<code class="replaceable"><i>Xvalue     </I
></CODE
><i class="lineannotation"><img src="../chars/larr.gif" alt="&lt;-"> both are equivalent of this in the configuration and </I
><em class="emphasis">m4</EM
> files</PRE
></BLOCKQUOTE
></P
><p class="para">In all four cases the argument <code class="replaceable"><i>value</I
></CODE
> is of type string.
The <code class="replaceable"><i>value</I
></CODE
> is assigned to the macro named <code class="literal">X</CODE
>.
Pre-V8.7 macro names are always a single character.
Multicharacter macro names that are available with 

V8.7 are described in
<a class="xref" href="ch31_01.htm" title="Defined Macros">Chapter 31, <cite class="chapter">Defined Macros</CITE
></A
>.</P
><p class="para">One example of the usefulness of this option concerns
the <em class="emphasis">rmail</EM
>(8) program.
Suppose a machine is used for networked mail.
Ordinarily, the <code class="literal">r</CODE
> macro is given the value &quot;smtp&quot;
to signify that mail is received over the network.
But for UUCP mail the <code class="literal">r</CODE
> macro should be given the value
&quot;UUCP.&quot;
One way to effect such a change is to arrange for <em class="emphasis">rmail</EM
>(8)
to invoke <em class="emphasis">sendmail</EM
> with a command-line argument of</P
><p class="para"><blockquote class="screen"><pre class="screen">-oMrUUCP</PRE
></BLOCKQUOTE
></P
><p class="para">In this command line, the <code class="literal">-o</CODE
> switch tells <em class="emphasis">sendmail</EM
> to define
a macro (the <code class="literal">M</CODE
>) whose name is <code class="literal">r</CODE
>
to have the text <code class="literal">UUCP</CODE
> as its new value.
[42]
This new value overrides
whatever value <code class="literal">r</CODE
> may have been given in the configuration file.
The <code class="literal">M</CODE
> option should be approached with caution. If you later
upgrade your <em class="emphasis">sendmail</EM
> program and install a new configuration
file, you may find that the names of macros aren't what you
expect. Previous
command-line assumptions about macro names may suddenly break.</P
><blockquote class="footnote"><p class="para">[42] Under V8 <em class="emphasis">sendmail</EM
> the <code class="literal">$s</CODE
> and <code class="literal">$r</CODE
> macros should
be assigned values with <code class="literal">-p</CODE
> command-line switch 
(see <a class="xref" href="ch36_07.htm" title="">Section 36.7.32, -p</A
> in <a class="xref" href="ch36_01.htm" title="The Command Line">Chapter 36</A
>).
Also note that <code class="literal">-oM</CODE
> has been deprecated in favor of the new <code class="literal">-M</CODE
> switch.</P
></BLOCKQUOTE
><p class="para">The <code class="literal">M</CODE
> option is safe only in assigning values to the
<code class="literal">r</CODE
> and <code class="literal">s</CODE
> macros. For all other macros it is unsafe
and, if specified from the command line,
may cause <em class="emphasis">sendmail</EM
> to relinquish its <em class="emphasis">root</EM
> privilege.
Pre-V8 SunOS <em class="emphasis">sendmail</EM
> was an exception in that it considered this
option safe for all macros.
Note that the <code class="literal">M</CODE
> option
should <em class="emphasis">never</EM
> be used in the configuration file.</P
></DIV
></BLOCKQUOTE
></DIV
></DIV
><div class="htmlnav"><p></P
><hr align="LEFT" width="515" title="footer"><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="SECT1" href="ch34_07.htm" title="34.7 Pitfalls"><img src="../gifs/txtpreva.gif" alt="Previous: 34.7 Pitfalls" border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><a class="book" href="index.htm" title="sendmail"><img src="../gifs/txthome.gif" alt="sendmail" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="CHAPTER" href="ch35_01.htm" title="35. Headers"><img src="../gifs/txtnexta.gif" alt="Next: 35. Headers" border="0"></A
></TD
></TR
><tr><td align="LEFT" valign="TOP" width="172">34.7 Pitfalls</TD
><td align="CENTER" valign="TOP" width="171"><a class="index" href="index/idx_0.htm" title="Book Index"><img src="../gifs/index.gif" alt="Book Index" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172">35. Headers</TD
></TR
></TABLE
><hr align="LEFT" width="515" title="footer"><p class="nav"><font size="-1">[ <a href="../index.htm" title="The Networking CD Bookshelf">Library Home</A
> | <a href="../dnsbind/index.htm" title="DNS &amp; BIND">DNS &amp; BIND</A
> | <a href="../tcpip/index.htm" title="TCP/IP Network Administration">TCP/IP</A
> | <a href="index.htm" title="sendmail">sendmail</A
> | <a href="../smdref/index.htm" title="sendmail Desktop Reference">sendmail Reference</A
> | <a href="../firewall/index.htm" title="Building Internet Firewalls">Firewalls</A
> | <a href="../puis/index.htm" title="Practical UNIX &amp; Internet Security">Practical Security</A
> ]</FONT
></P
></DIV
></BODY
></HTML
>
