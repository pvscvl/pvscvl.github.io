<html><head>
<title>[Chapter 15] 15.4 Security in Version 2 UUCP</TITLE>
<meta name="DC.title" content="Practical UNIX &amp; Internet Security"><meta name="DC.creator" content="Simson Garfinkel &amp; Gene Spafford"><meta name="DC.publisher" content="O'Reilly &amp; Associates, Inc."><meta name="DC.date" content="1999-02-04T00:12:02Z"><meta name="DC.type" content="Text.Monograph"><meta name="DC.format" content="text/html" scheme="MIME"><meta name="DC.source" content="1-56592-148-8" scheme="ISBN"><meta name="DC.language" content="en-US"><meta name="generator" content="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><link rev="made" href="mailto:online-books@oreilly.com" title="Online Books Comments"><link rel="up" href="ch15_01.htm" title="15. UUCP"><link rel="prev" href="ch15_03.htm#PUIS-CHP-15-SECT-3.3" title="15.3 UUCP and Security"><link rel="next" href="ch15_05.htm#PUIS-CHP-15-SECT-5.1.2" title="15.5 Security in BNU UUCP"></HEAD
><body bgcolor="#FFFFFF" text="#000000"><div class="htmlnav"><h1><img src="gifs/smbanner.gif" alt="Practical UNIX &amp; Internet Security" usemap="#srchmap" border="0"></H1
><map name=index.html"srchmap"><area shape="RECT" coords="0,0,466,65" href="index.htm" alt="Practical UNIX &amp; Internet Security"><area shape="RECT" coords="467,0,514,18" href="../search/psrch.htm" alt="Search this book"></MAP
><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="SECT1" href="ch15_03.htm#PUIS-CHP-15-SECT-3.3" title="15.3 UUCP and Security"><img src="../gifs/txtpreva.gif" alt="Previous: 15.3 UUCP and Security" border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><b><font face="ARIEL,HELVETICA,HELV,SANSERIF" size="-1">Chapter 15<br>UUCP</FONT
></B
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="SECT1" href="ch15_05.htm#PUIS-CHP-15-SECT-5.1.2" title="15.5 Security in BNU UUCP"><img src="../gifs/txtnexta.gif" alt="Next: 15.5 Security in BNU UUCP" border="0"></A
></TD
></TR
></TABLE
>&nbsp;<hr align="LEFT" width="515" title="footer"></DIV
><div class="SECT1"><h2 class="sect1"><a class="title" name="PUIS-CHP-15-SECT-4">15.4 Security in Version 2 UUCP</A
></H2
><p class="para"><a class="indexterm" name="AUTOID-18791"></A
><a class="indexterm" name="AUTOID-18793"></A
>Version 2 of <span class="acronym">UUCP</SPAN
>
provides five files that control what type of access remote systems
are allowed on your computer (see <a class="xref" href="#PUIS-CHP-15-TAB-1" title="UUCP Version 2 Access Control Files">Table 15.1</A
>).</P
><table class="table"><caption class="table"><a class="title" name="PUIS-CHP-15-TAB-1">Table 15.1: UUCP Version 2 Access Control Files</A
></CAPTION
><thead class="thead"><tr class="row" valign="TOP"><th class="entry" align="LEFT" rowspan="1" colspan="1"><p class="para">File</P
></TH
><th class="entry" align="LEFT" rowspan="1" colspan="1"><p class="para">Meaning</P
></TH
></TR
></THEAD
><tbody class="tbody"><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1"><p class="para">USERFILE</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Determines access to files and directories.</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1"><p class="para">L.cmds</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Specifies commands that can be executed
locally by remote sites.</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1"><p class="para">SEQFILE</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Specifies machines for which to keep
conversation counts.</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1"><p class="para">FWDFILE</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Specifies a list of systems to which
your system will forward files. (Not available in all implementations.)</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1"><p class="para">ORGFILE</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Specifies a list of systems (and optionally,
users on those systems) who can forward files through your system.
(Not available in all implementations.)</P
></TD
></TR
></TBODY
></TABLE
><p class="para">The two files of primary concern are <em class="emphasis">USERFILE</EM
>
and <em class="emphasis">L.cmds</EM
>; for a detailed description of the
other files, please see the book <em class="emphasis">Managing UUCP and Usenet</EM
>
referenced above.</P
><div class="sect2"><h3 class="sect2"><a class="title" name="PUIS-CHP-15-SECT-4.1">15.4.1 USERFILE: Providing Remote File Access</A
></H3
><p class="para">The
<em class="emphasis"><a class="indexterm" name="AUTOID-18843"></A
><a class="indexterm" name="AUTOID-18845"></A
><a class="indexterm" name="AUTOID-18848"></A
><a class="indexterm" name="AUTOID-18851"></A
><a class="indexterm" name="AUTOID-18854"></A
>/usr/lib/uucp/USERFILE</EM
> file controls
which files on your computer can be accessed through the <span class="acronym">UUCP</SPAN
>
system. Normally, you specify one entry in <em class="emphasis">USERFILE</EM
>
for each <span class="acronym">UUCP</SPAN
> login in the <em class="emphasis">/etc/passwd</EM
>
file. You can also include entries in <em class="emphasis">USERFILE</EM
>
for particular users on your computer: this allows you to give individual
users additional <span class="acronym">UUCP</SPAN
> privileges.</P
><p class="para"><em class="emphasis">USERFILE</EM
>
entries can specify four things:</P
><ul class="itemizedlist"><li class="listitem"><p class="para">Which directories can be accessed
by remote systems</P
></LI
><li class="listitem"><p class="para">The login name that a remote system must use to
talk to the local system</P
></LI
><li class="listitem"><p class="para">Whether a remote system must be called back by the
local system to confirm its identity before communication can take
place</P
></LI
><li class="listitem"><p class="para">Which files can be sent out over <span class="acronym">UUCP</SPAN
>
by local users</P
></LI
></UL
><div class="sect3"><h4 class="sect3"><a class="title" name="PUIS-CHP-15-SECT-4.1.1">15.4.1.1 USERFILE entries</A
></H4
><p class="para"><em class="emphasis">USERFILE</EM
>
is one of the more complicated parts of Version 2 <span class="acronym">UUCP</SPAN
>.
In some cases, making a mistake with <em class="emphasis">USERFILE</EM
>
can prevent <span class="acronym">UUCP</SPAN
> from working at all. In other
cases, it can result in a security hole.</P
><p class="para">Entries in
<em class="emphasis">USERFILE</EM
> take the form:</P
><blockquote class="screen"><pre class="screen"><kbd class="command">username,system-name [c] pathname(s)</KBD
></PRE
></BLOCKQUOTE
><p class="para">An entry in <em class="emphasis">USERFILE</EM
> that uses all four
fields might look like this:</P
><blockquote class="screen"><pre class="screen">Ugarp,garp c /usr/spool/uucppublic</PRE
></BLOCKQUOTE
><p class="para">These fields are described in <a class="xref" href="#PUIS-CHP-15-TAB-5" title="USERFILE Fields">Table 15.2</A
>.</P
><table class="table"><caption class="table"><a class="title" name="PUIS-CHP-15-TAB-5">Table 15.2: <em class="emphasis">USERFILE</EM
> Fields</A
></CAPTION
><thead class="thead"><tr class="row" valign="TOP"><th class="entry" align="LEFT" rowspan="1" colspan="1"><p class="para">Field</P
></TH
><th class="entry" align="LEFT" rowspan="1" colspan="1"><p class="para">Example</P
></TH
><th class="entry" align="LEFT" rowspan="1" colspan="1"><p class="para">Function in <em class="emphasis">USERFILE</EM
></P
></TH
></TR
></THEAD
><tbody class="tbody"><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1"><p class="para">username</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para"><i class="filename">Ugarp</I
></P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para"><em class="emphasis"></EM
>Login name in <em class="emphasis">/etc/passwd</EM
>
that will be used</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1"><p class="para">system name</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para"><i class="filename">garp</I
></P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para"><em class="emphasis"></EM
>System name of the remote system.</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1"><p class="para">c</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para"><i class="filename">c</I
></P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para"><em class="emphasis"></EM
>Optional callback flag. If present, <em class="emphasis">uucico</EM
>
on the local computer halts conversation after the remote machine
calls the local machine; <em class="emphasis">uucico</EM
> on the local
machine then calls back the remote machine to establish the remote
machine's identity</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1"><p class="para">pathname</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para"><i class="filename">/usr/spool/uucppublic</I
></P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para"><em class="emphasis"></EM
>List of absolute pathname prefixes separated
by blanks. The remote system can access only those files beginning
with these pathnames. A blank field indicates open access to any
file in the system, as does a pathname of /.</P
></TD
></TR
></TBODY
></TABLE
><p class="para">You should have at least one entry in <em class="emphasis">USERFILE</EM
>
without a username field, and at least one other entry without a
system name field:</P
><ul class="itemizedlist"><li class="listitem"><p class="para">The line that has no username field
is used by <em class="emphasis">uucico</EM
> when it is transmitting files,
to determine if it is allowed to transmit the file that you have
asked to transmit.</P
></LI
><li class="listitem"><p class="para">The line that has no system name field is used by
<em class="emphasis">uucico</EM
> when it is receiving files and cannot
find a name in the <em class="emphasis">USERFILE</EM
> that has a system
name matching the current system. <em class="emphasis">uucico</EM
> uses
this line to see if it is allowed to place a file in the requested
directory. This line is also used by the <em class="emphasis">uuxqt</EM
>
program.</P
></LI
></UL
><p class="para">To make things more
interesting, almost every implementation of <span class="acronym">UUCP</SPAN
>
parses <em class="emphasis">USERFILE</EM
> a little differently. The key
rules that apply to all versions are:</P
><ul class="itemizedlist"><li class="listitem"><p class="para">When <em class="emphasis">uucp</EM
> and
<em class="emphasis">uux</EM
> are run by users, and when <em class="emphasis">uucico</EM
>
runs in the Master role (a connection originating from your local
machine), <span class="acronym">UUCP</SPAN
> uses only the username part of
the username and system name fields.</P
></LI
><li class="listitem"><p class="para">When <em class="emphasis">uucico</EM
> runs in the Slave
role, <span class="acronym">UUCP</SPAN
> looks only at the system name field.</P
></LI
><li class="listitem"><p class="para">There must be at least one line that has an empty
system name, and one line that has an empty username. (In most <span class="acronym">BSD</SPAN
>-derived
systems, they can be the same line. Every other implementation requires
two separate lines. You are safest in using two lines if you don't
understand what your version allows.) The locations of these lines
in the file is not important, but both lines must be present.</P
></LI
></UL
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="PUIS-CHP-15-SECT-4.1.2">15.4.1.2 USERFILE entries for local users</A
></H4
><p class="para"><a class="indexterm" name="AUTOID-18979"></A
><a class="indexterm" name="AUTOID-18982"></A
>You can have an
entry in your <em class="emphasis">USERFILE</EM
> for every user who will
be allowed to transfer files. For example, the following entries
give the local users <em class="emphasis">lance</EM
> and <em class="emphasis">annalisa</EM
>
permission to transfer a file in or out of any directory on your
computer to which they have access:</P
><blockquote class="screen"><pre class="screen">lance, /
annalisa, /</PRE
></BLOCKQUOTE
><p class="para">This <em class="emphasis">USERFILE</EM
> entry gives the local user
<em class="emphasis">casper</EM
> permission to transfer files in or out
of the <span class="acronym">UUCP</SPAN
> public directory or the directory
<em class="emphasis">/usr/ghost</EM
>:</P
><blockquote class="screen"><pre class="screen">casper, /usr/spool/uucppublic /usr/ghost</PRE
></BLOCKQUOTE
><p class="para">Be aware that
<em class="emphasis">USERFILE</EM
> allows a maximum of 20 entries in
Version 7 and System V Release 1.0.</P
><p class="para">Instead of specifying
a <em class="emphasis">USERFILE</EM
> entry for each user on your system,
you can specify a <em class="emphasis">USERFILE</EM
> entry without a
username. This default entry covers <em class="emphasis">all users</EM
>
on your system that are not otherwise specified. To give all users
access to the <span class="acronym">UUCP</SPAN
> public directory, you might
use the following <em class="emphasis">USERFILE</EM
> entry:</P
><blockquote class="screen"><pre class="screen">,localhost /usr/spool/uucppublic</PRE
></BLOCKQUOTE
><p class="para">(The hostname <em class="emphasis">localhost</EM
> is ignored by
the <span class="acronym">UUCP</SPAN
> software and is included only for clarity.)</P
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="PUIS-CHP-15-SECT-4.1.3">15.4.1.3 Format of USERFILE entry without system name</A
></H4
><p class="para"><a class="indexterm" name="AUTOID-19010"></A
><a class="indexterm" name="AUTOID-19012"></A
>To
allow file transfer from other systems to your system, and to allow
files to be accessed by <em class="emphasis">uuxqt</EM
> (even when it
is started from your system), you must have at least one entry in
<em class="emphasis">USERFILE</EM
> for which the system name is not specified.
For example:</P
><blockquote class="screen"><pre class="screen">nuucp, /usr/spool/uucppublic</PRE
></BLOCKQUOTE
><p class="para">Although you might expect that this line would mean that any
system logging in with the name <em class="emphasis"><a class="indexterm" name="AUTOID-19020"></A
>nuucp</EM
>
would have access to<a class="indexterm" name="AUTOID-19022"></A
><a class="indexterm" name="AUTOID-19024"></A
>

<em class="emphasis">/usr/spool/uucppublic</EM
>, such is not the case
for all versions of <span class="acronym">UUCP</SPAN
>.</P
><p class="para">In <a class="indexterm" name="AUTOID-19031"></A
><a class="indexterm" name="AUTOID-19034"></A
>
System V Release 2.0 and in Ultrix,
<span class="acronym">UUCP</SPAN
> will actually check both the username field
and the blank system<em class="emphasis"> </EM
>name field, and will allow
logins by any system using <em class="emphasis">nuucp</EM
>.</P
><p class="para">In
other <span class="acronym">UUCP</SPAN
> implementations, however, the fact
that <em class="emphasis">nuucp</EM
> appears on this line is completely
irrelevant to a system calling in. The system name is used only
to validate file transfers for files that are received by your system.
If this is the first entry with a missing system name, <span class="acronym">UUCP</SPAN
>
will actually allow access to <em class="emphasis">uucppublic</EM
> by
any system for which there is no explicit <em class="emphasis">USERFILE</EM
>
entry containing that system's system name. If this is
not the first entry with a blank system name, it will have no effect.</P
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="PUIS-CHP-15-SECT-4.1.4">15.4.1.4 Special permissions</A
></H4
><p class="para"><a class="indexterm" name="AUTOID-19049"></A
>You
may wish to make special directories on your system available to
particular users on your system or to particular systems with which
you communicate. For example:</P
><blockquote class="screen"><pre class="screen">Ugarp,garp /usr/spool/uucppublic /usr/spool/news</PRE
></BLOCKQUOTE
><p class="para">This
line will make both the directories <em class="emphasis">/usr/spool/uucppublic</EM
>
and <em class="emphasis">/usr/spool/news</EM
> available to the system
name <i class="filename">garp</I
> when you call it, and to any system
that logs in with the <span class="acronym">UUCP</SPAN
> login <i class="systemitem">Ugarp</I
>. You might want to add
this line if you anticipate transferring news articles between your
computer and <em class="emphasis">garp</EM
> directly, without going through
the Usenet news software.</P
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="PUIS-CHP-15-SECT-4.1.5">15.4.1.5 Requiring callback</A
></H4
><p class="para"><a class="indexterm" name="AUTOID-19063"></A
><a class="indexterm" name="AUTOID-19066"></A
>Version 2 <span class="acronym">UUCP</SPAN
>
has a callback feature that you can use if you are extremely concerned
about security. With callback, when a remote system calls your computer,
your system immediately hangs up on the remote system and calls
it back. In this way, you can be sure that the remote system is
who it claims to be.</P
><p class="para">If you put a <em class="emphasis">c</EM
>
as the first entry in the <em class="emphasis">USERFILE</EM
> path list,
no files will be transferred when the remote system's <em class="emphasis">uucico</EM
>
logs in. Instead, your system will call back the remote system.
No special callback hardware is required to take advantage of <span class="acronym">UUCP</SPAN
>
callback, because it is performed by the system software, not by
the modem.</P
><p class="para">For example, here is garp's <em class="emphasis">USERFILE</EM
>
entry modified so the local system will always call <i class="filename">garp</I
>back whenever <i class="filename">garp</I
> calls the local
system:</P
><blockquote class="screen"><pre class="screen">Ugarp,garp c /usr/spool/uucppublic /usr/spool/news</PRE
></BLOCKQUOTE
><p class="para">Callback
adds to the security of <span class="acronym">UUCP</SPAN
>. Normally there
is no way to be sure that a computer calling up and claiming to
be <i class="filename">garp</I
>, for example, is really <i class="filename">garp</I
>.
It might be another system that belongs to a computer cracker who
has learned <i class="filename">garp</I
>'s <span class="acronym">UUCP</SPAN
>
login and password. If you call back the remote system, however,
you can be reasonably sure that you are connecting to the right
system.</P
><blockquote class="note"><p class="para"><strong>NOTE:</STRONG
> Only one system out of each pair of communicating systems
can have a <em class="emphasis">c</EM
> in its <em class="emphasis">USERFILE</EM
>
to enable the callback feature. If both ends of a connection enable
callback, they will loop endlessly&nbsp;- calling each other,
hanging up, and calling back. For more information, see the comments
on callback in <a class="xref" href="ch14_01.htm" title="Telephone Security">Chapter 14, <cite class="chapter">Telephone Security</CITE
></A
>.</P
></BLOCKQUOTE
></DIV
></DIV
><div class="sect2"><h3 class="sect2"><a class="title" name="PUIS-CHP-15-SECT-4.2">15.4.2 A USERFILE Example</A
></H3
><p class="para">Here is a sample
<em class="emphasis">USERFILE</EM
>:</P
><blockquote class="screen"><pre class="screen">, /usr/spool/uucppublic
# Next line not needed in BSD 4.2 or 4.3
nuucp, /usr/spool/uucppublic
dan, /usr/spool/uucppublic /u1/dan
csd, /usr/spool/uucppublic /u1/csd
root, /
udecwrl,decwrl /usr/spool/uucppublic /usr/spool/news
upyrnj,pyrnj /usr/spool/uucppublic /usr/src</PRE
></BLOCKQUOTE
><p class="para">As noted earlier, in some systems the first line defines both
the missing <em class="emphasis">username</EM
> and the missing system
name and gives access to the directory <em class="emphasis">/usr/spool/uucppublic</EM
>.
In other implementations of <span class="acronym">UNIX</SPAN
>, two separate
lines are required: The first line will suffice for the missing
username, and another line, such as the second one shown here (the
line beginning with <em class="emphasis">nuucp</EM
>), will account for
the missing <em class="emphasis">system</EM
> name.</P
><p class="para">The effect
of these lines is to allow any local user, and any remote machine,
to transfer files only from the public directory.</P
><p class="para">If
you don't have any particularly trusted sites or users,
you may want to stop at this point. However, if you want to give
special privileges to particular local users, you'll include
lines such as the next three (the lines beginning with <em class="emphasis">dan</EM
>,
<em class="emphasis">csd</EM
>, and <em class="emphasis">root</EM
>). Users
<em class="emphasis">dan</EM
> and <em class="emphasis">csd</EM
> can transfer
files to or from their home directories as well as from the public
directory. Users logged in as <em class="emphasis">root</EM
> can transfer
files to or from any directory. (This structure makes sense, as
they can do anything else, including modifying <em class="emphasis">USERFILE</EM
>
to suit their needs or whims.)</P
><p class="para">Finally, you may need
to specify particular permissions for known local systems. In the
example, <i class="filename">decwrl </I
>is able to transfer files to
<i class="filename">/usr/spool/news</I
> as well as to the public directory.
The site <i class="filename">pyrnj </I
>is able to transfer files to
and from <i class="filename">/usr/src</I
> as well as to and from the
public directory.</P
><div class="sect3"><h4 class="sect3"><a class="title" name="PUIS-CHP-15-SECT-4.2.1">15.4.2.1 Some bad examples</A
></H4
><p class="para">If you are not very
concerned about security, the following <em class="emphasis">USERFILE</EM
>
might suffice:</P
><blockquote class="screen"><pre class="screen"># A wide open USERFILE
nuucp, /usr/spool/uucppublic
, /</PRE
></BLOCKQUOTE
><p class="para">However, we recommend against it!
This <em class="emphasis">USERFILE</EM
> will allow remote systems (assuming
that they all log in as <em class="emphasis">nuucp</EM
>) to transfer
files to or from the public directory, but will give complete <span class="acronym">UUCP</SPAN
>
access to local users. This is dangerous and is not recommended,
as it allows local users access to any protected file and directory
that is owned by <em class="emphasis">uucp</EM
>.</P
><p class="para">If you
don't talk to the outside world and are using <span class="acronym">UUCP</SPAN
>
only for communication with <span class="acronym">UNIX</SPAN
> sites inside
your organization, you might use the following <em class="emphasis">USERFILE</EM
>:</P
><blockquote class="screen"><pre class="screen"># A completely open USERFILE
, /
, /</PRE
></BLOCKQUOTE
><p class="para">This
userfile will allow any user on your system, or any remote system,
to transfer files to or from any directory. This example is even
more dangerous than the previous one. (Note that on many systems,
two lines are necessary, even though they are identical. The first
line defines the missing username, and the other line defines the
missing system name. In some systems, a single line will suffice,
but you will never be wrong if you include both of them.)</P
><p class="para">Remember
that even with complete access specified in <em class="emphasis">USERFILE</EM
>,
<span class="acronym">UUCP</SPAN
> is still subject to <span class="acronym">UNIX</SPAN
>
file permissions. A user requesting outbound transfer of a file
must have read access to it. For a remote system to have access
to a file or directory, the file or directory must be readable and
writable by all users, or by <span class="acronym">UUCP</SPAN
>.</P
><blockquote class="note"><p class="para"><strong>NOTE:</STRONG
> If you wish to run a secure system, the directory <i class="filename"><a class="indexterm" name="AUTOID-19140"></A
><a class="indexterm" name="AUTOID-19143"></A
>/usr/lib/uucp</I
>
(or <i class="filename">/etc/uucp</I
>) must not be in the permission
list! If users from the outside are allowed to transfer into these
directories, they can change the <i class="filename">USERFILE</I
> or
the <i class="filename">L.cmds</I
> files to allow them to execute any
command that they wish. Local users can similarly use the <em class="emphasis">uucp</EM
>
command to change these files, and subvert <span class="acronym">UUCP</SPAN
>.
Giving all access from the <a class="indexterm" name="AUTOID-19151"></A
>
/
directory is also dangerous&nbsp;- such access makes it possible
for people outside your organization to subvert your system easily,
as they can then modify any directory on your system that is world
writable.</P
><p class="para">For example, granting access to /
lets an outsider read the contents of your <em class="emphasis">/etc/passwd</EM
>
file, and also allows him to read and change the contents of your
<em class="emphasis">/usr/lib/uucp/L.sys</EM
> file. As an added precaution,
the home directory for the <i class="systemitem">uucp</I
>
user should not be in <em class="emphasis">/usr/spool/uucp/uucppublic,</EM
>
or any other directory that can be written to by a <em class="emphasis">uucp</EM
>
user. Doing so may allow an outside user to subvert your system.
<em class="emphasis"><a class="indexterm" name="AUTOID-19161"></A
><a class="indexterm" name="AUTOID-19163"></A
><a class="indexterm" name="AUTOID-19166"></A
><a class="indexterm" name="AUTOID-19169"></A
><a class="indexterm" name="AUTOID-19172"></A
></EM
></P
></BLOCKQUOTE
></DIV
></DIV
><div class="sect2"><h3 class="sect2"><a class="title" name="PUIS-CHP-15-SECT-4.3">15.4.3 L.cmds: Providing Remote Command Execution</A
></H3
><p class="para"><a class="indexterm" name="AUTOID-19178"></A
><a class="indexterm" name="AUTOID-19180"></A
><a class="indexterm" name="AUTOID-19183"></A
><a class="indexterm" name="AUTOID-19186"></A
>You
will probably want to limit the commands that can be executed by
a remote system via <em class="emphasis">uucp</EM
>. After all, if <em class="emphasis">any</EM
>
command could be executed by <span class="acronym">UUCP</SPAN
>, then people
on other computers could use the <i class="systemitem">/bin/rm</I
>
command to delete files in any writable directory on your computer!
[7]</P
><blockquote class="footnote"><p class="para">[7] This gives a new definition to the phrase &quot;world
writable.&quot;</P
></BLOCKQUOTE
><p class="para">For this reason,
<span class="acronym">UUCP</SPAN
> allows you to specify which commands remote
systems are allowed to execute on your computer. The list of valid
commands is contained in the directory <em class="emphasis">/usr/lib/uucp</EM
>
in the file <em class="emphasis">L.cmds</EM
>, <em class="emphasis">L-cmds</EM
>,
or <em class="emphasis"><a class="indexterm" name="AUTOID-19202"></A
>uuxqtcmds</EM
>
(different versions store the command list in different files).
Some early <span class="acronym">UNIX</SPAN
> systems (Version 7 or earlier)
may not have this file at all (and have no way of changing the defaults
without modifying the source code to the <em class="emphasis">uuxqt</EM
>
program.) For further information, check your own system's
documentation.</P
><p class="para">In some versions of <span class="acronym">UUCP</SPAN
>,
the <em class="emphasis">L.cmds</EM
> file can also include a <span class="acronym">PATH</SPAN
><kbd class="command">=</KBD
>
statement that specifies which directories <em class="emphasis">uuxqt</EM
>
should check when searching for the command to execute.</P
><p class="para">A
typical <em class="emphasis">L.cmds</EM
> file might contain the following
list of commands:</P
><blockquote class="screen"><pre class="screen">PATH=/bin:/usr/bin:/usr/ucb
rmail
rnews
lpr
who
finger</PRE
></BLOCKQUOTE
><p class="para">If a command is not in the commands file, <em class="emphasis">uux</EM
>
cannot execute it. <em class="emphasis">L.cmds</EM
> should at least contain
the <em class="emphasis"><a class="indexterm" name="AUTOID-19219"></A
>rmail</EM
>
program (the remote mail program that decides whether mail is to
be delivered locally or forwarded on to yet another system). If
<em class="emphasis">rmail</EM
> is not listed in <em class="emphasis">L.cmds</EM
>,
a local user will not be able to receive mail from remote users
via <span class="acronym">UUCP</SPAN
>.</P
><p class="para">Add commands to this file
carefully; commands like <em class="emphasis"><a class="indexterm" name="AUTOID-19226"></A
><a class="indexterm" name="AUTOID-19228"></A
><a class="indexterm" name="AUTOID-19230"></A
>cat</EM
> or <em class="emphasis">rm</EM
> may
place your system at risk. You should be careful about commands
that allow <a class="indexterm" name="AUTOID-19233"></A
>
shell escapes (such as <em class="emphasis">man</EM
>).
Even <em class="emphasis">finger</EM
> can be dangerous if you are very
concerned about security, because it might provide a cracker with
a list of usernames to try when guessing passwords.</P
><p class="para">Look
carefully at the <em class="emphasis">L.cmds</EM
> file that comes with
your system: you may wish to remove some of the commands that it
includes. For example, some <span class="acronym">BSD</SPAN
>-derived systems
include the <em class="emphasis"><a class="indexterm" name="AUTOID-19242"></A
><a class="indexterm" name="AUTOID-19244"></A
>ruusend</EM
> command in this file,
which allows file forwarding. This command is a security hole, because
a remote system could ask your system to forward protected files
that are owned by the <em class="emphasis">uucp</EM
> user, such as the
file<i class="filename"> L.sys</I
>.</P
><p class="para">If the <em class="emphasis">L.cmds</EM
>
file does not exist, <span class="acronym">UUCP</SPAN
> will use a default
set of commands. If the file exists but is empty, remote commands
cannot be executed on your system. In this event, the <span class="acronym">UUCP</SPAN
>
system can be used only for transferring files. <a class="indexterm" name="AUTOID-19253"></A
><a class="indexterm" name="AUTOID-19255"></A
></P
></DIV
></DIV
><div class="htmlnav"><p></P
><hr align="LEFT" width="515" title="footer"><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="SECT1" href="ch15_03.htm#PUIS-CHP-15-SECT-3.3" title="15.3 UUCP and Security"><img src="../gifs/txtpreva.gif" alt="Previous: 15.3 UUCP and Security" border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><a class="book" href="index.htm" title="Practical UNIX &amp; Internet Security"><img src="../gifs/txthome.gif" alt="Practical UNIX &amp; Internet Security" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="SECT1" href="ch15_05.htm#PUIS-CHP-15-SECT-5.1.2" title="15.5 Security in BNU UUCP"><img src="../gifs/txtnexta.gif" alt="Next: 15.5 Security in BNU UUCP" border="0"></A
></TD
></TR
><tr><td align="LEFT" valign="TOP" width="172">15.3 UUCP and Security</TD
><td align="CENTER" valign="TOP" width="171"><a class="index" href="index/idx_0.htm" title="Book Index"><img src="../gifs/index.gif" alt="Book Index" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172">15.5 Security in BNU UUCP</TD
></TR
></TABLE
><hr align="LEFT" width="515" title="footer"><p class="nav"><font size="-1">[ <a href="../index.htm" title="The Networking CD Bookshelf">Library Home</A
> | <a href="../dnsbind/index.htm" title="DNS &amp; BIND">DNS &amp; BIND</A
> | <a href="../tcpip/index.htm" title="TCP/IP Network Administration">TCP/IP</A
> | <a href="../sendmail/index.htm" title="sendmail">sendmail</A
> | <a href="../smdref/index.htm" title="sendmail Desktop Reference">sendmail Reference</A
> | <a href="../firewall/index.htm" title="Building Internet Firewalls">Firewalls</A
> | <a href="index.htm" title="Practical UNIX &amp; Internet Security">Practical Security</A
> ]</FONT
></P
></DIV
></BODY
></HTML
>
