<html><head>
<title>[Chapter 3] 3.2 Passwords</TITLE>
<meta name="DC.title" content="Practical UNIX &amp; Internet Security"><meta name="DC.creator" content="Simson Garfinkel &amp; Gene Spafford"><meta name="DC.publisher" content="O'Reilly &amp; Associates, Inc."><meta name="DC.date" content="1999-02-04T00:00:11Z"><meta name="DC.type" content="Text.Monograph"><meta name="DC.format" content="text/html" scheme="MIME"><meta name="DC.source" content="1-56592-148-8" scheme="ISBN"><meta name="DC.language" content="en-US"><meta name="generator" content="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><link rev="made" href="mailto:online-books@oreilly.com" title="Online Books Comments"><link rel="up" href="ch03_01.htm" title="3. Users and Passwords"><link rel="prev" href="ch03_01.htm" title="3.1 Usernames"><link rel="next" href="ch03_03.htm" title="3.3 Entering Your Password"></HEAD
><body bgcolor="#FFFFFF" text="#000000"><div class="htmlnav"><h1><img src="gifs/smbanner.gif" alt="Practical UNIX &amp; Internet Security" usemap="#srchmap" border="0"></H1
><map name=index.html"srchmap"><area shape="RECT" coords="0,0,466,65" href="index.htm" alt="Practical UNIX &amp; Internet Security"><area shape="RECT" coords="467,0,514,18" href="../search/psrch.htm" alt="Search this book"></MAP
><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="SECT1" href="ch03_01.htm" title="3.1 Usernames"><img src="../gifs/txtpreva.gif" alt="Previous: 3.1 Usernames" border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><b><font face="ARIEL,HELVETICA,HELV,SANSERIF" size="-1">Chapter 3<br>Users and Passwords</FONT
></B
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="SECT1" href="ch03_03.htm" title="3.3 Entering Your Password"><img src="../gifs/txtnexta.gif" alt="Next: 3.3 Entering Your Password" border="0"></A
></TD
></TR
></TABLE
>&nbsp;<hr align="LEFT" width="515" title="footer"></DIV
><div class="SECT1"><h2 class="sect1"><a class="title" name="PUIS-CHP-3-SECT-2">3.2 Passwords</A
></H2
><p class="para"><a class="indexterm" name="AUTOID-1962"></A
><a class="indexterm" name="AUTOID-1964"></A
>Once
you've entered your username, <span class="acronym">UNIX</SPAN
> typically
prompts you to enter your password. This section describes how <span class="acronym">UNIX</SPAN
>
stores and handles passwords on most systems and how you can select
a good password.</P
><div class="sect2"><h3 class="sect2"><a class="title" name="PUIS-CHP-3-SECT-2.1">3.2.1 The /etc/passwd File</A
></H3
><p class="para"><span class="acronym">UNIX</SPAN
><a class="indexterm" name="AUTOID-1973"></A
><a class="indexterm" name="AUTOID-1975"></A
>
uses
the <i class="filename">/etc/passwd</I
> file to keep track of every
user on the system. The <i class="filename">/etc/passwd</I
> file contains
the username, real name, identification information, and basic account
information for each user. Each line in the file contains a database
record; the record fields are separated by a colon (:).</P
><p class="para">You can use the <kbd class="command"><a class="indexterm" name="AUTOID-1982"></A
>cat</KBD
> command to display your system's <i class="filename">/etc/passwd</I
>
file. Here are a few sample lines from a typical file:</P
><blockquote class="screen"><pre class="screen">root:fi3sED95ibqR6:0:1:System Operator:/:/bin/ksh 
daemon:*:1:1::/tmp: 
uucp:OORoMN9FyZfNE:4:4::/var/spool/uucppublic:/usr/lib/uucp/uucico 
rachel:eH5/.mj7NB3dx:181:100:Rachel Cohen:/u/rachel:/bin/ksh 
arlin:f8fk3j1OIf34.:182:100:Arlin Steinberg:/u/arlin:/bin/csh</PRE
></BLOCKQUOTE
><p class="para">The first three accounts, <i class="systemitem.username">root</I
>,
<i class="systemitem.username">daemon</I
>, and <i class="systemitem.username">uucp</I
>, are system accounts, while
<i class="systemitem.username">rachel</I
> and <i class="systemitem.username">arlin</I
> are accounts for individual
users.</P
><p class="para">The individual fields of the <i class="filename">/etc/passwd</I
>
file have fairly straightforward meanings. Table 3-1
explains a sample line from the file shown above</P
><table class="table"><caption class="table"><a class="title" name="AUTOID-1994">Table 3.1: Example /etc/passwd
Fields</A
></CAPTION
><thead class="thead"><tr class="row" valign="TOP"><th class="entry" align="LEFT" rowspan="1" colspan="1"><p class="para">Field</P
></TH
><th class="entry" align="LEFT" rowspan="1" colspan="1"><p class="para">Contents</P
></TH
></TR
></THEAD
><tbody class="tbody"><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1"><p class="para">rachel</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">The username</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1"><p class="para">eH5/.mj7NB3dx</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">The user's &quot;encrypted
password&quot;</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1"><p class="para">181</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">The user's user identification
number (<span class="acronym">UID</SPAN
>)</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1"><p class="para">100</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">The user's group identification
number (<span class="acronym">GID</SPAN
>)</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1"><p class="para">Rachel Cohen</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">The user's full name (also known
as the <span class="acronym">GECOS</SPAN
><a class="indexterm" name="AUTOID-2034"></A
>
or <span class="acronym">GCOS</SPAN
> field)[3]</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1"><p class="para">/u/rachel</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">The user's home directory</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1"><p class="para">/bin/ksh</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para"><a class="indexterm" name="AUTOID-2053"></A
>The user's
shell[4]</P
></TD
></TR
></TBODY
></TABLE
><blockquote class="footnote"><p class="para">[3] When UNIX was first
written, it ran on a small minicomputer. Many users at Bell Labs
used their<span class="acronym"> </SPAN
>UNIX accounts to create batch jobs
to be run via <a class="indexterm" name="AUTOID-2040"></A
>
RJE (Remote
Job Entry) on the bigger GECOS computer in the Labs. The user identification
information for the RJE was kept in the <i class="filename">/etc/passwd</I
>
file as part of the standard user identification. GECOS stood for
General Electric Computer Operating System; GE was one of several
major companies that made computers around that time.</P
><p class="para">[4] An empty field for the shell name does not
mean that the user has no shell; instead, it means that the Bourne
shell (<i class="filename">/bin/sh</I
>) should be used as a default.</P
></BLOCKQUOTE
><p class="para">.</P
><p class="para">Passwords are normally represented by a special encrypted
format that is described in &quot;The UNIX Encrypted Password
System&quot; in <a class="xref" href="ch08_01.htm" title="Defending  Your Accounts">Chapter 8, <cite class="chapter">Defending  Your Accounts</CITE
></A
>; the password itself is not
really stored in the file. Encrypted passwords may also be stored
in separate <i class="firstterm"><a class="indexterm" name="AUTOID-2062"></A
>shadow
password file</I
>s, which are also described in <a class="xref" href="ch08_01.htm" title="Defending  Your Accounts">Chapter 8</A
>.
The meanings of the <span class="acronym">UID</SPAN
> and <span class="acronym">GID</SPAN
>
fields are described in <a class="xref" href="ch04_01.htm" title="Users, Groups, and the Superuser">Chapter 4, <cite class="chapter">Users, Groups, and the Superuser</CITE
></A
>.</P
></DIV
><div class="sect2"><h3 class="sect2"><a class="title" name="PUIS-CHP-3-SECT-2.2">3.2.2 The /etc/passwd File
and Network Databases</A
></H3
><p class="para"><a class="indexterm" name="AUTOID-2071"></A
>These
days, many organizations have moved away from large time-sharing
computers and invested in large client/server networks
containing many servers and dozens or hundreds of workstations.
These systems are usually set up so that any user can make use of
any workstation in a group or in the entire organization. When these
systems are in use, every user effectively has an account on every
workstation.</P
><p class="para">Unfortunately, on these large, distributed systems, you cannot
ensure that every computer has the same <i class="filename">/etc/passwd</I
>
file. For this reason, there are now several different commercial
systems available that make the information stored in the <i class="filename">/etc/passwd</I
>
file available over a network.</P
><p class="para">Four such systems are:</P
><ul class="itemizedlist"><li class="listitem"><p class="para">Sun Microsystems' <a class="indexterm" name="AUTOID-2080"></A
>
Network Information System
(<span class="acronym">NIS</SPAN
>)</P
></LI
><li class="listitem"><p class="para">Sun Microsystems' <span class="acronym">NIS</SPAN
>+</P
></LI
><li class="listitem"><p class="para">Open Software Foundation's Distributed
Computing Environment (<span class="acronym">DCE</SPAN
>)</P
></LI
><li class="listitem"><p class="para">NeXT Computer's NetInfo</P
></LI
></UL
><p class="para">All of these systems take the information that is usually
stored in each workstation's <i class="filename">/etc/passwd </I
>file
and store it in one or more network server computers. If you are
using one of these systems and wish to view the contents of the
password database, you cannot simply <kbd class="command">cat</KBD
> the
<i class="filename">/etc/passwd</I
> file. Instead, you must use a command
that is specific to your system.</P
><p class="para">Sun's <span class="acronym">NIS</SPAN
> service supplements
the information stored in workstations' own files. If you
are using <span class="acronym">NIS</SPAN
> and you wish to get a list of every
user account, you would use the following command:</P
><blockquote class="screen"><pre class="screen"> <a class="indexterm" name="AUTOID-2099"></A
> % cat /etc/passwd;ypcat passwd</PRE
></BLOCKQUOTE
><p class="para">Sun's <a class="indexterm" name="AUTOID-2102"></A
>
<span class="acronym">NIS</SPAN
>+
service can be configured to supplement or substitute its user account
entries for those entries in the <i class="filename">/etc/passwd</I
> file,
depending on the contents of the /etc/nsswitch.conf
file. If you are using a system that runs <span class="acronym">NIS</SPAN
>+,
you will want to use the <a class="indexterm" name="AUTOID-2107"></A
>
niscat
command and specify your <span class="acronym">NIS</SPAN
>+ domain.
For example:</P
><blockquote class="screen"><pre class="screen">% niscat -o passwd.bigco</PRE
></BLOCKQUOTE
><p class="para"><a class="indexterm" name="AUTOID-2112"></A
>On machines running NetInfo,
the local <i class="filename">/etc/passwd</I
> file is ignored and the
network version is used instead. Therefore, if you are using NetInfo
and wish to see the user accounts, you only need to type:</P
><blockquote class="screen"><pre class="screen">% nidump passwd /</PRE
></BLOCKQUOTE
><p class="para"><a class="indexterm" name="AUTOID-2117"></A
><a class="indexterm" name="AUTOID-2119"></A
>Computers that are using <span class="acronym">DCE</SPAN
> use
an encrypted network database system as an alternative to encrypted
passwords and <i class="filename">/etc/passwd</I
> files. However, in order
to maintain compatibility, some of them have programs which run
on a regular basis that create a local <i class="filename">/etc/passwd</I
>
file. You should check your manuals for information about your specific
system.</P
><p class="para">These network database systems are described in greater detail
in <a class="xref" href="ch19_01.htm" title="RPC, NIS, NIS+,  and Kerberos">Chapter 19, <cite class="chapter">RPC, NIS, NIS+,  and Kerberos</CITE
></A
>.</P
><p class="para">At many sites, the administrators prefer not to use network
database management systems for fear that the system itself may
somehow become compromised. This fear may result from the fact that
configurations are often complex, and sometimes the protocols are
not particularly resistant to attack. In these environments, the
administrator simply keeps one central file of user information
and then copies it to remote machines on a periodic basis (for example,
using <kbd class="command">rdist</KBD
>). The drawback to this approach is
that it often requires the administrator to intervene to change
a user password or shell entry. In general, you should learn to
master the configuration of the system supplied by your vendor and
use it. You can then put other safeguards in place, such as those
mentioned in <a class="xref" href="ch21_01.htm" title="Firewalls">Chapter 21, <cite class="chapter">Firewalls</CITE
></A
>, and in <a class="xref" href="ch22_01.htm" title="Wrappers and Proxies">Chapter 22, <cite class="chapter">Wrappers and Proxies</CITE
></A
>.</P
><blockquote class="note"><p class="para"><strong>NOTE:</STRONG
> Because there are so many different ways to access the
information that has traditionally been stored in the <i class="filename">/etc/passwd</I
>
file, throughout this book we will simply use the phrase &quot;password
file&quot; or &quot;/etc/passwd&quot;
as a shorthand for the multitude of different systems. In the programming
examples, we will use a special command called &quot;<a class="indexterm" name="AUTOID-2134"></A
>
cat-passwd&quot; that prints the
contents of the password database on standard output. On a traditional
<span class="acronym">UNIX</SPAN
> system without shadow passwords, the <i class="filename">cat-passwd</I
>
command could simply be the command <kbd class="command">cat</KBD
> <i class="filename">/etc/passwd</I
>.
On a machine running <span class="acronym">NIS</SPAN
>, it could be the command
<kbd class="command">ypcat passwd</KBD
>. You could write such a program
for yourself that would to make repeated calls to the <kbd class="command">getpwent</KBD
>() library call and print the results.<a class="indexterm" name="AUTOID-2143"></A
><a class="indexterm" name="AUTOID-2145"></A
><a class="indexterm" name="AUTOID-2148"></A
></P
></BLOCKQUOTE
></DIV
><div class="sect2"><h3 class="sect2"><a class="title" name="PUIS-CHP-3-SECT-2.3">3.2.3 Authentication</A
></H3
><p class="para"><a class="indexterm" name="AUTOID-2153"></A
>After you tell <span class="acronym">UNIX</SPAN
>
who you are, you must prove your identity. This process is called
<i class="firstterm">authentication</I
>. Classically, there are three
different ways that you can authenticate yourself to a computer
system, and you use one or more of them each time:</P
><ol class="orderedlist"><li class="listitem"><p class="para">You can tell the computer something
that you know (for example, a password).</P
></LI
><li class="listitem"><p class="para">You can &quot;show&quot; the computer something
you have (for example, a card key).</P
></LI
><li class="listitem"><p class="para">You can let the computer measure something about
you (for example, your fingerprint).</P
></LI
></OL
><p class="para">None of these systems is foolproof. For example, by eavesdropping
on your terminal line, somebody can learn your password. By attacking
you at gunpoint, somebody can steal your card key. And if your attacker
has a knife, you might even lose your finger! In general, the more
trustworthy the form of identification, the more troublesome the
method is to use, and the more aggressive an attacker must be to
compromise it.</P
></DIV
><div class="sect2"><h3 class="sect2"><a class="title" name="PUIS-CHP-3-SECT-2.4">3.2.4 Passwords Are a Shared Secret</A
></H3
><p class="para">Passwords are the simplest form of authentication: they are
a secret that you share with the computer. When you log in, you
type your password to prove to the computer that you are who you
claim to be. The computer ensures that the password you type matches
the account that you have specified. If they match, you are allowed
to proceed.</P
><p class="para"><span class="acronym">UNIX</SPAN
> doesn't display your password
as you type it. This gives you extra protection if you're
using a printing terminal or if somebody is watching over your shoulder
as you type.[5]</P
><blockquote class="footnote"><p class="para">[5] This is sometimes referred to as <a class="indexterm" name="AUTOID-2172"></A
>
shoulder surfing.</P
></BLOCKQUOTE
><p class="para">Passwords are normally <span class="acronym">UNIX</SPAN
>'s
first line of defense against outsiders who want to break into your
system. Although you could break into a system or steal information
through the network without first logging in, many break-ins result
because of poorly chosen or poorly protected passwords.</P
></DIV
><div class="sect2"><h3 class="sect2"><a class="title" name="PUIS-CHP-3-SECT-2.5">3.2.5 Why Use Passwords?</A
></H3
><p class="para">Most desktop personal computers do not use passwords (although
there are several third-party programs that do provide varying degrees
of protection, and passwords are used by both the Windows and Macintosh
network filesystems). The fact that the PC has no passwords makes
the computer easier to use, both by the machine's primary
user and by anybody else who happens to be in the area. People with
PCs rely on physical security&nbsp;- doors, walls, and locks&nbsp;- to
protect the information stored on their disks from vandals and computer
criminals.</P
><p class="para">Likewise, many of the research groups that originally developed
the <span class="acronym">UNIX</SPAN
> operating system did not have passwords
for individual users&nbsp;- often for the same reason that they
shied away from locks on desks and office doors. In these environments,
trust, respect, and social convention were very powerful deterrents
to information theft and destruction.</P
><p class="para">But when a computer is connected to a modem that can be accessed
from almost any place in the world that has a telephone, or when
it is connected to a network that is used by people outside the
immediate group, passwords on computer accounts become just as necessary
as locks on the doors of a townhouse: without them, an intruder
can come right in, unhindered, and wreak havoc. And indeed, in today's
electronic world, there are numerous people who try the &quot;front
door&quot; of every computer they can find. If the door is unlocked,
sometimes the vandals will enter and do damage.</P
><p class="para">Passwords are especially important on computers that are shared
by several people, or on computers that are connected to networks
where various computers have trust relationships with each other
(we'll explain what this means in a later chapter). In
such circumstances, a single easily compromised account can endanger
the security of the entire installation or network.</P
></DIV
><div class="sect2"><h3 class="sect2"><a class="title" name="PUIS-CHP-3-SECT-2.6">3.2.6 Conventional UNIX Passwords</A
></H3
><p class="para">Today, <a class="indexterm" name="AUTOID-2186"></A
><a class="indexterm" name="AUTOID-2189"></A
>
most
<span class="acronym">UNIX</SPAN
> systems use simple passwords to authenticate
users: the user knows a password, and types the password into the
computer to log in.</P
><p class="para">Conventional passwords have been part of <span class="acronym">UNIX</SPAN
>
since its early years. The advantage of this system is that it runs
without any special equipment (such as card readers or fingerprint
scanners).</P
><p class="para">The disadvantage of conventional passwords is that they are
easily foiled&nbsp;- especially if you log into your computer
over a network. In recent years, conventional passwords have not
provided dependable security in a networked environment: there are
simply too many opportunities for a sophisticated attacker to capture
a password and then use it at a later time.[6] Today, even unsophisticated attackers
can launch these attacks, thanks to a variety of sophisticated tools
available on the net. The only way to safely use a <span class="acronym">UNIX</SPAN
>
computer remotely over a network such as the Internet is to use
either (or both) one-time passwords or data encryption (see <a class="xref" href="ch03_07.htm" title="One-Time Passwords">Section 3.7, "One-Time Passwords</A
>
 later in this chapter and in <a class="xref" href="ch08_01.htm" title="Defending  Your Accounts">Chapter 8</A
>, and <a class="xref" href="ch06_01.htm" title="Cryptography">Chapter 6, <cite class="chapter">Cryptography</CITE
></A
>).</P
><blockquote class="footnote"><p class="para">[6] Passwords
are still quite effective for most stand-alone systems with hard-wired
terminals.</P
></BLOCKQUOTE
><p class="para">Unfortunately, we live in an imperfect world, and most <span class="acronym">UNIX</SPAN
> systems continue to depend on reusable passwords for user
authentication. As such, passwords continue to be one of the most
widely exploited methods of compromising <span class="acronym">UNIX</SPAN
>
systems on networks.</P
></DIV
></DIV
><div class="htmlnav"><p></P
><hr align="LEFT" width="515" title="footer"><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="SECT1" href="ch03_01.htm" title="3.1 Usernames"><img src="../gifs/txtpreva.gif" alt="Previous: 3.1 Usernames" border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><a class="book" href="index.htm" title="Practical UNIX &amp; Internet Security"><img src="../gifs/txthome.gif" alt="Practical UNIX &amp; Internet Security" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="SECT1" href="ch03_03.htm" title="3.3 Entering Your Password"><img src="../gifs/txtnexta.gif" alt="Next: 3.3 Entering Your Password" border="0"></A
></TD
></TR
><tr><td align="LEFT" valign="TOP" width="172">3.1 Usernames</TD
><td align="CENTER" valign="TOP" width="171"><a class="index" href="index/idx_0.htm" title="Book Index"><img src="../gifs/index.gif" alt="Book Index" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172">3.3 Entering Your Password</TD
></TR
></TABLE
><hr align="LEFT" width="515" title="footer"><p class="nav"><font size="-1">[ <a href="../index.htm" title="The Networking CD Bookshelf">Library Home</A
> | <a href="../dnsbind/index.htm" title="DNS &amp; BIND">DNS &amp; BIND</A
> | <a href="../tcpip/index.htm" title="TCP/IP Network Administration">TCP/IP</A
> | <a href="../sendmail/index.htm" title="sendmail">sendmail</A
> | <a href="../smdref/index.htm" title="sendmail Desktop Reference">sendmail Reference</A
> | <a href="../firewall/index.htm" title="Building Internet Firewalls">Firewalls</A
> | <a href="index.htm" title="Practical UNIX &amp; Internet Security">Practical Security</A
> ]</FONT
></P
></DIV
></BODY
></HTML
>
