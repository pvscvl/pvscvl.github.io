<html><head>
<title>[Appendix A] UNIX Security Checklist</TITLE>
<meta name="DC.title" content="Practical UNIX &amp; Internet Security"><meta name="DC.creator" content="Simson Garfinkel &amp; Gene Spafford"><meta name="DC.publisher" content="O'Reilly &amp; Associates, Inc."><meta name="DC.date" content="1999-02-04T00:21:39Z"><meta name="DC.type" content="Text.Monograph"><meta name="DC.format" content="text/html" scheme="MIME"><meta name="DC.source" content="1-56592-148-8" scheme="ISBN"><meta name="DC.language" content="en-US"><meta name="generator" content="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><link rev="made" href="mailto:online-books@oreilly.com" title="Online Books Comments"><link rel="up" href="part07.htm" title="VII. Appendixes"><link rel="prev" href="part07.htm" title="VII. Appendixes"><link rel="next" href="appb_01.htm" title="B. Important Files"></HEAD
><body bgcolor="#FFFFFF" text="#000000"><div class="htmlnav"><h1><img src="gifs/smbanner.gif" alt="Practical UNIX &amp; Internet Security" usemap="#srchmap" border="0"></H1
><map name=index.html"srchmap"><area shape="RECT" coords="0,0,466,65" href="index.htm" alt="Practical UNIX &amp; Internet Security"><area shape="RECT" coords="467,0,514,18" href="../search/psrch.htm" alt="Search this book"></MAP
><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="PART" href="part07.htm" title="VII. Appendixes"><img src="../gifs/txtpreva.gif" alt="Previous: VII. Appendixes" border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><b><font face="ARIEL,HELVETICA,HELV,SANSERIF" size="-1">Appendix A</FONT
></B
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="APPENDIX" href="appb_01.htm" title="B. Important Files"><img src="../gifs/txtnexta.gif" alt="Next: B. Important Files" border="0"></A
></TD
></TR
></TABLE
>&nbsp;<hr align="LEFT" width="515" title="footer"></DIV
><div class="APPENDIX"><h1 class="appendix"><a class="title" name="PUIS-APP-A">A. UNIX Security Checklist</A
></H1
><div class="htmltoc"><p><b>Contents:</B
><br><a class="SECT1" href="#PUIS-APP-A-SECT-1" title="A.1 Preface">Preface</A
></P
><p></P
></DIV
><p class="para">This appendix summarizes the hints and recommendations made
in this book. You can use this appendix as a reminder of things
to examine and do, or you can use it as an index.</P
><div class="sect1"><h2 class="sect1"><a class="title" name="PUIS-APP-A-SECT-1">A.1 Preface</A
></H2
><ul class="itemizedlist"><li class="listitem"><p class="para">Reread your manuals and vendor documentation.</P
></LI
><li class="listitem"><p class="para">Mark your calendar for 6-12 months in the
future to reread your manuals, again.</P
></LI
></UL
><div class="sect2"><h3 class="sect2"><a class="title" name="PUIS-APP-A-SECT-1.1">A.1.1 Chapter 1: Introduction</A
></H3
><ul class="itemizedlist"><li class="listitem"><p class="para">Order other appropriate references
on security and computer crime. Schedule time to read them when
they arrive.</P
></LI
><li class="listitem"><p class="para">Become familiar with your users' expectations
and experience with <span class="acronym">UNIX</SPAN
>.</P
></LI
><li class="listitem"><p class="para">Write a letter to your vendors indicating your interest
and concern about (insufficient) software quality and security features.</P
></LI
><li class="listitem"><p class="para">Post a reminder above your computer or desk: &quot;Security
is not `Me versus the Users' but `All
of Us versus Them.'&quot;</P
></LI
></UL
><div class="sect3"><h4 class="sect3"><a class="title" name="PUIS-APP-A-SECT-1.1.1">A.1.1.1 Chapter 2: Policies and Guidelines</A
></H4
><ul class="itemizedlist"><li class="listitem"><p class="para"><a class="indexterm" name="AUTOID-36052"></A
>Assess
your environment. What do you need to protect? What are you protecting
against?</P
></LI
><li class="listitem"><p class="para">Understand priorities, budget, and resources available.</P
></LI
><li class="listitem"><p class="para">Perform a risk assessment and cost-benefit analysis.</P
></LI
><li class="listitem"><p class="para">Get management involved.</P
></LI
><li class="listitem"><p class="para">Set priorities for security and use.</P
></LI
><li class="listitem"><p class="para">Develop a positive security policy. Circulate it
to all users.</P
></LI
><li class="listitem"><p class="para">Ensure that authority is matched with responsibility.</P
></LI
><li class="listitem"><p class="para">Ensure that everything to be protected has an &quot;owner.&quot;</P
></LI
><li class="listitem"><p class="para">Work to educate your users on good security practice.</P
></LI
><li class="listitem"><p class="para">Don't have different, less secure rules
for top-level management.</P
></LI
></UL
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="PUIS-APP-A-SECT-1.1.2">A.1.1.2 Chapter 3: Users and Passwords</A
></H4
><ul class="itemizedlist"><li class="listitem"><p class="para"><a class="indexterm" name="AUTOID-36077"></A
><a class="indexterm" name="AUTOID-36080"></A
>Be sure that every person who uses your computer
has his or her own account.</P
></LI
><li class="listitem"><p class="para">Be sure that every user's account has a
password.</P
></LI
><li class="listitem"><p class="para">After you change your password, <em class="emphasis">$don't forget
it!</EM
></P
></LI
><li class="listitem"><p class="para">After you change your password, test it with the
<i class="filename">su</I
> command, by trying to log in on another
terminal, or by using the <kbd class="command">telnet localhost</KBD
> command.</P
></LI
><li class="listitem"><p class="para">Pick strong, nonobvious passwords.</P
></LI
><li class="listitem"><p class="para">Consider automatic generation or screening of passwords.</P
></LI
><li class="listitem"><p class="para">Pick passwords that are not so difficult to remember
that you have to write them down.</P
></LI
><li class="listitem"><p class="para">If you must write down your password, don't
make it obvious that what you have written is, in fact, a password.
Do not write your account name or the name of the computer on the
same piece of paper. Do not attach your password to your terminal,
keyboard, or any part of your computer.</P
></LI
><li class="listitem"><p class="para">Never record passwords online or send them to another
user via electronic mail.</P
></LI
><li class="listitem"><p class="para">Don't use your password as the password
to another application such as a Multi-User Dungeon (<span class="acronym">MUD</SPAN
>)
game.</P
></LI
><li class="listitem"><p class="para">Don't use your password on other computer
systems under different administrative control.</P
></LI
><li class="listitem"><p class="para">Consider use of one-time passwords, tokens, or smart
cards.</P
></LI
><li class="listitem"><p class="para">Ensure that all users know about good password management
practices.</P
></LI
></UL
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="PUIS-APP-A-SECT-1.1.3">A.1.1.3 Chapter 4: Users, Groups, and the Superuser</A
></H4
><ul class="itemizedlist"><li class="listitem"><p class="para"><a class="indexterm" name="AUTOID-36116"></A
>Ensure
that no two regular users are assigned or share the same account.</P
></LI
><li class="listitem"><p class="para">Never give any users, other than <span class="acronym">UUCP</SPAN
>
users, the same <span class="acronym">UID</SPAN
>.</P
></LI
><li class="listitem"><p class="para">Think about how you can assign group IDs to promote
appropriate sharing and protection without sharing accounts.</P
></LI
><li class="listitem"><p class="para">Avoid use of the <i class="filename">root</I
> account for routine activities
that can be done under a plain user ID.</P
></LI
><li class="listitem"><p class="para">Think of how to protect especially sensitive files
in the event that the <i class="filename">root</I
> account is compromised. This protection
includes use of removable media and encryption.</P
></LI
><li class="listitem"><p class="para">Restrict access to the <kbd class="command">su</KBD
> command, or restrict the
ability to <kbd class="command">su</KBD
> to user <i class="filename">root</I
>.</P
></LI
><li class="listitem"><p class="para">su to the user's ID when investigating
problem reports rather than exploring as user root.</P
></LI
><li class="listitem"><p class="para">Scan the files<i class="filename"> /var/adm/messages</I
>,
<i class="filename">/var/adm/sulog</I
>, or other appropriate log files
on a regular basis for bad<i class="filename"> su </I
>attempts.</P
></LI
></UL
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="PUIS-APP-A-SECT-1.1.4">A.1.1.4 Chapter 5: The UNIX Filesystem</A
></H4
><ul class="itemizedlist"><li class="listitem"><p class="para"><a class="indexterm" name="AUTOID-36148"></A
>Learn
about the useful options to your version of the <kbd class="command">ls</KBD
> command.</P
></LI
><li class="listitem"><p class="para">If your system has <span class="acronym">ACLS</SPAN
>, learn
how to use them. Remember, do not depend on <span class="acronym">ACLS</SPAN
>
to protect files on <span class="acronym">NFS</SPAN
> partitions.</P
></LI
><li class="listitem"><p class="para">Set your umask to an appropriate value (e.g., 027
or 077).</P
></LI
><li class="listitem"><p class="para">Never write <span class="acronym">SUID/SGID</SPAN
> shell scripts.</P
></LI
><li class="listitem"><p class="para">Periodically scan your system for <span class="acronym">SUID/SGID</SPAN
>
files.</P
></LI
><li class="listitem"><p class="para">Disable <span class="acronym">SUID</SPAN
> on disk partition
mounts (local and remote) unless necessary.</P
></LI
><li class="listitem"><p class="para">Determine if <kbd class="command">write</KBD
>, <kbd class="command">chmod</KBD
>,
<kbd class="command">chown</KBD
>, and <kbd class="command">chgrp</KBD
> operations
on files clear the <span class="acronym">SUID/SGID</SPAN
> bits on your system.
Get in the habit of checking files based on this information.</P
></LI
><li class="listitem"><p class="para">Scan for device files on your system. Check their
ownership and permissions to ensure that they are reasonable.</P
></LI
><li class="listitem"><p class="para">If your system has &quot;universes&quot;
or Context Dependent Files (<span class="acronym">CDFS</SPAN
>), be sure that
all your administrative actions actually scan <em class="emphasis">all </EM
>the
files and directories on your system.</P
></LI
></UL
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="PUIS-APP-A-SECT-1.1.5">A.1.1.5 Chapter 6: Cryptography</A
></H4
><ul class="itemizedlist"><li class="listitem"><p class="para"><a class="indexterm" name="AUTOID-36186"></A
><a class="indexterm" name="AUTOID-36189"></A
>Learn about the restrictions
your government places on the use, export, and sale of cryptography.
Consider contacting your legislators with your opinions on these
laws, especially if they negatively impact your ability to protect
your systems.</P
></LI
><li class="listitem"><p class="para">Never use <i class="filename">rot13</I
> as an encryption
method to protect data.</P
></LI
><li class="listitem"><p class="para">Don't depend on the <kbd class="command">crypt</KBD
>
command to protect anything particularly sensitive, especially if
it is more than 1024 bytes in length.</P
></LI
><li class="listitem"><p class="para">If you use the Data Encryption Standard (<span class="acronym">DES</SPAN
>)
algorithm for encryption, consider superencrypting with Triple-<span class="acronym">DES</SPAN
>.</P
></LI
><li class="listitem"><p class="para">Use the <kbd class="command">compress</KBD
> command (or
similar compression system) on files before encrypting them.</P
></LI
><li class="listitem"><p class="para">Learn how to use message digests. Obtain and install
a message digest program (such as MD5).</P
></LI
><li class="listitem"><p class="para"><em class="emphasis">Never</EM
> use a login password
as an encryption key. Choose encryption keys as you would a password,
however&nbsp;- avoid obvious or easily guessed words or patterns.</P
></LI
><li class="listitem"><p class="para">Protect your encryption key as you would your password&nbsp;- don't
write it down, put it in a shell file, or store it online.</P
></LI
><li class="listitem"><p class="para">Protect your encryption programs against tampering.</P
></LI
><li class="listitem"><p class="para">Avoid proprietary encryption methods whose strengths
are not known.</P
></LI
><li class="listitem"><p class="para">Consider obtaining a copy of the <span class="acronym">PGP</SPAN
>
software and making it available to your users. Use <span class="acronym">PGP</SPAN
>
to encrypt files and sensitive email, and to create and check digital
signatures on important files.</P
></LI
></UL
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="PUIS-APP-A-SECT-1.1.6">A.1.1.6 Chapter 7: Backups</A
></H4
><ul class="itemizedlist"><li class="listitem"><p class="para"><a class="indexterm" name="AUTOID-36225"></A
>Make
regular backups.</P
></LI
><li class="listitem"><p class="para">Be certain that <em class="emphasis">everything</EM
>
on your system is on your backups.</P
></LI
><li class="listitem"><p class="para">Remember to update your backup regimen whenever
you update your system or change its configuration.</P
></LI
><li class="listitem"><p class="para">Make paper copies of critical files for comparison
or rebuilding your system (e.g., <i class="filename">/etc/passwd</I
>,
<i class="filename">/etc/rc</I
>, and <i class="filename">/etc/fstab</I
>).</P
></LI
><li class="listitem"><p class="para">Make at least every other backup onto a different
tape to guard against media failure.</P
></LI
><li class="listitem"><p class="para">Do not reuse a backup tape too many times, because
the tapes will eventually fail.</P
></LI
><li class="listitem"><p class="para">Try to restore a few files from your backup tapes
on a regular basis.</P
></LI
><li class="listitem"><p class="para">Make periodic archive backups of your entire system
and keep them forever.</P
></LI
><li class="listitem"><p class="para">Try to completely rebuild your system from a set
of backup tapes to be certain that your backup procedures are complete.</P
></LI
><li class="listitem"><p class="para">Keep your backups under lock and key.</P
></LI
><li class="listitem"><p class="para">Do not store your backups in the same room as your
computer system: consider off-site backup storage.</P
></LI
><li class="listitem"><p class="para">Ensure that access to your backup tapes during transport
and storage is limited to authorized and trusted individuals.</P
></LI
><li class="listitem"><p class="para">If your budget and needs are appropriate, investigate
doing backups across a network link to a &quot;hot spare&quot;
site.</P
></LI
><li class="listitem"><p class="para">Encrypt your backups, but escrow the keys in case
you lose them.</P
></LI
><li class="listitem"><p class="para">When using software that accesses files directly
rather than through the raw devices, consider remounting the filesystems
as read-only during backups to prevent changes to file access times.</P
></LI
><li class="listitem"><p class="para">Make periodic paper copies of important files.</P
></LI
></UL
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="PUIS-APP-A-SECT-1.1.7">A.1.1.7 Chapter 8: Defending Your Accounts</A
></H4
><ul class="itemizedlist"><li class="listitem"><p class="para"><a class="indexterm" name="AUTOID-36267"></A
>Make
sure that every account has a password.</P
></LI
><li class="listitem"><p class="para">Make sure to change the password of every &quot;default&quot;
account that came with your <span class="acronym">UNIX</SPAN
>. system. If
possible, disable accounts like <i class="filename">uucp</I
> and <i class="filename">daemon</I
>
so that people cannot use them to log into your system.</P
></LI
><li class="listitem"><p class="para">Do not set up accounts that run single commands.</P
></LI
><li class="listitem"><p class="para">Instead of logging into the <i class="filename">root </I
>account,
log in to your own account and use <i class="filename">su</I
>.</P
></LI
><li class="listitem"><p class="para">Do not create &quot;default&quot; or &quot;guest&quot;
accounts for visitors.</P
></LI
><li class="listitem"><p class="para">If you need to set up an account that can run only
a few commands, use the <i class="filename">rsh </I
>restricted shell.</P
></LI
><li class="listitem"><p class="para">Think about creating restricted filesystem accounts
for special-purpose commands or users.</P
></LI
><li class="listitem"><p class="para">Do not set up a single account that is shared by
a group of people. Use the group ID mechanism instead.</P
></LI
><li class="listitem"><p class="para">Monitor the format and contents of the <i class="filename">/etc/passwd</I
>
file.</P
></LI
><li class="listitem"><p class="para">Put time/tty restrictions on login to accounts
as appropriate.</P
></LI
><li class="listitem"><p class="para">Disable dormant accounts on your computer.</P
></LI
><li class="listitem"><p class="para">Disable the accounts of people on extended vacations.</P
></LI
><li class="listitem"><p class="para">Establish a system by which accounts are always
created with a fixed expiration date and must be renewed to be kept
active.</P
></LI
><li class="listitem"><p class="para">Do not declare network connections, modems, or public
terminals as &quot;secure&quot; in the <i class="filename">/etc/default/login</I
>
or <i class="filename">/etc/ttys</I
> files.</P
></LI
><li class="listitem"><p class="para">Be careful who you put in the <i class="systemitem">wheel</I
> group, as these people
can use the <i class="filename">su </I
>command to become the superuser
(if applicable).</P
></LI
><li class="listitem"><p class="para">If possible, set your systems to require the <i class="filename">root</I
>
password when rebooting in single-user mode.</P
></LI
><li class="listitem"><p class="para">If your system supports the <span class="acronym">TCB</SPAN
>/trusted
path mechanism, enable it.</P
></LI
><li class="listitem"><p class="para">If your system allows the use of a longer password
than the standard <kbd class="command">crypt()</KBD
>
uses, enable it. Tell your users to use longer passwords.</P
></LI
><li class="listitem"><p class="para">Consider using some form of one-time password or
token-based authentication, especially on accounts that may be used
across a network link.</P
></LI
><li class="listitem"><p class="para">Consider using the Distributed Computing Environment
(<span class="acronym">DCE</SPAN
>) or Kerberos for any local network of single-user
workstations, if your vendor software allows it.</P
></LI
><li class="listitem"><p class="para">Enable password constraints, if present in your
software, to help prevent users from picking bad passwords. Otherwise,
consider adding password screening or coaching software to assist
your users in picking good passwords.</P
></LI
><li class="listitem"><p class="para">Consider cracking your own passwords periodically,
but don't place much faith in results that show no passwords
cracked.</P
></LI
><li class="listitem"><p class="para">If you have shadow password capability, enable it.
If your software does not support a shadow password file, contact
the vendor and request that such support be added.</P
></LI
><li class="listitem"><p class="para">If your system does not have a shadow password file,
make sure that the file <i class="filename">/etc/passwd </I
>cannot
be read anonymously over the network via <span class="acronym">UUCP</SPAN
>
or <span class="acronym">TFTP</SPAN
>.</P
></LI
><li class="listitem"><p class="para">If your computer supports password aging, set a
lifetime between one and six months.</P
></LI
><li class="listitem"><p class="para">If you have source code for your operating system,
you may wish to slightly alter the algorithm used by <i class="filename">crypt</I
>()
to encrypt your password. For example, you can increase the number
of encryption rounds from 25 to 200.</P
></LI
><li class="listitem"><p class="para">If you are using a central mail server or firewall,
consider the benefits of account-name aliasing.</P
></LI
></UL
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="PUIS-APP-A-SECT-1.1.8">A.1.1.8 Chapter 9: Integrity Management</A
></H4
><ul class="itemizedlist"><li class="listitem"><p class="para"><a class="indexterm" name="AUTOID-36346"></A
>If
your system supports immutable files, use them. If you don't
have them, consider asking your vendor when they will be supported
in your version of <span class="acronym">UNIX</SPAN
>.</P
></LI
><li class="listitem"><p class="para">If possible, mount disks read-only if they contain
system software.</P
></LI
><li class="listitem"><p class="para">Make a checklist listing the size, modification
time, and permissions of every program on your system. You may wish
to include cryptographic checksums in the lists. Keep copies of
this checklist on removable media and use them to determine if any
of your system files or programs have been modified.</P
></LI
><li class="listitem"><p class="para">Write a daily check script to check for unauthorized
changes to files and system directories.</P
></LI
><li class="listitem"><p class="para">Double check the protection attributes on system
command and data files, on their directories, and on all ancestor
directories.</P
></LI
><li class="listitem"><p class="para">If you export filesystems containing system programs,
you may wish to export these filesystems read-only, so that they
cannot be modified by <span class="acronym">NFS</SPAN
> clients.</P
></LI
><li class="listitem"><p class="para">Consider making all files on <span class="acronym">NFS</SPAN
>-exported
disks owned by user <i class="filename">root</I
>.</P
></LI
><li class="listitem"><p class="para">If you have backups of critical directories, you
can use comparison checking to detect unauthorized modifications.
Be careful to protect your backup copies and comparison programs
from potential attackers.</P
></LI
><li class="listitem"><p class="para">Consider running <i class="filename">rdist</I
> from
a protected system on a regular basis to report changes.</P
></LI
><li class="listitem"><p class="para">Make an offline list of every <span class="acronym">SUID</SPAN
>
and <span class="acronym">SGID</SPAN
> file on your system.</P
></LI
><li class="listitem"><p class="para">Consider installing something to check message digests
of files (e.g., Tripwire). Be certain that the program and all its
data files are stored on read-only media or protected with encryption
(or both).</P
></LI
></UL
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="PUIS-APP-A-SECT-1.1.9">A.1.1.9 Chapter 10: Auditing and Logging</A
></H4
><ul class="itemizedlist"><li class="listitem"><p class="para"><a class="indexterm" name="AUTOID-36381"></A
><a class="indexterm" name="AUTOID-36384"></A
>Consider installing a dedicated PC or other non-<span class="acronym">UNIX</SPAN
>
machine as a network log host.</P
></LI
><li class="listitem"><p class="para">Have your users check the last login time each time
they log in to make sure that nobody else is using their accounts.</P
></LI
><li class="listitem"><p class="para">Consider installing a simple <kbd class="command">cron</KBD
> task to save copies
of the <i class="filename">lastlog</I
> file to track logins.</P
></LI
><li class="listitem"><p class="para">Evaluate whether C2 logging on your system is practical
and appropriate. If so, install it.</P
></LI
><li class="listitem"><p class="para">Determine if there is an intrusion-detection and/or
audit-reduction tool available to use with your C2 logs.</P
></LI
><li class="listitem"><p class="para">Make sure that your <i class="filename">utmp</I
> file
is not world writable.</P
></LI
><li class="listitem"><p class="para">Turn on whatever accounting mechanism you may have
that logs command usage.</P
></LI
><li class="listitem"><p class="para">Run <i class="filename">last </I
>periodically to see
who has been using the system. Use this program on a regular basis.</P
></LI
><li class="listitem"><p class="para">Review your specialized log files on a regular basis.
This review should include (if they exist on your system) <i class="filename">loginlog,
sulog, aculog, xferlog</I
>, and others.</P
></LI
><li class="listitem"><p class="para">Consider adding an automatic log monitor such as
Swatch.</P
></LI
><li class="listitem"><p class="para">Make sure that your log files are on your daily
backups before they get reset.</P
></LI
><li class="listitem"><p class="para">If you have <i class="filename">syslog</I
>, configure
it so that all <i class="filename">auth</I
> messages are logged to
a special file. If you can, also have these messages logged to a
special hardcopy printer and to another computer on your network.</P
></LI
><li class="listitem"><p class="para">Be aware that log file entries may be forged and
misleading in the event of a carefully crafted attack.</P
></LI
><li class="listitem"><p class="para">Keep a paper log on a per-site and per-machine basis.</P
></LI
><li class="listitem"><p class="para">If you process your logs in an automated fashion,
craft your filters so that they exclude the things you don't
want rather than pass only what you do want. This approach will
ensure that you see all exceptional condition messages.</P
></LI
></UL
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="PUIS-APP-A-SECT-1.1.10">A.1.1.10 Chapter 11: Protecting Against Programmed Threats</A
></H4
><ul class="itemizedlist"><li class="listitem"><p class="para"><a class="indexterm" name="AUTOID-36428"></A
><a class="indexterm" name="AUTOID-36431"></A
>Be <em class="emphasis">extremely</EM
> careful about installing
new software. Never install binaries obtained from untrustworthy
sources (like the Usenet).</P
></LI
><li class="listitem"><p class="para">When installing new software, install it first on
a noncritical system on which you can test it and observe any misbehavior
or bugs.</P
></LI
><li class="listitem"><p class="para">Run integrity checks on your system on a regular
basis (see Chapter 9).</P
></LI
><li class="listitem"><p class="para">Don't include nonstandard directories in
your execution path.</P
></LI
><li class="listitem"><p class="para">Don't leave any <i class="filename">bin</I
>
or library directories writable by untrustworthy accounts.</P
></LI
><li class="listitem"><p class="para">Set permissions on commands to prevent unauthorized
alteration.</P
></LI
><li class="listitem"><p class="para">Scan your system for any user home directories or
dot files that are world writable or group writable.</P
></LI
><li class="listitem"><p class="para">If you suspect a network-based worm attack or a
virus in widely circulated software, call a <span class="acronym">FIRST</SPAN
>
response team or the vendor to confirm the instance before spreading
any alarm.</P
></LI
><li class="listitem"><p class="para">Never write or use <span class="acronym">SUID</SPAN
> or <span class="acronym">SGID</SPAN
>
shell scripts unless you are a hoary <span class="acronym">UNIX</SPAN
> wizard.</P
></LI
><li class="listitem"><p class="para">Disable terminal answer-back, if possible.</P
></LI
><li class="listitem"><p class="para">Never have &quot;.&quot; (the current directory)
in your search path. Never have writable directories in your search
path.</P
></LI
><li class="listitem"><p class="para">When running as the superuser, get in the habit
of typing full pathnames for commands.</P
></LI
><li class="listitem"><p class="para">Check the behavior of your <i class="filename">xargs</I
>
and <i class="filename">find</I
> commands. Review the use of these
commands (and the shell) in all scripts executed by<i class="filename"> cron.</I
></P
></LI
><li class="listitem"><p class="para">Watch for unauthorized modification to initialization
files in any user or system account, including editor start-up files,
<i class="filename">.forward</I
> files, etc.</P
></LI
><li class="listitem"><p class="para">Periodically review all system start-up and configuration
files for additions and changes.</P
></LI
><li class="listitem"><p class="para">Periodically review mailer alias files for unauthorized
changes.</P
></LI
><li class="listitem"><p class="para">Periodically review configuration files for server
programs (e.g.,<i class="filename"> inetd.conf</I
>).</P
></LI
><li class="listitem"><p class="para">Check the security of your <i class="filename">at </I
>program,
and disable the program if necessary.</P
></LI
><li class="listitem"><p class="para">Verify that any files run from the <kbd class="command">cron</KBD
> command
files cannot be altered or replaced by unauthorized users.</P
></LI
><li class="listitem"><p class="para">Don't use the <i class="filename">vi</I
> or
<i class="filename">ex</I
> editors in a directory without first checking
for a Trojan <i class="filename">.exrc </I
>file. Disable the automatic
command execution feature in <span class="acronym">GNU</SPAN
> Emacs.</P
></LI
><li class="listitem"><p class="para">Make sure that the devices used for backups are
not world readable.</P
></LI
><li class="listitem"><p class="para">Make sure that any shared libraries are properly
protected and that protections cannot be overridden.</P
></LI
></UL
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="PUIS-APP-A-SECT-1.1.11">A.1.1.11 Chapter 12: Physical Security</A
></H4
><ul class="itemizedlist"><li class="listitem"><p class="para"><a class="indexterm" name="AUTOID-36498"></A
>Develop a physical security plan that includes a
description of your assets, environment, threats, perimeter, and
defenses.</P
></LI
><li class="listitem"><p class="para">Determine who might have physical access to any
of your resources under any circumstances.</P
></LI
><li class="listitem"><p class="para">Have heat and smoke alarms in your computer room.
If you have a raised floor, install alarm sensors both above and
below the floor. If you have a dropped ceiling, put sensors above
the ceiling, too.</P
></LI
><li class="listitem"><p class="para">Check the placement and recharge status of fire
extinguishers on a regular basis.</P
></LI
><li class="listitem"><p class="para">Make sure that personnel know how to use all fire
protection and suppression equipment.</P
></LI
><li class="listitem"><p class="para">Make sure that the placement and nature of fire-suppression
systems will not endanger personnel or equipment more than is necessary.</P
></LI
><li class="listitem"><p class="para">Have water sensors installed above and below raised
floors in your computer room.</P
></LI
><li class="listitem"><p class="para">Train your users and operators about what to do
when an alarm sounds.</P
></LI
><li class="listitem"><p class="para">Strictly prohibit smoking, eating, and drinking
in your computer room or near computer equipment.</P
></LI
><li class="listitem"><p class="para">Install and regularly clean air filters in your
computer room.</P
></LI
><li class="listitem"><p class="para">Place your computer systems where they will be protected
in the event of earthquake, explosion, or structural failure.</P
></LI
><li class="listitem"><p class="para">Keep your backups offsite.</P
></LI
><li class="listitem"><p class="para">Have temperature and humidity controls in your computer
room. Have alarms associated with the systems to indicate if values
get out of range. Have recorders to monitor these values over time.</P
></LI
><li class="listitem"><p class="para">Beware of insects trying to &quot;bug&quot;
your computers.</P
></LI
><li class="listitem"><p class="para">Install filtered power and/or surge protectors
for all your computer equipment. Consider installing an uninterruptible
power supply, if appropriate.</P
></LI
><li class="listitem"><p class="para">Have antistatic measures in place.</P
></LI
><li class="listitem"><p class="para">Store computer equipment and magnetic media away
from building structural steel members that might conduct electricity
after a lightning strike.</P
></LI
><li class="listitem"><p class="para">Lock and physically isolate your computers from
public access.</P
></LI
><li class="listitem"><p class="para">Consider putting motion alarms or other protections
in place to protect valuable equipment when personnel are not present.</P
></LI
><li class="listitem"><p class="para">Protect power switches and fuses.</P
></LI
><li class="listitem"><p class="para">Avoid having glass walls or large windows in your
computer room.</P
></LI
><li class="listitem"><p class="para">Protect all your network cables, terminators, and
connectors from tampering. Examine them periodically.</P
></LI
><li class="listitem"><p class="para">Use locks, tie-downs, and bolts to keep computer
equipment from being carried away.</P
></LI
><li class="listitem"><p class="para">Encrypt sensitive data held on your systems.</P
></LI
><li class="listitem"><p class="para">Have disaster-recovery and business-continuation
plans in place.</P
></LI
><li class="listitem"><p class="para">Consider using fiber optic cable for networks.</P
></LI
><li class="listitem"><p class="para">Physically protect your backups and test them periodically.</P
></LI
><li class="listitem"><p class="para">Sanitize media (e.g., tapes and disks) and printouts
before disposal. Use bulk erasers, shredders, or incinerators.</P
></LI
><li class="listitem"><p class="para">Check peripheral devices for local onboard storage
that can lead to disclosure of information.</P
></LI
><li class="listitem"><p class="para">Consider encrypting all of your backups and offline
storage.</P
></LI
><li class="listitem"><p class="para">Never use programmable function keys on a terminal
for login or password information.</P
></LI
><li class="listitem"><p class="para">Consider setting <i class="filename">autologout </I
>on
user accounts. <a class="indexterm" name="AUTOID-36564"></A
></P
></LI
></UL
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="PUIS-APP-A-SECT-1.1.12">A.1.1.12 Chapter 13: Personnel Security</A
></H4
><ul class="itemizedlist"><li class="listitem"><p class="para"><a class="indexterm" name="AUTOID-36572"></A
><a class="indexterm" name="AUTOID-36575"></A
>Conduct background checks of individuals
being considered for sensitive positions. Do so with the permission
of the applicants.</P
></LI
><li class="listitem"><p class="para">If the position is extremely sensitive, and if it
is legally allowable, consider using a polygraph examination of
the candidate.</P
></LI
><li class="listitem"><p class="para">Have applicants and contractors in sensitive positions
obtain bonding.</P
></LI
><li class="listitem"><p class="para">Provide comprehensive and appropriate training for
all new personnel, and for personnel taking on new assignments.</P
></LI
><li class="listitem"><p class="para">Provide refresher training on a regular basis.</P
></LI
><li class="listitem"><p class="para">Make sure that staff have adequate time and resources
to pursue continuing education opportunities.</P
></LI
><li class="listitem"><p class="para">Institute an ongoing user security-awareness program.</P
></LI
><li class="listitem"><p class="para">Have regular performance reviews and monitoring.
Try to resolve potential problems before they become real problems.</P
></LI
><li class="listitem"><p class="para">Make sure that users in sensitive positions are
not overloaded with work, responsibility or stress on a frequent
or regular basis, even if compensated for the overload. In particular,
users should be required to take holiday and vacation leave regularly.</P
></LI
><li class="listitem"><p class="para">Monitor users in sensitive positions (without intruding
on their privacy) for signs of excess stress or personal problems.</P
></LI
><li class="listitem"><p class="para">Audit access to equipment and critical data.</P
></LI
><li class="listitem"><p class="para">Apply policies of least privilege and separation
of duties where applicable.</P
></LI
><li class="listitem"><p class="para">When any user leaves the organization, make sure
that access is properly terminated and duties transferred.</P
></LI
><li class="listitem"><p class="para">Make sure that no user becomes irreplaceable.</P
></LI
></UL
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="PUIS-APP-A-SECT-1.1.13">A.1.1.13 Chapter 14: Telephone Security</A
></H4
><ul class="itemizedlist"><li class="listitem"><p class="para"><a class="indexterm" name="AUTOID-36609"></A
>Make
sure that incoming modems automatically log out the user if the
telephone call gets interrupted.</P
></LI
><li class="listitem"><p class="para">Make sure that incoming modems automatically hang
up on an incoming call if the caller logs out or if the caller's
login process gets killed.</P
></LI
><li class="listitem"><p class="para">Make sure that outgoing modems hang up on the outgoing
call if the <i class="filename">tip</I
> or <i class="filename">cu </I
>program
is exited.</P
></LI
><li class="listitem"><p class="para">Make sure that the <i class="filename">tip</I
> or <i class="filename">cu</I
>
programs automatically exit if the user gets logged out of the remote
machine or if the telephone call is interrupted.</P
></LI
><li class="listitem"><p class="para">Make sure that there is no way for the local user
to reprogram the modem.</P
></LI
><li class="listitem"><p class="para">Do not install call forwarding on any of your incoming
lines.</P
></LI
><li class="listitem"><p class="para">Consider getting <span class="acronym">CALLER</SPAN
>*<span class="acronym">ID/ANI</SPAN
>
to trace incoming calls automatically. Log the numbers that call
your system.</P
></LI
><li class="listitem"><p class="para">Physically protect the modems and phone lines.</P
></LI
><li class="listitem"><p class="para">Disable third-party billing to your modem lines.</P
></LI
><li class="listitem"><p class="para">Consider getting leased lines and/or callback
modems.</P
></LI
><li class="listitem"><p class="para">Consider using separate callout telephone lines
with no dial-in capability for callback schemes.</P
></LI
><li class="listitem"><p class="para">Check permissions on all associated devices and
configuration files.</P
></LI
><li class="listitem"><p class="para">Consider use of encrypting modems with fixed keys
to guard against unauthorized use or eavesdropping.</P
></LI
></UL
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="PUIS-APP-A-SECT-1.1.14">A.1.1.14 Chapter 15: UUCP</A
></H4
><ul class="itemizedlist"><li class="listitem"><p class="para"><a class="indexterm" name="AUTOID-36647"></A
>Be
sure that every <span class="acronym">UUCP</SPAN
> login has a unique password.</P
></LI
><li class="listitem"><p class="para">Set up a different <span class="acronym">UUCP</SPAN
> login
for every computer you communicate with via <span class="acronym">UUCP</SPAN
>.</P
></LI
><li class="listitem"><p class="para">Make sure that <i class="filename">/usr/lib/uucp/L.sys</I
>
or <i class="filename">/usr/lib/uucp/Systems</I
> is
mode 400, readable only by the <span class="acronym">UUCP</SPAN
> user.</P
></LI
><li class="listitem"><p class="para">Do not export <span class="acronym">UUCP</SPAN
> files or commands
on a writable <span class="acronym">NFS</SPAN
> partition.</P
></LI
><li class="listitem"><p class="para">Make sure that the files in the <i class="filename">/usr/lib/uucp</I
>
directories can't be read or written remotely or locally
with the <span class="acronym">UUCP</SPAN
> system.</P
></LI
><li class="listitem"><p class="para">Make sure that no <span class="acronym">UUCP</SPAN
> login
has <i class="filename">/usr/spool/uucp/uucppublic</I
>
for its home directory.</P
></LI
><li class="listitem"><p class="para">Limit <span class="acronym">UUCP</SPAN
> access to the smallest
set of directories necessary.</P
></LI
><li class="listitem"><p class="para">If there are daily, weekly, or monthly administrative
scripts run by cron to clean up the <span class="acronym">UUCP</SPAN
> system,
make sure that they are run with the <span class="acronym">UUCP</SPAN
> <span class="acronym">UID</SPAN
>
but that they are owned by <kbd class="command">root</KBD
>.</P
></LI
><li class="listitem"><p class="para">Make sure that the <kbd class="command">ruusend</KBD
> command is not in your
<i class="filename">L.cmds</I
> file (Version 2 <span class="acronym">UUCP</SPAN
>.</P
></LI
><li class="listitem"><p class="para">Only allow execution of commands by <span class="acronym">UUCP</SPAN
>
that are absolutely necessary.</P
></LI
><li class="listitem"><p class="para">Consider making some or all of your <span class="acronym">UUCP</SPAN
>
connections use callback to initiate a connection.</P
></LI
><li class="listitem"><p class="para">Make sure that mail to the <span class="acronym">UUCP</SPAN
>
users gets sent to the system administrator.</P
></LI
><li class="listitem"><p class="para">Test your mailer to make sure that it will not deliver
a file or execute a command that is encapsulated in an address.</P
></LI
><li class="listitem"><p class="para">Disable <span class="acronym">UUCP</SPAN
> over IP unless you
need <span class="acronym">UUCP</SPAN
>.</P
></LI
><li class="listitem"><p class="para">If the machine has an active <span class="acronym">FTP</SPAN
>
service, ensure that all <span class="acronym">UUCP</SPAN
> users are listed
in the <i class="filename">/etc/ftpusers </I
>file.</P
></LI
><li class="listitem"><p class="para">Be sure that the <span class="acronym">UUCP</SPAN
> control
files are protected and cannot be read or modified using the <span class="acronym">UUCP</SPAN
>
program.</P
></LI
><li class="listitem"><p class="para">Only give <span class="acronym">UUCP</SPAN
><em class="emphasis"> </EM
>access
to the directories to which it needs access. You may wish to limit
<span class="acronym">UUCP</SPAN
> to the directory <em class="emphasis">/usr/spool/uucppublic</EM
>.</P
></LI
><li class="listitem"><p class="para">Limit the commands which can be executed from offsite
to those that are absolutely necessary.</P
></LI
><li class="listitem"><p class="para">Disable or delete any <em class="emphasis">uucpd</EM
>
daemon if you aren't using it.</P
></LI
><li class="listitem"><p class="para">Remove all of the <span class="acronym">UUCP</SPAN
> software
and libraries if you aren't going to use them.</P
></LI
></UL
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="PUIS-APP-A-SECT-1.1.15">A.1.1.15 Chapter 16: TCP/IP Networks</A
></H4
><ul class="itemizedlist"><li class="listitem"><p class="para"><a class="indexterm" name="AUTOID-36729"></A
><a class="indexterm" name="AUTOID-36732"></A
>Consider low-level encryption
mechanisms in enterprise networks, or to &quot;tunnel&quot;
through external networks.</P
></LI
><li class="listitem"><p class="para">Do not depend on IP addresses or <span class="acronym">DNS</SPAN
>
information for authentication.</P
></LI
><li class="listitem"><p class="para">Do not depend on header information in news articles
or email as they can be forged.</P
></LI
></UL
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="PUIS-APP-A-SECT-1.1.16">A.1.1.16 Chapter 17: TCP/IP Services</A
></H4
><ul class="itemizedlist"><li class="listitem"><p class="para">Routinely examine your <i class="filename">inetd</I
> configuration
file.</P
></LI
><li class="listitem"><p class="para">If your standard software does not offer this level
of control, consider installing the <i class="filename">tcpwrapper</I
>
program to better regulate and log access to your servers. Then,
contact your vendor and ask when equivalent functionality will be
provided as a standard feature in the vendors' systems.</P
></LI
><li class="listitem"><p class="para">Disable any unneeded network services.</P
></LI
><li class="listitem"><p class="para">Consider disabling any services that provide nonessential
information to outsiders that might enable them to gather information
about your systems.</P
></LI
><li class="listitem"><p class="para">Make sure that your version of the <i class="filename">ftpd</I
> program is up to date.</P
></LI
><li class="listitem"><p class="para">If you support anonymous <span class="acronym">FTP</SPAN
>,
don't have a copy of your real <i class="filename">/etc/passwd</I
>
as an <i class="filename">~ftp/etc/passwd.</I
></P
></LI
><li class="listitem"><p class="para">Make sure that <i class="filename">/etc/ftpusers</I
> contains
at least the account names <i class="filename">root</I
>, <kbd class="command">uucp</KBD
>, and <kbd class="command">bin</KBD
>. The file should
also contain the name of any other account that does not belonged
to an actual human being.</P
></LI
><li class="listitem"><p class="para">Frequently scan the files in, and usage of, your
<kbd class="command">ftp</KBD
> account.</P
></LI
><li class="listitem"><p class="para">Make sure that all directory permissions and ownership
on your ftp account are set correctly.</P
></LI
><li class="listitem"><p class="para">If your software allows, configure any &quot;incoming&quot;
directories so that files dropped off cannot then be uploaded without
operator intervention.</P
></LI
><li class="listitem"><p class="para">Make sure that your <kbd class="command">sendmail</KBD
> program will not deliver
mail directly to a file.</P
></LI
><li class="listitem"><p class="para">Make sure that your <kbd class="command">sendmail</KBD
> program does not have
a wizard's password set in the configuration file.</P
></LI
><li class="listitem"><p class="para">Limit the number of &quot;trusted users&quot;
in your <i class="filename">sendmail.cf</I
> file.</P
></LI
><li class="listitem"><p class="para">Make sure that your version of the <kbd class="command">sendmail</KBD
> program
does not support the <kbd class="command">debug</KBD
>, <kbd class="command">wiz</KBD
>, or <kbd class="command">kill</KBD
> commands.</P
></LI
><li class="listitem"><p class="para">Delete the &quot;decode&quot; alias in your
<i class="filename">aliases</I
> file. Examine carefully any other alias that delivers to
a program or file.</P
></LI
><li class="listitem"><p class="para">Make sure that your version of the <kbd class="command">sendmail</KBD
> program
is up to date, with all published patches in place.</P
></LI
><li class="listitem"><p class="para">Make sure that the <i class="filename">aliases</I
> file cannot be altered
by unauthorized individuals.</P
></LI
><li class="listitem"><p class="para">Consider replacing <kbd class="command">sendmail</KBD
> with <kbd class="command">smap</KBD
>, or another
more tractable network agent.</P
></LI
><li class="listitem"><p class="para">Have an alias for every non-user account so that
mail to any valid address gets delivered to a person and not to
an unmonitored mailbox.</P
></LI
><li class="listitem"><p class="para">Consider disabling <span class="acronym">SMTP</SPAN
> commands
such as <span class="acronym">VRFY</SPAN
> and <span class="acronym">EXPN</SPAN
> with
settings in your <kbd class="command">sendmail</KBD
> configuration.</P
></LI
><li class="listitem"><p class="para">Disable zone transfers in your <span class="acronym">DNS</SPAN
>,
if possible.</P
></LI
><li class="listitem"><p class="para">Make sure that you are running the latest version
of the nameserver software (e.g., <kbd class="command">bind</KBD
>) with all patches applied.</P
></LI
><li class="listitem"><p class="para">Make sure that all files used by the nameserver
software are properly protected against tampering, and perhaps against
reading by unauthorized users.</P
></LI
><li class="listitem"><p class="para">Use IP addresses instead of domain names in places
where the practice makes sense (e.g., in <i class="filename">.rhosts</I
> files). (But beware
that most implementations of trusted commands don't understand
IP addresses in .rhosts, and that, in such cases, doing this might
introduce a vulnerability.)</P
></LI
><li class="listitem"><p class="para">Make sure that <span class="acronym">TFTP</SPAN
> access, if
enabled, is limited to a single directory containing boot files.</P
></LI
><li class="listitem"><p class="para">Tell your users about the information that the <kbd class="command">finger</KBD
>
program makes available on the network.</P
></LI
><li class="listitem"><p class="para">Make sure that your <kbd class="command">finger</KBD
> program is more recent
than November 5, 1988.</P
></LI
><li class="listitem"><p class="para">Disable or replace the <kbd class="command">finger</KBD
> service with something
that provides less information.</P
></LI
><li class="listitem"><p class="para">If you are using <span class="acronym">POP</SPAN
> or <span class="acronym">IMAP</SPAN
>,
configure your system to use <span class="acronym">APOP</SPAN
> or Kerberos
for authentication.</P
></LI
><li class="listitem"><p class="para">Consider running the <kbd class="command">authd</KBD
> daemon for all machines
in the local net.</P
></LI
><li class="listitem"><p class="para">Configure your <span class="acronym">NNTP</SPAN
> or <span class="acronym">INND</SPAN
>
server to restrict who can post articles or transfer Usenet news.
Make sure that you have the most recent version of the software.</P
></LI
><li class="listitem"><p class="para">Block <span class="acronym">NTP</SPAN
> connections from outside
your organization.</P
></LI
><li class="listitem"><p class="para">Block <span class="acronym">SNMP</SPAN
> connections from outside
your organization.</P
></LI
><li class="listitem"><p class="para">Disable <kbd class="command">rexec</KBD
> service unless needed.</P
></LI
><li class="listitem"><p class="para">Routinely scan your system for suspicious <i class="filename">.rhosts</I
>
files. Make sure that all existing <i class="filename">.rhosts</I
> files are protected to
mode 600.</P
></LI
><li class="listitem"><p class="para">Consider not allowing users to have <i class="filename">.rhosts</I
> files
on your system.</P
></LI
><li class="listitem"><p class="para">If you have a plus sign (+) in your <i class="filename">/etc/hosts.equiv</I
>
file, <em class="emphasis">remove it.</EM
></P
></LI
><li class="listitem"><p class="para">Do not place usernames in your <i class="filename">/etc/hosts.equiv</I
>
file.</P
></LI
><li class="listitem"><p class="para">Restrict access to your printing software via the
<i class="filename">/etc/hosts.lpd</I
> file.</P
></LI
><li class="listitem"><p class="para">Make your list of trusted hosts as small as possible.</P
></LI
><li class="listitem"><p class="para">Block incoming <span class="acronym">RIP</SPAN
> packets; use
static routes where possible and practical.</P
></LI
><li class="listitem"><p class="para">Disable <span class="acronym">UUCP</SPAN
> over IP unless needed.</P
></LI
><li class="listitem"><p class="para">Set up your <i class="filename">logindevperm</I
> or <i class="filename">fbtab</I
> files to restrict
permissions on frame buffers and devices, if this is possible on
your system.</P
></LI
><li class="listitem"><p class="para">If your X11 Server blocks on null connections, get
an updated version.</P
></LI
><li class="listitem"><p class="para">Enable the best X11 authentication possible in your
configuration (e.g., Kerberos, Secure <span class="acronym">RPC</SPAN
>, &quot;magic
cookies&quot;) instead of using <kbd class="command">xhost</KBD
>.</P
></LI
><li class="listitem"><p class="para">Disable the <kbd class="command">rexd</KBD
> <span class="acronym">RPC</SPAN
> service.</P
></LI
><li class="listitem"><p class="para">Be very cautious about installing <span class="acronym">MUDS</SPAN
>,
<span class="acronym">IRCS</SPAN
>, or other servers.</P
></LI
><li class="listitem"><p class="para">Scan your network connections regularly with <kbd class="command">netstat</KBD
>.</P
></LI
><li class="listitem"><p class="para">Scan your network with tools such as <span class="acronym">SATAN</SPAN
>
and <span class="acronym">ISS</SPAN
> to determine if you have uncorrected
vulnerabilities &nbsp;-  before an attacker does the same.</P
></LI
><li class="listitem"><p class="para">Re-evaluate why you are connected to the network
at all, and disconnect machines that do not really need to be connected.<a class="indexterm" name="AUTOID-36906"></A
><a class="indexterm" name="AUTOID-36909"></A
></P
></LI
></UL
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="PUIS-APP-A-SECT-1.1.17">A.1.1.17 Chapter 18: WWW Security</A
></H4
><ul class="itemizedlist"><li class="listitem"><p class="para"><a class="indexterm" name="AUTOID-36917"></A
>Consider running any <span class="acronym">WWW</SPAN
> server
from a Macintosh platform instead of from a <span class="acronym">UNIX</SPAN
>
platform.</P
></LI
><li class="listitem"><p class="para">Do not run your server as user <i class="filename">root</I
>. Have it set
to run as a <i class="systemitem">nobody</I
> user
unique to the <span class="acronym">WWW</SPAN
> service.</P
></LI
><li class="listitem"><p class="para">Become familiar with all the configuration options
for the particular server you use, and set its options appropriately
(and conservatively).</P
></LI
><li class="listitem"><p class="para">Disable automatic directory listings.</P
></LI
><li class="listitem"><p class="para">Set the server to not follow symbolic links, or
to only follow links that are owned by the same user that owns the
destination of the link.</P
></LI
><li class="listitem"><p class="para">Limit or prohibit server-side includes.</P
></LI
><li class="listitem"><p class="para">Be extremely cautions about writing and installing
<span class="acronym">CGI</SPAN
> scripts or programs. (See the specific programming
recommendations in the chapter.) Consider using <kbd class="command">taintperl</KBD
> as the
implementation language.</P
></LI
><li class="listitem"><p class="para">Configure your server to only allow <span class="acronym">CGI</SPAN
>
scripts from a particular directory under your control.</P
></LI
><li class="listitem"><p class="para">Do not mix <span class="acronym">WWW</SPAN
> and <span class="acronym">FTP</SPAN
>
servers on the same machine in the same filesystem hierarchy.</P
></LI
><li class="listitem"><p class="para">Consider making your <span class="acronym">WWW</SPAN
> server
<kbd class="command">chroot</KBD
> into a protected directory.</P
></LI
><li class="listitem"><p class="para">Monitor the logs and usage of your <span class="acronym">WWW</SPAN
>
service.</P
></LI
><li class="listitem"><p class="para">If you are transferring sensitive information over
the <span class="acronym">WWW</SPAN
> connection (e.g., personal information),
enable encryption.</P
></LI
><li class="listitem"><p class="para">Prevent general access to the server log files.</P
></LI
><li class="listitem"><p class="para">Be aware of the potential risks posed by dependence
on a limited number of third-party providers.</P
></LI
></UL
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="PUIS-APP-A-SECT-1.1.18">A.1.1.18 Chapter 19: RPC, NIS, NIS+, and Kerberos</A
></H4
><ul class="itemizedlist"><li class="listitem"><p class="para">Enable Kerberos or Secure <span class="acronym">RPC</SPAN
>
if possible.</P
></LI
><li class="listitem"><p class="para">Use <span class="acronym">NIS</SPAN
>+ in preference
to <span class="acronym">NIS</SPAN
>, if possible.</P
></LI
><li class="listitem"><p class="para">Use netgroups to restrict access to services, including
login.</P
></LI
><li class="listitem"><p class="para">Put <kbd class="command">keylogout</KBD
> in your <kbd class="command">logout</KBD
> file if you are running
secure <span class="acronym">RPC</SPAN
>.</P
></LI
><li class="listitem"><p class="para">Make sure that your version of <kbd class="command">ypbind</KBD
> only listens
on privileged ports.</P
></LI
><li class="listitem"><p class="para">Make sure that your version of <kbd class="command">portmapper</KBD
> does not
do proxy forwarding.</P
></LI
><li class="listitem"><p class="para">If your version of <kbd class="command">portmapper</KBD
> has a &quot;securenets&quot;
feature, configure the program so that it restricts which machines
can send requests to your portmapper. If this feature is not present,
contact your vendor and ask when it will be supported.</P
></LI
><li class="listitem"><p class="para">Make sure that there is an asterisk (*)
in the password field of any line beginning with a plus sign (+)
in both the <kbd class="command">passwd</KBD
> and <kbd class="command">group</KBD
> files of any <span class="acronym">NIS</SPAN
>
client.</P
></LI
><li class="listitem"><p class="para">Make sure that there is no line beginning with a
plus sign (+) in the <kbd class="command">passwd</KBD
> or <kbd class="command">group</KBD
> files on any <span class="acronym">NIS</SPAN
>
server.</P
></LI
><li class="listitem"><p class="para">If you are using Kerberos, understand its limitations.</P
></LI
></UL
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="PUIS-APP-A-SECT-1.1.19">A.1.1.19 Chapter 20: NFS</A
></H4
><ul class="itemizedlist"><li class="listitem"><p class="para"><a class="indexterm" name="AUTOID-37003"></A
>Program your firewall and routers to block <span class="acronym">NFS</SPAN
>
packets.</P
></LI
><li class="listitem"><p class="para">Use <span class="acronym">NFS</SPAN
> version 3, if available,
in <span class="acronym">TCP</SPAN
> mode.</P
></LI
><li class="listitem"><p class="para">Use the netgroups mechanism to restrict the export
of (and thus the ability to remotely mount) filesystems to a small
set of local machines.</P
></LI
><li class="listitem"><p class="para">Mount partitions <kbd class="command">nosuid</KBD
> unless <span class="acronym">SUID</SPAN
>
access is absolutely necessary.</P
></LI
><li class="listitem"><p class="para">Mount partitions <kbd class="command">nodev</KBD
>, if available.</P
></LI
><li class="listitem"><p class="para">Set <i class="filename">root</I
> ownership on files and directories mounted
remotely.</P
></LI
><li class="listitem"><p class="para">Never export a mounted partition on your system
to an untrusted machine if the partition has any world- or group-writable
directories.</P
></LI
><li class="listitem"><p class="para">Set the kernel <kbd class="command">portmon</KBD
> variable to ignore <span class="acronym">NFS</SPAN
>
requests from unprivileged ports.</P
></LI
><li class="listitem"><p class="para">Export filesystems to a small set of hosts, using
the <i class="filename">access=</I
> or <i class="filename">ro=</I
> options.</P
></LI
><li class="listitem"><p class="para">Do not export user home directories in a writable
mode.</P
></LI
><li class="listitem"><p class="para">Do not export filesystems to yourself!</P
></LI
><li class="listitem"><p class="para">Do not use the <i class="filename">root=</I
> option when exporting
filesystems unless absolutely necessary.</P
></LI
><li class="listitem"><p class="para">Use <i class="filename">fsirand</I
> on all partitions
that are exported. Rerun the program periodically.</P
></LI
><li class="listitem"><p class="para">When possible, use the <kbd class="command">secure</KBD
> option for <span class="acronym">NFS</SPAN
>
mounts.</P
></LI
><li class="listitem"><p class="para">Monitor who is mounting your <span class="acronym">NFS</SPAN
>
partitions (but realize that you may not have a complete picture
because of the stateless nature of <span class="acronym">NFS</SPAN
>).</P
></LI
><li class="listitem"><p class="para">Reconsider why you want to use <span class="acronym">NFS</SPAN
>,
and think about doing without. For instance, replicating disk on
local machines may be a safer approach.</P
></LI
></UL
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="PUIS-APP-A-SECT-1.1.20">A.1.1.20 Chapter 21: Firewalls</A
></H4
><ul class="itemizedlist"><li class="listitem"><p class="para"><a class="indexterm" name="AUTOID-37059"></A
>Keep
in mind that firewalls should be used <em class="emphasis">in addition to</EM
>
other security measure and not <em class="emphasis">in place of</EM
>
them.</P
></LI
><li class="listitem"><p class="para">Consider setting a policy of default deny for your
firewall.</P
></LI
><li class="listitem"><p class="para">Consider internal firewalls as well as external
firewalls.</P
></LI
><li class="listitem"><p class="para">Use the most complete firewall you can afford and
one that makes sense in your environment. At the very least, put
a screening router in place.</P
></LI
><li class="listitem"><p class="para">Consider buying a commercially provided and configured
firewall, rather than creating your own.</P
></LI
><li class="listitem"><p class="para">Plan on centralizing services such as <span class="acronym">DNS</SPAN
>,
email, and Usenet on closely guarded bastion hosts.</P
></LI
><li class="listitem"><p class="para">Break your network up into small, independent subnets.
Each subnet should have its own <span class="acronym">NIS</SPAN
> server and
netgroups domain.</P
></LI
><li class="listitem"><p class="para">Don't configure any machine to trust machines
outside the local subnet.</P
></LI
><li class="listitem"><p class="para">Make sure that user accounts have different passwords
for machines on different subnets.</P
></LI
><li class="listitem"><p class="para">Make sure that firewall machines have the highest
level of logging.</P
></LI
><li class="listitem"><p class="para">Configure firewall machines without user accounts
and program development utilities, if possible.</P
></LI
><li class="listitem"><p class="para">Don't mount <span class="acronym">NFS</SPAN
> directories
across subnet boundaries.</P
></LI
><li class="listitem"><p class="para">Have a central mail machine with MX aliasing and
name rewriting.</P
></LI
><li class="listitem"><p class="para">Monitor activity on the firewall regularly.</P
></LI
><li class="listitem"><p class="para">Configure your firewall/bastion hosts to
remove all unnecessary services and utilities.</P
></LI
><li class="listitem"><p class="para">Keep in mind that firewalls can sometimes fail.
Plan accordingly: periodically test your firewall and have defense
in depth for that eventuality.</P
></LI
><li class="listitem"><p class="para">Give serious thought to whether or not you really
want all your systems to be connected to the rest of the world,
even if a firewall is interposed. (See the discussion in the chapter.)</P
></LI
></UL
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="PUIS-APP-A-SECT-1.1.21">A.1.1.21 Chapter 22: Wrappers and Proxies</A
></H4
><ul class="itemizedlist"><li class="listitem"><p class="para"><a class="indexterm" name="AUTOID-37104"></A
><a class="indexterm" name="AUTOID-37106"></A
>Consider installing the <kbd class="command">smap</KBD
> proxy in place
of the sendmail program to receive mail over the network.</P
></LI
><li class="listitem"><p class="para">Consider installing the <kbd class="command">tcpwrapper</KBD
> program to restrict
and log access to local network services.</P
></LI
><li class="listitem"><p class="para">Consider installing the <i class="filename">ident/authd</I
> service
on your system to help track network access. However, remember that
the results returned by this service are not completely trustworthy.</P
></LI
><li class="listitem"><p class="para">Consider writing your own wrapper programs to provide
extra control or logging for your local system.</P
></LI
></UL
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="PUIS-APP-A-SECT-1.1.22">A.1.1.22 Chapter 23: Writing Secure SUID and Network Programs</A
></H4
><ul class="itemizedlist"><li class="listitem"><p class="para">Convey to your vendors your concern
about software quality in their products.</P
></LI
><li class="listitem"><p class="para">Observe the 24 general rules presented in the chapter
when writing any software, and especially when writing software
that needs extra privileges or trust.</P
></LI
><li class="listitem"><p class="para">Observe the 17 general rules presented in the chapter
when writing any network server programs.</P
></LI
><li class="listitem"><p class="para">Observe the 14 general rules presented in the chapter
when writing any program that will be <span class="acronym">SUID</SPAN
> or
<span class="acronym">SGID</SPAN
>.</P
></LI
><li class="listitem"><p class="para">Think about using <kbd class="command">chroot</KBD
> for privileged programs.</P
></LI
><li class="listitem"><p class="para">Avoid storing or transmitting passwords in clear
text in any application.</P
></LI
><li class="listitem"><p class="para">Be very cautious about generating and using &quot;random&quot;
numbers.</P
></LI
></UL
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="PUIS-APP-A-SECT-1.1.23">A.1.1.23 Chapter 24: Discovering a Break-in</A
></H4
><ul class="itemizedlist"><li class="listitem"><p class="para"><a class="indexterm" name="AUTOID-37142"></A
>Plan
ahead: have response plans designed and rehearsed.</P
></LI
><li class="listitem"><p class="para">If a break-in occurs, don't panic!</P
></LI
><li class="listitem"><p class="para">Start a diary and/or script file as soon
as you discover or suspect a break-in. Note and timestamp everything
you discover and do.</P
></LI
><li class="listitem"><p class="para">Run hardcopies of files showing changes and tracing
activity. Initial and time-stamp these copies.</P
></LI
><li class="listitem"><p class="para">Run machine status-checking programs regularly to
watch for unusual activity: <kbd class="command">ps</KBD
>, <kbd class="command">w</KBD
>, <kbd class="command">vmstat</KBD
>, etc.</P
></LI
><li class="listitem"><p class="para">If a break-in occurs, consider making a dump of
the system to backup media before correcting anything.</P
></LI
><li class="listitem"><p class="para">Carefully examine the system after a break-in. See
the chapter text for specifics&nbsp;- there is too much detail
to list here. Specifically, be certain that you restore the system
to a known, good state.</P
></LI
><li class="listitem"><p class="para">Carefully check backups and logs to determine if
this is a single occurrence or is related to a set of incidents.</P
></LI
></UL
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="PUIS-APP-A-SECT-1.1.24">A.1.1.24 Chapter 25: Denial of Service Attacks and Solutions</A
></H4
><ul class="itemizedlist"><li class="listitem"><p class="para"><a class="indexterm" name="AUTOID-37167"></A
><a class="indexterm" name="AUTOID-37170"></A
>If user quotas
are available on your system, enable them.</P
></LI
><li class="listitem"><p class="para">Configure appropriate process and user limits on
your system.</P
></LI
><li class="listitem"><p class="para">Don't test new software while running as
<i class="filename">root</I
>.</P
></LI
><li class="listitem"><p class="para">Install a firewall to prevent network problems.</P
></LI
><li class="listitem"><p class="para">Educate your users on polite methods of sharing
system resources.</P
></LI
><li class="listitem"><p class="para">Run long-running tasks in the background, setting
the <i class="filename">nice</I
> to a positive value.</P
></LI
><li class="listitem"><p class="para">Configure disk partitions to have sufficient inodes
and storage.</P
></LI
><li class="listitem"><p class="para">Make sure that you have appropriate swap space configured.</P
></LI
><li class="listitem"><p class="para">Monitor disk usage and encourage users to archive
and delete old files.</P
></LI
><li class="listitem"><p class="para">Consider investing in a network monitor appropriate
for your network. Have a spare network connection available, if
you need it.</P
></LI
><li class="listitem"><p class="para">Keep available an up-to-date paper list of low-level
network addresses (e.g., Ethernet addresses), IP addresses, and
machine names.</P
></LI
><li class="listitem"><p class="para">Ensure good physical security for all network cables
and connectors.</P
></LI
></UL
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="PUIS-APP-A-SECT-1.1.25">A.1.1.25 Chapter 26: Computer Security and U.S. Law</A
></H4
><ul class="itemizedlist"><li class="listitem"><p class="para"><a class="indexterm" name="AUTOID-37203"></A
>Consult
with your legal counsel to determine legal options and liability
in the event of a security incident.</P
></LI
><li class="listitem"><p class="para">Consult with your insurance carrier to determine
if your insurance covers loss from break-ins. Determine if your
insurance covers business interruption during an investigation.
Also determine if you will be required to institute criminal or
civil action to recover on your insurance.</P
></LI
><li class="listitem"><p class="para">Replace any &quot;welcome&quot; messages
with warnings against unauthorized use.</P
></LI
><li class="listitem"><p class="para">Put explicit copyright and/or proprietary
property notices in code start-up screens and source code. Formally
register copyrights on your locally developed code and databases.</P
></LI
><li class="listitem"><p class="para">Keep your backups separate from your machine.</P
></LI
><li class="listitem"><p class="para">Keep written records of your actions when investigating
an incident. Time-stamp and initial media, printouts, and other
materials as you proceed.</P
></LI
><li class="listitem"><p class="para">Develop contingency plans and response plans in
advance of difficulties.</P
></LI
><li class="listitem"><p class="para">Define, in writing, levels of user access and responsibility.
Have<em class="emphasis"> all </EM
>users provide a signature noting their
understanding of and agreement to such a statement. Include an explicit
statement about the return of manuals, printouts, and other information
upon user departure.</P
></LI
><li class="listitem"><p class="para">Develop contacts with your local law-enforcement
personnel.</P
></LI
><li class="listitem"><p class="para">Do not be unduly hesitant about reporting a computer
crime and involving law-enforcement personnel.</P
></LI
><li class="listitem"><p class="para">If called upon to help in an investigation, request
a signed statement by a judge requesting (or directing) your &quot;expert&quot;
assistance. Recommend a disinterested third party to act as an expert,
if possible.</P
></LI
><li class="listitem"><p class="para">Expand your professional training and contacts by
attending security training sessions or conferences. Consider joining
security-related organizations.</P
></LI
><li class="listitem"><p class="para">Be aware of other liability concerns.</P
></LI
><li class="listitem"><p class="para">Restrict access to cryptographic software from the
network.</P
></LI
><li class="listitem"><p class="para">Restrict or prohibit access to material that could
lead to legal difficulties. This includes copyrighted material,
pornographic material, trade secrets, etc.</P
></LI
><li class="listitem"><p class="para">Make sure that users understand copyright and license
restrictions on commercial software, images, and sound files.</P
></LI
><li class="listitem"><p class="para">Prohibit or restrict access to Usenet from organizational
machines. Consider coupling this to provision of personal accounts
with an independent service provider.</P
></LI
><li class="listitem"><p class="para">Make your users aware of the dangers of electronic
harassment or defamation.</P
></LI
><li class="listitem"><p class="para">Make certain that your legal counsel is consulted
before you provide locally developed software to others outside
your organization.</P
></LI
></UL
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="PUIS-APP-A-SECT-1.1.26">A.1.1.26 Chapter 27: Who Do You Trust?</A
></H4
><ul class="itemizedlist"><li class="listitem"><p class="para">Read the chapter. Develop a healthy
sense of paranoia.</P
></LI
><li class="listitem"><p class="para">Protest when vendors attempt to sell you products
advertised with &quot;hacker challenges&quot; instead of
more reliable proof of good design and testing.</P
></LI
><li class="listitem"><p class="para">Make your vendor aware of your concerns about security,
adequate testing, and fixing security bugs in a timely fashion.</P
></LI
><li class="listitem"><p class="para">Buy another 1000 copies of this book for all your
friends and acquaintances. The copies will make you intelligent,
attractive, and incredibly popular. Trust us on this.</P
></LI
></UL
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="PUIS-APP-A-SECT-1.1.27">A.1.1.27 Appendix B: Important Files</A
></H4
><ul class="itemizedlist"><li class="listitem"><p class="para">Become familiar with the important
files on your system.</P
></LI
><li class="listitem"><p class="para">Understand why <span class="acronym">SUID/SGID</SPAN
> files
have those permissions.</P
></LI
></UL
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="PUIS-APP-A-SECT-1.1.28">A.1.1.28 Appendix C: UNIX Processes</A
></H4
><ul class="itemizedlist"><li class="listitem"><p class="para">Understand how processes work on your
system.</P
></LI
><li class="listitem"><p class="para">Understand the commands that are available to manipulate
processes on your system.</P
></LI
></UL
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="PUIS-APP-A-SECT-1.1.29">A.1.1.29 Appendix D: Paper Sources</A
></H4
><ul class="itemizedlist"><li class="listitem"><p class="para">Paper Sources</P
></LI
></UL
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="PUIS-APP-A-SECT-1.1.30">A.1.1.30 Appendix E: Electronic Resources</A
></H4
><ul class="itemizedlist"><li class="listitem"><p class="para">Electronic Resources</P
></LI
></UL
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="PUIS-APP-A-SECT-1.1.31">A.1.1.31 Appendix F: Organizations</A
></H4
><ul class="itemizedlist"><li class="listitem"><p class="para">Learn more about security.</P
></LI
><li class="listitem"><p class="para">Explore other resources concerning security, <span class="acronym">UNIX</SPAN
>,
and the Internet.</P
></LI
><li class="listitem"><p class="para">Monitor newsgroups, mailing lists, and other resources
that will help you stay current on threats and countermeasures.</P
></LI
><li class="listitem"><p class="para">Explore professional opportunities that enable you
to network with other professionals, and add to your knowledge and
experience.</P
></LI
></UL
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="PUIS-APP-A-SECT-1.1.32">A.1.1.32 Appendix G: Table of IP Services</A
></H4
><ul class="itemizedlist"><li class="listitem"><p class="para">Read the table and add your own site
notes indicating the services you do and do not wish to support.</P
></LI
></UL
></DIV
></DIV
></DIV
></DIV
><div class="htmlnav"><p></P
><hr align="LEFT" width="515" title="footer"><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="PART" href="part07.htm" title="VII. Appendixes"><img src="../gifs/txtpreva.gif" alt="Previous: VII. Appendixes" border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><a class="book" href="index.htm" title="Practical UNIX &amp; Internet Security"><img src="../gifs/txthome.gif" alt="Practical UNIX &amp; Internet Security" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="APPENDIX" href="appb_01.htm" title="B. Important Files"><img src="../gifs/txtnexta.gif" alt="Next: B. Important Files" border="0"></A
></TD
></TR
><tr><td align="LEFT" valign="TOP" width="172">VII. Appendixes</TD
><td align="CENTER" valign="TOP" width="171"><a class="index" href="index/idx_0.htm" title="Book Index"><img src="../gifs/index.gif" alt="Book Index" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172">B. Important Files</TD
></TR
></TABLE
><hr align="LEFT" width="515" title="footer"><p class="nav"><font size="-1">[ <a href="../index.htm" title="The Networking CD Bookshelf">Library Home</A
> | <a href="../dnsbind/index.htm" title="DNS &amp; BIND">DNS &amp; BIND</A
> | <a href="../tcpip/index.htm" title="TCP/IP Network Administration">TCP/IP</A
> | <a href="../sendmail/index.htm" title="sendmail">sendmail</A
> | <a href="../smdref/index.htm" title="sendmail Desktop Reference">sendmail Reference</A
> | <a href="../firewall/index.htm" title="Building Internet Firewalls">Firewalls</A
> | <a href="index.htm" title="Practical UNIX &amp; Internet Security">Practical Security</A
> ]</FONT
></P
></DIV
></BODY
></HTML
>
