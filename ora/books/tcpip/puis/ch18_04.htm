<html><head>
<title>[Chapter 18] 18.4 Avoiding the Risks of Eavesdropping</TITLE>
<meta name="DC.title" content="Practical UNIX &amp; Internet Security"><meta name="DC.creator" content="Simson Garfinkel &amp; Gene Spafford"><meta name="DC.publisher" content="O'Reilly &amp; Associates, Inc."><meta name="DC.date" content="1999-02-04T00:14:41Z"><meta name="DC.type" content="Text.Monograph"><meta name="DC.format" content="text/html" scheme="MIME"><meta name="DC.source" content="1-56592-148-8" scheme="ISBN"><meta name="DC.language" content="en-US"><meta name="generator" content="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><link rev="made" href="mailto:online-books@oreilly.com" title="Online Books Comments"><link rel="up" href="ch18_01.htm" title="18. WWW Security"><link rel="prev" href="ch18_03.htm" title="18.3 Controlling Access to Files on Your Server"><link rel="next" href="ch18_05.htm#PUIS-CHP-18-SECT-5.1" title="18.5 Risks of Web Browsers"></HEAD
><body bgcolor="#FFFFFF" text="#000000"><div class="htmlnav"><h1><img src="gifs/smbanner.gif" alt="Practical UNIX &amp; Internet Security" usemap="#srchmap" border="0"></H1
><map name=index.html"srchmap"><area shape="RECT" coords="0,0,466,65" href="index.htm" alt="Practical UNIX &amp; Internet Security"><area shape="RECT" coords="467,0,514,18" href="../search/psrch.htm" alt="Search this book"></MAP
><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="SECT1" href="ch18_03.htm" title="18.3 Controlling Access to Files on Your Server"><img src="../gifs/txtpreva.gif" alt="Previous: 18.3 Controlling Access to Files on Your Server" border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><b><font face="ARIEL,HELVETICA,HELV,SANSERIF" size="-1">Chapter 18<br>WWW Security</FONT
></B
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="SECT1" href="ch18_05.htm#PUIS-CHP-18-SECT-5.1" title="18.5 Risks of Web Browsers"><img src="../gifs/txtnexta.gif" alt="Next: 18.5 Risks of Web Browsers" border="0"></A
></TD
></TR
></TABLE
>&nbsp;<hr align="LEFT" width="515" title="footer"></DIV
><div class="SECT1"><h2 class="sect1"><a class="title" name="PUIS-CHP-18-SECT-4">18.4 Avoiding the Risks of Eavesdropping</A
></H2
><p class="para"><a class="indexterm" name="AUTOID-25296"></A
><a class="indexterm" name="AUTOID-25299"></A
>The risks of eavesdropping
affect all Internet protocols, but are of particular concern on
the World Wide Web, where sensitive documents and other kinds of
information, such as credit card numbers, may be transmitted. There
are only two ways to protect information from eavesdropping. The
first is to assure that the information travels over a physically
secure network (which the Internet is not). The second is to encrypt
the information so that it can only be decrypted by the intended
recipient.</P
><p class="para">Another form of eavesdropping that is possible is <i class="firstterm"><a class="indexterm" name="AUTOID-25304"></A
><a class="indexterm" name="AUTOID-25306"></A
>
traffic
analysis</I
>. In this type of eavesdropping, an attacker
learns about the transactions performed by a target, without actually
learning the content. As we will see below, the log files kept by
Web servers are particularly vulnerable to this type of attack.</P
><div class="sect2"><h3 class="sect2"><a class="title" name="PUIS-CHP-18-SECT-4.1">18.4.1 Eavesdropping Over the Wire</A
></H3
><p class="para"><a class="indexterm" name="AUTOID-25312"></A
><a class="indexterm" name="AUTOID-25315"></A
>Information
sent over the Internet must be encrypted to be protected from eavesdropping.
There are four ways in which information sent by the Web can be
encrypted:</P
><ol class="orderedlist"><li class="listitem"><p class="para"><b class="emphasis.bold">Link encryption. </B
><a class="indexterm" name="AUTOID-25322"></A
><a class="indexterm" name="AUTOID-25325"></A
><a class="indexterm" name="AUTOID-25327"></A
>
The long-haul telephone lines that are used to
carry the IP packets can be encrypted. Organizations can also use
encrypting routers to automatically encrypt information sent over
the Internet that is destined for another office. Link encryption
provides for the encryption of <em class="emphasis">all</EM
> traffic,
but it can only be performed with prior arrangement. Link encryption
has traditionally been very expensive, but new generations of routers
and firewalls are being produced that incorporate this feature.</P
></LI
><li class="listitem"><p class="para"><b class="emphasis.bold">Document encryption. </B
><a class="indexterm" name="AUTOID-25334"></A
><a class="indexterm" name="AUTOID-25337"></A
>
The documents
that are placed on the Web server can be encrypted with a system
such as <span class="acronym">PGP</SPAN
>. Although this encryption provides
for effective privacy protection, it is cumbersome because it requires
the documents to be specially encrypted before they are placed on
the server and they must be specially decrypted when they are received.</P
></LI
><li class="listitem"><p class="para"><a class="indexterm" name="AUTOID-25343"></A
><a class="indexterm" name="AUTOID-25345"></A
><b class="emphasis.bold">SSL (Secure Socket Layer).</B
>
<span class="acronym">SSL</SPAN
> is a system designed by Netscape Communications
that provides an encrypted <span class="acronym">TCP/IP</SPAN
> pathway between
two hosts on the Internet. <span class="acronym">SSL</SPAN
> can be used to
encrypt any <span class="acronym">TCP/IP</SPAN
> protocol, such as <span class="acronym">HTTP</SPAN
>,
<span class="acronym">TELNET</SPAN
>, or <span class="acronym">FTP</SPAN
>.</P
><p class="para"><span class="acronym">SSL</SPAN
> can use a variety of public-key and
token-based systems for exchanging a session key. Once a session
key is exchanged, it can use a variety of secret key algorithms.
Currently, programs that use <span class="acronym">SSL</SPAN
> that are distributed
for anonymous <span class="acronym">FTP</SPAN
> on the Internet and that are
sold to international markets are restricted to using a 40-bit key,
which should not be considered secure.</P
><p class="para">A complete description of the <span class="acronym">SSL</SPAN
> protocol
can be found at the site <a class="systemitem.url" href="../../../../../../../home.netscape.com/newsref/std/SSL.html.">http://home.netscape.com/newsref/std/SSL.html.</A
></P
></LI
><li class="listitem"><p class="para"><span class="acronym">SHTTP</SPAN
><a class="indexterm" name="AUTOID-25366"></A
><a class="indexterm" name="AUTOID-25368"></A
><a class="indexterm" name="AUTOID-25371"></A
>
(Secure <span class="acronym">HTTP</SPAN
>).
Secure <span class="acronym">HTTP</SPAN
> is an encryption system for <span class="acronym">HTTP</SPAN
>
designed by Commerce Net. <span class="acronym">SHTTP</SPAN
> only works with
<span class="acronym">HTTP</SPAN
>.</P
><p class="para">A complete description of the <span class="acronym">SHTTP</SPAN
> protocol
can be found at <a class="systemitem.url" href="../../../../../../../www.eit.com/projects/s-http/.">http://www.eit.com/projects/s-http/.</A
></P
></LI
></OL
><p class="para">It is widely believed that most commercial Web servers that
seek to use encryption will use either <span class="acronym">SSL</SPAN
> or
<span class="acronym">SHTTP</SPAN
>. Unlike the other options above, both <span class="acronym">SSL</SPAN
>
and <span class="acronym">SHTTP</SPAN
> require special software to be running
on both the Web server and in the Web browser. This software will
likely be in most commercial Web browsers within a few months after
this book is published, although it may not be widespread in freely
available browsers until the patents on public key cryptography
expire within the coming years.</P
><p class="para">When using an encrypted protocol, your security depends on
several issues:</P
><ul class="itemizedlist"><li class="listitem"><p class="para">The strength of the encryption algorithm</P
></LI
><li class="listitem"><p class="para">The length of the encryption key</P
></LI
><li class="listitem"><p class="para">The secrecy of the encryption key</P
></LI
><li class="listitem"><p class="para">The reliability of the underlying software that
is running on the Web server</P
></LI
><li class="listitem"><p class="para">The reliability of the underlying software that
is running on the Web client</P
></LI
></UL
><p class="para"><a class="indexterm" name="AUTOID-25401"></A
><a class="indexterm" name="AUTOID-25404"></A
><a class="indexterm" name="AUTOID-25407"></A
>During
the summer of 1995, a variety of articles were published describing
failures of the encryption system used by the Netscape Navigator.
In the first case, a researcher in France was able to break the
encryption key used on a single message by using a network of workstations
and two supercomputers. The message had been encrypted with the
international version of the Netscape Navigator using a 40-bit RC4
key. In the second case, a group of students at the University of
California at Berkeley discovered a flaw in the random number generator
used by the <span class="acronym">UNIX</SPAN
>-based version of Navigator.
[3]
In the third case, the same group of students at Berkeley discovered
a way to alter the binaries of the Navigator program as they traveled
between the university's <span class="acronym">NFS</SPAN
> server
and the client workstation on which the program was actually running.[4]</P
><blockquote class="footnote"><p class="para">[3] The
random number generator was seeded with a number that depended on
the current time and the process number of the Navigator process.</P
><p class="para">[4] The students pointed out that while they attacked the Navigator's
binaries as it was moving from the server computer to the client,
they could have as easily have attacked the program as it was being
downloaded from an FTP site.</P
></BLOCKQUOTE
><p class="para">All of these attacks are highly sophisticated. Nevertheless,
most of them do not seem to be having an impact on the commercial
development of the Web. It is likely that within a few years the
encryption keys will be lengthened to 64 bits. Netscape has improved
the process by which its Navigator program seeds its random number
generator. The third problem, of binaries being surreptitiously
altered, will likely not be a problem for most users with improved
software distribution systems that themselves use encryption and
digital signatures.<a class="indexterm" name="AUTOID-25417"></A
><a class="indexterm" name="AUTOID-25420"></A
></P
></DIV
><div class="sect2"><h3 class="sect2"><a class="title" name="PUIS-CHP-18-SECT-4.2">18.4.2 Eavesdropping Through Log Files</A
></H3
><p class="para"><a class="indexterm" name="AUTOID-25426"></A
><a class="indexterm" name="AUTOID-25429"></A
><a class="indexterm" name="AUTOID-25432"></A
><a class="indexterm" name="AUTOID-25435"></A
>Most Web servers create log files
that record considerable information about each request. These log
files grow without limit until they are automatically trimmed or
until they fill up the computer's hard disk (usually resulting
in a loss of service). By examining these files, it is possible
to infer a great deal about the people who are using the Web server.</P
><p class="para">For example, the <span class="acronym">NCSA</SPAN
> httpd server maintains
the following log files in its <i class="filename">logs/ </I
>directory:</P
><dl class="variablelist"><dt class="term">access_log</DT
><dd class="listitem"><p class="para">A list of the individual accesses to the server.</P
></DD
><dt class="term">agent_log</DT
><dd class="listitem"><p class="para">A list of the programs that have been used to access
the server.</P
></DD
><dt class="term">error_log</DT
><dd class="listitem"><p class="para">A list of the errors that the server has experienced,
whether generated by the server itself or by your <span class="acronym">CGI</SPAN
>
scripts. (Anything that a script prints to Standard Error is appended
into this file.)</P
></DD
><dt class="term">refer_log</DT
><dd class="listitem"><p class="para">This log file contains entries that include the
<span class="acronym">URL</SPAN
> that the browser previously visited and the
<span class="acronym">URL</SPAN
> that it is currently viewing.</P
></DD
></DL
><p class="para">By examining the information in these log files, you can create
a very comprehensive picture of the people who are accessing a Web
server, the information that they are viewing, and where they have
previously been.</P
><p class="para">In <a class="xref" href="ch10_01.htm" title="Auditing and Logging">Chapter 10, <cite class="chapter">Auditing and Logging</CITE
></A
>, we describe
the fields that are stored in the <a class="indexterm" name="AUTOID-25464"></A
><a class="indexterm" name="AUTOID-25466"></A
>
<i class="filename">access_log</I
> file. Here they
are again:</P
><ul class="itemizedlist"><li class="listitem"><p class="para">The name of the remote computer that
initiated the transfer</P
></LI
><li class="listitem"><p class="para">The remote login name, if it was supplied, or &quot;-&quot;
if not supplied</P
></LI
><li class="listitem"><p class="para">The remote username, if supplied, or &quot;-&quot;
if not supplied</P
></LI
><li class="listitem"><p class="para">The time that the transfer was initiated (day of
month, month, year, hour, minute, second, and time zone offset)</P
></LI
><li class="listitem"><p class="para">The <span class="acronym">HTTP</SPAN
> command that was executed
(can be <span class="acronym">GET</SPAN
> for receiving files, <span class="acronym">POST</SPAN
>
for processing forms, or <span class="acronym">HEAD</SPAN
> for viewing the
<span class="acronym">MIME</SPAN
> header)</P
></LI
><li class="listitem"><p class="para">The status code that was returned</P
></LI
><li class="listitem"><p class="para">The number of bytes that were transferred</P
></LI
></UL
><p class="para">Here are a few lines from an access_log file:</P
><blockquote class="screen"><pre class="screen">koriel.sun.com - - [06/Dec/1995:18:44:01 -0500] &quot;GET /simson/resume.html HTTP/1.0&quot; 200 8952
lawsta11.oitlabs.unc.edu - - [06/Dec/1995:18:47:14 -0500] &quot;GET /simson/ HTTP/1.0&quot; 200 2749
lawsta11.oitlabs.unc.edu - - [06/Dec/1995:18:47:15 -0500] &quot;GET /icons/back.gif HTTP/1.0&quot; 200 354
lawsta11.oitlabs.unc.edu - - [06/Dec/1995:18:47:16 -0500] &quot;GET  /cgi-bin/counter?file=simson HTTP/1.0&quot; 200 545
piweba1y-ext.prodigy.com - - [06/Dec/1995:18:52:30 -0500] &quot;GET /vineyard/history/&quot; HTTP/1.0&quot; 404 -</PRE
></BLOCKQUOTE
><p class="para">As you can tell, there is a wealth of information here. Apparently,
some user at Sun Microsystems is interested in Simson's
resume. A user at the University of North Carolina also seems interested
in Simson. And a Prodigy user appears to want information about
the history of Martha's Vineyard.</P
><p class="para">None of these entries in the log file contain the username
of the person conducting the Web request. But they may still be
used to identify individuals. It's highly likely that <i class="systemitem">koreil.sun.com</I
> is a single <span class="acronym">SPARC</SPAN
>station
sitting on a single employee's desk at Sun. We don't
know what <i class="systemitem">lawsta11.otilabs.unc.edu</I
>
is, but we suspect that it is a single machine in a library. Many
organizations now give distinct IP addresses to individual users
for use with their PCs, or for dial-in with <span class="acronym">PPP</SPAN
>
or <span class="acronym">SLIP</SPAN
>. Without the use of a proxy server such
as <span class="acronym">SOCKS</SPAN
> (see <a class="xref" href="ch22_01.htm" title="Wrappers and Proxies">Chapter 22</A
>) or systems that rewrite
IP addresses, Web server log files reveal those addresses.</P
><p class="para">And there is more information to be &quot;mined&quot;
as well. Consider the following entries from the <i class="filename"><a class="indexterm" name="AUTOID-25503"></A
><a class="indexterm" name="AUTOID-25505"></A
>refer_log</I
> file:</P
><blockquote class="screen"><pre class="screen">http://www2.infoseek.com/NS/Titles?qt=unix-hater -&gt; /unix-haters.html
http://www.intersex.com/main/ezines.html -&gt; /awa/
http://www.jaxnet.com/~jdcarr/places.html -&gt; /vineyard/ferry.tiny.gif</PRE
></BLOCKQUOTE
><p class="para">In the first line, it's clear that a search on the
InfoSeek server for the string &quot;unixhater&quot; turned
up the Web file <i class="filename">/unix-haters</I
>.html on the current server.
This is an indication that the user was surfing the Web looking
for material having to deal with <span class="acronym">UNIX</SPAN
>. In the
second line, a person who had been browsing the InterSex <span class="acronym">WWW</SPAN
>
server looking for information about electronic magazines followed
a link to the <i class="filename">/awa/</I
> directory. This possibly indicates
that the user is interested in content of a sexually oriented nature.
In the last example, apparently a user, <i class="filename">jdcarr@jaxnet.com,</I
>
has embedded a link in his or her <i class="filename">places.html</I
> file to a <span class="acronym">GIF</SPAN
>
file of the Martha's Vineyard ferry. This indicates that
<i class="systemitem">jdcarr </I
>is taking advantage
of other people's network servers and Internet connections.</P
><p class="para">By themselves, these references can be amusing. But they can
also be potentially important. Lincoln Stein and Bob Bagwill note
in the World Wide Web Security <span class="acronym">FAQ</SPAN
> that a referral
such as this one could indicate that a person is planning a corporate
takeover:</P
><blockquote class="screen"><pre class="screen">file://prez.xyz.com/hotlists/stocks2sellshort.html -&gt;http://www.xyz.com</PRE
></BLOCKQUOTE
><p class="para">The information in the <i class="filename">refer_log</I
> can also be combined
with information in the <a class="indexterm" name="AUTOID-25523"></A
>
<i class="filename">access_log</I
>
to determine the names of the people (or at least their computers)
who are following these links. Version 1.5 of the <span class="acronym">NCSA</SPAN
>
<i class="filename">httpd</I
> Web server even has an option to store
referrals in the access log.</P
><p class="para">The <i class="filename">access_log</I
> file contains the name of the complete
<span class="acronym">URL</SPAN
> that is provided. For Web forms that use
the <span class="acronym">GET</SPAN
> method instead of the <span class="acronym">POST</SPAN
>
method, all of the arguments are included in the <span class="acronym">URL</SPAN
>,
and thus all of them end up in the <i class="filename">access_log</I
> file.</P
><p class="para">Consider the following:</P
><blockquote class="screen"><pre class="screen">asy2.vineyard.net - - [06/Oct/1995:19:04:37 -0400] &quot;GET /cgi-bin/vni/useracct?username=bbennett&amp;password=leonlikesfood&amp;cun=jayd&amp;fun=jay+Desmond&amp;pun=766WYRCI&amp;add1=box+634&amp;add2=&amp;city=Gay+Head&amp;state=MA&amp;zip=02535&amp;phone=693-9766&amp;choice=ReallyCreateUser HTTP/1.0&quot; 200 292</PRE
></BLOCKQUOTE
><p class="para">Or even this one:</P
><blockquote class="screen"><pre class="screen">mac.vineyard.net - - [07/Oct/1995:03:04:30 -0400] &quot;GET /cgi-bin/change-password?username=bbennett&amp;oldpassword=dearth&amp;newpassword=flabby3 HTTP/1.0&quot; 200 400</PRE
></BLOCKQUOTE
><p class="para">This is one reason why you should use the <span class="acronym">POST</SPAN
>
method in preference to the <span class="acronym">GET</SPAN
> method!</P
><p class="para">Finally, consider what can be learned from <a class="indexterm" name="AUTOID-25544"></A
><a class="indexterm" name="AUTOID-25546"></A
>
agent_log. Here
are a few sample lines:</P
><blockquote class="screen"><pre class="screen">NCSA_Mosaic/2.6 (X11;HP-UX A.09.05 9000/720)  libwww/2.12 modified  via proxy gateway  CERN-HTTPD/3.0 libwww/2.17
NCSA_Mosaic/2.6 (X11;HP-UX A.09.05 9000/720)  libwww/2.12 modified  via proxy gateway  CERN-HTTPD/3.0 libwww/2.17
Proxy gateway CERN-HTTPD/3.0 libwww/2.17
Mozilla/1.1N (X11; I; OSF1 V3.0 alpha)  via proxy gateway  CERN-HTTPD/3.0 libwww/2.17
Mozilla/1.2b1 (Windows; I; 16bit)</PRE
></BLOCKQUOTE
><p class="para">In addition to the name of the Web browser that is being used,
this file reveals information about the structure of an organization's
firewall. It also reveals the use of beta software within an organization.</P
><p class="para">Some servers allow you to restrict the amount of information
that is logged. If you do not require information to be logged,
you may wish to suppress the logging.</P
><p class="para">In summary, users of the Web should be informed that their
actions are being monitored. As many firms wish to use this information
for marketing, it is quite likely that the amount of information
that Web browsers provide to servers will, rather than decrease,
increase in the<a class="indexterm" name="AUTOID-25553"></A
><a class="indexterm" name="AUTOID-25556"></A
><a class="indexterm" name="AUTOID-25559"></A
><a class="indexterm" name="AUTOID-25562"></A
><a class="indexterm" name="AUTOID-25565"></A
>

future.<a class="indexterm" name="AUTOID-25569"></A
><a class="indexterm" name="AUTOID-25572"></A
></P
></DIV
></DIV
><div class="htmlnav"><p></P
><hr align="LEFT" width="515" title="footer"><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="SECT1" href="ch18_03.htm" title="18.3 Controlling Access to Files on Your Server"><img src="../gifs/txtpreva.gif" alt="Previous: 18.3 Controlling Access to Files on Your Server" border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><a class="book" href="index.htm" title="Practical UNIX &amp; Internet Security"><img src="../gifs/txthome.gif" alt="Practical UNIX &amp; Internet Security" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="SECT1" href="ch18_05.htm#PUIS-CHP-18-SECT-5.1" title="18.5 Risks of Web Browsers"><img src="../gifs/txtnexta.gif" alt="Next: 18.5 Risks of Web Browsers" border="0"></A
></TD
></TR
><tr><td align="LEFT" valign="TOP" width="172">18.3 Controlling Access to Files on Your Server</TD
><td align="CENTER" valign="TOP" width="171"><a class="index" href="index/idx_0.htm" title="Book Index"><img src="../gifs/index.gif" alt="Book Index" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172">18.5 Risks of Web Browsers</TD
></TR
></TABLE
><hr align="LEFT" width="515" title="footer"><p class="nav"><font size="-1">[ <a href="../index.htm" title="The Networking CD Bookshelf">Library Home</A
> | <a href="../dnsbind/index.htm" title="DNS &amp; BIND">DNS &amp; BIND</A
> | <a href="../tcpip/index.htm" title="TCP/IP Network Administration">TCP/IP</A
> | <a href="../sendmail/index.htm" title="sendmail">sendmail</A
> | <a href="../smdref/index.htm" title="sendmail Desktop Reference">sendmail Reference</A
> | <a href="../firewall/index.htm" title="Building Internet Firewalls">Firewalls</A
> | <a href="index.htm" title="Practical UNIX &amp; Internet Security">Practical Security</A
> ]</FONT
></P
></DIV
></BODY
></HTML
>
