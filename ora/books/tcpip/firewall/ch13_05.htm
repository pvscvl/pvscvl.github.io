<html><head>
<title>[Chapter 13] 13.5 Being Prepared </TITLE>
<meta name="DC.title" content="Building Internet Firewalls"><meta name="DC.creator" content="D. Brent Chapman &amp; Elizabeth D. Zwicky"><meta name="DC.publisher" content="O'Reilly &amp; Associates, Inc."><meta name="DC.date" content="1999-02-04T00:30:05Z"><meta name="DC.type" content="Text.Monograph"><meta name="DC.format" content="text/html" scheme="MIME"><meta name="DC.source" content="1-56592-124-0" scheme="ISBN"><meta name="DC.language" content="en-US"><meta name="generator" content="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><link rev="made" href="mailto:online-books@oreilly.com" title="Online Books Comments"><link rel="up" href="ch13_01.htm" title="13. Responding to Security Incidents"><link rel="prev" href="ch13_04.htm#FIRE-13-S2-10" title="13.4 Planning Your Response"><link rel="next" href="part04.htm" title="IV. Apendixes"></HEAD
><body bgcolor="#FFFFFF" text="#000000"><div class="htmlnav"><h1><img src="gifs/smbanner.gif" alt="Building Internet Firewalls" usemap="#srchmap" border="0"></H1
><map name=index.html"srchmap"><area shape="RECT" coords="0,0,466,65" href="index.htm" alt="Building Internet Firewalls"><area shape="RECT" coords="467,0,514,18" href="../search/fsrch.htm" alt="Search this book"></MAP
><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="SECT1" href="ch13_04.htm#FIRE-13-S2-10" title="13.4 Planning Your Response"><img src="../gifs/txtpreva.gif" alt="Previous: 13.4 Planning Your Response" border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><b><font face="ARIEL,HELVETICA,HELV,SANSERIF" size="-1">Chapter 13<br>Responding to Security Incidents</FONT
></B
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="PART" href="part04.htm" title="IV. Apendixes"><img src="../gifs/txtnexta.gif" alt="Next: IV. Apendixes" border="0"></A
></TD
></TR
></TABLE
>&nbsp;<hr align="LEFT" width="515" title="footer"></DIV
><div class="SECT1"><h2 class="sect1"><a class="title" name="FIRE-13-S1-5">13.5 Being Prepared </A
></H2
><p class="para">The incident response plan is not the only thing that you need to have
ready in advance. There are a number of practices and procedures that
you need to set up so that you'll be able to respond quickly and
effectively when an incident occurs. Most of these procedures are
general good practice; some of them are aimed at letting you recover
from any kind of disaster; and a few are specific to security incidents.</P
><div class="sect2"><h3 class="sect2"><a class="title" name="FIRE-13-S2-16">13.5.1 Backing Up Your Filesystems</A
></H3
><p class="para"><a class="indexterm" name="AUTOID-22144"></A
><a class="indexterm" name="AUTOID-22146"></A
><a class="indexterm" name="AUTOID-22149"></A
>Your filesystem backups are probably the single most important part
of your recovery plan. Before you do anything else (including writing
your response plan), make sure that your site's backup plan is a solid
one and that it works. Don't assume that it's <span class="acronym">OK</SPAN
>
just because you haven't had a problem yet. It is entirely possible to
go for months without noticing that you have no backups at all, and it
may take you years to notice that they're only partially
broken. Unfortunately, when you do notice, it's often when you need
the backups most, and the outcome is likely to be disastrous.</P
><p class="para">Backups are vital for two reasons:

<ul class="itemizedlist"><li class="listitem"><p class="para">If your site suffers serious damage and you have to restore your
systems from scratch, you will need these backups.</P
></LI
><li class="listitem"><p class="para">If you aren't sure of the extent of the damage, backups will help
you to determine what changes were made to a system and when. </P
></LI
></UL
></P
><p class="para">Every organization needs a backup plan and not just for security
reasons. If you don't have one, that's probably a sign that your
current backup system is <em class="emphasis">not</EM
>
<span class="acronym">OK</SPAN
>. When you are doing incident-response planning,
however, pay special attention to your backup plan.</P
><p class="para">For your security-critical systems (e.g., bastion hosts and
servers), you might want to consider keeping your monthly or weekly
backups indefinitely, rather than recycling them as you would your
regular systems. If an incident does occur, you can use this archive of
backup tapes to recover a &quot;snapshot&quot; of the system as of any
of the dates of the backups. Snapshots of this kind can be helpful
in investigating security incidents. For example, if you find that a
program has been modified, going back through the snapshots will tell
you approximately when the modification took place. That may tell you
when the break-in occurred; if the modification happened before the
break-in, it may tell you that it was an accident and not part of the
incident at all.</P
><p class="para">If you're not sure whether or not you should be worried, try testing
your backup system. Play around and see what you can restore. Ask these
questions:

<ul class="itemizedlist"><li class="listitem"><p class="para">Can you restore files from all of your tapes? </P
></LI
><li class="listitem"><p class="para">Can you do a restore of an entire filesystem? </P
></LI
><li class="listitem"><p class="para">If you pick a specific file, can you figure out how to restore it?</P
></LI
><li class="listitem"><p class="para">If you have a corrupt file and want a version from before it was
corrupted, can you do that? </P
></LI
><li class="listitem"><p class="para">If all of your disks died (or were trashed by an attacker)
simultaneously, would you be able to rebuild your computer facility?</P
></LI
></UL
></P
><p class="para">Even the best backup system won't work if the backup images aren't
safeguarded. Don't rely on online backups and keep your media in a
secure place separate from the data they're backing up.</P
><blockquote class="note"><p class="para"><strong>NOTE:</STRONG
> The design of backup systems is outside the scope of this book. This
description, along with the description in <a class="xref" href="ch12_01.htm" title="Maintaining Firewalls">Chapter 12, <cite class="chapter">Maintaining Firewalls</CITE
></A
>, provides only a summary. If you're uncertain
about your backup system, you'll want to look at a general
system-administration reference. See <a class="xref" href="appa_01.htm" title="Resources">Appendix A</A
> for
complete information on additional resources.</P
></BLOCKQUOTE
></DIV
><div class="sect2"><h3 class="sect2"><a class="title" name="FIRE-13-S2-17">13.5.2 Labeling and Diagraming Your System</A
></H3
><p class="para"><a class="indexterm" name="AUTOID-22183"></A
><a class="indexterm" name="AUTOID-22186"></A
><a class="indexterm" name="AUTOID-22188"></A
>As organizations grow, they acquire hardware; they configure
networking in different ways; and they add or change equipment of
various kinds.  Usually only one or two people really know what a
site's systems look like in any detail.</P
><p class="para"><a class="indexterm" name="AUTOID-22191"></A
>Information about system configuration may be crucial to investigating
and controlling a security incident. While you may know exactly how
everything works and fits together at your site, you may not be the
person who has to respond to the incident. What if you're on vacation?
Think about what your managers or coworkers would need to know about
each system in order to respond effectively to an incident involving
that system.</P
><p class="para">Labels and diagrams are crucial in an emergency. System labels should
indicate what a system is, what it does, what its physical
configuration is (how much disk space, how much memory, etc.), and who
is responsible for it. They should be attached firmly to the correct
systems and easily legible. Use large type sizes, and put at least
minimal labels on the back as well as the front (the front of a
machine may have more flat space, but you're probably going to be
looking at it from behind when you're trying to work on it). Network
diagrams should show how the various systems are connected, both
physically and logically, as well as things like what kind of packet
filtering is done where.</P
><p class="para">Be sure that labels are kept up to date as you move systems around;
wrong labels are worse than no labels at all. It's particularly
important to label racked equipment and equipment with widely
scattered pieces. There's nothing more frustrating than turning off
all the equipment in a rack, only to discover that some of it was
actually part of the computer in the next rack over, which you meant
to leave running.</P
><p class="para">Information that's easily available when machines are working normally
may be impossible to find if machines are not working. For example,
you'll need disk partition tables written down in order to reformat and
reinstall disks, and you may need a printed copy of the host table in
order to configure machines as they're brought back up.</P
></DIV
><div class="sect2"><h3 class="sect2"><a class="title" name="FIRE-13-S2-18">13.5.3 Keeping Secured Checksums</A
></H3
><p class="para"><a class="indexterm" name="AUTOID-22200"></A
><a class="indexterm" name="AUTOID-22203"></A
>Once you've had a break-in, you need to know what's been changed on
your systems. The standard tools that come with your operating system
won't tell you; intruders can fake modification dates and match the
trivial checksums most operating systems provide. You will need to
install a cryptographic checksumming program (such as Tripwire, which
is discussed in <a class="xref" href="ch05_01.htm" title="Bastion Hosts">Chapter 5</A
>), make checksums of
important files, and store them where an intruder can't modify them
(which generally means somewhere off-line). You may not need to
checksum every system separately if they're all running the same
release of the same operating system, although you should make sure
that the checksum program is available on all your systems.</P
></DIV
><div class="sect2"><h3 class="sect2"><a class="title" name="FIRE-13-S2-19">13.5.4 Keeping Activity Logs</A
></H3
><p class="para"><a class="indexterm" name="AUTOID-22210"></A
>An activity log is a record of any changes that have been made to a
system, both before an incident and during the response to an
incident.  Normally, you'll use an activity log to list programs
you've installed, configuration files you've modified, or peripherals
you've added. During an incident, you'll be doing a lot more logging.</P
><p class="para">What is the purpose of an activity log? A log allows you to redo the
changes if you have to rebuild the system. It also lets you determine
whether any of the changes affect the incident or the
response. Without a log, you may find mystery programs; you don't know
where they came from and what they were supposed to do, so you can't
tell if the intruder installed them or not, if they still work the way
they're supposed to, or how to rebuild them. <a class="xref" href="#FIRE-13-FIG-4" title="Activity logs">Figure 13.4</A
> shows a sampling of routine log entries and
incident log entries.</P
><h4 class="figure"><a class="title" name="FIRE-13-FIG-4">Figure 13.4: Activity logs</A
></H4
><img class="graphic" src="figs/fire1304.gif" alt="Figure 13.4"><p class="para">There are a variety of easy ways to keep activity logs, both
electronic and manual; email, notebooks, and tape recorders can also be
used. Some are better for routine logs (those that record your
activities <em class="emphasis">before</EM
> an incident occurs). Others may
be more appropriate for incident logs (those that keep track of your
activities <em class="emphasis">during</EM
> an incident).</P
><p class="para">Email to an appropriate staff alias that also keeps a record of all
messages is probably the simplest approach to keeping an activity log.
Not only will email keep a permanent record of system changes, but it
has the side benefit of letting everybody else know what's going on as
the changes are made. The email approach is good for routine logs,
whereas manual methods are likely to work more reliably during an
incident. During an actual security incident, your email system may be
down, so any messages generated during the response may be lost. You may
also be unable to reach existing on-line logs during an incident, so
keep a printed copy of these email messages up to date in a binder
somewhere. </P
><p class="para">Notebooks make a good incident log, but people must be disciplined
enough to use them. For routine logs, notebooks may not be convenient,
because they may not be physically accessible when people actually make
changes to the system. Some sites use a combination of electronic and
paper logs for routine logs, with a paper logbook kept in the machine
room for notes. This works as long as it's clear which things should be
logged where; having two sets of logs to keep track of can be confusing.</P
><p class="para">Pocket tape recorders make good incident logs, although they require
that somebody transcribe them later on. They're not reasonable for
routine logging.</P
></DIV
><div class="sect2"><h3 class="sect2"><a class="title" name="FIRE-13-S2-20">13.5.5 Keeping a Cache of Tools and Supplies</A
></H3
><p class="para"><a class="indexterm" name="AUTOID-22226"></A
><a class="indexterm" name="AUTOID-22228"></A
>Well before a security incident, collect the tools and supplies that you
are likely to need during that incident. You don't want to be running
around, begging and borrowing, when the clock is ticking.</P
><p class="para">Here are some of the things you'll need to have in order to respond
well to an incident. (Actually, these are things you ought to have
around at all times; they come in handy in all sorts of disasters.)</P
><ul class="itemizedlist"><li class="listitem"><p class="para">Blank backup tapes and possibly spare disks as well. </P
></LI
><li class="listitem"><p class="para">Basic tools; you'll need them if you disconnect your system from
the external network, or if you need to rewire the internal network to
disconnect compromised hosts. Make sure you have a ladder if your site
uses in-ceiling cabling or tall equipment racks.</P
></LI
><li class="listitem"><p class="para">Spare networking equipment&nbsp;- at least transceivers and cables. </P
></LI
></UL
><p class="para">Set aside basic supplies (e.g., a backup's worth of media, a few
transceivers and cables, the most critical tools, notebooks or tape
recorders for incident logs) in a cache to be used only in case of
disaster. This should be separate from your normal stock of spare parts
and tools.</P
></DIV
><div class="sect2"><h3 class="sect2"><a class="title" name="FIRE-13-S2-21">13.5.6 Testing the Reload of the Operating
System </A
></H3
><p class="para"><a class="indexterm" name="AUTOID-22243"></A
><a class="indexterm" name="AUTOID-22246"></A
><a class="indexterm" name="AUTOID-22249"></A
>If a serious security incident occurs, you may need to restore your
system from backups. In this case, you will need to load a minimal
operating system before you can load the backups. Are you equipped to
do this?</P
><p class="para">Make sure that you:

<ul class="itemizedlist"><li class="listitem"><p class="para">Understand your system's operating system installation procedures</P
></LI
><li class="listitem"><p class="para">Understand the procedures for restoring from backups</P
></LI
><li class="listitem"><p class="para">Have all the materials (distribution media, manuals, etc.)
available to restore the system </P
></LI
><li class="listitem"><p class="para">Test your reload plans and procedures before you really need them</P
></LI
></UL
></P
><p class="para">Testing your ability to reload the operating system is a good
idea, and too few organizations ever do it. You can learn a lot by
doing this. While you're trying to reload a dead system is not a good
time to discover that you've got a bad copy of the distribution
media. It's also not a good time to discover that the people who have
to do the reload can't figure out how to do it. The best way to test
is to designate the least experienced people who might have to do the
work, and let them try out the reload well ahead of time.</P
><p class="para">Most organizations find that the first time they try to reinstall the
operating system and restore on a completely blank disk, the operation
fails. This can happen for a number of reasons, although the usual
reason is a failure in the design of the backup system. One site found
that they were doing their backups with a program that wasn't
distributed with the operating system, so they couldn't restore from a
fresh operating system installation. (After that, they made a
tape of the restore program using the standard operating system tools;
they could then load the standard operating system, recover their custom
restore program, and reload their data from backups.)</P
></DIV
><div class="sect2"><h3 class="sect2"><a class="title" name="FIRE-13-S2-22">13.5.7 Doing Drills</A
></H3
><p class="para"><a class="indexterm" name="AUTOID-22267"></A
><a class="indexterm" name="AUTOID-22270"></A
>Don't assume that responding to a security incident will come naturally.
 Like everything else, such a response benefits from practice. Test
your own organization's ability to respond to an incident by running
occasional drills.</P
><p class="para">There are two basic types of drills: 

<ul class="itemizedlist"><li class="listitem"><p class="para"> 
In a paper (or &quot;tabletop&quot;) drill, you
gather all the relevant people in a conference room (or over pizza at
your local hangout), outline a hypothetical problem, and work through
the consequences and recovery procedures. It's important to go through
all the details, step by step, to expose any missing pieces or
misunderstandings.  </P
></LI
><li class="listitem"><p class="para">In a live drill, you actually carry out a response and recovery
procedure. A live drill can be performed, with appropriate notice to
users, during scheduled system downtimes.</P
></LI
></UL
></P
><p class="para">You might also test only parts of your response. For example, before
configuring a new machine, use it to test your recovery procedures by
recovering an existing machine onto it. If you have down time scheduled
for your facility, you may be able to use it to test what happens when
you disconnect from the network. Run your checksum comparison program
before and after you install changes to the operating system to see what
changes it catches when you think everything's the same, and what it
does about the things you know have changed. Coordinate with another
site to see what messages are logged when various types of attacks occur
(pick someone you know and trust and who'll reliably tell you exactly
what they did, or do it yourself). Try taking all of your central
machines down at the same time and see whether they'll all come back up
in this situation. (Do this when you have a few hours to spare; if it
doesn't work, it often takes a while to figure out how to coax the
machines past their interdependencies.)</P
><p class="para">This is all a lot of trouble, but there is a certain amount of perverse
amusement to be had by playing around with fictitious disasters, and
it's much less stressful than having to improvise in a real disaster.<a class="indexterm" name="AUTOID-22281"></A
><a class="indexterm" name="AUTOID-22282"></A
><a class="indexterm" name="AUTOID-22283"></A
></P
></DIV
></DIV
><div class="htmlnav"><p></P
><hr align="LEFT" width="515" title="footer"><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="SECT1" href="ch13_04.htm#FIRE-13-S2-10" title="13.4 Planning Your Response"><img src="../gifs/txtpreva.gif" alt="Previous: 13.4 Planning Your Response" border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><a class="book" href="index.htm" title="Building Internet Firewalls"><img src="../gifs/txthome.gif" alt="Building Internet Firewalls" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="PART" href="part04.htm" title="IV. Apendixes"><img src="../gifs/txtnexta.gif" alt="Next: IV. Apendixes" border="0"></A
></TD
></TR
><tr><td align="LEFT" valign="TOP" width="172">13.4 Planning Your Response</TD
><td align="CENTER" valign="TOP" width="171"><a class="index" href="index/idx_a.htm" title="Book Index"><img src="../gifs/index.gif" alt="Book Index" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172">IV. Apendixes</TD
></TR
></TABLE
><hr align="LEFT" width="515" title="footer"><p class="nav"><font size="-1">[ <a href="../index.htm" title="The Networking CD Bookshelf">Library Home</A
> | <a href="../dnsbind/index.htm" title="DNS &amp; BIND">DNS &amp; BIND</A
> | <a href="../tcpip/index.htm" title="TCP/IP Network Administration">TCP/IP</A
> | <a href="../sendmail/index.htm" title="sendmail">sendmail</A
> | <a href="../smdref/index.htm" title="sendmail Desktop Reference">sendmail Reference</A
> | <a href="index.htm" title="Building Internet Firewalls">Firewalls</A
> | <a href="../puis/index.htm" title="Practical UNIX &amp; Internet Security">Practical Security</A
> ]</FONT
></P
></DIV
></BODY
></HTML
>
