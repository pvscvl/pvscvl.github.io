<html><head>
<title>[Chapter 12] Maintaining Firewalls</TITLE>
<meta name="DC.title" content="Building Internet Firewalls"><meta name="DC.creator" content="D. Brent Chapman &amp; Elizabeth D. Zwicky"><meta name="DC.publisher" content="O'Reilly &amp; Associates, Inc."><meta name="DC.date" content="1999-02-04T00:29:22Z"><meta name="DC.type" content="Text.Monograph"><meta name="DC.format" content="text/html" scheme="MIME"><meta name="DC.source" content="1-56592-124-0" scheme="ISBN"><meta name="DC.language" content="en-US"><meta name="generator" content="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><link rev="made" href="mailto:online-books@oreilly.com" title="Online Books Comments"><link rel="up" href="part03.htm" title="III. Keeping Your Site Secure"><link rel="prev" href="ch11_04.htm" title="11.4 What If You Can't Get a Security Policy?"><link rel="next" href="ch12_02.htm#FIRE-12-S2-7" title="12.2 Monitoring Your System"></HEAD
><body bgcolor="#FFFFFF" text="#000000"><div class="htmlnav"><h1><img src="gifs/smbanner.gif" alt="Building Internet Firewalls" usemap="#srchmap" border="0"></H1
><map nameindex.html="srchmap"><area shape="RECT" coords="0,0,466,65" href="index.htm" alt="Building Internet Firewalls"><area shape="RECT" coords="467,0,514,18" href="../search/fsrch.htm" alt="Search this book"></MAP
><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="SECT1" href="ch11_04.htm" title="11.4 What If You Can't Get a Security Policy?"><img src="../gifs/txtpreva.gif" alt="Previous: 11.4 What If You Can't Get a Security Policy?" border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><b><font face="ARIEL,HELVETICA,HELV,SANSERIF" size="-1">Chapter 12</FONT
></B
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="SECT1" href="ch12_02.htm#FIRE-12-S2-7" title="12.2 Monitoring Your System"><img src="../gifs/txtnexta.gif" alt="Next: 12.2 Monitoring Your System" border="0"></A
></TD
></TR
></TABLE
>&nbsp;<hr align="LEFT" width="515" title="footer"></DIV
><div class="CHAPTER"><h1 class="chapter"><a class="title" name="FIRE-12-CHP">12. Maintaining Firewalls</A
></H1
><div class="htmltoc"><p><b>Contents:</B
><br><a class="SECT1" href="#FIRE-12-S1-1" title="12.1 Housekeeping">Housekeeping</A
><br><a class="SECT1" href="ch12_02.htm#FIRE-12-S2-7" title="12.2 Monitoring Your System">Monitoring Your System</A
><br><a class="SECT1" href="ch12_03.htm#FIRE-12-S3-1" title="12.3 Keeping Up to Date">Keeping Up to Date</A
><br><a class="SECT1" href="ch12_04.htm" title="12.4 How Long Does It Take?">How Long Does It Take?</A
><br><a class="SECT1" href="ch12_05.htm" title="12.5 When Should You Start Over?">When Should You Start Over?</A
></P
><p></P
></DIV
><p class="para"><a class="indexterm" name="CH12FWMAIN"></A
><a class="indexterm" name="CH12MAINFW"></A
>If you've done a good job of designing a firewall that fits the needs of
your organization, maintaining that firewall should be fairly
straightforward. What does it mean to maintain a firewall? Maintenance
tasks fall into three major categories: 

<ul class="itemizedlist"><li class="listitem"><p class="para">Housekeeping</P
></LI
><li class="listitem"><p class="para">Monitoring your system</P
></LI
><li class="listitem"><p class="para">Keeping up to date </P
></LI
></UL
></P
><p class="para">Once you've designed and built your firewall, it really shouldn't take a
great deal of effort to keep it going, especially because much of the
maintenance work can be automated.</P
><div class="sect1"><h2 class="sect1"><a class="title" name="FIRE-12-S1-1">12.1 Housekeeping</A
></H2
><p class="para"><a class="indexterm" name="CH12HOUSE"></A
>Housekeeping is the eternal round of small tasks that need to be done to
keep your firewall clean and safe. There are three main tasks you'll
need to deal with again and again:

<ul class="itemizedlist"><li class="listitem"><p class="para">Backing up your firewall</P
></LI
><li class="listitem"><p class="para">Managing your accounts</P
></LI
><li class="listitem"><p class="para">Managing your disk space</P
></LI
></UL
></P
><div class="sect2"><h3 class="sect2"><a class="title" name="FIRE-12-S2-1">12.1.1 Backing Up Your Firewall</A
></H3
><p class="para"><a class="indexterm" name="AUTOID-21203"></A
><a class="indexterm" name="AUTOID-21206"></A
>Make sure to back up all parts of your firewall. That means not
only the general-purpose computers you may be using as bastion hosts or
internal servers, but also the routers or other special-purpose devices.
Rebuilding router configurations usually isn't easy, and your security
depends on having your routers configured correctly.</P
><p class="para">Put your general-purpose machines on a regular, automated backup system.
Preferably, that system should produce confirmation mail when it is
running normally and distinctly different messages when it sees errors.</P
><p class="para">Why not produce mail only when errors occur? If the system produces
mail only on errors, you won't notice the system if it fails to run at
all. (Silence is not necessarily golden, as any parent of small
children knows. If they aren't making noise, they're probably making
mischief.) </P
><p class="para">Why distinctly different messages? If the system produces even vaguely
similar messages when it is running normally and when it fails, people
who are accustomed to ignoring the success messages will also ignore the
failure messages. Ideally, a separate program should check to make sure
that the backups have run, and to produce messages when they haven't. </P
><p class="para">Special-purpose machines like routers change much less often, and
probably don't need an automated backup system. (This is fortunate,
because they rarely support them.) When you do make changes, take
advantage of any means available to record the configuration. Most
systems write their configuration to a local floppy disk; some of them
also support <span class="acronym">FTP</SPAN
>. Write two floppy disks, clearly
label and date them, and store one of them separate from the
machine. Make these backups even if you have downloaded the
configuration with <span class="acronym">FTP</SPAN
>; you don't want the router
to be completely dependent on another machine. If you have written the
configuration on the router, rather than <span class="acronym">FTP</SPAN
>'ing
it, make an <span class="acronym">FTP</SPAN
> copy as well as the floppy
disks. Why? Sometimes it's easier to find files than to find small
physical objects like floppy disks, and sometimes the floppy drive
dies when the rest of the router still works.</P
><blockquote class="note"><p class="para"><strong>NOTE:</STRONG
> The design of backup systems is outside the scope of this book. This
description, along with the section in <a class="xref" href="ch13_01.htm" title="Responding to Security Incidents">Chapter 13, <cite class="chapter">Responding to Security Incidents</CITE
></A
>
called &quot;Backing Up Your Filesystems&quot; provide only a
summary. If you're uncertain about your backup system, you'll want to
look at a general system administration reference. See <a class="xref" href="appa_01.htm" title="Resources">Appendix A, <cite class="appendix">Resources</CITE
></A
> for complete information on additional
resources.</P
></BLOCKQUOTE
></DIV
><div class="sect2"><h3 class="sect2"><a class="title" name="FIRE-12-S2-2">12.1.2 Managing Your Accounts</A
></H3
><p class="para"><a class="indexterm" name="CH12ACCT"></A
><a class="indexterm" name="CH12MGGACCT"></A
>Account management&nbsp;- adding new accounts, removing old ones, aging
passwords, etc.&nbsp;- is one of the most often neglected housekeeping
tasks. On firewall systems, it's absolutely crucial that new accounts
be added correctly, old accounts removed promptly, and passwords
changed appropriately. (See your own system's documentation for how to
do all this.)</P
><p class="para">Establish a procedure for adding accounts; wherever you can, use a
program to add them. Even though there shouldn't be many users on
your firewall systems, every one of them is a possible danger, and it's
worth the effort to ensure they're set up correctly every time.
People have an unfortunate tendency to leave out steps, or to pause for
a few days in the middle of a process. If that gap leaves an account
that has no password, you're creating open invitations to intruders.</P
><p class="para">Make sure your account creation procedure includes dating the
account, and that accounts are automatically reviewed every few
months. You don't need to automatically turn them off, but you do
need to automatically inform somebody that they've timed out. This is
relatively easy to do on a <span class="acronym">UNIX</SPAN
> system; it may be
harder on other systems, particularly dedicated systems like
routers. If possible, set things up so that the accounts can be
watched by an automated system. This can be done by generating account
files on the <span class="acronym">UNIX</SPAN
> side and then transferring them
to the other machine, or by generating the accounts on the machine
itself, but automatically copying the account files to the
<span class="acronym">UNIX</SPAN
> side and examining them.</P
><p class="para">You should also arrange to get termination notices from the appropriate
authorities whenever someone leaves your organization. Most companies
are able to send around notices for full-time employees, and most
universities can provide graduation notification for students. It may be
much harder to keep track of contractors and students who drop out, so
you shouldn't rely on official notifications to tell you about everybody
who has left. You may also need to confirm notifications: for example,
you may get termination notices for people who are actually converting
to contract status, or graduation notices for people who are continuing
as graduate students or junior faculty. These people are going to be
annoyed if you get rid of all their files (although it's probably
acceptable to temporarily disable their accounts if their status is in
doubt).</P
><p class="para"><a class="indexterm" name="AUTOID-21235"></A
>If your operating system supports password aging, you may want to turn
it on. Use a relatively long time period&nbsp;- perhaps three to six months.
 If you time out passwords more frequently (e.g., every month), users
will be willing to go to great lengths to circumvent the timeout, and
you probably won't see any real gain in security. Similarly, if your
password aging doesn't guarantee that the user will see a notification
before the account becomes unusable, don't turn it on. Otherwise, you
will annoy your users, and you will run the risk of accidentally locking
out administrators who have a critical need to use the machine. </P
><p class="para">If password aging on your system is going to require a user to change
his password as he is logging in, you need a password program that
strictly enforces good passwords. If you don't do this, people will
choose simple passwords in the heat of the moment, honestly intending to
change them to better ones later. All in all, you may find it more
effective to simply send people notices on a regular basis, even though
you'll get less compliance that way.<a class="indexterm" name="AUTOID-21239"></A
><a class="indexterm" name="AUTOID-21240"></A
></P
></DIV
><div class="sect2"><h3 class="sect2"><a class="title" name="FIRE-12-S2-3">12.1.3 Managing Your Disk Space</A
></H3
><p class="para"><a class="indexterm" name="AUTOID-21244"></A
>Data always expands to fill all available space, even on machines
that have almost no users. People dump things in odd corners of the filesystem, &quot;just for now,&quot; and they build up there. This causes more problems
than you may realize. Aside from the fact that you may want that disk
space, this random junk complicates incident response. You'll end up
asking yourself: </P
><blockquote class="blockquote"><p class="para">Is that a program that you left lying around last time you needed to
install a new version, or did an intruder put it in? </P
><p class="para">Is that truly a random data file, or does it have some deep meaning to
an intruder? </P
></BLOCKQUOTE
><p class="para">Unfortunately, there is no automatic way to find junk; human beings,
particularly system administrators who can write anywhere on the disk,
are too unpredictable. Another person needs to look around on a
regular basis. It's particularly effective to send every new system
administrator on a tour of the disks; they'll notice things the old
hands have become accustomed to.</P
><p class="para">Auditing programs like Tripwire, discussed in <a class="xref" href="ch05_01.htm" title="Bastion Hosts">Chapter 5, <cite class="chapter">Bastion Hosts</CITE
></A
>,
will tell you about new files that appear in supposedly static areas,
and this information will help you keep things straight. You will still
need to check all the areas where you intentionally allow changes, and
you should periodically go back and re-check the static areas. You will
probably get the alert while you still know why you put that file in
that place, and that knowledge may wear off over time.</P
><p class="para"><a class="indexterm" name="AUTOID-21254"></A
><a class="indexterm" name="AUTOID-21257"></A
>On most firewall machines, your main disk space problem will be logs.
These can and should be rotated automatically, and you may want to
compress them as well; a program like <em class="emphasis">trimlog</EM
>
(see <a class="xref" href="appb_01.htm" title="Tools">Appendix B, <cite class="appendix">Tools</CITE
></A
>) helps automate the process. It's
important to stop programs or cause them to suspend logging while you
are trying to truncate or move logs. If a program is trying to write
to a log file while you're trying to move or truncate it, you're
obviously going to have problems. In fact, though, you may run into
difficulties even if a program is simply holding the file open in
preparation for writing to it later, e.g., you may discover the
program is still logging to the file you renamed.<a class="indexterm" name="AUTOID-21262"></A
></P
></DIV
></DIV
></DIV
><div class="htmlnav"><p></P
><hr align="LEFT" width="515" title="footer"><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="SECT1" href="ch11_04.htm" title="11.4 What If You Can't Get a Security Policy?"><img src="../gifs/txtpreva.gif" alt="Previous: 11.4 What If You Can't Get a Security Policy?" border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><a class="book" href="index.htm" title="Building Internet Firewalls"><img src="../gifs/txthome.gif" alt="Building Internet Firewalls" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="SECT1" href="ch12_02.htm#FIRE-12-S2-7" title="12.2 Monitoring Your System"><img src="../gifs/txtnexta.gif" alt="Next: 12.2 Monitoring Your System" border="0"></A
></TD
></TR
><tr><td align="LEFT" valign="TOP" width="172">11.4 What If You Can't Get a Security Policy?</TD
><td align="CENTER" valign="TOP" width="171"><a class="index" href="index/idx_a.htm" title="Book Index"><img src="../gifs/index.gif" alt="Book Index" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172">12.2 Monitoring Your System</TD
></TR
></TABLE
><hr align="LEFT" width="515" title="footer"><p class="nav"><font size="-1">[ <a href="../index.htm" title="The Networking CD Bookshelf">Library Home</A
> | <a href="../dnsbind/index.htm" title="DNS &amp; BIND">DNS &amp; BIND</A
> | <a href="../tcpip/index.htm" title="TCP/IP Network Administration">TCP/IP</A
> | <a href="../sendmail/index.htm" title="sendmail">sendmail</A
> | <a href="../smdref/index.htm" title="sendmail Desktop Reference">sendmail Reference</A
> | <a href="index.htm" title="Building Internet Firewalls">Firewalls</A
> | <a href="../puis/index.htm" title="Practical UNIX &amp; Internet Security">Practical Security</A
> ]</FONT
></P
></DIV
></BODY
></HTML
>
