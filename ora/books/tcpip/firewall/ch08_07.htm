<html><head>
<title>[Chapter 8] 8.7 Other Information Services</TITLE>
<meta name="DC.title" content="Building Internet Firewalls"><meta name="DC.creator" content="D. Brent Chapman &amp; Elizabeth D. Zwicky"><meta name="DC.publisher" content="O'Reilly &amp; Associates, Inc."><meta name="DC.date" content="1999-02-04T00:24:40Z"><meta name="DC.type" content="Text.Monograph"><meta name="DC.format" content="text/html" scheme="MIME"><meta name="DC.source" content="1-56592-124-0" scheme="ISBN"><meta name="DC.language" content="en-US"><meta name="generator" content="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><link rev="made" href="mailto:online-books@oreilly.com" title="Online Books Comments"><link rel="up" href="ch08_01.htm" title="8. Configuring Internet Services"><link rel="prev" href="ch08_06.htm#FIRE-08-S2-20" title="8.6 World Wide Web (WWW) and HTTP"><link rel="next" href="ch08_08.htm#FIRE-08-S3-55" title="8.8 Information Lookup Services"></HEAD
><body bgcolor="#FFFFFF" text="#000000"><div class="htmlnav"><h1><img src="gifs/smbanner.gif" alt="Building Internet Firewalls" usemap="#srchmap" border="0"></H1
><map nindex.htmlame="srchmap"><area shape="RECT" coords="0,0,466,65" href="index.htm" alt="Building Internet Firewalls"><area shape="RECT" coords="467,0,514,18" href="../search/fsrch.htm" alt="Search this book"></MAP
><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="SECT1" href="ch08_06.htm#FIRE-08-S2-20" title="8.6 World Wide Web (WWW) and HTTP"><img src="../gifs/txtpreva.gif" alt="Previous: 8.6 World Wide Web (WWW) and HTTP" border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><b><font face="ARIEL,HELVETICA,HELV,SANSERIF" size="-1">Chapter 8<br>Configuring Internet Services</FONT
></B
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="SECT1" href="ch08_08.htm#FIRE-08-S3-55" title="8.8 Information Lookup Services"><img src="../gifs/txtnexta.gif" alt="Next: 8.8 Information Lookup Services" border="0"></A
></TD
></TR
></TABLE
>&nbsp;<hr align="LEFT" width="515" title="footer"></DIV
><div class="SECT1"><h2 class="sect1"><a class="title" name="FIRE-08-S1-7">8.7 Other Information Services</A
></H2
><p class="para">In addition to the World Wide Web services described in the previous
section, there are a number of other popular information services as
well, including Gopher, <span class="acronym">WAIS</SPAN
>, and Archie.</P
><div class="sect2"><h3 class="sect2"><a class="title" name="FIRE-08-S2-25">8.7.1 Gopher</A
></H3
><p class="para"><a class="indexterm" name="CH08GOPHER"></A
><a class="indexterm" name="CH08CONFGOPH"></A
>Gopher is a menu-driven text-based tool for browsing through files and
directories across the Internet. When a user selects a Gopher menu
item, Gopher retrieves the specified file and displays it
appropriately. This means that if a file is compressed, Gopher
automatically uncompresses it; if it's a <span class="acronym">GIF</SPAN
> image,
Gopher automatically runs a <span class="acronym">GIF</SPAN
> viewer.</P
><p class="para">The security concerns for Gopher are essentially the same&nbsp;- from both a
server and a client point of view&nbsp;- as those described in the preceding
section for
<span class="acronym">HTTP</SPAN
> servers and clients.</P
><p class="para">For servers, you have to worry about what a malicious client can trick
you into running. Like <span class="acronym">HTTP</SPAN
> servers, some Gopher
servers use auxiliary programs to generate Gopher pages on the
fly. Gopher servers are therefore susceptible to the same kinds of
problems as <span class="acronym">HTTP</SPAN
> servers:</P
><ul class="itemizedlist"><li class="listitem"><p class="para">Can an attacker trick the auxiliary program?</P
></LI
><li class="listitem"><p class="para">Can the attacker upload his own auxiliary program and cause it to be
run?</P
></LI
></UL
><p class="para">For clients, you have to worry about what a malicious server can trick
you into doing. Gopher uses the same kinds of extensible data type and
auxiliary program mechanisms as <span class="acronym">HTTP</SPAN
>, so the
concerns are similar to those described for <span class="acronym">HTTP</SPAN
>.</P
><p class="para">Like <span class="acronym">HTTP</SPAN
> servers, Gopher servers also sometimes
live on nonstandard ports, so those concerns are similar to
<span class="acronym">HTTP</SPAN
> as well. Some Gopher clients support
transparent proxying (via <span class="acronym">SOCKS</SPAN
> or other
mechanisms), but many don't.</P
><p class="para"><a class="indexterm" name="AUTOID-11527"></A
><a class="indexterm" name="AUTOID-11531"></A
>Most of the common <span class="acronym">WWW</SPAN
> browsers such as Mosaic and
Netscape Navigator are Gopher clients as well as being
<span class="acronym">HTTP</SPAN
> clients. These browsers generally support the
proxying of Gopher via <span class="acronym">SOCKS</SPAN
> or via transparent
<span class="acronym">HTTP</SPAN
> proxy servers such as the CERN
<span class="acronym">HTTP</SPAN
> server described in the preceding
section. Even if you can't find a dedicated Gopher client that does
proxying, you can probably use one of these <span class="acronym">WWW</SPAN
>
browsers (and an appropriate proxy server) instead. Your users may
even prefer this approach to using a separate Gopher client, because
it means they only have one application&nbsp;- a client for
<span class="acronym">HTTP</SPAN
>, Gopher, and several other protocols&nbsp;- to learn
and configure, rather than a separate application for each protocol.</P
><div class="sect3"><h4 class="sect3"><a class="title" name="FIRE-08-S3-43">8.7.1.1 Packet filtering characteristics of
Gopher</A
></H4
><p class="para"><a class="indexterm" name="AUTOID-11546"></A
>Gopher is a <span class="acronym">TCP</SPAN
>-based service. Gopher clients use
ports above 1023. Most Gopher servers use port 70, but some don't;
see the discussion of nonstandard server ports above, in the section
called &quot;Packet Filtering Characteristics of
<span class="acronym">HTTP</SPAN
>.&quot;</P
><table class="informaltable"><thead class="thead"><tr class="row" valign="TOP"><th class="entry" align="LEFT" rowspan="1" colspan="1">Direc-</TH
><th class="entry" align="LEFT" rowspan="1" colspan="1">Source</TH
><th class="entry" align="LEFT" rowspan="1" colspan="1">Dest.</TH
><th class="entry" align="LEFT" rowspan="1" colspan="1">Pro-</TH
><th class="entry" align="LEFT" rowspan="1" colspan="1">Source</TH
><th class="entry" align="LEFT" rowspan="1" colspan="1">Dest.</TH
><th class="entry" align="LEFT" rowspan="1" colspan="1">ACK</TH
><th class="entry" align="LEFT" rowspan="1" colspan="1"></TH
></TR
><tr class="row" valign="TOP"><th class="entry" align="LEFT" rowspan="1" colspan="1">tion</TH
><th class="entry" align="LEFT" rowspan="1" colspan="1">Addr.</TH
><th class="entry" align="LEFT" rowspan="1" colspan="1">Addr.</TH
><th class="entry" align="LEFT" rowspan="1" colspan="1">tocol</TH
><th class="entry" align="LEFT" rowspan="1" colspan="1">Port</TH
><th class="entry" align="LEFT" rowspan="1" colspan="1">Port</TH
><th class="entry" align="LEFT" rowspan="1" colspan="1">Set</TH
><th class="entry" align="LEFT" rowspan="1" colspan="1">Notes</TH
></TR
></THEAD
><tbody class="tbody"><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1"><p class="para">In</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Ext</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Int</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para"><span class="acronym">TCP</SPAN
></P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">&gt;1023</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">70[21]</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">[22]</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Incoming session, client to server</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1"><p class="para">Out</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Int</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Ext</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para"><span class="acronym">TCP</SPAN
></P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">70[21] </P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">&gt;1023</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Yes</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Incoming session, server to client</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1"><p class="para">Out</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Int</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Ext</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para"><span class="acronym">TCP</SPAN
></P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">&gt;1023</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">70[21] </P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">[22]</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Outgoing session, client to server</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1"><p class="para">In</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Ext</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Int</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para"><span class="acronym">TCP</SPAN
></P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">70[21] </P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">&gt;1023</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Yes</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Outgoing session, server to client</P
></TD
></TR
></TBODY
></TABLE
><blockquote class="footnote"><p class="para">[21] 70 is the standard port number for Gopher servers, but some servers
run on different port numbers.</P
><p class="para">[22] <span class="acronym">ACK</SPAN
> is not set on the first packet of this type
(establishing connection) but will be set on the rest.</P
></BLOCKQUOTE
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="FIRE-08-S3-44">8.7.1.2 Proxying characteristics of Gopher</A
></H4
><p class="para"><a class="indexterm" name="AUTOID-11666"></A
>The <span class="acronym">TIS FWTK</SPAN
> <em class="emphasis">http-gw</EM
> proxy
server can serve Gopher as well as
<span class="acronym">HTTP</SPAN
>. <span class="acronym">SOCKS</SPAN
> does not include a
modified Gopher client, but Gopher clients are, in general, not
difficult to modify to use <span class="acronym">SOCKS</SPAN
>; many of the
Gopher clients freely available on the Internet support
<span class="acronym">SOCKS</SPAN
> as either a compile-time or run-time
option. Using a Web browser that supports proxying, like Netscape
Navigator or Mosaic, will give you proxy support for Gopher
automatically.</P
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="FIRE-08-S3-45">8.7.1.3 Summary of Gopher
recommendations</A
></H4
><p class="para">These recommendations are basically the same as for
<span class="acronym">HTTP</SPAN
>:</P
><ul class="itemizedlist"><li class="listitem"><p class="para">If you're going to run a Gopher server, use a dedicated bastion
host if possible. </P
></LI
><li class="listitem"><p class="para">If you're going to run a Gopher server, carefully configure the Gopher
server to control what it has access to; in particular, watch out for
ways that someone could upload a program to Gopher system somehow (via
mail or <span class="acronym">FTP</SPAN
>, for example), and then execute it via
the Gopher server.</P
></LI
><li class="listitem"><p class="para">Carefully control the external programs your Gopher server can
access.</P
></LI
><li class="listitem"><p class="para">You can't allow internal hosts to access all Gopher servers without
allowing them to access all <span class="acronym">TCP</SPAN
> ports, because some
Gopher servers use nonstandard port numbers. If you don't mind
allowing your users access to all <span class="acronym">TCP</SPAN
> ports, you
can use packet filtering to examine the <span class="acronym">ACK</SPAN
> bit to
allow outgoing connections to those ports (but not incoming
connections from those ports). If you do mind, then either restrict
your users to servers on the standard port (70), or use proxying.</P
></LI
><li class="listitem"><p class="para">Configure your Gopher clients carefully, and warn your users not to
reconfigure them based on external advice.</P
></LI
><li class="listitem"><p class="para">If possible, use a Web browser such as Mosaic or Netscape Navigator
for your Gopher client, rather than a dedicated client. Your users are
probably going to demand <span class="acronym">WWW</SPAN
> access before Gopher
access anyway, so you might as well only have to figure out and secure
one application.</P
></LI
></UL
><a class="indexterm" name="AUTOID-11698"></A
><a class="indexterm" name="AUTOID-11699"></A
></DIV
></DIV
><div class="sect2"><h3 class="sect2"><a class="title" name="FIRE-08-S2-26">8.7.2 Wide Area Information Servers
(<span class="acronym">WAIS</SPAN
>)</A
></H3
><p class="para"><a class="indexterm" name="CH08WAIS"></A
><a class="indexterm" name="CH08CONFWAIS"></A
><span class="acronym">WAIS</SPAN
> indexes large text databases so that they can
be searched efficiently by simple keyword or more complicated Boolean
expressions. For example, you can ask for all the documents that
mention &quot;firewalls&quot; or all the documents that mention
&quot;firewalls&quot; but don't mention &quot;fire
marshals&quot;. (You might do this to make sure you don't get 
documents about literal
firewalls.) <span class="acronym">WAIS</SPAN
> was originally developed at
Thinking Machines as a prototype information service, and is now
widely used on the Internet for things like mailing-list archives and
catalogs of various text-based information (library card catalogs, for
example).</P
><p class="para"><span class="acronym">WAIS</SPAN
> servers present the same basic security
concerns as the servers for all of the other common Internet services,
such as <span class="acronym">FTP</SPAN
> and <span class="acronym">HTTP</SPAN
>: Can an
attacker use this server to access something he shouldn't?</P
><p class="para">You address this problem just as you do with other servers: Secure and
restrict the environment the server runs in. In this way, you ensure
that even if the attacker gets out of the server, there's nothing else
of interest to be found on the machine. Further, nothing else should
trust the machine enough to significantly facilitate further
break-ins.</P
><p class="para">Generally, <span class="acronym">WAIS</SPAN
> servers do not run auxiliary
programs the way <span class="acronym">HTTP</SPAN
> and Gopher servers do,
so with <span class="acronym">WAIS</SPAN
>, you don't need to worry that
attackers will trick your servers or upload auxiliary programs as they
can with the <span class="acronym">HTTP</SPAN
> and Gopher servers. Because
<span class="acronym">WAIS</SPAN
> clients are not generally extensible with new
data types and auxiliary programs, as <span class="acronym">HTTP</SPAN
> and
Gopher clients are, you also don't have that can of worms to worry
about.</P
><p class="para"><span class="acronym">WAIS</SPAN
> servers do share one characteristic of
<span class="acronym">HTTP</SPAN
> and Gopher servers, however: while there is a
standard port number for <span class="acronym">WAIS</SPAN
> servers
(<span class="acronym">TCP</SPAN
> port 210), not all of them use it. See the
discussion of this in the section on <span class="acronym">HTTP</SPAN
> above for
an understanding of the problems this can cause.</P
><p class="para"><span class="acronym">WAIS</SPAN
> clients are generally standalone
programs. They help you find <span class="acronym">WAIS</SPAN
> servers, submit
queries to those servers, display the results, submit follow-on queries
based on previous results, and so on. <span class="acronym">WAIS</SPAN
>
information is generally text-based, so <span class="acronym">WAIS</SPAN
>
clients generally don't have the problems that <span class="acronym">HTTP</SPAN
>
and Gopher clients do regarding the safety of the data they retrieve.</P
><p class="para">Some <span class="acronym">WWW</SPAN
> browsers include limited
<span class="acronym">WAIS</SPAN
> client support.</P
><div class="sect3"><h4 class="sect3"><a class="title" name="FIRE-08-S3-46">8.7.2.1 Packet filtering characteristics of
<span class="acronym">WAIS</SPAN
></A
></H4
><p class="para"><a class="indexterm" name="AUTOID-11743"></A
><span class="acronym">WAIS</SPAN
> is a <span class="acronym">TCP</SPAN
>-based
service. <span class="acronym">WAIS</SPAN
> clients use random ports above 1023.
<span class="acronym">WAIS</SPAN
> servers usually use port 210, but sometimes
don't; see the discussion of nonstandard server ports above, in the
section about <span class="acronym">HTTP</SPAN
>.</P
><table class="informaltable"><thead class="thead"><tr class="row" valign="TOP"><th class="entry" align="LEFT" rowspan="1" colspan="1">Direc-</TH
><th class="entry" align="LEFT" rowspan="1" colspan="1">Source</TH
><th class="entry" align="LEFT" rowspan="1" colspan="1">Dest.</TH
><th class="entry" align="LEFT" rowspan="1" colspan="1">Pro-</TH
><th class="entry" align="LEFT" rowspan="1" colspan="1">Source</TH
><th class="entry" align="LEFT" rowspan="1" colspan="1">Dest.</TH
><th class="entry" align="LEFT" rowspan="1" colspan="1">ACK</TH
><th class="entry" align="LEFT" rowspan="1" colspan="1"></TH
></TR
><tr class="row" valign="TOP"><th class="entry" align="LEFT" rowspan="1" colspan="1">tion</TH
><th class="entry" align="LEFT" rowspan="1" colspan="1">Addr.</TH
><th class="entry" align="LEFT" rowspan="1" colspan="1">Addr.</TH
><th class="entry" align="LEFT" rowspan="1" colspan="1">tocol</TH
><th class="entry" align="LEFT" rowspan="1" colspan="1">Port</TH
><th class="entry" align="LEFT" rowspan="1" colspan="1">Port</TH
><th class="entry" align="LEFT" rowspan="1" colspan="1">Set</TH
><th class="entry" align="LEFT" rowspan="1" colspan="1">Notes</TH
></TR
></THEAD
><tbody class="tbody"><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1"><p class="para">In</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Ext</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Int</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para"><span class="acronym">TCP</SPAN
></P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">&gt;1023</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">210[23]</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">[24] </P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Incoming session, client to server</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1"><p class="para">Out</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Int</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Ext</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para"><span class="acronym">TCP</SPAN
></P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">210[23] </P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">&gt;1023</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Yes</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Incoming session, server to client</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1"><p class="para">Out</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Int</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Ext</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para"><span class="acronym">TCP</SPAN
></P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">&gt;1023</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">210[23] </P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">[24]</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Outgoing session, client to server</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1"><p class="para">In</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Ext</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Int</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para"><span class="acronym">TCP</SPAN
></P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">210[23] </P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">&gt;1023</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Yes</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Outgoing session, server to client</P
></TD
></TR
></TBODY
></TABLE
><blockquote class="footnote"><p class="para">[23] 210 is the standard port number for <span class="acronym">WAIS</SPAN
>
servers, but some servers run on different port numbers.</P
><p class="para">[24] <span class="acronym">ACK</SPAN
> is not set on the first packet of this type
 (establishing connection) but will be set on the rest.</P
></BLOCKQUOTE
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="FIRE-08-S3-47">8.7.2.2 Proxying characteristics of
<span class="acronym">WAIS</SPAN
></A
></H4
><p class="para"><a class="indexterm" name="AUTOID-11868"></A
>If you use a proxying Web browser like Netscape Navigator or Mosaic to
access <span class="acronym">WAIS</SPAN
>, you automatically get client
support. As a straightforward single-connection protocol with plenty
of user-specified information, <span class="acronym">WAIS</SPAN
> lends itself to
both modified-client and modified-procedure
proxying. <span class="acronym">SOCKS</SPAN
> support is commonly available in
standalone <span class="acronym">WAIS</SPAN
> clients.</P
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="FIRE-08-S3-48">8.7.2.3 Gateways to <span class="acronym">WAIS</SPAN
></A
></H4
><p class="para"><a class="indexterm" name="AUTOID-11880"></A
>A number of sites on the Internet provide <span class="acronym">WAIS</SPAN
>
gateways for <span class="acronym">HTTP</SPAN
> clients, allowing people using
<span class="acronym">WWW</SPAN
> browsers to access <span class="acronym">WAIS</SPAN
>
servers indirectly. Gateways include:</P
><blockquote class="literallayout"><p class="literallayout"><a class="systemitem.url" href="../../../../../../../www.ai.mit.edu/the-net/wais.html">http://www.ai.mit.edu/the-net/wais.html</A
><br><a class="systemitem.url" href="../../../../../../../www.wais.com/">http://www.wais.com/</A
></P
></BLOCKQUOTE
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="FIRE-08-S3-49">8.7.2.4 Summary of <span class="acronym">WAIS</SPAN
> recommendations</A
></H4
><ul class="itemizedlist"><li class="listitem"><p class="para">If you want to run a <span class="acronym">WAIS</SPAN
> server, run it on a
bastion host and on the standard port for <span class="acronym">WAIS</SPAN
>
(<span class="acronym">TCP</SPAN
> port 210). Carefully configure the server to
control what information it has access to.</P
></LI
><li class="listitem"><p class="para">You can't allow internal hosts to access all <span class="acronym">WAIS</SPAN
>
servers without allowing them to access all <span class="acronym">TCP</SPAN
>
ports, because some <span class="acronym">WAIS</SPAN
> servers use nonstandard
port numbers. If you don't mind allowing your users access to all
<span class="acronym">TCP</SPAN
> ports, you can use packet filtering to examine
the <span class="acronym">ACK</SPAN
> bit to allow outgoing connections to those
ports (but not incoming connections from those ports). If you do mind,
then either restrict your users to servers on the standard port
(<span class="acronym">TCP</SPAN
> port 210) or use proxying.</P
></LI
><li class="listitem"><p class="para">If possible, use a Web browser such as Mosaic or Netscape Navigator
for your <span class="acronym">WAIS</SPAN
> client, rather than a dedicated
client. Your users are probably going to demand <span class="acronym">WWW</SPAN
>
access before <span class="acronym">WAIS</SPAN
> access anyway, so you might as
well figure out and secure just one application.</P
></LI
></UL
><a class="indexterm" name="AUTOID-11912"></A
><a class="indexterm" name="AUTOID-11913"></A
></DIV
></DIV
><div class="sect2"><h3 class="sect2"><a class="title" name="FIRE-08-S2-91">8.7.3 Archie</A
></H3
><p class="para"><a class="indexterm" name="CH08ARCHIE"></A
><a class="indexterm" name="CH08CONFARCHIE"></A
>Archie is an Internet service that lets users search through indexes
of anonymous <span class="acronym">FTP</SPAN
> servers for strings or regular
expressions that match file and directory names in the
<span class="acronym">FTP</SPAN
> archives. Archie continually polls public
anonymous <span class="acronym">FTP</SPAN
> servers to keep up to date with
what's available at the sites.</P
><div class="sect3"><h4 class="sect3"><a class="title" name="FIRE-08-S3-50">8.7.3.1 Packet filtering characteristics of
Archie</A
></H4
><p class="para"><a class="indexterm" name="AUTOID-11929"></A
>Archie is a <span class="acronym">UDP</SPAN
>-based service. Dedicated Archie
clients use ports above 1023; Archie servers use port 1525. As we
discuss in <a class="xref" href="ch06_01.htm" title="Packet Filtering">Chapter 6</A
>, <span class="acronym">UDP</SPAN
>-based
services in general are a problem for packet filtering
firewalls. Alternative ways to access Archie (other than directly via
the Archie protocol) are discussed in the sections below.</P
><table class="informaltable"><thead class="thead"><tr class="row" valign="TOP"><th class="entry" align="LEFT" rowspan="1" colspan="1">Direc-</TH
><th class="entry" align="LEFT" rowspan="1" colspan="1">Source</TH
><th class="entry" align="LEFT" rowspan="1" colspan="1">Dest.</TH
><th class="entry" align="LEFT" rowspan="1" colspan="1">Pro-</TH
><th class="entry" align="LEFT" rowspan="1" colspan="1">Source</TH
><th class="entry" align="LEFT" rowspan="1" colspan="1">Dest.</TH
><th class="entry" align="LEFT" rowspan="1" colspan="1">ACK</TH
><th class="entry" align="LEFT" rowspan="1" colspan="1"></TH
></TR
><tr class="row" valign="TOP"><th class="entry" align="LEFT" rowspan="1" colspan="1">tion</TH
><th class="entry" align="LEFT" rowspan="1" colspan="1">Addr.</TH
><th class="entry" align="LEFT" rowspan="1" colspan="1">Addr.</TH
><th class="entry" align="LEFT" rowspan="1" colspan="1">tocol</TH
><th class="entry" align="LEFT" rowspan="1" colspan="1">Port</TH
><th class="entry" align="LEFT" rowspan="1" colspan="1">Port</TH
><th class="entry" align="LEFT" rowspan="1" colspan="1">Set</TH
><th class="entry" align="LEFT" rowspan="1" colspan="1">Notes</TH
></TR
></THEAD
><tbody class="tbody"><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1"><p class="para">Out</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Int</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Ext[25] </P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para"><span class="acronym">UDP</SPAN
></P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">&gt;1023</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">1525</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">[26]</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Outgoing query, client to server</P
></TD
></TR
><tr class="row" valign="TOP"><td class="entry" rowspan="1" colspan="1"><p class="para">In</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Ext[25]</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Int</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para"><span class="acronym">UDP</SPAN
></P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">1525</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">&gt;1023</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">[26]</P
></TD
><td class="entry" rowspan="1" colspan="1"><p class="para">Incoming response, server to client</P
></TD
></TR
></TBODY
></TABLE
><blockquote class="footnote"><p class="para">[25] The external address should be one of the well-known Archie servers.</P
><p class="para">[26] <span class="acronym">UDP</SPAN
> packets do not have <span class="acronym">ACK</SPAN
> bits.</P
></BLOCKQUOTE
><p class="para">Most sites with packet filtering systems typically filter out all
<span class="acronym">UDP</SPAN
> traffic, and then open specific, restricted
peepholes between their internal hosts and their bastion host
(<em class="emphasis">not</EM
> the whole outside world) for key
<span class="acronym">UDP</SPAN
>-based services.</P
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="FIRE-08-S3-51">8.7.3.2 Proxying characteristics of
Archie</A
></H4
><p class="para"><a class="indexterm" name="AUTOID-12017"></A
>Because Archie is a <span class="acronym">UDP</SPAN
>-based service, it is not
supported by <span class="acronym">SOCKS</SPAN
>; however, it can be proxied by the
<span class="acronym">UDP</SPAN
> Packet Relayer. <span class="acronym">TIS FWTK</SPAN
> does not
provide an Archie proxy server and does not provide a generic proxy
server for <span class="acronym">UDP</SPAN
> (<em class="emphasis">plug-gw</EM
>
supports only <span class="acronym">TCP</SPAN
>). Using one of the
<span class="acronym">HTTP</SPAN
>-Archie gateways (discussed below) gives you
the proxying of your Web browser, and provides a better user interface
than many dedicated Archie clients.</P
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="FIRE-08-S3-52">8.7.3.3 Providing Archie service to your
users</A
></H4
><p class="para">There are several ways to let your users access Archie servers,
including Telnet, email, and <span class="acronym">WWW</SPAN
> gateways, and the
dedicated Archie protocol. Sites running Archie servers generally
prefer people to access them via the dedicated Archie protocol (or via
<span class="acronym">WWW</SPAN
> gateways, which in turn access the Archie
servers via the dedicated Archie protocol) because this is more
efficient for them and allows them to serve a greater number of users.</P
>Archie access via Telnet<p class="para"><a class="indexterm" name="AUTOID-12037"></A
><a class="indexterm" name="AUTOID-12040"></A
>If you allow outgoing Telnet, Archie servers can be accessed by
opening a Telnet session to the machine and logging in as
&quot;archie&quot; (no password required). This will give you
access to a command-line-oriented Archie query program. Now you can
either capture a log of the Telnet session to save your results or
tell the server to email you the results after you're done. Issue the
command &quot;help&quot; to get started with a description of
the server's command language.</P
>Archie access via email<p class="para"><a class="indexterm" name="AUTOID-12046"></A
><a class="indexterm" name="AUTOID-12049"></A
>Generally, Archie servers can also be accessed by email. If you send
an email message to &quot;archie&quot; at one of the Archie
sites (e.g., <em class="emphasis">archie@archie.ans.net</EM
>), it
will treat the mail as a query to be processed and will email back the
results. Send the query &quot;help&quot; to find out how to use
the service.</P
>Archie access via WWW gateways<p class="para"><a class="indexterm" name="AUTOID-12056"></A
><a class="indexterm" name="AUTOID-12059"></A
>Like many services, Archie servers can also be accessed via a
variety of <span class="acronym">WWW</SPAN
> gateways; simply point your Web
browser at one of the following:</P
><blockquote class="literallayout"><p class="literallayout"><a class="systemitem.url" href="../../../../../../../www.lerc.nasa.gov/Doc/archieplex-httpd.html">http://www.lerc.nasa.gov/Doc/archieplex-httpd.html</A
><br><a class="systemitem.url" href="../../../../../../../hoohoo.ncsa.uiuc.edu/archie.html">http://hoohoo.ncsa.uiuc.edu/archie.html</A
><br><a class="systemitem.url" href="../../../../../../../www.nexor.co.uk/archie.html">http://www.nexor.co.uk/archie.html</A
></P
></BLOCKQUOTE
>Archie access via packet filtering
and the dedicated Archie protocol<p class="para"><a class="indexterm" name="AUTOID-12070"></A
><a class="indexterm" name="AUTOID-12073"></A
>Archie servers can be accessed directly with dedicated Archie clients.
The problem is, as we've discussed above, Archie is
<span class="acronym">UDP</SPAN
>-based, and most sites block all but a very
restricted set of <span class="acronym">UDP</SPAN
> packets through their
firewall in order to avoid security problems with
<span class="acronym">RPC</SPAN
>-based services like <span class="acronym">NFS</SPAN
> and
<span class="acronym">NIS/YP</SPAN
>. </P
><p class="para">What makes it possible to provide direct Archie access via packet
filtering is that there are so few Archie servers. Many sites
consider it safe enough to open a peephole in the packet filtering for
Archie to the well-known Archie servers their users are likely to
use. There are several reasons for this:</P
><ul class="itemizedlist"><li class="listitem"><p class="para">The list of servers is small and fairly stable. </P
></LI
><li class="listitem"><p class="para">In order to be attacked through this peephole, the attack would have
to come (or at least convincingly appear to come) from one of these
sites. Given that these are all well-known and very heavily used
sites, any break-in to them is probably going to be noticed very
quickly, particularly if it takes down the Archie server in order to
use its port to attack some other site. Even forging packets is likely
to result in widespread service outages and quick detection.</P
></LI
><li class="listitem"><p class="para">Even if someone did break into one of the Archie servers, what are
the chances that the attacker would then go after your 
site in particular?</P
></LI
></UL
><p class="para">You may also decide that you are willing to take a chance and open your
packet filtering sufficiently to allow your users to access the handful
of major Archie servers in the world, or at least the default servers
you've configured into the client you're distributing.</P
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="FIRE-08-S3-53">8.7.3.4 Running an Archie server</A
></H4
><p class="para"><a class="indexterm" name="AUTOID-12093"></A
><a class="indexterm" name="AUTOID-12096"></A
>Providing an Archie server is a major undertaking, requiring the
dedication of a fairly substantial amount of computing power, disk
space, and network bandwidth. Because of this, there are only about 20
Archie servers in the world; telling you how to become the 21st is
beyond the scope of this book. In any case, it's unlikely to be
beneficial to the world for you to do it. If there are too many
servers, they are more likely to be incomplete or out of date and to
consume bandwidth people need to access the FTP servers.</P
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="FIRE-08-S3-54">8.7.3.5 Summary of Archie recommendations</A
></H4
><ul class="itemizedlist"><li class="listitem"><p class="para">Don't run an Archie server.</P
></LI
><li class="listitem"><p class="para">Teach your users to access Archie via <span class="acronym">WWW</SPAN
> gateways.</P
></LI
></UL
><a class="indexterm" name="AUTOID-12107"></A
><a class="indexterm" name="AUTOID-12108"></A
></DIV
></DIV
></DIV
><div class="htmlnav"><p></P
><hr align="LEFT" width="515" title="footer"><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="SECT1" href="ch08_06.htm#FIRE-08-S2-20" title="8.6 World Wide Web (WWW) and HTTP"><img src="../gifs/txtpreva.gif" alt="Previous: 8.6 World Wide Web (WWW) and HTTP" border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><a class="book" href="index.htm" title="Building Internet Firewalls"><img src="../gifs/txthome.gif" alt="Building Internet Firewalls" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="SECT1" href="ch08_08.htm#FIRE-08-S3-55" title="8.8 Information Lookup Services"><img src="../gifs/txtnexta.gif" alt="Next: 8.8 Information Lookup Services" border="0"></A
></TD
></TR
><tr><td align="LEFT" valign="TOP" width="172">8.6 World Wide Web (WWW) and HTTP</TD
><td align="CENTER" valign="TOP" width="171"><a class="index" href="index/idx_a.htm" title="Book Index"><img src="../gifs/index.gif" alt="Book Index" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172">8.8 Information Lookup Services</TD
></TR
></TABLE
><hr align="LEFT" width="515" title="footer"><p class="nav"><font size="-1">[ <a href="../index.htm" title="The Networking CD Bookshelf">Library Home</A
> | <a href="../dnsbind/index.htm" title="DNS &amp; BIND">DNS &amp; BIND</A
> | <a href="../tcpip/index.htm" title="TCP/IP Network Administration">TCP/IP</A
> | <a href="../sendmail/index.htm" title="sendmail">sendmail</A
> | <a href="../smdref/index.htm" title="sendmail Desktop Reference">sendmail Reference</A
> | <a href="index.htm" title="Building Internet Firewalls">Firewalls</A
> | <a href="../puis/index.htm" title="Practical UNIX &amp; Internet Security">Practical Security</A
> ]</FONT
></P
></DIV
></BODY
></HTML
>
