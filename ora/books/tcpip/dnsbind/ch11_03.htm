<html><head>
<title>[Chapter 11] 11.3 Option Settings</TITLE>
<meta name="DC.title" content="DNS &amp; BIND"><meta name="DC.creator" content="Cricket Liu &amp; Paul Albitz"><meta name="DC.publisher" content="O'Reilly &amp; Associates, Inc."><meta name="DC.date" content="1999-01-06T18:37:26Z"><meta name="DC.type" content="Text.Monograph"><meta name="DC.format" content="text/html" scheme="MIME"><meta name="DC.source" content="1-56592-512-2" scheme="ISBN"><meta name="DC.language" content="en-US"><meta name="generator" content="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><link rev="made" href="mailto:online-books@oreilly.com" title="Online Books Comments"><link rel="up" href="ch11_01.htm" title="11. nslookup"><link rel="prev" href="ch11_02.htm" title="11.2 Interactive Versus Noninteractive"><link rel="next" href="ch11_04.htm" title="11.4 Avoiding the Search List"></HEAD
><body bgcolor="#FFFFFF" text="#000000"><div class="htmlnav"><h1><img src="gifs/smbanner.gif" alt="DNS &amp; BIND" usemap="#srchmap" border="0"></H1
><map name=index.html"srchmap"><area shape="RECT" coords="0,0,466,65" href="index.htm" alt="DNS &amp; BIND"><area shape="RECT" coords="467,0,514,18" href="../search/dsrch.htm" alt="Search this book"></MAP
><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="SECT1" href="ch11_02.htm" title="11.2 Interactive Versus Noninteractive"><img src="../gifs/txtpreva.gif" alt="Previous: 11.2 Interactive Versus Noninteractive" border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><b><font face="ARIEL,HELVETICA,HELV,SANSERIF" size="-1">Chapter 11<br>nslookup</FONT
></B
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="SECT1" href="ch11_04.htm" title="11.4 Avoiding the Search List"><img src="../gifs/txtnexta.gif" alt="Next: 11.4 Avoiding the Search List" border="0"></A
></TD
></TR
></TABLE
>&nbsp;<hr align="LEFT" width="515" title="footer"></DIV
><div class="SECT1"><h2 class="sect1"><a class="title" name="AUTOID-11957">11.3 Option Settings</A
></H2
><p class="para"><a class="indexterm" name="CH11.NSLOOKUPOPTIONS"></A
><kbd class="command">nslookup</KBD
> has its own set of dials and knobs, called
option settings. All of the option settings can be changed. We'll
discuss here what each of the options means. We'll use the rest of the
chapter to show you how to use them.</P
><blockquote class="screen"><pre class="screen">% <code class="userinput"><b>nslookup</B
></CODE
>
Default Server:  bladerunner.fx.movie.edu
Address:  0.0.0.0

&gt; <code class="userinput"><b>set all</B
></CODE
>
Default Server:  bladerunner.fx.movie.edu
Address:  0.0.0.0

Set options:
  nodebug         defname         search          recurse
  nod2            novc            noignoretc      port=53
  querytype=A     class=IN        timeout=5       retry=4
  root=a.root-servers.net.
  domain=fx.movie.edu
  srchlist=fx.movie.edu


&gt; <code class="userinput"><b>^D</B
></CODE
></PRE
></BLOCKQUOTE
><p class="para">Before we get into the options, we need to cover the
introductory lines. The default name server is <i class="systemitem.sitename">bladerunner.fx.movie.edu</I
>.  This means
that every query sent by <kbd class="command">nslookup</KBD
> is going to be
sent to <i class="systemitem.sitename">bladerunner</I
>. The
address 0.0.0.0 means <span class="quote">"this host."</SPAN
> When
<kbd class="command">nslookup</KBD
> is using address 0.0.0.0 or 127.0.0.1 as
its server, it is using the name server running on the local
system&nbsp;- in this case, <i class="systemitem.sitename">bladerunner</I
>.</P
><p class="para">The options come in two flavors: <i class="type">Boolean</I
> and
<i class="type">value</I
>.  The options that do not have an equals sign after
them are<a class="indexterm" name="AUTOID-11978"></A
>
Boolean options. They have the interesting property of being either
<span class="quote">"on"</SPAN
> or <span class="quote">"off."</SPAN
> The value options can take on
different, well, values. How can we tell which Boolean options are on
and which are off? The option is <em class="emphasis">off</EM
> when a
<span class="quote">"no"</SPAN
> precedes the option's
name. <em class="emphasis">nodebug</EM
> means that debugging is off. As you
might guess, the option <em class="emphasis">search</EM
> is on.</P
><p class="para">How you change Boolean or value options depends on whether you
are using <kbd class="command">nslookup</KBD
> interactively or not.  In an
interactive session, you change an option with the<a class="indexterm" name="AUTOID-11988"></A
>
<kbd class="command">set</KBD
> command, as in <kbd class="command">set debug</KBD
> or
<kbd class="command">set domain=classics.movie.edu</KBD
>.  From the command
line, you omit the word <kbd class="command">set</KBD
> and precede the option
with a hyphen, as in <kbd class="command">nslookup -debug</KBD
> or
<kbd class="command">nslookup -domain=classics.movie.edu</KBD
>. The options
can be abbreviated to their shortest unique string&nbsp;- e.g.,
<i class="option">nodeb</I
> for <i class="option">nodebug</I
>. In addition to
its abbreviation, the <i class="option">querytype</I
> option can also be
called simply <i class="option">type</I
>.</P
><p class="para">Let's go through each of the options:</P
><dl class="variablelist"><dt class="term"><i class="function">[no]debug</I
></DT
><dd class="listitem"><p class="para"><a class="indexterm" name="AUTOID-12007"></A
><a class="indexterm" name="AUTOID-12009"></A
><a class="indexterm" name="AUTOID-12011"></A
>Debugging is turned off by default. If it is turned on, the name
server shows timeouts and displays the response packets. See
<i class="option">[no]d2</I
> for a discussion of debug level 2.</P
></DD
><dt class="term"><i class="function">[no]defname</I
></DT
><dd class="listitem"><p class="para"><a class="indexterm" name="AUTOID-12020"></A
><a class="indexterm" name="AUTOID-12022"></A
>By default, <kbd class="command">nslookup</KBD
> adds the default domain name
to names without a dot in them. Before search lists existed, the
<span class="acronym">BIND</SPAN
> resolver code would only add the default
domain to names without <em class="emphasis">any</EM
> dots in them; this
option reflects that behavior. <kbd class="command">nslookup</KBD
> can
implement the pre-search list behavior (with <i class="option">search</I
>
off and <i class="option">defname</I
> on), or it can implement the search
list behavior (with <i class="option">search</I
> on).</P
></DD
><dt class="term"><i class="option">[no]search</I
></DT
><dd class="listitem"><p class="para">The<a class="indexterm" name="AUTOID-12036"></A
><a class="indexterm" name="AUTOID-12038"></A
>
search option <span class="quote">"overshadows"</SPAN
> the default domain name
(<i class="option">defname</I
>) option. That is, <i class="option">defname</I
>
only applies if <i class="option">search</I
> is turned off. By default,
<kbd class="command">nslookup</KBD
> appends the domains in the search list
(<i class="option">srchlist</I
>) to names that don't end in a dot.</P
></DD
><dt class="term"><i class="function">[no]recurse</I
></DT
><dd class="listitem"><p class="para"><a class="indexterm" name="AUTOID-12051"></A
><a class="indexterm" name="AUTOID-12053"></A
><kbd class="command">nslookup</KBD
> requests recursive service by
default. This turns on the recursion-desired bit in query packets. The
<span class="acronym">BIND</SPAN
> resolver sends recursive queries in the same
way. Name servers, however, send out nonrecursive queries to other
name servers.</P
></DD
><dt class="term"><i class="option">[no]d2</I
></DT
><dd class="listitem"><p class="para"><a class="indexterm" name="AUTOID-12062"></A
><a class="indexterm" name="AUTOID-12064"></A
>Debugging at level 2 is turned off by default. If it is turned on, you
see the query packets sent out in addition to the regular debugging
output.  Turning on <i class="option">d2</I
> also turns on
<i class="option">debug</I
>.  Turning off <i class="option">d2</I
> turns off
<i class="option">d2</I
> only; <i class="option">debug</I
> is left on. Turning
off <i class="option">debug</I
> turns off both <i class="option">debug</I
> and
<i class="option">d2</I
>.</P
></DD
><dt class="term"><i class="option">[no]vc</I
></DT
><dd class="listitem"><p class="para"><a class="indexterm" name="AUTOID-12079"></A
><a class="indexterm" name="AUTOID-12081"></A
><a class="indexterm" name="AUTOID-12083"></A
><a class="indexterm" name="AUTOID-12085"></A
><a class="indexterm" name="AUTOID-12087"></A
><a class="indexterm" name="AUTOID-12090"></A
>By default, <kbd class="command">nslookup</KBD
> makes queries using
<span class="acronym">UDP</SPAN
> packets instead of over a
<em class="emphasis">v</EM
>irtual
<em class="emphasis">c</EM
>ircuit (<span class="acronym">TCP</SPAN
>). Most
<span class="acronym">BIND</SPAN
> resolver queries are made with
<span class="acronym">UDP</SPAN
>, so the default <kbd class="command">nslookup</KBD
>
behavior matches the resolver. As the resolver can be instructed to
use <span class="acronym">TCP</SPAN
>, so can <kbd class="command">nslookup</KBD
>.</P
></DD
><dt class="term"><i class="function">[no]ignoretc</I
></DT
><dd class="listitem"><p class="para"><a class="indexterm" name="AUTOID-12108"></A
><a class="indexterm" name="AUTOID-12110"></A
><a class="indexterm" name="AUTOID-12112"></A
>By default, <kbd class="command">nslookup</KBD
> <em class="emphasis">doesn't</EM
>
ignore truncated packets. If a packet is received that has the
<span class="quote">"truncated"</SPAN
> bit set&nbsp;- indicating that the name server
couldn't fit all the important information in the
<span class="acronym">UDP</SPAN
> response
packet&nbsp;- <kbd class="command">nslookup</KBD
> doesn't ignore it; it retries
the query using a <span class="acronym">TCP</SPAN
> connection instead of
<span class="acronym">UDP</SPAN
>. Again, this matches the
<span class="acronym">BIND</SPAN
> resolver behavior. The reason for retrying the
query using a <span class="acronym">TCP</SPAN
> connection is that
<span class="acronym">TCP</SPAN
> responses can be twice as large as
<span class="acronym">UDP</SPAN
> responses. <span class="acronym">TCP</SPAN
> responses
<em class="emphasis">could</EM
> be many times the size of a
<span class="acronym">UDP</SPAN
> response (a <span class="acronym">TCP</SPAN
> connection
can carry much more data than a single <span class="acronym">UDP</SPAN
> packet),
but the buffers <span class="acronym">BIND</SPAN
> uses for a
<span class="acronym">TCP</SPAN
> query are only twice as large as the
<span class="acronym">UDP</SPAN
> buffers.</P
></DD
><dt class="term"><i class="function">port=53</I
></DT
><dd class="listitem"><p class="para"><a class="indexterm" name="AUTOID-12138"></A
>The <span class="acronym">DNS</SPAN
> service is on port 53. You can start a name
server on another port&nbsp;- for debugging purposes, for
example&nbsp;- and <kbd class="command">nslookup</KBD
> can be directed to use
that port.</P
></DD
><dt class="term"><i class="function">querytype=A</I
></DT
><dd class="listitem"><p class="para"><a class="indexterm" name="AUTOID-12147"></A
>By default, <kbd class="command">nslookup</KBD
> looks up A (address) resource
record types. In addition, if you type in an <span class="acronym">IP</SPAN
>
address (and the <kbd class="command">nslookup</KBD
> query type is address or
pointer), then <kbd class="command">nslookup</KBD
> will invert the address,
append <i class="systemitem.sitename">in-addr.arpa</I
>, and look
up <span class="acronym">PTR</SPAN
> (pointer) data instead.</P
></DD
><dt class="term"><i class="function">class=IN</I
></DT
><dd class="listitem"><p class="para">The only<a class="indexterm" name="AUTOID-12160"></A
>
class that matters is <i class="wordasword">Internet</I
>. Well, there
is the <i class="wordasword">Hesiod</I
> (<span class="acronym">HS</SPAN
>) class
too, if you are an <span class="acronym">MIT</SPAN
>er or run Ultrix.</P
></DD
><dt class="term"><i class="function">timeout=5</I
></DT
><dd class="listitem"><p class="para"><a class="indexterm" name="AUTOID-12172"></A
>If the name server doesn't respond within 5 seconds,
<kbd class="command">nslookup</KBD
> resends the query and doubles the timeout
(to 10, 20, and then 40 seconds).  The <span class="acronym">BIND</SPAN
>
resolver uses the same timeouts when querying a single name
server.</P
></DD
><dt class="term"><i class="function">retry=4</I
></DT
><dd class="listitem"><p class="para"><a class="indexterm" name="AUTOID-12182"></A
>Send the query four times before giving up. After each retry, the
timeout value is doubled. Again, this matches the
<span class="acronym">BIND</SPAN
> resolver behavior.</P
></DD
><dt class="term"><i class="function">root=a.root-servers.net.</I
></DT
><dd class="listitem"><p class="para"><a class="indexterm" name="AUTOID-12190"></A
><a class="indexterm" name="AUTOID-12192"></A
><a class="indexterm" name="AUTOID-12195"></A
>There is a convenience command called <kbd class="command">root</KBD
>, which
switches your default server to the server named here. Executing the
<kbd class="command">root</KBD
> command from a modern
<kbd class="command">nslookup</KBD
>'s prompt is equivalent to executing
<kbd class="command">server a.root-servers.net</KBD
>. Older versions use
<i class="systemitem.sitename">nic.ddn.mil</I
> (old) or even
<i class="systemitem.sitename">sri-nic.arpa</I
> (ancient) as the
default root name server. You can change the default
<span class="quote">"root"</SPAN
> server with <kbd class="command">set
root=server</KBD
>.</P
></DD
><dt class="term"><i class="function">domain=fx.movie.edu</I
></DT
><dd class="listitem"><p class="para"><a class="indexterm" name="AUTOID-12211"></A
><a class="indexterm" name="AUTOID-12214"></A
>This is the default domain appended if the <i class="option">defname</I
>
option is on.</P
></DD
><dt class="term"><i class="function">srchlist=fx.movie.edu</I
></DT
><dd class="listitem"><p class="para"><a class="indexterm" name="AUTOID-12223"></A
>If <i class="option">search</I
> is on, these are the domains appended to
names that do not end in a dot. The domains are listed in the order
that they are tried, separated by a slash. (The 4.8.3 search list
defaulted to <i class="systemitem.sitename">fx.movie.edu</I
>/<i class="systemitem.sitename">movie.edu</I
>.  At 4.9.3, you have to
explicitly set the search list in
<i class="filename">/etc/resolv.conf</I
> to get both <i class="systemitem.sitename">fx.movie.edu</I
> and <i class="systemitem.sitename">movie.edu</I
>.)</P
></DD
></DL
><div class="sect2"><h3 class="sect2"><a class="title" name="AUTOID-12231">11.3.1 The .nslookuprc File</A
></H3
><p class="para">You can set up new default <kbd class="command">nslookup</KBD
> options
in an<a class="indexterm" name="AUTOID-12235"></A
>
<i class="filename">.nslookuprc</I
> file. <kbd class="command">nslookup</KBD
>
will look for an <i class="filename">.nslookuprc</I
> file in your home
directory when it starts up, in both interactive and noninteractive
modes.  The <i class="filename">.nslookuprc</I
> file can contain any
legal <kbd class="command">set</KBD
> commands, one per line. This is useful,
for example, if your old <kbd class="command">nslookup</KBD
> still thinks
<i class="systemitem.sitename">sri-nic.arpa</I
> is a root name
server.  You can set the default root name server to a real root with
a line like this in your <i class="filename">.nslookuprc</I
> file:</P
><blockquote class="screen"><pre class="screen">set root=a.root-servers.net.</PRE
></BLOCKQUOTE
><p class="para">You might also use <i class="filename">.nslookuprc</I
> to set your
search list to something other than your host's default search list,
or to change the timeouts <kbd class="command">nslookup</KBD
> uses.</P
></DIV
><a class="indexterm" name="AUTOID-12249"></A
></DIV
><div class="htmlnav"><p></P
><hr align="LEFT" width="515" title="footer"><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="SECT1" href="ch11_02.htm" title="11.2 Interactive Versus Noninteractive"><img src="../gifs/txtpreva.gif" alt="Previous: 11.2 Interactive Versus Noninteractive" border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><a class="book" href="index.htm" title="DNS &amp; BIND"><img src="../gifs/txthome.gif" alt="DNS &amp; BIND" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="SECT1" href="ch11_04.htm" title="11.4 Avoiding the Search List"><img src="../gifs/txtnexta.gif" alt="Next: 11.4 Avoiding the Search List" border="0"></A
></TD
></TR
><tr><td align="LEFT" valign="TOP" width="172">11.2 Interactive Versus Noninteractive</TD
><td align="CENTER" valign="TOP" width="171"><a class="index" href="index/idx_0.htm" title="Book Index"><img src="../gifs/index.gif" alt="Book Index" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172">11.4 Avoiding the Search List</TD
></TR
></TABLE
><hr align="LEFT" width="515" title="footer"><p class="nav"><font size="-1">[ <a href="../index.htm" title="The Networking CD Bookshelf">Library Home</A
> | <a href="index.htm" title="DNS &amp; BIND">DNS &amp; BIND</A
> | <a href="../tcpip/index.htm" title="TCP/IP Network Administration">TCP/IP</A
> | <a href="../sendmail/index.htm" title="sendmail">sendmail</A
> | <a href="../smdref/index.htm" title="sendmail Desktop Reference">sendmail Reference</A
> | <a href="../firewall/index.htm" title="Building Internet Firewalls">Firewalls</A
> | <a href="../puis/index.htm" title="Practical UNIX &amp; Internet Security">Practical Security</A
> ]</FONT
></P
></DIV
></BODY
></HTML
>
