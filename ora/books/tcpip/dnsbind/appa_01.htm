<html><head>
<title>[Appendix A] DNS Message Format and Resource Records</TITLE>
<meta name="DC.title" content="DNS &amp; BIND"><meta name="DC.creator" content="Cricket Liu &amp; Paul Albitz"><meta name="DC.publisher" content="O'Reilly &amp; Associates, Inc."><meta name="DC.date" content="1999-01-06T18:45:10Z"><meta name="DC.type" content="Text.Monograph"><meta name="DC.format" content="text/html" scheme="MIME"><meta name="DC.source" content="1-56592-512-2" scheme="ISBN"><meta name="DC.language" content="en-US"><meta name="generator" content="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><link rev="made" href="mailto:online-books@oreilly.com" title="Online Books Comments"><link rel="up" href="index.htm" title="DNS &amp; BIND"><link rel="prev" href="ch15_09.htm" title="15.9 DNS and WINS"><link rel="next" href="appa_02.htm" title="A.2 DNS Message"></HEAD
><body bgcolor="#FFFFFF" text="#000000"><div class="htmlnav"><h1><img src="gifs/smbanner.gif" alt="DNS &amp; BIND" usemap="#srchmap" border="0"></H1
><map name=index.html"srchmap"><area shape="RECT" coords="0,0,466,65" href="index.htm" alt="DNS &amp; BIND"><area shape="RECT" coords="467,0,514,18" href="../search/dsrch.htm" alt="Search this book"></MAP
><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="SECT1" href="ch15_09.htm" title="15.9 DNS and WINS"><img src="../gifs/txtpreva.gif" alt="Previous: 15.9 DNS and WINS" border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><b><font face="ARIEL,HELVETICA,HELV,SANSERIF" size="-1">Appendix A</FONT
></B
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="SECT1" href="appa_02.htm" title="A.2 DNS Message"><img src="../gifs/txtnexta.gif" alt="Next: A.2 DNS Message" border="0"></A
></TD
></TR
></TABLE
>&nbsp;<hr align="LEFT" width="515" title="footer"></DIV
><div class="APPENDIX"><h1 class="appendix"><a class="title" name="DNS3-APP-A">A. DNS Message Format and Resource
Records</A
></H1
><div class="htmltoc"><p><b>Contents:</B
><br><a class="sect1" href="#AUTOID-18071" title="A.1 Master File Format">Master File Format</A
><br><a class="sect1" href="appa_02.htm" title="A.2 DNS Message">DNS Message</A
><br><a class="sect1" href="appa_03.htm#AUTOID-18674" title="A.3 Header Section Format">Header Section Format</A
><br><a class="sect1" href="appa_04.htm#AUTOID-18705" title="A.4 Resource Record Data">Resource Record Data</A
></P
><p></P
></DIV
><p class="para"><a class="indexterm" name="AUTOID-18061"></A
>This
appendix outlines the format of DNS messages and enumerates all
the resource record types. The resource records are shown in their
textual format, as you would specify them in a DNS database file, and
in their binary format, as they appear in DNS messages. You'll find
a few resource records here that we didn't cover in the book because
they are experimental or obsolete.</P
><p class="para">We've included here
the portions of RFC 1035, written by Paul<a class="indexterm" name="AUTOID-18064"></A
>
Mockapetris, that deal
with the textual format of<a class="indexterm" name="AUTOID-18066"></A
>
master files (what we called <em class="emphasis">db
files</EM
> or <em class="emphasis">DNS database files</EM
> in the book)
or with the DNS message format (for those of you who need to parse
DNS packets).</P
><div class="sect1"><h2 class="sect1"><a class="title" name="AUTOID-18071">A.1 Master File Format</A
></H2
><p class="para">(From RFC 1035, pages
33-35)</P
><p class="para"><a class="indexterm" name="DNS3-IDX-A-DB-FILES-FORMAT-OF"></A
><a class="indexterm" name="DNS3-IDX-A-RFC-1035"></A
><a class="indexterm" name="DNS3-IDX-A-FORMAT-DB-FILES"></A
>The format of these files is a sequence
of entries. Entries are predominantly line-oriented, though parentheses
can be used to continue a list of items across a line boundary,
and text literals can contain CRLF within the text. Any combination
of tabs and spaces acts as a delimiter between the separate items
that make up an entry. The end of any line in the master file can
end with a comment. The comment starts with a &quot;;&quot;.</P
><p class="para">The
following entries are defined:</P
><blockquote class="screen"><pre class="screen"><code class="replaceable"><i>blank</I
></CODE
>[<code class="replaceable"><i>comment</I
></CODE
>]

$ORIGIN <code class="replaceable"><i>domain-name</I
></CODE
> [<code class="replaceable"><i>comment</I
></CODE
>]

$INCLUDE <code class="replaceable"><i>file-name</I
></CODE
> [<code class="replaceable"><i>domain-name</I
></CODE
>] [<code class="replaceable"><i>comment</I
></CODE
>]

<code class="replaceable"><i>domain-name</I
></CODE
><code class="replaceable"><i>rr</I
></CODE
> [<code class="replaceable"><i>comment</I
></CODE
>]

<code class="replaceable"><i>blank</I
></CODE
><code class="replaceable"><i>rr</I
></CODE
> [<code class="replaceable"><i>comment</I
></CODE
>]</PRE
></BLOCKQUOTE
><p class="para">Blank lines, with or without comments, are allowed anywhere
in the file.</P
><p class="para">Two control entries are defined:<a class="indexterm" name="AUTOID-18100"></A
><a class="indexterm" name="AUTOID-18102"></A
>
<code class="literal">$ORIGIN</CODE
> and <code class="literal">$INCLUDE</CODE
>. <code class="literal">$ORIGIN</CODE
> is followed
by a domain name, and resets the current origin for relative domain
names to the stated name. <code class="literal">$INCLUDE</CODE
> inserts the named file into the
current file, and may optionally specify a domain name that sets
the relative domain name origin for the included file. <code class="literal">$INCLUDE</CODE
>
may also have a comment. Note that an <code class="literal">$INCLUDE</CODE
> entry never changes
the relative origin of the parent file, regardless of changes to
the relative origin made within the included file.</P
><p class="para">The
last two forms represent RRs. If an entry for an RR begins with
a blank, then the RR is assumed to be owned by the last stated owner.
If an RR entry begins with a <code class="replaceable"><i>domain-name</I
></CODE
>, then the owner
name is reset.</P
><p class="para"><code class="replaceable"><i>rr</I
></CODE
> contents take one of the following
forms:</P
><blockquote class="screen"><pre class="screen">[<code class="replaceable"><i>TTL</I
></CODE
>] [<code class="replaceable"><i>class</I
></CODE
>] <code class="replaceable"><i>type</I
></CODE
> <code class="replaceable"><i>RDATA</I
></CODE
>
[<code class="replaceable"><i>class</I
></CODE
>] [<code class="replaceable"><i>TTL</I
></CODE
>] <code class="replaceable"><i>type</I
></CODE
> <code class="replaceable"><i>RDATA</I
></CODE
></PRE
></BLOCKQUOTE
><p class="para">The RR begins with optional TTL and class fields,
followed by a type and RDATA field appropriate to the type and class. Class
and type use the standard mnemonics; TTL is a decimal integer. Omitted
class and TTL values are default to the last explicitly stated values.
Since type and class mnemonics are disjoint, the parse is unique.</P
><p class="para"><code class="replaceable"><i>domain-name</I
></CODE
>s make up a large share of the data in the
master file. The labels in the domain name are expressed as character strings
and separated by dots. Quoting conventions allow arbitrary characters
to be stored in domain names.<a class="indexterm" name="AUTOID-18126"></A
><a class="indexterm" name="AUTOID-18129"></A
><a class="indexterm" name="AUTOID-18131"></A
><a class="indexterm" name="AUTOID-18134"></A
><a class="indexterm" name="AUTOID-18137"></A
>
Domain names that end in a dot are called absolute, and are taken as
complete.  Domain names which do not end in a dot are called relative;
the actual domain name is the concatenation of the relative part with
an origin specified in an <code class="literal">$ORIGIN</CODE
>,
<code class="literal">$INCLUDE</CODE
>, or as an argument to the master
file-loading routine. A relative name is an error when no origin is
available.</P
><p class="para"><code class="replaceable"><i>character-string</I
></CODE
> is expressed in one
of two ways: as a contiguous set of characters without interior
spaces, or as a string beginning with a &quot; and ending with a &quot;. Inside
a &quot;-delimited string any character can occur, except for a &quot; itself,
which must be quoted using a backslash (&quot;\&quot;).</P
><p class="para">Because
these files are text files, several special encodings are necessary
to allow arbitrary data to be loaded. In particular:</P
><dl class="variablelist"><dt class="term">.</DT
><dd class="listitem"><p class="para">Of the root.</P
></DD
><dt class="term">@</DT
><dd class="listitem"><p class="para">A free-standing<a class="indexterm" name="AUTOID-18154"></A
>
@ is used to denote the current origin.</P
></DD
><dt class="term">\X</DT
><dd class="listitem"><p class="para">Where X is any character other than a digit (0-9),
is used to quote that character so that its special meaning does
not apply. For example, &quot;\.&quot; can be used to place a dot character
in a label.[1]</P
><blockquote class="footnote"><p class="para">[1]  Not implemented by BIND 4.8.3.</P
></BLOCKQUOTE
></DD
><dt class="term">\DDD</DT
><dd class="listitem"><p class="para"><a class="indexterm" name="AUTOID-18166"></A
>Where
each D is a digit is the octet corresponding to the decimal number
described by DDD. The resulting octet is assumed to be text and
is not checked for special meaning.[2]</P
><blockquote class="footnote"><p class="para">[2]  Not implemented by BIND 4.8.3.</P
></BLOCKQUOTE
></DD
><dt class="term">(  )</DT
><dd class="listitem"><p class="para">Parentheses are used to group data that crosses
a line boundary. In effect, line terminations are not recognized
within<a class="indexterm" name="AUTOID-18174"></A
><a class="indexterm" name="AUTOID-18176"></A
>
parentheses.[3]</P
><blockquote class="footnote"><p class="para">[3]  BIND 4.8.3 allows parentheses only on SOA and WKS
resource records.</P
></BLOCKQUOTE
></DD
><dt class="term">;</DT
><dd class="listitem"><p class="para"><a class="indexterm" name="AUTOID-18184"></A
><a class="indexterm" name="AUTOID-18186"></A
>Semicolon
is used to start a comment; the remainder of the line is ignored.</P
></DD
></DL
><div class="sect2"><h3 class="sect2"><a class="title" name="AUTOID-18188">A.1.1 Character Case</A
></H3
><p class="para">(From RFC 1035, page 9)</P
><p class="para"><a class="indexterm" name="AUTOID-18192"></A
>For
all parts of the DNS that are part of the official protocol, all
comparisons between character strings (e.g., labels, domain names, etc.)
are done in a case-insensitive manner. At present, this rule is
in force throughout the domain system without exception. However,
future additions beyond current usage may need to use the full binary
octet capabilities in names, so attempts to store domain names in
7-bit ASCII or use of special bytes to terminate labels, etc., should
be avoided.</P
></DIV
><div class="sect2"><h3 class="sect2"><a class="title" name="AUTOID-18194">A.1.2 Types</A
></H3
><p class="para"><a class="indexterm" name="DNS3-IDX-A-RESOURCE-RECORDS-TYPES-OF-LIST"></A
>Here is a complete list of resource
record types. The textual representation is used in master files.
The binary representation is used in DNS queries and responses. These
resource records are described on pages 13-21 of RFC 1035.</P
><div class="sect3"><h4 class="sect3"><a class="title" name="AUTOID-18200">A.1.2.1 A address<a class="indexterm" name="AUTOID-18202"></A
><a class="indexterm" name="AUTOID-18204"></A
></A
></H4
><p class="para">(From RFC 1035, page 20)</P
><p class="para">Textual
Representation:</P
><blockquote class="screen"><pre class="screen"><code class="replaceable"><i>owner</I
></CODE
> <code class="replaceable"><i>class</I
></CODE
> <code class="replaceable"><i>ttl</I
></CODE
> A <code class="replaceable"><i>address</I
></CODE
></PRE
></BLOCKQUOTE
><p class="para">Example:</P
><blockquote class="screen"><pre class="screen">localhost.movie.edu.   IN A 127.0.0.1</PRE
></BLOCKQUOTE
><p class="para">Binary Representation:</P
><blockquote class="screen"><pre class="screen">Address type code: 1
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                    ADDRESS                    |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
where:
ADDRESS         A 32 bit Internet address.</PRE
></BLOCKQUOTE
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="AUTOID-18218">A.1.2.2 <a class="indexterm" name="AUTOID-18220"></A
>CNAME canonical name</A
></H4
><p class="para">(From RFC 1035, page 14)</P
><p class="para">Textual
Representation:</P
><blockquote class="screen"><pre class="screen"><code class="replaceable"><i>owner</I
></CODE
> <code class="replaceable"><i>class</I
></CODE
> <code class="replaceable"><i>ttl</I
></CODE
> CNAME <code class="replaceable"><i>canonical-dname</I
></CODE
></PRE
></BLOCKQUOTE
><p class="para">Example:</P
><blockquote class="screen"><pre class="screen">wh.movie.edu.  IN  CNAME  wormhole.movie.edu.</PRE
></BLOCKQUOTE
><p class="para">Binary Representation:</P
><blockquote class="screen"><pre class="screen">CNAME type code: 5
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    /                     CNAME                     /
    /                                               /
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
where:
CNAME           A <code class="replaceable"><i>domain-name</I
></CODE
> which specifies the canonical
                or primary name for the owner.  The owner name is
                an alias.</PRE
></BLOCKQUOTE
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="AUTOID-18234">A.1.2.3 <a class="indexterm" name="AUTOID-18236"></A
><a class="indexterm" name="AUTOID-18238"></A
>HINFO host information</A
></H4
><p class="para">(From RFC 1035, page 14)</P
><p class="para">Textual Representation:</P
><blockquote class="screen"><pre class="screen"><code class="replaceable"><i>owner</I
></CODE
> <code class="replaceable"><i>class</I
></CODE
> <code class="replaceable"><i>ttl</I
></CODE
> HINFO <code class="replaceable"><i>cpu</I
></CODE
> <code class="replaceable"><i>os</I
></CODE
></PRE
></BLOCKQUOTE
><p class="para">Example:</P
><blockquote class="screen"><pre class="screen">grizzly.movie.edu.  IN  HINFO  VAX-11/780 UNIX</PRE
></BLOCKQUOTE
><p class="para">Binary Representation:</P
><blockquote class="screen"><pre class="screen">HINFO type code: 13
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    /                      CPU                      /
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    /                       OS                      /
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
where:
CPU             A <code class="replaceable"><i>character-string</I
></CODE
> which specifies the CPU type.
OS              A <code class="replaceable"><i>character-string</I
></CODE
> which specifies the
                operating system type.</PRE
></BLOCKQUOTE
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="AUTOID-18256">A.1.2.4 <a class="indexterm" name="AUTOID-18258"></A
>MB
mailbox domain name&nbsp;- experimental</A
></H4
><p class="para">(From RFC 1035, page 14)</P
><p class="para">Textual Representation:</P
><blockquote class="screen"><pre class="screen"><code class="replaceable"><i>owner</I
></CODE
> <code class="replaceable"><i>class</I
></CODE
> <code class="replaceable"><i>ttl</I
></CODE
> MB <code class="replaceable"><i>mbox-dname</I
></CODE
></PRE
></BLOCKQUOTE
><p class="para">Example:</P
><blockquote class="screen"><pre class="screen">al.movie.edu.  IN  MB  robocop.movie.edu.</PRE
></BLOCKQUOTE
><p class="para">Binary Representation:</P
><blockquote class="screen"><pre class="screen">MB type code: 7
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    /                   MADNAME                     /
    /                                               /
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
where:
MADNAME         A <code class="replaceable"><i>domain-name</I
></CODE
> which specifies a host which has
                the specified mailbox.</PRE
></BLOCKQUOTE
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="AUTOID-18272">A.1.2.5 <a class="indexterm" name="AUTOID-18274"></A
>MD
mail destination&nbsp;- obsolete</A
></H4
><p class="para">MD has been replaced with
MX.</P
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="AUTOID-18277">A.1.2.6 MF mail forwarder&nbsp;- obsolete</A
></H4
><p class="para">MF has been
replaced with MX.</P
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="AUTOID-18280">A.1.2.7 <a class="indexterm" name="AUTOID-18282"></A
>MG
mail group member&nbsp;- experimental</A
></H4
><p class="para">(From RFC 1035, page 16)</P
><p class="para">Textual Representation:</P
><blockquote class="screen"><pre class="screen"><code class="replaceable"><i>owner</I
></CODE
> <code class="replaceable"><i>class</I
></CODE
> <code class="replaceable"><i>ttl</I
></CODE
> MG <code class="replaceable"><i>mgroup-dname</I
></CODE
></PRE
></BLOCKQUOTE
><p class="para">Example:</P
><blockquote class="screen"><pre class="screen">admin.movie.edu.  IN  MG  al.movie.edu.
                      IN  MG  ed.movie.edu.
                      IN  MG  jc.movie.edu.</PRE
></BLOCKQUOTE
><p class="para">Binary Representation:</P
><blockquote class="screen"><pre class="screen">MG type code: 8
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    /                   MGMNAME                     /
    /                                               /
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
where:
MGMNAME         A <code class="replaceable"><i>domain-name</I
></CODE
> which specifies a mailbox which
                is a member of the mail group specified by the
                domain name.</PRE
></BLOCKQUOTE
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="AUTOID-18296">A.1.2.8 <a class="indexterm" name="AUTOID-18298"></A
>MINFO
mailbox or mail list information&nbsp;- experimental</A
></H4
><p class="para">(From RFC 1035,
page 16)</P
><p class="para">Textual Representation:</P
><blockquote class="screen"><pre class="screen"><code class="replaceable"><i>owner</I
></CODE
> <code class="replaceable"><i>class</I
></CODE
> <code class="replaceable"><i>ttl</I
></CODE
> MINFO <code class="replaceable"><i>resp-mbox</I
></CODE
> <code class="replaceable"><i>error-mbox</I
></CODE
></PRE
></BLOCKQUOTE
><p class="para">Example:</P
><blockquote class="screen"><pre class="screen">admin.movie.edu.  IN  MINFO  al.movie.edu. al.movie.edu.</PRE
></BLOCKQUOTE
><p class="para">Binary Representation:</P
><blockquote class="screen"><pre class="screen">MINFO type code: 14
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    /                    RMAILBX                    /
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    /                    EMAILBX                    /
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
where:
RMAILBX         A <code class="replaceable"><i>domain-name</I
></CODE
> which specifies a mailbox which
                is responsible for the mailing list or mailbox.
                If this domain name names the root, the owner of
                the MINFO RR is responsible for itself.  Note
                that many existing mailing lists use a mailbox
                X-request for the RMAILBX field of mailing list
                X, e.g., Msgroup-request for Msgroup.  This field
                provides a more general mechanism.
EMAILBX         A <code class="replaceable"><i>domain-name</I
></CODE
> which specifies a mailbox which is
                to receive error messages related to the mailing
                list or mailbox specified by the owner of the
                MINFO RR (similar to the ERRORS-TO: field which has
                been proposed). If this domain name names the root,
                errors should be returned to the sender of the
                message.</PRE
></BLOCKQUOTE
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="AUTOID-18314">A.1.2.9 <a class="indexterm" name="AUTOID-18316"></A
>MR
mail rename&nbsp;- experimental</A
></H4
><p class="para">(From RFC 1035, page 17)</P
><p class="para">Textual
Representation:</P
><blockquote class="screen"><pre class="screen"><code class="replaceable"><i>owner</I
></CODE
> <code class="replaceable"><i>class</I
></CODE
> <code class="replaceable"><i>ttl</I
></CODE
> MR <code class="replaceable"><i>new-mbox</I
></CODE
></PRE
></BLOCKQUOTE
><p class="para">Example:</P
><blockquote class="screen"><pre class="screen">eddie.movie.edu.  IN  MR  eddie.bornagain.edu.</PRE
></BLOCKQUOTE
><p class="para">Binary Representation:</P
><blockquote class="screen"><pre class="screen">MR type code: 9
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    /                   NEWNAME                     /
    /                                               /
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
where:
NEWNAME         A <code class="replaceable"><i>domain-name</I
></CODE
> which specifies a mailbox which
                is the proper rename of the specified mailbox.</PRE
></BLOCKQUOTE
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="AUTOID-18330">A.1.2.10 <a class="indexterm" name="AUTOID-18332"></A
>MX
mail exchanger</A
></H4
><p class="para">(From RFC 1035, page 17)</P
><p class="para">Textual
Representation:</P
><blockquote class="screen"><pre class="screen"><code class="replaceable"><i>owner</I
></CODE
> <code class="replaceable"><i>class</I
></CODE
> <code class="replaceable"><i>ttl</I
></CODE
> MX <code class="replaceable"><i>preference</I
></CODE
> <code class="replaceable"><i>exchange-dname</I
></CODE
></PRE
></BLOCKQUOTE
><p class="para">Example:</P
><blockquote class="screen"><pre class="screen">ora.com.  IN  MX  0  ora.ora.com.
          IN  MX  10 ruby.ora.com.
          IN  MX  10 opal.ora.com.</PRE
></BLOCKQUOTE
><p class="para">Binary Representation:</P
><blockquote class="screen"><pre class="screen">MX type code: 15
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                  PREFERENCE                   |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    /                   EXCHANGE                    /
    /                                               /
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
where:
PREFERENCE      A 16 bit integer which specifies the preference
                given to this RR among others at the same owner.
                Lower values are preferred.
EXCHANGE        A <code class="replaceable"><i>domain-name</I
></CODE
> which specifies a host willing
                to act as a mail exchange for the owner name.</PRE
></BLOCKQUOTE
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="AUTOID-18347">A.1.2.11 <a class="indexterm" name="AUTOID-18349"></A
><a class="indexterm" name="AUTOID-18351"></A
>NS
name server</A
></H4
><p class="para">(From RFC 1035, page 18)</P
><p class="para">Textual
Representation:</P
><blockquote class="screen"><pre class="screen"><code class="replaceable"><i>owner</I
></CODE
> <code class="replaceable"><i>class</I
></CODE
> <code class="replaceable"><i>ttl</I
></CODE
> NS <code class="replaceable"><i>name-server-dname</I
></CODE
></PRE
></BLOCKQUOTE
><p class="para">Example:</P
><blockquote class="screen"><pre class="screen">movie.edu.     IN NS terminator.movie.edu</PRE
></BLOCKQUOTE
><p class="para">Binary Representation:</P
><blockquote class="screen"><pre class="screen">NS type code: 1
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    /                   NSDNAME                     /
    /                                               /
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
where:
NSDNAME         A <code class="replaceable"><i>domain-name</I
></CODE
> which specifies a host which
                should be authoritative for the specified
                class and domain.</PRE
></BLOCKQUOTE
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="AUTOID-18366">A.1.2.12 <a class="indexterm" name="AUTOID-18368"></A
>NULL
null&nbsp;- experimental</A
></H4
><p class="para">(From RFC 1035, page 17)</P
><p class="para">Binary
Representation:</P
><blockquote class="screen"><pre class="screen">NULL type code: 10
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    /                  <code class="replaceable"><i>anything</I
></CODE
>               /
    /                                               /
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
Anything at all may be in the RDATA field so long as it is 65535
octets or less.</PRE
></BLOCKQUOTE
><p class="para">NULL is not implemented by BIND.</P
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="AUTOID-18375">A.1.2.13 <a class="indexterm" name="AUTOID-18377"></A
>PTR
pointer</A
></H4
><p class="para">(From RFC 1035, page 18)</P
><p class="para">Textual Representation:</P
><blockquote class="screen"><pre class="screen"><code class="replaceable"><i>owner</I
></CODE
> <code class="replaceable"><i>class</I
></CODE
> <code class="replaceable"><i>ttl</I
></CODE
> PTR <code class="replaceable"><i>dname</I
></CODE
></PRE
></BLOCKQUOTE
><p class="para">Example:</P
><blockquote class="screen"><pre class="screen">1.249.249.192.in-addr.arpa.  IN PTR wormhole.movie.edu.</PRE
></BLOCKQUOTE
><p class="para">Binary Representation:</P
><blockquote class="screen"><pre class="screen">PTR type code: 12
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    /                   PTRDNAME                    /
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
where:
PTRDNAME        A <code class="replaceable"><i>domain-name</I
></CODE
> which points to some location in
                the domain name space.</PRE
></BLOCKQUOTE
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="AUTOID-18391">A.1.2.14 <a class="indexterm" name="AUTOID-18393"></A
>SOA
start of authority</A
></H4
><p class="para">(From RFC 1035, pages 19-20)</P
><p class="para">Textual
Representation:</P
><blockquote class="screen"><pre class="screen"><code class="replaceable"><i>owner</I
></CODE
> <code class="replaceable"><i>class</I
></CODE
> <code class="replaceable"><i>ttl</I
></CODE
> SOA <code class="replaceable"><i>source-dname</I
></CODE
> <code class="replaceable"><i>mbox</I
></CODE
> (
        <code class="replaceable"><i>serial</I
></CODE
> <code class="replaceable"><i>refresh</I
></CODE
> <code class="replaceable"><i>retry</I
></CODE
> <code class="replaceable"><i>expire</I
></CODE
> <code class="replaceable"><i>minimum</I
></CODE
> )</PRE
></BLOCKQUOTE
><p class="para">Example:</P
><blockquote class="screen"><pre class="screen">movie.edu. IN SOA terminator.movie.edu. al.robocop.movie.edu. (
                      1        ; Serial
                      10800    ; Refresh after 3 hours
                      3600     ; Retry after 1 hour
                      604800   ; Expire after 1 week
                      86400 )  ; Minimum TTL of 1 day</PRE
></BLOCKQUOTE
><p class="para">Binary Representation:</P
><blockquote class="screen"><pre class="screen">SOA type code: 6
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    /                     MNAME                     /
    /                                               /
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    /                     RNAME                     /
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                    SERIAL                     |
    |                                               |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                    REFRESH                    |
    |                                               |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                     RETRY                     |
    |                                               |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                    EXPIRE                     |
    |                                               |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                    MINIMUM                    |
    |                                               |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
where:
MNAME           The <code class="replaceable"><i>domain-name</I
></CODE
> of the name server that was the
                original or primary source of data for this zone.
RNAME           A <code class="replaceable"><i>domain-name</I
></CODE
> which specifies the mailbox of the
                person responsible for this zone.
SERIAL          The unsigned 32 bit version number of the original
                copy of the zone.  Zone transfers preserve this
                value.  This value wraps and should be compared
                using sequence space arithmetic.
REFRESH         A 32 bit time interval before the zone should be
                refreshed.
RETRY           A 32 bit time interval that should elapse before
                a failed refresh should be retried.
EXPIRE          A 32 bit time value that specifies the upper limit
                on the time interval that can elapse before the
                zone is no longer authoritative.
MINIMUM         The unsigned 32 bit minimum TTL field that should
                be exported with any RR from this zone.</PRE
></BLOCKQUOTE
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="AUTOID-18414">A.1.2.15 <a class="indexterm" name="AUTOID-18416"></A
>TXT
text</A
></H4
><p class="para">(From RFC 1035, page 20)</P
><p class="para">Textual Representation:</P
><blockquote class="screen"><pre class="screen"><code class="replaceable"><i>owner</I
></CODE
> <code class="replaceable"><i>class</I
></CODE
> <code class="replaceable"><i>ttl</I
></CODE
> TXT <code class="replaceable"><i>txt-strings</I
></CODE
></PRE
></BLOCKQUOTE
><p class="para">Example:</P
><blockquote class="screen"><pre class="screen">cujo.movie.edu.  IN  TXT  &quot;Location: machine room dog house&quot;</PRE
></BLOCKQUOTE
><p class="para">Binary Representation:</P
><blockquote class="screen"><pre class="screen">TXT type code: 16
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    /                   TXT-DATA                    /
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
where:
TXT-DATA        One or more <code class="replaceable"><i>character-string</I
></CODE
>s.</PRE
></BLOCKQUOTE
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="AUTOID-18430">A.1.2.16 <a class="indexterm" name="AUTOID-18432"></A
>WKS
well-known services</A
></H4
><p class="para">(From RFC 1035, page 21)</P
><p class="para">Textual
Representation:</P
><blockquote class="screen"><pre class="screen"><code class="replaceable"><i>owner</I
></CODE
> <code class="replaceable"><i>class</I
></CODE
> <code class="replaceable"><i>ttl</I
></CODE
> WKS <code class="replaceable"><i>address</I
></CODE
> <code class="replaceable"><i>protocol</I
></CODE
> <code class="replaceable"><i>service-list</I
></CODE
></PRE
></BLOCKQUOTE
><p class="para">Example:</P
><blockquote class="screen"><pre class="screen">terminator.movie.edu.  IN  WKS 192.249.249.3  TCP ( telnet smtp
                                              ftp shell domain )</PRE
></BLOCKQUOTE
><p class="para">Binary Representation:</P
><blockquote class="screen"><pre class="screen">WKS type code: 11
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                    ADDRESS                    |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |       PROTOCOL        |                       |
    +--+--+--+--+--+--+--+--+                       |
    |                                               |
    /                   <code class="replaceable"><i>BIT MAP</I
></CODE
>               /
    /                                               /
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
where:
ADDRESS         An 32 bit Internet address
PROTOCOL        An 8 bit IP protocol number
<code class="replaceable"><i>BIT MAP</I
></CODE
>       A variable length bit map.  The bit map must
                be a multiple of 8 bits long.<a class="indexterm" name="AUTOID-18449"></A
></PRE
></BLOCKQUOTE
></DIV
></DIV
><div class="sect2"><h3 class="sect2"><a class="title" name="AUTOID-18450">A.1.3 New Types from RFC 1183</A
></H3
><div class="sect3"><h4 class="sect3"><a class="title" name="AUTOID-18452">A.1.3.1 <a class="indexterm" name="AUTOID-18454"></A
>AFSDB<a class="indexterm" name="AUTOID-18456"></A
><a class="indexterm" name="DNS3-IDX-A-RFC1183"></A
>
Andrew
File System Data Base&nbsp;- experimental</A
></H4
><p class="para">Textual Representation:</P
><blockquote class="screen"><pre class="screen"><code class="replaceable"><i>owner</I
></CODE
> <code class="replaceable"><i>ttl</I
></CODE
> <code class="replaceable"><i>class</I
></CODE
> AFSDB <code class="replaceable"><i>subtype</I
></CODE
> <code class="replaceable"><i>hostname</I
></CODE
></PRE
></BLOCKQUOTE
><p class="para">Example:</P
><blockquote class="screen"><pre class="screen">fx.movie.edu.  IN  AFSDB  1 bladerunner.fx.movie.edu.
               IN  AFSDB  2 bladerunner.fx.movie.edu.
               IN  AFSDB  1 empire.fx.movie.edu.
               IN  AFSDB  2 aliens.fx.movie.edu.</PRE
></BLOCKQUOTE
><p class="para">Binary Representation:</P
><blockquote class="screen"><pre class="screen">AFSDB type code: 18
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                   SUBTYPE                     |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    /                   HOSTNAME                    /
    /                                               /
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
where:
SUBTYPE         Subtype 1 is an AFS cell database server. Subtype 2
                is a DCE authenticated name server.
HOSTNAME        A <code class="replaceable"><i>domain-name</I
></CODE
> which specifies a host that has a
                server for the cell named by the owner of the RR.</PRE
></BLOCKQUOTE
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="AUTOID-18472">A.1.3.2 <a class="indexterm" name="AUTOID-18474"></A
>ISDN<a class="indexterm" name="AUTOID-18476"></A
><a class="indexterm" name="AUTOID-18479"></A
><a class="indexterm" name="AUTOID-18482"></A
>
Integrated
Services Digital Network address&nbsp;- experimental</A
></H4
><p class="para">Textual
Representation:</P
><blockquote class="screen"><pre class="screen"><code class="replaceable"><i>owner</I
></CODE
> <code class="replaceable"><i>ttl</I
></CODE
> <code class="replaceable"><i>class</I
></CODE
> ISDN <code class="replaceable"><i>ISDN-address</I
></CODE
> <code class="replaceable"><i>sa</I
></CODE
></PRE
></BLOCKQUOTE
><p class="para">Example:</P
><blockquote class="screen"><pre class="screen">delay.hp.com.    IN  ISDN  141555514539488
hep.hp.com.      IN  ISDN  141555514539488 004</PRE
></BLOCKQUOTE
><p class="para">Binary Representation:</P
><blockquote class="screen"><pre class="screen">ISDN type code: 20
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    /                 ISDN ADDRESS                  /
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    /                  SUBADDRESS                   /
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
where:
ISDN ADDRESS    A <code class="replaceable"><i>character-string</I
></CODE
> which identifies the ISDN number
                of <code class="replaceable"><i>owner</I
></CODE
> and DDI (Direct Dial In) if any.
SUBADDRESS      An optional <code class="replaceable"><i>character-string</I
></CODE
> specifying the
                subaddress.</PRE
></BLOCKQUOTE
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="AUTOID-18498">A.1.3.3 <a class="indexterm" name="AUTOID-18500"></A
>RP
Responsible Person&nbsp;- experimental</A
></H4
><p class="para">Textual Representation:</P
><blockquote class="screen"><pre class="screen"><code class="replaceable"><i>owner</I
></CODE
> <code class="replaceable"><i>ttl</I
></CODE
> <code class="replaceable"><i>class</I
></CODE
> RP <code class="replaceable"><i>mbox-dname</I
></CODE
> <code class="replaceable"><i>txt-dname</I
></CODE
></PRE
></BLOCKQUOTE
><p class="para">Example:</P
><blockquote class="screen"><pre class="screen">; The current origin is fx.movie.edu
@            IN  RP   ajs.fx.movie.edu.   ajs.fx.movie.edu.
bladerunner  IN  RP   root.fx.movie.edu.  hotline.fx.movie.edu.
             IN  RP   richard.fx.movie.edu.  rb.fx.movie.edu.
ajs          IN  TXT  &quot;Arty Segue, (415) 555-3610&quot;
hotline      IN  TXT  &quot;Movie U. Network Hotline, (415) 555-4111&quot;
rb           IN  TXT  &quot;Richard Boisclair, (415) 555-9612&quot;</PRE
></BLOCKQUOTE
><p class="para">Binary Representation:</P
><blockquote class="screen"><pre class="screen">RP type code: 17
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    /                    MAILBOX                    /
    /                                               /
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    /                    TXTDNAME                   /
    /                                               /
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
where:
MAILBOX         A <code class="replaceable"><i>domain-name</I
></CODE
> that specifies the mailbox for
                the responsible person.
TXTDNAME        A <code class="replaceable"><i>domain-name</I
></CODE
> for which TXT RR's exist.  A
                subsequent query can be performed to retrieve
                the associated TXT resource records at
                <code class="replaceable"><i>txt-dname</I
></CODE
></PRE
></BLOCKQUOTE
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="AUTOID-18516">A.1.3.4 <a class="indexterm" name="AUTOID-18518"></A
>RT
Route Through&nbsp;- experimental</A
></H4
><p class="para">Textual Representation:</P
><blockquote class="screen"><pre class="screen"><code class="replaceable"><i>owner</I
></CODE
> <code class="replaceable"><i>ttl</I
></CODE
> <code class="replaceable"><i>class</I
></CODE
> RT <code class="replaceable"><i>preference</I
></CODE
> <code class="replaceable"><i>intermediate-host</I
></CODE
></PRE
></BLOCKQUOTE
><p class="para">Example:</P
><blockquote class="screen"><pre class="screen">sh.prime.com.  IN  RT  2   Relay.Prime.COM.
               IN  RT  10  NET.Prime.COM.</PRE
></BLOCKQUOTE
><p class="para">Binary Representation:</P
><blockquote class="screen"><pre class="screen">RT type code: 21
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                  PREFERENCE                   |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    /                 INTERMEDIATE                  /
    /                                               /
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
where:
PREFERENCE      A 16 bit integer which specifies the preference
                given to this RR among others at the same owner.
                Lower values are preferred.
EXCHANGE        A <code class="replaceable"><i>domain-name</I
></CODE
> which specifies a host which will
                serve as an intermediate in reaching the host
                specified by <code class="replaceable"><i>owner</I
></CODE
>.</PRE
></BLOCKQUOTE
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="AUTOID-18533">A.1.3.5 <a class="indexterm" name="AUTOID-18535"></A
>X25
X.25 address&nbsp;- experimental</A
></H4
><p class="para">Textual Representation:</P
><blockquote class="screen"><pre class="screen"><code class="replaceable"><i>owner</I
></CODE
> <code class="replaceable"><i>ttl</I
></CODE
> <code class="replaceable"><i>class</I
></CODE
> X25 <code class="replaceable"><i>PSDN-address</I
></CODE
></PRE
></BLOCKQUOTE
><p class="para">Example:</P
><blockquote class="screen"><pre class="screen">relay.pink.com.  IN  X25   31105060845</PRE
></BLOCKQUOTE
><p class="para">Binary Representation:</P
><blockquote class="screen"><pre class="screen">X25 type code: 19
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    /                 PSDN ADDRESS                  /
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
where:
PSDN ADDRESS    A <code class="replaceable"><i>character-string</I
></CODE
> which identifies the PSDN
                (Public Switched Data Network) address in the
                X.121 numbering plan associated with <code class="replaceable"><i>owner</I
></CODE
>.<a class="indexterm" name="AUTOID-18549"></A
></PRE
></BLOCKQUOTE
></DIV
></DIV
><div class="sect2"><h3 class="sect2"><a class="title" name="AUTOID-18550">A.1.4 New Types from RFC 1664<a class="indexterm" name="AUTOID-18552"></A
></A
></H3
><div class="sect3"><h4 class="sect3"><a class="title" name="AUTOID-18554">A.1.4.1 <a class="indexterm" name="AUTOID-18556"></A
>PX
pointer to<a class="indexterm" name="AUTOID-18558"></A
>
 X.400/RFC 822
mapping information</A
></H4
><p class="para">Textual Representation:</P
><blockquote class="screen"><pre class="screen"><code class="replaceable"><i>owner</I
></CODE
> <code class="replaceable"><i>ttl</I
></CODE
> <code class="replaceable"><i>class</I
></CODE
> PX <code class="replaceable"><i>preference</I
></CODE
> <code class="replaceable"><i>RFC822 address</I
></CODE
> <code class="replaceable"><i>X.400 address</I
></CODE
></PRE
></BLOCKQUOTE
><p class="para">Example:</P
><blockquote class="screen"><pre class="screen">ab.net2.it.  IN  PX  10   ab.net2.it.  O-ab.PRMD-net2.ADMDb.C-it.</PRE
></BLOCKQUOTE
><p class="para">Binary Representation:</P
><blockquote class="screen"><pre class="screen"> PX type code: 26
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                  PREFERENCE                   |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    /                    MAP822                     /
    /                                               /
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    /                    MAPX400                    /
    /                                               /
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
where:
PREFERENCE   A 16 bit integer which specifies the preference given to
             this RR among others at the same owner.  Lower values
             are preferred.
MAP822       A <code class="replaceable"><i>domain-name</I
></CODE
> element containing <code class="replaceable"><i>rfc822-domain</I
></CODE
>, the
             RFC 822 part of the RFC 1327 mapping information.
MAPX400      A <code class="replaceable"><i>domain-name</I
></CODE
> element containing the value of
             <code class="replaceable"><i>x400-in-domain-syntax</I
></CODE
> derived from the X.400 part of
             the RFC 1327 mapping information.<a class="indexterm" name="AUTOID-18576"></A
></PRE
></BLOCKQUOTE
></DIV
></DIV
><div class="sect2"><h3 class="sect2"><a class="title" name="AUTOID-18577">A.1.5 Classes</A
></H3
><p class="para">(From RFC 1035, page 13)</P
><p class="para"><a class="indexterm" name="AUTOID-18581"></A
><a class="indexterm" name="AUTOID-18583"></A
>CLASS
fields appear in resource records. The following CLASS mnemonics
and values are defined:</P
><dl class="variablelist"><dt class="term">IN</DT
><dd class="listitem"><p class="para">1 the Internet</P
></DD
><dt class="term">CS</DT
><dd class="listitem"><p class="para">2 the CSNET class (obsolete&nbsp;- used only for examples
in some obsolete RFCs)</P
></DD
><dt class="term">CH</DT
><dd class="listitem"><p class="para">3 the CHAOS class</P
></DD
><dt class="term">HS</DT
><dd class="listitem"><p class="para">4 the Hesiod class<a class="indexterm" name="AUTOID-18602"></A
><a class="indexterm" name="AUTOID-18603"></A
></P
></DD
></DL
></DIV
></DIV
></DIV
><div class="htmlnav"><p></P
><hr align="LEFT" width="515" title="footer"><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="SECT1" href="ch15_09.htm" title="15.9 DNS and WINS"><img src="../gifs/txtpreva.gif" alt="Previous: 15.9 DNS and WINS" border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><a class="book" href="index.htm" title="DNS &amp; BIND"><img src="../gifs/txthome.gif" alt="DNS &amp; BIND" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="SECT1" href="appa_02.htm" title="A.2 DNS Message"><img src="../gifs/txtnexta.gif" alt="Next: A.2 DNS Message" border="0"></A
></TD
></TR
><tr><td align="LEFT" valign="TOP" width="172">15.9 DNS and WINS</TD
><td align="CENTER" valign="TOP" width="171"><a class="index" href="index/idx_0.htm" title="Book Index"><img src="../gifs/index.gif" alt="Book Index" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172">A.2 DNS Message</TD
></TR
></TABLE
><hr align="LEFT" width="515" title="footer"><p class="nav"><font size="-1">[ <a href="../index.htm" title="The Networking CD Bookshelf">Library Home</A
> | <a href="index.htm" title="DNS &amp; BIND">DNS &amp; BIND</A
> | <a href="../tcpip/index.htm" title="TCP/IP Network Administration">TCP/IP</A
> | <a href="../sendmail/index.htm" title="sendmail">sendmail</A
> | <a href="../smdref/index.htm" title="sendmail Desktop Reference">sendmail Reference</A
> | <a href="../firewall/index.htm" title="Building Internet Firewalls">Firewalls</A
> | <a href="../puis/index.htm" title="Practical UNIX &amp; Internet Security">Practical Security</A
> ]</FONT
></P
></DIV
></BODY
></HTML
>
