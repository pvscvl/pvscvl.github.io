<html><head>
<title>[Chapter 4] 4.2 Setting Up DNS Data</TITLE>
<meta name="DC.title" content="DNS &amp; BIND"><meta name="DC.creator" content="Cricket Liu &amp; Paul Albitz"><meta name="DC.publisher" content="O'Reilly &amp; Associates, Inc."><meta name="DC.date" content="1999-01-06T18:26:06Z"><meta name="DC.type" content="Text.Monograph"><meta name="DC.format" content="text/html" scheme="MIME"><meta name="DC.source" content="1-56592-512-2" scheme="ISBN"><meta name="DC.language" content="en-US"><meta name="generator" content="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><link rev="made" href="mailto:online-books@oreilly.com" title="Online Books Comments"><link rel="up" href="ch04_01.htm" title="4. Setting Up BIND"><link rel="prev" href="ch04_01.htm" title="4.1 Our Domain"><link rel="next" href="ch04_03.htm" title="4.3 Setting Up a BIND Configuration File"></HEAD
><body bgcolor="#FFFFFF" text="#000000"><div class="htmlnav"><h1><img src="gifs/smbanner.gif" alt="DNS &amp; BIND" usemap="#srchmap" border="0"></H1
><map name=index.html"srchmap"><area shape="RECT" coords="0,0,466,65" href="index.htm" alt="DNS &amp; BIND"><area shape="RECT" coords="467,0,514,18" href="../search/dsrch.htm" alt="Search this book"></MAP
><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="SECT1" href="ch04_01.htm" title="4.1 Our Domain"><img src="../gifs/txtpreva.gif" alt="Previous: 4.1 Our Domain" border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><b><font face="ARIEL,HELVETICA,HELV,SANSERIF" size="-1">Chapter 4<br>Setting Up <span class="acronym">BIND</SPAN
></FONT
></B
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="SECT1" href="ch04_03.htm" title="4.3 Setting Up a BIND Configuration File"><img src="../gifs/txtnexta.gif" alt="Next: 4.3 Setting Up a BIND Configuration File" border="0"></A
></TD
></TR
></TABLE
>&nbsp;<hr align="LEFT" width="515" title="footer"></DIV
><div class="SECT1"><h2 class="sect1"><a class="title" name="AUTOID-2698">4.2 Setting Up <span class="acronym">DNS</SPAN
> Data</A
></H2
><p class="para"><a class="indexterm" name="DNS3-IDX-4-MAPPING"></A
><a class="indexterm" name="AUTOID-2704"></A
>Our first step in setting up the Movie U. name servers is to translate
the host table into equivalent <span class="acronym">DNS</SPAN
> data. The
<span class="acronym">DNS</SPAN
> version of the data has multiple files. One
file maps all the host names to addresses.  Other files map the
addresses back to host names. The address-to-name lookup is sometimes
called<a class="indexterm" name="AUTOID-2709"></A
>
<i class="firstterm">reverse mapping</I
>. Each network has its own file
for the reverse mapping.</P
><p class="para">As a convention in this book, a file mapping host names to
addresses is called <i class="filename">db.DOMAIN</I
>.
In <i class="systemitem.sitename">movie.edu</I
>, this file is
<i class="filename">db.movie</I
>.  The files mapping addresses to host
names are called <i class="filename">db.ADDR</I
>,
where <i class="wordasword">ADDR</I
> is the network
number without the trailing zeros. In our example, the files are
<i class="filename">db.192.249.249</I
> and
<i class="filename">db.192.253.253</I
>; there's one for each network. The
<i class="wordasword">db</I
> is short for database. We'll call the
collection of <i class="filename">db.DOMAIN</I
> and
<i class="filename">db.ADDR</I
> files<a class="indexterm" name="AUTOID-2723"></A
>
<i class="firstterm">db files</I
> or<a class="indexterm" name="AUTOID-2726"></A
>
<i class="firstterm">DNS database files</I
>. There are a couple of other
data files: <i class="filename">db.cache</I
> and
<i class="filename">db.127.0.0</I
>. These files are overhead. Each name
server must have them, and they are, more or less, the same for each
server.</P
><p class="para">To tie all the db files together, a name server needs a startup
file&nbsp;- for <span class="acronym">BIND</SPAN
> version 4, this file is usually<a class="indexterm" name="AUTOID-2735"></A
><a class="indexterm" name="AUTOID-2737"></A
><a class="indexterm" name="AUTOID-2740"></A
>
<i class="filename">/etc/named.boot</I
>.  For <span class="acronym">BIND</SPAN
>
version 8, this file is usually <i class="filename">/etc/named.conf</I
>.
The db files are <span class="acronym">DNS</SPAN
>-specific. The startup file is
specific to the name server implementation&nbsp;- in this case,
<span class="acronym">BIND</SPAN
>.</P
><div class="sect2"><h3 class="sect2"><a class="title" name="AUTOID-2748">4.2.1 The db Files</A
></H3
><p class="para"><a class="indexterm" name="AUTOID-2751"></A
><a class="indexterm" name="AUTOID-2753"></A
><a class="indexterm" name="AUTOID-2755"></A
><a class="indexterm" name="AUTOID-2758"></A
>Most entries in db files are called <i class="firstterm"><span class="acronym">DNS</SPAN
>
resource records</I
>.  <span class="acronym">DNS</SPAN
> lookups are
case-insensitive, so you can enter names in your db files in
uppercase, lowercase, or mixed case. We tend to use all
lowercase. Even though lookups are case-insensitive, case is
preserved.</P
><p class="para">Resource records must start in column one.  The resource records
in the example files we present in this book do start in column one,
but they may look indented because of the way this book is
formatted. In the <span class="acronym">DNS</SPAN
> <span class="acronym">RFC</SPAN
>s, the
examples present the resource records in a certain order. Most people
have chosen to follow that ordering, as we have here, but this
ordering is not a requirement. The ordering of resource records in the
db files is as follows:</P
><dl class="variablelist"><dt class="term"><a class="indexterm" name="AUTOID-2771"></A
><a class="indexterm" name="AUTOID-2774"></A
><a class="indexterm" name="AUTOID-2777"></A
><a class="indexterm" name="AUTOID-2779"></A
><span class="acronym">SOA</SPAN
> record</DT
><dd class="listitem"><p class="para">Indicates <em class="emphasis">authority</EM
> for this zone data</P
></DD
><dt class="term"><a class="indexterm" name="AUTOID-2788"></A
><span class="acronym">NS</SPAN
> record</DT
><dd class="listitem"><p class="para">Lists a <em class="emphasis">name server</EM
> for this zone</P
></DD
><dt class="term">Other records</DT
><dd class="listitem"><p class="para">Data about hosts in this zone</P
></DD
></DL
><p class="para">Of the other records, this chapter covers:</P
><dl class="variablelist"><dt class="term"><a class="indexterm" name="AUTOID-2802"></A
>A</DT
><dd class="listitem"><p class="para">Name-to-address mapping</P
></DD
><dt class="term"><a class="indexterm" name="AUTOID-2808"></A
><span class="acronym">PTR</SPAN
></DT
><dd class="listitem"><p class="para">Address-to-name mapping</P
></DD
><dt class="term"><a class="indexterm" name="AUTOID-2815"></A
><span class="acronym">CNAME</SPAN
></DT
><dd class="listitem"><p class="para">Canonical name (for aliases)</P
></DD
></DL
><p class="para">Those of you who have some experience with the
<span class="acronym">DNS</SPAN
> file format will look, no doubt, at our data
and say to yourselves, <span class="quote">"It would have been shorter to specify it
this other way...."</SPAN
> We are not using abbreviations or
shortcuts in our data, at least not initially.  Once you understand
the long version, we'll go back and <span class="quote">"tighten up"</SPAN
> the
files.</P
></DIV
><div class="sect2"><h3 class="sect2"><a class="title" name="AUTOID-2824">4.2.2 Comments</A
></H3
><p class="para">The db files are easier to read if they contain<a class="indexterm" name="AUTOID-2827"></A
><a class="indexterm" name="AUTOID-2830"></A
>
comments and blank lines. Comments start with a semicolon and finish
at the end of the line. As you might guess, the name server ignores
comments and blank lines.</P
></DIV
><div class="sect2"><h3 class="sect2"><a class="title" name="AUTOID-2833">4.2.3 <span class="acronym">SOA</SPAN
> Records</A
></H3
><p class="para"><a class="indexterm" name="DNS3-IDX-4-AUTHORITY-FOR-DOMAINS-SOA-RECORDS"></A
><a class="indexterm" name="DNS3-IDX-4-SUBDOMAINS-SOA-RECORDS"></A
><a class="indexterm" name="DNS3-IDX-4-SOA-RECORDS"></A
><a class="indexterm" name="DNS3-IDX-4-ZONES-SOA-RECORDS"></A
>The first entry in each of these files is the
<span class="acronym">SOA</SPAN
> (start of authority) resource record. The<a class="indexterm" name="AUTOID-2849"></A
><a class="indexterm" name="AUTOID-2852"></A
>
<span class="acronym">SOA</SPAN
> record indicates that this name server is the
best source of information for the data within this zone. Our name
server is <i class="firstterm">authoritative</I
> for the zone
<i class="systemitem.sitename">movie.edu</I
> because of the
<span class="acronym">SOA</SPAN
> record.  An <span class="acronym">SOA</SPAN
> record is
required in each <i class="filename">db.DOMAIN</I
> and
<i class="filename">db.ADDR</I
> file. There can be
one, and only one, <span class="acronym">SOA</SPAN
> record in a db file.</P
><p class="para">We added the following <span class="acronym">SOA</SPAN
> record to the
<i class="filename">db.movie</I
> file:</P
><blockquote class="screen"><pre class="screen">movie.edu. IN SOA terminator.movie.edu. al.robocop.movie.edu. (
                          1        ; Serial
                          10800    ; Refresh after 3 hours
                          3600     ; Retry after 1 hour
                          604800   ; Expire after 1 week
                          86400 )  ; Minimum TTL of 1 day</PRE
></BLOCKQUOTE
><p class="para">The name <i class="systemitem.sitename">movie.edu.</I
>
must start in column one of the file. Make sure the names end with a trailing<a class="indexterm" name="AUTOID-2870"></A
><a class="indexterm" name="AUTOID-2873"></A
><a class="indexterm" name="AUTOID-2875"></A
><a class="indexterm" name="AUTOID-2878"></A
>
dot, as we have done here, or you will be surprised at the
result!  (We'll explain later in this chapter.)</P
><p class="para">The <i class="wordasword"><span class="acronym">IN</SPAN
></I
> stands for
Internet. This is one <i class="firstterm">class</I
> of data. Other
classes exist, but none of them are currently in widespread use.  Our
examples use only the<a class="indexterm" name="AUTOID-2885"></A
>
<span class="acronym">IN</SPAN
> class.  The class field is optional.  If the
class is omitted, the class <span class="acronym">IN</SPAN
> is assumed.</P
><p class="para"><a class="indexterm" name="AUTOID-2891"></A
><a class="indexterm" name="AUTOID-2894"></A
><a class="indexterm" name="AUTOID-2897"></A
>The first name after <i class="wordasword"><span class="acronym">SOA</SPAN
></I
>
(<i class="systemitem.sitename">terminator.movie.edu.</I
>) is
the name of the primary master name server for this data. The second
name (<i class="systemitem.sitename">al.robocop.movie.edu.</I
>)
is the mail address of the person in charge of the data (if you
replace the first <span class="quote">"."</SPAN
> with an <span class="quote">"@"</SPAN
>). Often
you'll see <i class="systemitem.example">root</I
>, <i class="systemitem.example">postmaster</I
>, or <i class="systemitem.example">hostmaster</I
> as the email address. Name
servers won't use these names&nbsp;- they are meant for human consumption. If
you have a problem with someone's domain, you can send an email
message to the listed email address. <span class="acronym">BIND</SPAN
> 4.9 and
later versions provide another resource record type,
<span class="acronym">RP</SPAN
> (responsible person), for this purpose also. The<a class="indexterm" name="AUTOID-2911"></A
>
<span class="acronym">RP</SPAN
> record is discussed in <a class="xref" href="ch07_01.htm" title="Maintaining BIND">Chapter 7, <cite class="chapter">Maintaining <span class="acronym">BIND</SPAN
></CITE
></A
>.</P
><p class="para">The<a class="indexterm" name="AUTOID-2917"></A
><a class="indexterm" name="AUTOID-2919"></A
>
parentheses allow the <span class="acronym">SOA</SPAN
> record to span more than
one line. Most of the fields within the parentheses of the
<span class="acronym">SOA</SPAN
> record are for use by slave name servers and
are discussed when we introduce slave name servers later in this
chapter. For now, assume these are reasonable values.</P
><p class="para">We added similar <span class="acronym">SOA</SPAN
> records to the beginning
of the <i class="filename">db.192.249.249</I
> and
<i class="filename">db.192.253.253</I
> files.  In these files, we changed
the first name in the <span class="acronym">SOA</SPAN
> record from <i class="systemitem.sitename">movie.edu.</I
> to the name of the appropriate
<i class="systemitem.sitename">in-addr.arpa</I
> domain:
<i class="systemitem.sitename">249.249.192.in-addr.arpa.</I
> and
<i class="systemitem.sitename">253.253.192.in-addr.arpa.</I
>,
respectively.<a class="indexterm" name="AUTOID-2932"></A
><a class="indexterm" name="AUTOID-2933"></A
><a class="indexterm" name="AUTOID-2934"></A
><a class="indexterm" name="AUTOID-2935"></A
></P
></DIV
><div class="sect2"><h3 class="sect2"><a class="title" name="AUTOID-2936">4.2.4 <span class="acronym">NS</SPAN
> Records</A
></H3
><p class="para">The next entries we added to each file are <span class="acronym">NS</SPAN
>
(name server) resource records. We added one<a class="indexterm" name="AUTOID-2941"></A
><a class="indexterm" name="AUTOID-2944"></A
><a class="indexterm" name="AUTOID-2948"></A
>
<span class="acronym">NS</SPAN
> record for each name server for our zone. Here
are the <span class="acronym">NS</SPAN
> records from the
<i class="filename">db.movie</I
> file:</P
><blockquote class="screen"><pre class="screen">movie.edu.  IN NS  terminator.movie.edu.
movie.edu.  IN NS  wormhole.movie.edu.</PRE
></BLOCKQUOTE
><p class="para"><a class="indexterm" name="AUTOID-2956"></A
><a class="indexterm" name="AUTOID-2959"></A
>These records indicate that there are two name servers for the zone
<i class="systemitem.sitename">movie.edu</I
>.  The name servers are on the hosts <i class="systemitem.sitename">terminator</I
> and <i class="systemitem.sitename">wormhole</I
>. Multihomed hosts, like
<i class="systemitem.sitename">wormhole</I
>, are excellent choices
for name servers since they are <span class="quote">"well-connected."</SPAN
> They
are directly accessible by hosts on more than one network and, if they
also serve as routers, they are not often down because they are
closely monitored. We'll cover more on where to place your name
servers in <a class="xref" href="ch08_01.htm" title="Growing Your Domain">Chapter 8, <cite class="chapter">Growing Your Domain</CITE
></A
>.</P
><p class="para">As with the <span class="acronym">SOA</SPAN
> record, we added
<span class="acronym">NS</SPAN
> records to the
<i class="filename">db.192.249.249</I
> and
<i class="filename">db.192.253.253</I
> files.</P
></DIV
><div class="sect2"><h3 class="sect2"><a class="title" name="AUTOID-2972">4.2.5 Address and Alias Records</A
></H3
><p class="para"><a class="indexterm" name="DNS3-IDX-4-ALIASES"></A
><a class="indexterm" name="DNS3-IDX-4-MAPPING-NAMES-TO-ADDRESSES"></A
><a class="indexterm" name="DNS3-IDX-4-ADDRESSES-MAPPING-NAMES-TO"></A
><a class="indexterm" name="DNS3-IDX-4-DOMAIN-NAMES-MAPPING-TO-ADDRESSES"></A
>Next, we created the name-to-address mappings. We added the following
resource records to the <i class="filename">db.movie</I
> file:</P
><blockquote class="screen"><pre class="screen">;
; Host addresses
;
localhost.movie.edu.  IN A     127.0.0.1
robocop.movie.edu.    IN A     192.249.249.2
terminator.movie.edu. IN A     192.249.249.3
diehard.movie.edu.    IN A     192.249.249.4
misery.movie.edu.     IN A     192.253.253.2
shining.movie.edu.    IN A     192.253.253.3
carrie.movie.edu.     IN A     192.253.253.4
;
; Multi-homed hosts
;
wormhole.movie.edu.   IN A     192.249.249.1
wormhole.movie.edu.   IN A     192.253.253.1
;
; Aliases
;
bigt.movie.edu.       IN CNAME terminator.movie.edu.
dh.movie.edu.         IN CNAME diehard.movie.edu.
wh.movie.edu.         IN CNAME wormhole.movie.edu.
wh249.movie.edu.      IN A     192.249.249.1
wh253.movie.edu.      IN A     192.253.253.1</PRE
></BLOCKQUOTE
><p class="para">The first two blocks are probably not a surprise.  The A stands
for address, and each resource record maps a name to an
address. <i class="systemitem.sitename">wormhole</I
> acts as a
router. It has two addresses associated with its name and therefore
two address records. Unlike host table lookups, a
<span class="acronym">DNS</SPAN
> lookup can return more than one address for a
name. A lookup of <i class="systemitem.sitename">wormhole</I
>
will return two. If the requestor and name server are on the same
network, some name servers will place the <span class="quote">"closest"</SPAN
>
address first in the response for better performance. This feature is
called<a class="indexterm" name="AUTOID-2993"></A
><a class="indexterm" name="AUTOID-2996"></A
>
<i class="firstterm">address sorting</I
> and is covered in <a class="xref" href="ch10_01.htm" title="Advanced Features and Security">Chapter 10, <cite class="chapter">Advanced Features and Security</CITE
></A
>. If address sorting does not apply, the
addresses are <i class="firstterm">rotated</I
> between queries so
subsequent responses list them in a different order. This <span class="quote">"round
robin"</SPAN
> feature shows up first in <span class="acronym">BIND</SPAN
>
4.9.</P
><p class="para"><a class="indexterm" name="AUTOID-3004"></A
><a class="indexterm" name="AUTOID-3007"></A
>The third block has the host table aliases. For the first three
aliases, we created <span class="acronym">CNAME</SPAN
> (canonical name) resource
records. However, we created address records for the other two
aliases&nbsp;- more on this in a moment. A <span class="acronym">CNAME</SPAN
> record
maps an alias to its canonical name.  The name server handles
<span class="acronym">CNAME</SPAN
> records in a different manner than aliases
are handled in the host table.  When a name server looks up a name and
finds a <span class="acronym">CNAME</SPAN
> record, it replaces the name with the
canonical name and looks up the new name.  For example, when the name
server looks up <i class="systemitem.sitename">wh</I
>, it finds
a <span class="acronym">CNAME</SPAN
> record pointing to <i class="systemitem.sitename">wormhole</I
>.  <i class="systemitem.sitename">wormhole</I
> is then looked up, and both
addresses are returned.</P
><p class="para">There is one thing you need to remember about aliases like
<i class="systemitem.sitename">bigt</I
>&nbsp;- they should never appear
on the right-hand side of a resource record. Stated differently:
always use the canonical name (<i class="systemitem.sitename">terminator</I
>) in the data portion of the
resource record. Notice that the <span class="acronym">NS</SPAN
> records we just
created use the canonical name.</P
><p class="para"><a class="indexterm" name="AUTOID-3023"></A
>The final two entries solve a special problem. Suppose you have a
router, like <i class="systemitem.sitename">wormhole</I
>, and
you want to check one of the interfaces. One common troubleshooting
technique is to <kbd class="command">ping</KBD
> the interface to verify that
it is responding. If you <kbd class="command">ping</KBD
> the name <i class="systemitem.sitename">wormhole</I
>, the name server returns both
addresses when the name is looked up. <kbd class="command">ping</KBD
> uses the
first address in the list. But which address is first?</P
><p class="para">With the host table, we chose the address we wanted by using
either <i class="systemitem.sitename">wh249</I
> or <i class="systemitem.sitename">wh253</I
>&nbsp;- each name referred to
<em class="emphasis">one</EM
> of the host's addresses.  To provide
equivalent capability with <span class="acronym">DNS</SPAN
>, we didn't make
<i class="systemitem.sitename">wh249</I
> and <i class="systemitem.sitename">wh253</I
> into aliases
(<span class="acronym">CNAME</SPAN
> records). That would result in both
addresses for <i class="systemitem.sitename">wormhole</I
> being
returned when the alias was looked up. Instead, we used address
records. Now, to check the operation of the 192.253.253.1 interface on
<i class="systemitem.sitename">wormhole</I
>, we <kbd class="command">ping
wh253</KBD
> since it refers to only one address. The same applies
to <i class="systemitem.sitename">wh249</I
>.</P
><p class="para">To state this as a general rule: if a host is<a class="indexterm" name="AUTOID-3043"></A
><a class="indexterm" name="AUTOID-3045"></A
>
multihomed (has more than one network interface), create an address
(A) record for each alias unique to one address. Create a
<span class="acronym">CNAME</SPAN
> record for each alias common to all the
addresses.</P
><p class="para">Now, don't tell your users about names like <i class="systemitem.sitename">wh249</I
> and <i class="systemitem.sitename">wh253</I
>.  Those names are meant for
system-administration purposes only. If users learn to use names like
<i class="systemitem.sitename">wh249</I
>, they will be confused
when the name doesn't work for them in some places, like
<i class="filename">.rhosts</I
> files.  That's because these places want
the name that results from looking up the address, and that name is
going to be the canonical name, <i class="systemitem.sitename">wormhole</I
>.</P
><p class="para">Since we used<a class="indexterm" name="AUTOID-3056"></A
>
A (address) records for the <i class="systemitem.sitename">wh249</I
> and <i class="systemitem.sitename">wh253</I
> aliases, you might ask: <span class="quote">"Is
it okay to use address records instead of <span class="acronym">CNAME</SPAN
>
records in <em class="emphasis">all</EM
> cases?"</SPAN
> Well, using address
records instead of <span class="acronym">CNAME</SPAN
> records doesn't cause
problems with most applications, since the application only cares that
it finds the <span class="acronym">IP</SPAN
> address. There is one
application&nbsp;- <kbd class="command">sendmail</KBD
>&nbsp;- whose behavior
changes, though. <kbd class="command">sendmail</KBD
> usually replaces aliases
in mail headers with their canonical name; this<a class="indexterm" name="AUTOID-3067"></A
><a class="indexterm" name="AUTOID-3069"></A
>
<i class="firstterm">canonicalization</I
> only happens if the name in
the mail header has <span class="acronym">CNAME</SPAN
> data associated with
it. Without <span class="acronym">CNAME</SPAN
> records for aliases, your
<kbd class="command">sendmail</KBD
> will have to understand all of the
possible aliases your host might be known by, which will require extra
<kbd class="command">sendmail</KBD
> configuration work on your part.</P
><p class="para">In addition to the problem with <kbd class="command">sendmail</KBD
>,
users might be confused when they try to figure out the canonical name
to enter in their <i class="filename">.rhosts</I
> file. Looking up a name
that has <span class="acronym">CNAME</SPAN
> data leads them to the canonical
name, whereas address data won't. In this case, users
<em class="emphasis">should</EM
> instead be looking up the
<em class="emphasis"><span class="acronym">IP</SPAN
> address</EM
> to get the
canonical name, as <kbd class="command">rlogind</KBD
> does, but users like
these never seem to be on systems we administer.<a class="indexterm" name="AUTOID-3084"></A
><a class="indexterm" name="AUTOID-3085"></A
><a class="indexterm" name="AUTOID-3086"></A
><a class="indexterm" name="AUTOID-3087"></A
></P
></DIV
><div class="sect2"><h3 class="sect2"><a class="title" name="AUTOID-3088">4.2.6 <span class="acronym">PTR</SPAN
> Records</A
></H3
><p class="para"><a class="indexterm" name="DNS3-IDX-4-ADDRESSES-MAPPING-TO-NAMES"></A
><a class="indexterm" name="DNS3-IDX-4-DOMAIN-NAMES-MAPPING-ADDRESSES-TO"></A
><a class="indexterm" name="DNS3-IDX-4-MAPPING-ADDRESSES-TO-NAMES"></A
><a class="indexterm" name="DNS3-IDX-4-PTR-RECORDS"></A
><a class="indexterm" name="AUTOID-3103"></A
><a class="indexterm" name="AUTOID-3107"></A
>Next we created the address-to-name mappings. The file
<i class="filename">db.192.249.249</I
> maps addresses to host names for
the 192.249.249 network. The <span class="acronym">DNS</SPAN
> resource records
used for this mapping are <span class="acronym">PTR</SPAN
> (pointer)
records. There is one record for each host interface on this
network. (Recall that addresses are looked up as names in
<span class="acronym">DNS</SPAN
>. The address is reversed and <i class="systemitem.sitename">in-addr.arpa</I
> is appended.)</P
><p class="para">Here are the <span class="acronym">PTR</SPAN
> records we added for network
192.249.249:</P
><blockquote class="screen"><pre class="screen">1.249.249.192.in-addr.arpa.  IN PTR wormhole.movie.edu.
2.249.249.192.in-addr.arpa.  IN PTR robocop.movie.edu.
3.249.249.192.in-addr.arpa.  IN PTR terminator.movie.edu.
4.249.249.192.in-addr.arpa.  IN PTR diehard.movie.edu.</PRE
></BLOCKQUOTE
><p class="para">There are a couple of things to notice about this data. First,
addresses should only point to a single name: the canonical
name. Thus, 192.249.249.1 maps to <i class="systemitem.sitename">wormhole</I
> and not to <i class="systemitem.sitename">wh249</I
>. You <em class="emphasis">can</EM
>
create two <span class="acronym">PTR</SPAN
> records, one for <i class="systemitem.sitename">wormhole</I
> and one for <i class="systemitem.sitename">wh249</I
>, but most systems are not prepared
to see more than one name for an address. Second, even though
<i class="systemitem.sitename">wormhole</I
> has two addresses,
you only see one of them here. That's because this file shows only the
direct connections to network 192.249.249, and <i class="systemitem.sitename">wormhole</I
> has only one connection
there.</P
><p class="para">We created similar data for the 192.253.253 network.</P
><a class="indexterm" name="AUTOID-3128"></A
><a class="indexterm" name="AUTOID-3129"></A
><a class="indexterm" name="AUTOID-3130"></A
><a class="indexterm" name="AUTOID-3131"></A
></DIV
><div class="sect2"><h3 class="sect2"><a class="title" name="AUTOID-3132">4.2.7 The Completed Data Files</A
></H3
><p class="para"><a class="indexterm" name="DNS3-IDX-4-DB-FILES-CONTENTS-OF-EXAMPLE"></A
>Now that the various resource records of the db files have been
explained, we'll show you what they look like when all the data are in
one place. Again, the actual order of these resource records does not
matter.</P
><p class="para">Here are the contents of the file <i class="filename">db.movie</I
>:</P
><blockquote class="screen"><pre class="screen">movie.edu. IN SOA terminator.movie.edu. al.robocop.movie.edu. (
                          1        ; Serial
                          10800    ; Refresh after 3 hours
                          3600     ; Retry after 1 hour
                          604800   ; Expire after 1 week
                          86400 )  ; Minimum TTL of 1 day

;
; Name servers
;
movie.edu.  IN NS  terminator.movie.edu.
movie.edu.  IN NS  wormhole.movie.edu.

;
; Addresses for the canonical names
;
localhost.movie.edu.  IN A     127.0.0.1
robocop.movie.edu.    IN A     192.249.249.2
terminator.movie.edu. IN A     192.249.249.3
diehard.movie.edu.    IN A     192.249.249.4
misery.movie.edu.     IN A     192.253.253.2
shining.movie.edu.    IN A     192.253.253.3
carrie.movie.edu.     IN A     192.253.253.4
wormhole.movie.edu.   IN A     192.249.249.1
wormhole.movie.edu.   IN A     192.253.253.1

;
; Aliases
;
bigt.movie.edu.       IN CNAME terminator.movie.edu.
dh.movie.edu.         IN CNAME diehard.movie.edu.
wh.movie.edu.         IN CNAME wormhole.movie.edu.

;
; Interface specific names
;
wh249.movie.edu.      IN A     192.249.249.1
wh253.movie.edu.      IN A     192.253.253.1</PRE
></BLOCKQUOTE
><p class="para">Here are the contents of the file <i class="filename">db.192.249.249</I
>:</P
><blockquote class="screen"><pre class="screen">249.249.192.in-addr.arpa. IN SOA terminator.movie.edu. al.robocop.movie.edu.(
                          1        ; Serial
                          10800    ; Refresh after 3 hours
                          3600     ; Retry after 1 hour
                          604800   ; Expire after 1 week
                          86400 )  ; Minimum TTL of 1 day

;
; Name servers
;
249.249.192.in-addr.arpa.  IN NS  terminator.movie.edu.
249.249.192.in-addr.arpa.  IN NS  wormhole.movie.edu.

;
; Addresses point to canonical name
;
1.249.249.192.in-addr.arpa.  IN PTR wormhole.movie.edu.
2.249.249.192.in-addr.arpa.  IN PTR robocop.movie.edu.
3.249.249.192.in-addr.arpa.  IN PTR terminator.movie.edu.
4.249.249.192.in-addr.arpa.  IN PTR diehard.movie.edu.</PRE
></BLOCKQUOTE
><p class="para">Here are the contents of the file <i class="filename">db.192.253.253</I
>:</P
><blockquote class="screen"><pre class="screen">253.253.192.in-addr.arpa. IN SOA terminator.movie.edu. al.robocop.movie.edu.(
                          1        ; Serial
                          10800    ; Refresh after 3 hours
                          3600     ; Retry after 1 hour
                          604800   ; Expire after 1 week
                          86400 )  ; Minimum TTL of 1 day

;
; Name servers
;
253.253.192.in-addr.arpa.  IN NS  terminator.movie.edu.
253.253.192.in-addr.arpa.  IN NS  wormhole.movie.edu.

;
; Addresses point to canonical name
;
1.253.253.192.in-addr.arpa.  IN PTR wormhole.movie.edu.
2.253.253.192.in-addr.arpa.  IN PTR misery.movie.edu.
3.253.253.192.in-addr.arpa.  IN PTR shining.movie.edu.
4.253.253.192.in-addr.arpa.  IN PTR carrie.movie.edu.</PRE
></BLOCKQUOTE
><a class="indexterm" name="AUTOID-3147"></A
></DIV
><div class="sect2"><h3 class="sect2"><a class="title" name="AUTOID-3148">4.2.8 The Loopback Address</A
></H3
><p class="para"><a class="indexterm" name="AUTOID-3151"></A
><a class="indexterm" name="AUTOID-3153"></A
><a class="indexterm" name="AUTOID-3156"></A
>A name server needs one additional
<i class="filename">db.ADDR</I
> file to cover the
<i class="systemitem.sitename">loopback</I
> network: the special
address that hosts use to direct traffic to themselves. This network
is (almost) always 127.0.0, and the host number is (almost) always
127.0.0.1. Therefore, the name of this file is
<i class="filename">db.127.0.0</I
>.  No surprise here; it looks like the
other <i class="filename">db.ADDR</I
> files.</P
><p class="para">Here are the contents of the file <i class="filename">db.127.0.0</I
>:</P
><blockquote class="screen"><pre class="screen">0.0.127.in-addr.arpa. IN SOA terminator.movie.edu. al.robocop.movie.edu. (
                          1        ; Serial
                          10800    ; Refresh after 3 hours
                          3600     ; Retry after 1 hour
                          604800   ; Expire after 1 week
                          86400 )  ; Minimum TTL of 1 day

0.0.127.in-addr.arpa.  IN NS  terminator.movie.edu.
0.0.127.in-addr.arpa.  IN NS  wormhole.movie.edu.

1.0.0.127.in-addr.arpa.  IN PTR localhost.</PRE
></BLOCKQUOTE
><p class="para">Why do name servers need this silly little file?  Think about it
for a second. No one was given responsibility for network 127, yet
systems use it for a loopback address. Since no one has direct
responsibility, everyone who uses it is responsible for it
individually. You could omit this file and your name server would
operate. However, a lookup of 127.0.0.1 might fail because the root
name server contacted wasn't configured itself to map 127.0.0.1 to a
name. You ought to provide the mapping yourself so there are no
surprises.</P
></DIV
><div class="sect2"><h3 class="sect2"><a class="title" name="AUTOID-3167">4.2.9 The Root Cache Data</A
></H3
><p class="para"><a class="indexterm" name="DNS3-IDX-4-CACHING-ROOT-CACHE-DATA"></A
><a class="indexterm" name="DNS3-IDX-4-.-DOT-ROOT-DOMAIN"></A
><a class="indexterm" name="DNS3-IDX-4-DOT-.-ROOT-DOMAIN"></A
><a class="indexterm" name="DNS3-IDX-4-ROOT-DOMAIN-CACHE-DATA-FOR"></A
><a class="indexterm" name="DNS3-IDX-4-DOMAINS-ROOT-DOMAIN-CACHE-DATA-FOR"></A
>Besides your local information, the name server also needs to know
where the name servers are for the root domain. This information must
be retrieved from the Internet host <a class="systemitem.ftpserver" href="../../../WebStripper/protected.html#link=ftp://ftp.rs.internic.net">ftp.rs.internic.net</A
> (198.41.0.7).  Use
anonymous <kbd class="command">ftp</KBD
> to retrieve the file<a class="indexterm" name="AUTOID-3188"></A
>
<a class="systemitem.url" href="../../../WebStripper/protected.html#link=ftp://ftp.rs.internic.net/domain/named.root">named.root</A
>
from the <a class="systemitem.url" href="../../../WebStripper/protected.html#link=ftp://ftp.rs.internic.net/domain">domain</A
> subdirectory.
(<i class="filename">named.root</I
> is the same file we've been calling
<i class="filename">db.cache</I
>.  Just rename
<i class="filename">named.root</I
> to <i class="filename">db.cache</I
> after
you've retrieved it.)</P
><blockquote class="screen"><pre class="screen">;       This file holds the information on root name servers needed to
;       initialize cache of Internet domain name servers
;       (e.g. reference this file in the &quot;cache  .  &lt;file&gt;&quot;
;       configuration file of BIND domain name servers).
;
;       This file is made available by InterNIC registration services
;       under anonymous FTP as
;           file                /domain/named.root
;           on server           FTP.RS.INTERNIC.NET
;       -OR- under Gopher at    RS.INTERNIC.NET
;           under menu          InterNIC Registration Services (NSI)
;              submenu          InterNIC Registration Archives
;           file                named.root
;
;       last update:    Aug 22, 1997
;       related version of root zone:   1997082200
;
;
; formerly NS.INTERNIC.NET
;
.                        3600000  IN  NS    A.ROOT-SERVERS.NET.
A.ROOT-SERVERS.NET.      3600000      A     198.41.0.4
;
; formerly NS1.ISI.EDU
;
.                        3600000      NS    B.ROOT-SERVERS.NET.
B.ROOT-SERVERS.NET.      3600000      A     128.9.0.107
;
; formerly C.PSI.NET
;
.                        3600000      NS    C.ROOT-SERVERS.NET.
C.ROOT-SERVERS.NET.      3600000      A     192.33.4.12
;
; formerly TERP.UMD.EDU
;
.                        3600000      NS    D.ROOT-SERVERS.NET.
D.ROOT-SERVERS.NET.      3600000      A     128.8.10.90
;
; formerly NS.NASA.GOV
;
.                        3600000      NS    E.ROOT-SERVERS.NET.
E.ROOT-SERVERS.NET.      3600000      A     192.203.230.10
;
; formerly NS.ISC.ORG
;
.                        3600000      NS    F.ROOT-SERVERS.NET.
F.ROOT-SERVERS.NET.      3600000      A     192.5.5.241
;
; formerly NS.NIC.DDN.MIL
;
.                        3600000      NS    G.ROOT-SERVERS.NET.
G.ROOT-SERVERS.NET.      3600000      A     192.112.36.4
;
; formerly AOS.ARL.ARMY.MIL
;
.                        3600000      NS    H.ROOT-SERVERS.NET.
H.ROOT-SERVERS.NET.      3600000      A     128.63.2.53
;
; formerly NIC.NORDU.NET
;
.                        3600000      NS    I.ROOT-SERVERS.NET.
I.ROOT-SERVERS.NET.      3600000      A     192.36.148.17
;
; temporarily housed at NSI (InterNIC)
;
.                        3600000      NS    J.ROOT-SERVERS.NET.
J.ROOT-SERVERS.NET.      3600000      A     198.41.0.10
;
; housed in LINX, operated by RIPE NCC
;
.                        3600000      NS    K.ROOT-SERVERS.NET.
K.ROOT-SERVERS.NET.      3600000      A     193.0.14.129
;
; temporarily housed at ISI (IANA)
;
.                        3600000      NS    L.ROOT-SERVERS.NET.
L.ROOT-SERVERS.NET.      3600000      A     198.32.64.12
;
; housed in Japan, operated by WIDE
;
.                        3600000      NS    M.ROOT-SERVERS.NET.
M.ROOT-SERVERS.NET.      3600000      A     202.12.27.33
; End of File</PRE
></BLOCKQUOTE
><p class="para">The domain name <span class="quote">"."</SPAN
> refers to the root
domain. Since the root domain's name servers change over time, don't
assume <em class="emphasis">this</EM
> list is current. Pull a new version
of <a class="systemitem.url" href="../../../WebStripper/protected.html#link=ftp://ftp.rs.internic.net/domain/named.root">named.root</A
>.</P
><p class="para"><a class="indexterm" name="AUTOID-3202"></A
><a class="indexterm" name="AUTOID-3205"></A
>How is this file kept up to date?  As the network administrator, you
must keep it up to date. Some versions of <span class="acronym">BIND</SPAN
> did
update this file periodically. That feature was disabled: apparently,
it didn't work as well as the authors had hoped. Sometimes the changed
<i class="filename">db.cache</I
> file is mailed to the<a class="indexterm" name="AUTOID-3210"></A
>
<i class="systemitem.example">bind-users</I
> or<a class="indexterm" name="AUTOID-3213"></A
>
<i class="systemitem.example">namedroppers</I
> mailing list. If
you are on one of these lists, you are likely to hear about
changes.</P
><p class="para"><a class="indexterm" name="AUTOID-3217"></A
>Can you put data other than root name server data in this file? You
can, but it won't be used. Originally, the name server installed this
data in its cache. However, the cache file has changed (subtly) to be
the root name server <em class="emphasis">hints</EM
> (but the name
<span class="quote">"cache file"</SPAN
> stuck). The name server stores the hints
data in a special place and does not discard the hints if their<a class="indexterm" name="AUTOID-3222"></A
><a class="indexterm" name="AUTOID-3224"></A
><a class="indexterm" name="AUTOID-3226"></A
><a class="indexterm" name="AUTOID-3228"></A
>
<span class="acronym">TTL</SPAN
>s drop to zero, as it would with cache data. The
name server uses the hint data to query the root name servers for the
current list of root name servers, which it caches. When the cached
list of root name servers times out, the name server again uses the
hints to get a new list.</P
><p class="para">What are the <code class="literal">3600000</CODE
>s for? In older versions
of this file, this number used to be <code class="literal">99999999</CODE
>.
Since this file was originally cache data, the name server needed to
know how long to keep these records active. The
<code class="literal">99999999</CODE
>s meant a very long time. The root name
server data was to be kept active for as long as the server ran. Since
the name server now stores this data in a special place and doesn't
discard it if it times out, the <span class="acronym">TTL</SPAN
> is
unnecessary. But it's not harmful to have the
<code class="literal">3600000</CODE
>s, and it makes for interesting
<span class="acronym">BIND</SPAN
> folklore when you pass responsibility to the
next name server administrator.<a class="indexterm" name="AUTOID-3239"></A
><a class="indexterm" name="AUTOID-3240"></A
><a class="indexterm" name="AUTOID-3241"></A
><a class="indexterm" name="AUTOID-3242"></A
><a class="indexterm" name="AUTOID-3243"></A
><a class="indexterm" name="AUTOID-3244"></A
></P
></DIV
></DIV
><div class="htmlnav"><p></P
><hr align="LEFT" width="515" title="footer"><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="SECT1" href="ch04_01.htm" title="4.1 Our Domain"><img src="../gifs/txtpreva.gif" alt="Previous: 4.1 Our Domain" border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><a class="book" href="index.htm" title="DNS &amp; BIND"><img src="../gifs/txthome.gif" alt="DNS &amp; BIND" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="SECT1" href="ch04_03.htm" title="4.3 Setting Up a BIND Configuration File"><img src="../gifs/txtnexta.gif" alt="Next: 4.3 Setting Up a BIND Configuration File" border="0"></A
></TD
></TR
><tr><td align="LEFT" valign="TOP" width="172">4.1 Our Domain</TD
><td align="CENTER" valign="TOP" width="171"><a class="index" href="index/idx_0.htm" title="Book Index"><img src="../gifs/index.gif" alt="Book Index" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172">4.3 Setting Up a BIND Configuration File</TD
></TR
></TABLE
><hr align="LEFT" width="515" title="footer"><p class="nav"><font size="-1">[ <a href="../index.htm" title="The Networking CD Bookshelf">Library Home</A
> | <a href="index.htm" title="DNS &amp; BIND">DNS &amp; BIND</A
> | <a href="../tcpip/index.htm" title="TCP/IP Network Administration">TCP/IP</A
> | <a href="../sendmail/index.htm" title="sendmail">sendmail</A
> | <a href="../smdref/index.htm" title="sendmail Desktop Reference">sendmail Reference</A
> | <a href="../firewall/index.htm" title="Building Internet Firewalls">Firewalls</A
> | <a href="../puis/index.htm" title="Practical UNIX &amp; Internet Security">Practical Security</A
> ]</FONT
></P
></DIV
></BODY
></HTML
>
