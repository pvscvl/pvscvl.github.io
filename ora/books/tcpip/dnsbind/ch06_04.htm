<html><head>
<title>[Chapter 6] 6.4 Vendor-Specific Options</TITLE>
<meta name="DC.title" content="DNS &amp; BIND"><meta name="DC.creator" content="Cricket Liu &amp; Paul Albitz"><meta name="DC.publisher" content="O'Reilly &amp; Associates, Inc."><meta name="DC.date" content="1999-01-06T18:29:36Z"><meta name="DC.type" content="Text.Monograph"><meta name="DC.format" content="text/html" scheme="MIME"><meta name="DC.source" content="1-56592-512-2" scheme="ISBN"><meta name="DC.language" content="en-US"><meta name="generator" content="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><link rev="made" href="mailto:online-books@oreilly.com" title="Online Books Comments"><link rel="up" href="ch06_01.htm" title="6. Configuring Hosts"><link rel="prev" href="ch06_03.htm#AUTOID-5173" title="6.3 Minimizing Pain and Suffering"><link rel="next" href="ch07_01.htm" title="7. Maintaining BIND"></HEAD
><body bgcolor="#FFFFFF" text="#000000"><div class="htmlnav"><h1><img src="gifs/smbanner.gif" alt="DNS &amp; BIND" usemap="#srchmap" border="0"></H1
><map name=index.html"srchmap"><area shape="RECT" coords="0,0,466,65" href="index.htm" alt="DNS &amp; BIND"><area shape="RECT" coords="467,0,514,18" href="../search/dsrch.htm" alt="Search this book"></MAP
><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="SECT1" href="ch06_03.htm#AUTOID-5173" title="6.3 Minimizing Pain and Suffering"><img src="../gifs/txtpreva.gif" alt="Previous: 6.3 Minimizing Pain and Suffering" border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><b><font face="ARIEL,HELVETICA,HELV,SANSERIF" size="-1">Chapter 6<br>Configuring Hosts</FONT
></B
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="CHAPTER" href="ch07_01.htm" title="7. Maintaining BIND"><img src="../gifs/txtnexta.gif" alt="Next: 7. Maintaining BIND" border="0"></A
></TD
></TR
></TABLE
>&nbsp;<hr align="LEFT" width="515" title="footer"></DIV
><div class="SECT1"><h2 class="sect1"><a class="title" name="AUTOID-5347">6.4 Vendor-Specific Options</A
></H2
><p class="para"><a class="indexterm" name="DNS3-IDX-6-CONFIGURING-HOSTS-TO-USE-DNS-VENDOR-SPECIFIC-DIFFERENCES"></A
><a class="indexterm" name="DNS3-IDX-6-RESOLVERS-VENDOR-SPECIFIC-IMPLEMENTATIONS"></A
><a class="indexterm" name="DNS3-IDX-6-VENDOR-SPECIFIC-BIND-OPTIONS"></A
><a class="indexterm" name="DNS3-IDX-6-UNIX-VENDOR-SPECIFIC-BIND-IMPLEMENTATIONS"></A
><a class="indexterm" name="DNS3-IDX-6-HOSTS-CONFIGURING-TO-USE-DNS-VENDOR-SPECIFIC-UNIX-SYSTEMS"></A
><span class="acronym">UNIX</SPAN
> is ostensibly a standard operating system, but
there are almost as many <span class="acronym">UNIX</SPAN
> standards as flavors
of <span class="acronym">UNIX</SPAN
>. Likewise, there are almost as many
different styles of resolver configuration as there are
<span class="acronym">UNIX</SPAN
>es. Almost all support the original Berkeley
syntax, but most add nonstandard enhancements or variations,
too. We'll cover as many of the major styles of resolver configuration
as we can.</P
><div class="sect2"><h3 class="sect2"><a class="title" name="AUTOID-5369">6.4.1 Sun's Sun<span class="acronym">OS</SPAN
> 4.x</A
></H3
><p class="para"><a class="indexterm" name="DNS3-IDX-6-SUNOS-4.X"></A
>Configuring a host running Sun<span class="acronym">OS</SPAN
> can be a
challenge. The behavior of the Sun<span class="acronym">OS</SPAN
> resolver is
arguably as different from that of standard <span class="acronym">DNS</SPAN
> as
major vendors get&nbsp;- primarily because Sun<span class="acronym">OS</SPAN
>'s
resolver is integrated with Sun's<a class="indexterm" name="DNS3-IDX-6-NIS-NETWORK-INFORMATION-SERVICE"></A
><a class="indexterm" name="AUTOID-5381"></A
>
Network Information Service, or <span class="acronym">NIS</SPAN
> (née Yellow
Pages).</P
><p class="para"><span class="acronym">NIS</SPAN
>, briefly, provides a mechanism for
keeping important files synchronized between hosts on a network.  This
includes not just <i class="filename">/etc/hosts</I
>, but also
<i class="filename">/etc/services</I
>, <i class="filename">/etc/passwd</I
>,
and others. Sun positions <span class="acronym">DNS</SPAN
> as a backup option to
<span class="acronym">NIS</SPAN
>; if the <span class="acronym">NIS</SPAN
> resolver can't
find a host name (or <span class="acronym">IP</SPAN
> address) in the
<span class="acronym">NIS</SPAN
> hosts map, you can configure it to query a name
server.</P
><p class="para">Note that the resolver functionality is implemented as part of
the<a class="indexterm" name="AUTOID-5396"></A
>
<kbd class="command">ypserv</KBD
> program, which also handles other types of
<span class="acronym">NIS</SPAN
> queries. So if <kbd class="command">ypserv</KBD
> isn't
running, neither is your resolver! (Mercifully, the resolver in
Solaris 2 doesn't require that you run <kbd class="command">ypserv</KBD
>.)
One benefit of using <kbd class="command">ypserv</KBD
> to resolve all queries
is that you don't need to configure the resolvers on
<span class="acronym">NIS</SPAN
> clients, only on <span class="acronym">NIS</SPAN
>
servers.[9] The <span class="acronym">NIS</SPAN
> clients will query an
<span class="acronym">NIS</SPAN
> server for host data, and the
<span class="acronym">NIS</SPAN
> server will query <span class="acronym">DNS</SPAN
>, if
necessary.</P
><blockquote class="footnote"><p class="para">[9] Actually, you also need to configure the resolver on hosts on
which you use <kbd class="command">sendmail.mx</KBD
>, Sun's
<span class="acronym">MX</SPAN
>-smart version of
<kbd class="command">sendmail</KBD
>.</P
></BLOCKQUOTE
><p class="para">If you run Sun<span class="acronym">OS</SPAN
> 4.X (Solaris 1), you can (1)
follow the party line and configure your resolver to use
<span class="acronym">DNS</SPAN
> as a backup to <span class="acronym">NIS</SPAN
>, (2)
choose to run <span class="acronym">NIS</SPAN
> without host maps, or (3) buck
convention and recompile your resolver to use <span class="acronym">DNS</SPAN
>
exclusively&nbsp;- or you can pick up free copies of modified resolvers
on the Internet. However, we must warn you that, according to our
sources, Sun <em class="emphasis">will not support</EM
> the modified
resolver option.</P
><p class="para">If you run Solaris 2, you can simply configure the resolver like
a normal human being. You also have control over the order in which
the resolver consults various naming services via the
<i class="filename">nsswitch.conf</I
> file.</P
><div class="sect3"><h4 class="sect3"><a class="title" name="AUTOID-5423">6.4.1.1 Modified resolvers</A
></H4
><p class="para">We won't go into much detail about this option here, primarily
because this process is now well-documented and nearly automated in
the newest <span class="acronym">DNS</SPAN
> distribution.  The process itself
usually involves creating a new <i class="filename">libc.so</I
>&nbsp;- the
standard, shared C library&nbsp;- by pulling out routines that call
<span class="acronym">NIS</SPAN
> and replacing them with pure
<span class="acronym">DNS</SPAN
> versions. Although Sun generously provides the
necessary replacement routines, they don't support them. Worse, the
routines supplied with Sun<span class="acronym">OS</SPAN
> 4.1 were based on
<span class="acronym">DNS</SPAN
> 4.8.1.</P
><p class="para">If you have the latest <span class="acronym">DNS</SPAN
> source
distribution, look for instructions on installing the
<span class="acronym">DNS</SPAN
> 8.1.2 resolver routines under
Sun<span class="acronym">OS</SPAN
> in the package's
<i class="filename">src/port/sunos/shres</I
> subdirectory, currently in a
file called <i class="filename">INSTALL</I
>.</P
><p class="para">If you'd rather skip the potentially edifying experience of
creating your own shared C library and leverage someone else's
efforts, you can check out<a class="indexterm" name="AUTOID-5439"></A
>
<kbd class="command">resolv+</KBD
>, based on the <span class="acronym">DNS</SPAN
> 4.8.3
resolver.</P
><p class="para"><kbd class="command">resolv+</KBD
> is an enhanced version of the 4.8.3
resolver routines for Sun<span class="acronym">OS</SPAN
>, written by Bill<a class="indexterm" name="AUTOID-5446"></A
>
Wisner, which allows administrators to choose the order in which
<span class="acronym">NIS</SPAN
> and <span class="acronym">DNS</SPAN
> are queried (much
like the extensions other vendors have added to
<span class="acronym">UNIX</SPAN
>, which we'll discuss later). The new routines
are available, with instructions on how to build them into
<i class="filename">libc.so</I
>, from <a class="systemitem.ftpserver" href="../../../WebStripper/protected.html#link=ftp://ftp.uu.net">ftp.uu.net</A
> as the file <a class="systemitem.url" href="../../../WebStripper/protected.html#link=ftp://ftp.uu.net/networking/ip/dns/resolv+2.1.1.tar.Z">/networking/ip/dns/resolv+2.1.1.tar.Z</A
>.
For more information on the functionality <kbd class="command">resolv+</KBD
>
provides, see the Linux section later in this chapter.</P
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="AUTOID-5455">6.4.1.2 Using <span class="acronym">DNS</SPAN
> with
<span class="acronym">NIS</SPAN
></A
></H4
><p class="para"><a class="indexterm" name="AUTOID-5460"></A
>If you go the socially acceptable route, though, you'll need to
make <span class="acronym">NIS</SPAN
> and <span class="acronym">DNS</SPAN
> coexist
peacefully. That's a little tricky, so we'll go over it in some
detail. We won't cover how to set up
<span class="acronym">NIS</SPAN
>&nbsp;- that's already been covered in gory
detail in Hal Stern's <cite class="citetitle">Managing <span class="acronym">NFS</SPAN
> and
<span class="acronym">NIS</SPAN
></CITE
> (O'Reilly &amp; Associates,
1991). Note that these instructions only apply to versions of
Sun<span class="acronym">OS</SPAN
> after 4.1. If you run an older version of
Sun<span class="acronym">OS</SPAN
>, consider the replacement libraries on
<a class="systemitem.ftpserver" href="../../../WebStripper/protected.html#link=ftp://ftp.uu.net">ftp.uu.net</A
>.</P
><p class="para">First, you'll need to modify the<a class="indexterm" name="DNS3-IDX-6-MAKEFILE-NIS"></A
>
<i class="filename">Makefile</I
> <span class="acronym">NIS</SPAN
> uses to build its
maps&nbsp;- the files that it distributes to other hosts on the
network. You should make this modification on the master
<span class="acronym">NIS</SPAN
> server, not on the slaves.</P
><p class="para">The <span class="acronym">NIS</SPAN
> <i class="filename">Makefile</I
> lives
in <i class="filename">/var/yp/Makefile</I
> on a Sun<span class="acronym">OS</SPAN
>
host. The change you need to make is simple: you need to uncomment one
line and comment another. Find the lines that read:</P
><blockquote class="screen"><pre class="screen">#B=-b
B=</PRE
></BLOCKQUOTE
><p class="para">and change them to read:</P
><blockquote class="screen"><pre class="screen">B=-b
#B=</PRE
></BLOCKQUOTE
><p class="para">Then rebuild your <span class="acronym">NIS</SPAN
> hosts map:</P
><blockquote class="screen"><pre class="screen"># <code class="userinput"><b>cd /var/yp</B
></CODE
>
# <code class="userinput"><b>rm hosts.time</B
></CODE
>
# <code class="userinput"><b>make hosts.time</B
></CODE
>
updated hosts
pushed hosts</PRE
></BLOCKQUOTE
><p class="para"><a class="indexterm" name="AUTOID-5493"></A
>This will insert a <span class="quote">"magic cookie"</SPAN
> into the hosts map that
instructs <span class="acronym">NIS</SPAN
> to query <span class="acronym">DNS</SPAN
> if it
can't find a host name in the hosts map. Now, when the
<kbd class="command">ypserv</KBD
> program looks up a name, it will check the
appropriate hosts map for the local <span class="acronym">NIS</SPAN
>
<i class="structfield">domainname</I
>, and if it can't find the name
there, it will query a name server.  The search list
<kbd class="command">ypserv</KBD
> uses when it queries the name server is
derived from either the local <span class="acronym">NIS</SPAN
>
<i class="structfield">domainname</I
> or from the
<i class="structfield">domain</I
> directive in
<i class="filename">resolv.conf</I
>.</P
><p class="para">Next, you should create a <i class="filename">resolv.conf</I
> file,
if you need one. The rules for configuring the resolver change
slightly with Sun<span class="acronym">OS</SPAN
>:</P
><ul class="itemizedlist"><li class="listitem"><p class="para">You <em class="emphasis">can't</EM
> set the
<kbd class="command">hostname</KBD
> to a domain name and have the resolver
infer the local domain.</P
></LI
><li class="listitem"><p class="para">You also can't use the <i class="structfield">search</I
>
directive in <i class="filename">resolv.conf</I
>, since the
Sun<span class="acronym">OS</SPAN
> 4.1.1 resolver is based on
<span class="acronym">DNS</SPAN
> 4.8.1. The resolver will silently ignore
it.</P
></LI
><li class="listitem"><p class="para">You <em class="emphasis">can</EM
> set the <span class="acronym">NIS</SPAN
>
<i class="structfield">domainname</I
> to a domain name (you have to
set it to the name of your <span class="acronym">NIS</SPAN
> domain if you're
using <span class="acronym">NIS</SPAN
>), and the resolver will derive the name
of the local <span class="acronym">DNS</SPAN
> domain from it. However, this
doesn't work quite the same way it does with <span class="acronym">DNS</SPAN
>;
if you set <i class="structfield">domainname</I
> to <i class="systemitem.sitename">fx.movie.edu</I
>, for example, the search list
will only include <i class="systemitem.sitename">movie.edu</I
>.
Why doesn't the search list include <i class="systemitem.sitename">fx.movie.edu</I
>?  Because
<span class="acronym">NIS</SPAN
> assumes it's already checked an authoritative
source of <i class="systemitem.sitename">fx.movie.edu</I
> host
data&nbsp;- the <i class="systemitem.sitename">fx.movie.edu</I
>
hosts map.</P
></LI
><li class="listitem"><p class="para">If you want to set the default domain to the same name as your
<span class="acronym">NIS</SPAN
> <i class="structfield">domainname</I
>, you can
prepend a dot or a plus (<span class="quote">"+"</SPAN
>) to the<a class="indexterm" name="AUTOID-5542"></A
>
<i class="structfield">domainname</I
>. To set your default domain to
<i class="systemitem.sitename">fx.movie.edu</I
>, you could set
<i class="structfield">domainname</I
> to either <i class="systemitem.sitename">+fx.movie.edu</I
> or <i class="systemitem.sitename">.fx.movie.edu</I
>.</P
></LI
><li class="listitem"><p class="para">You can also override <span class="acronym">NIS</SPAN
>'s normal behavior
by setting the local domain with the
<i class="structfield">domain</I
>
directive in <i class="filename">resolv.conf</I
>.  So if you wanted to
force the resolver to include <i class="systemitem.sitename">fx.movie.edu</I
> in the search list, you could
add domain <i class="systemitem.sitename">fx.movie.edu</I
> to <i class="filename">resolv.conf</I
>.</P
></LI
><li class="listitem"><p class="para">You can even set the <i class="structfield">domain</I
> directive
in <i class="filename">resolv.conf</I
> to a <span class="acronym">DNS</SPAN
> domain
name totally unrelated to your <span class="acronym">NIS</SPAN
>
<i class="structfield">domainname</I
>. In some unfortunate situations,
the local <span class="acronym">NIS</SPAN
> <i class="structfield">domainname</I
>
isn't the same as, or even similar to, the <span class="acronym">DNS</SPAN
>
domain name. Say the Information Technology Department at Movie
U. originally set up the <span class="acronym">NIS</SPAN
> domain <i class="systemitem.sitename">it.dept.movieu</I
>, and still uses it. To
prevent spurious <span class="acronym">DNS</SPAN
> queries in the nonexistent
<i class="systemitem.sitename">dept.movieu</I
> domain, hosts in
this <span class="acronym">NIS</SPAN
> domain should be configured with domain
<i class="systemitem.sitename">movie.edu</I
> (or something similar) in
<i class="filename">resolv.conf</I
>.</P
></LI
></UL
><p class="para">Finally, Sun's <i class="filename">resolv.conf</I
> treats the<a class="indexterm" name="AUTOID-5577"></A
>
<i class="structfield">nameserver</I
> directive just as vanilla
<span class="acronym">DNS</SPAN
> does. So once you're done inserting magic
cookies and configuring your <span class="acronym">NIS</SPAN
>
<i class="structfield">domainname</I
> and possibly your
<span class="acronym">DNS</SPAN
> domain, you can add any name servers to
<i class="filename">resolv.conf</I
> and be done.</P
></DIV
><div class="sect3"><h4 class="sect3"><a class="title" name="AUTOID-5586">6.4.1.3 Ignoring <span class="acronym">NIS</SPAN
></A
></H4
><p class="para">If you want to retain Sun's support but would rather not use
icky <span class="acronym">NIS</SPAN
>, you still have an option: you can run
<span class="acronym">NIS</SPAN
> with an empty hosts map. First, set up your
<i class="filename">resolv.conf</I
> file, then insert the magic cookie
into the <span class="acronym">NIS</SPAN
> <i class="filename">Makefile</I
> as we
described in the preceding section, <span class="quote">"Using
<span class="acronym">DNS</SPAN
> with <span class="acronym">NIS</SPAN
>,"</SPAN
> and create
an empty hosts map. Creating an empty hosts map just requires moving
the <span class="acronym">NIS</SPAN
> master server's<a class="indexterm" name="AUTOID-5599"></A
><a class="indexterm" name="AUTOID-5602"></A
>
<i class="filename">/etc/hosts</I
> file aside temporarily, generating
your hosts <span class="acronym">NIS</SPAN
> map, then replacing the
<i class="filename">/etc/hosts</I
> file:</P
><blockquote class="screen"><pre class="screen">% <code class="userinput"><b>mv /etc/hosts /etc/hosts.tmp</B
></CODE
>
% <code class="userinput"><b>touch /etc/hosts # to keep make from complaining</B
></CODE
>
% <code class="userinput"><b>cd /var/yp</B
></CODE
>
% <code class="userinput"><b>make hosts.time</B
></CODE
>
updated hosts
pushed hosts
% <code class="userinput"><b>mv /etc/hosts.tmp /etc/hosts</B
></CODE
></PRE
></BLOCKQUOTE
><p class="para">Now, when the resolver checks <span class="acronym">NIS</SPAN
>, it won't
find anything, and will go directly to querying a domain name
server.</P
><p class="para">If you periodically rebuild your <span class="acronym">NIS</SPAN
> maps,
you should make sure the hosts map doesn't accidentally get rebuilt
from <i class="filename">/etc/hosts</I
>.  The best way to do this is to
remove the hosts target from the <span class="acronym">NIS</SPAN
>
<i class="filename">Makefile</I
>.  You can just comment out everything in
the <i class="filename">Makefile</I
> from the line that begins
with:</P
><blockquote class="screen"><pre class="screen">hosts.time: $(DIR)/hosts</PRE
></BLOCKQUOTE
><p class="para">to the next blank line.<a class="indexterm" name="AUTOID-5624"></A
></P
><a class="indexterm" name="AUTOID-5626"></A
><a class="indexterm" name="AUTOID-5627"></A
><a class="indexterm" name="AUTOID-5628"></A
></DIV
></DIV
><div class="sect2"><h3 class="sect2"><a class="title" name="AUTOID-5629">6.4.2 Sun's Solaris 2.x</A
></H3
><p class="para"><a class="indexterm" name="DNS3-IDX-6-SOLARIS-2.X"></A
><a class="indexterm" name="DNS3-IDX-6-SUN-S-SOLARIS-2.X"></A
>The resolver in Solaris 2 through 2.5.1 is based on the
<span class="acronym">DNS</SPAN
> 4.8.3 resolver, with extensions to give you the
ability to determine the order in which the resolver consults the
<span class="quote">"sources:"</SPAN
> <span class="acronym">DNS</SPAN
>,
<span class="acronym">NIS</SPAN
>, and <i class="filename">/etc/hosts</I
>.  The
resolver in Solaris 2.6 is based on the <span class="acronym">DNS</SPAN
> 4.9.3
resolver, with the same extensions.[10] This service order is configured in a file called
<i class="filename">nsswitch.conf</I
>, which lives in the
<i class="filename">/etc</I
> directory.</P
><blockquote class="footnote"><p class="para">[10] You can get patches to update Solaris 2.5 and 2.5.1 to
<span class="acronym">DNS</SPAN
> 4.9.3 via anonymous <kbd class="command">ftp</KBD
> from
<i class="systemitem.sitename">sunsolve1.sun.com</I
> in
<i class="filename">/pub/patches</I
>.  Check <a class="systemitem.url" href="../../../../../../../sunsolve.sun.com/sunsolve/pubpatches/patches.html">http://sunsolve.sun.com/sunsolve/pubpatches/patches.html</A
>
for the current patch numbers.</P
></BLOCKQUOTE
><p class="para">Actually,<a class="indexterm" name="AUTOID-5652"></A
>
<i class="filename">nsswitch.conf</I
> is used to configure the order in
which a number of different services are resolved. Individual
services, called <i class="firstterm">databases</I
> in Sun's parlance,
are selected by a keyword. For naming services, the database name is
<i class="structfield">hosts</I
>. The possible sources are
<i class="structname">dns</I
>, <i class="structname">nis</I
>,
<i class="structname">nisplus</I
>, and <i class="structname">files</I
>
(which refers to <i class="filename">/etc/hosts</I
>, in this
case). Configuring the order in which the sources are consulted is a
simple matter of listing them after the database name in that
order. For example:</P
><blockquote class="screen"><pre class="screen">hosts:  dns files</PRE
></BLOCKQUOTE
><p class="para">has the resolver try <span class="acronym">DNS</SPAN
> (i.e., query a name
server) first, then check <i class="filename">/etc/hosts</I
>. By default,
resolution moves from one source to the next (e.g., falls back to
<i class="filename">/etc/hosts</I
> from <span class="acronym">DNS</SPAN
>) only if
the first source isn't available. You can modify this behavior by
using several other criteria to determine when to move on to the next
source. The possible criteria are:</P
><dl class="variablelist"><dt class="term"><span class="acronym">UNAVAIL</SPAN
></DT
><dd class="listitem"><p class="para">The service hasn't been configured (in <span class="acronym">DNS</SPAN
>'s
case, there is no <i class="filename">resolv.conf</I
> file, and there is
no name server running on the local host).</P
></DD
><dt class="term"><span class="acronym">NOTFOUND</SPAN
></DT
><dd class="listitem"><p class="para">The service can't find the name or address in question.</P
></DD
><dt class="term"><span class="acronym">TRYAGAIN</SPAN
></DT
><dd class="listitem"><p class="para">The service isn't currently available (for example, because the
resolver has timed out while trying to look up a name).</P
></DD
><dt class="term"><span class="acronym">SUCCESS</SPAN
></DT
></DL
><p class="para">For each of these criteria, you can specify that the resolver
should either <i class="firstterm">continue</I
> or
<i class="firstterm">return</I
>. For example, if you want the resolver
to check <i class="filename">/etc/hosts</I
> if <span class="acronym">DNS</SPAN
>
isn't configured or if <span class="acronym">DNS</SPAN
> can't find the name, you
can use:</P
><blockquote class="screen"><pre class="screen">hosts:  dns [NOTFOUND=continue UNAVAIL=continue] files</PRE
></BLOCKQUOTE
><p class="para">If you want a <span class="acronym">DNS</SPAN
> <span class="acronym">NXDOMAIN</SPAN
>
(no such domain name) answer to halt the search for the name, you'd
use:</P
><blockquote class="screen"><pre class="screen">hosts:  dns [NOTFOUND=return]</PRE
></BLOCKQUOTE
><p class="para">The default Solaris resolver behavior, by the way, is determined
by the answers you give SunInstall.</P
><div class="sect3"><h4 class="sect3"><a class="title" name="AUTOID-5701">6.4.2.1 nscd</A
></H4
><p class="para">In recent versions of Solaris 2.X, including 2.5 and later, Sun
introduced a name service cache daemon, called<a class="indexterm" name="AUTOID-5704"></A
>
<kbd class="command">nscd</KBD
>.  <kbd class="command">nscd</KBD
> caches<a class="indexterm" name="AUTOID-5708"></A
>
the results of lookups in the <i class="filename">passwd</I
>, <i class="filename">group</I
>, and <i class="filename">hosts</I
> databases. You
can think of <kbd class="command">nscd</KBD
> as very similar to a caching-only
name server, except that it also works for information in <i class="filename">passwd</I
> and
<i class="filename">group</I
> databases.  Sun's intent with <kbd class="command">nscd</KBD
> was to
speed up performance by caching frequently-looked-up names.
Unfortunately, word on the street is that <kbd class="command">nscd</KBD
>
sometimes slows <span class="acronym">DNS</SPAN
> lookups, and many people
disable it.  Moreover, <kbd class="command">nscd</KBD
> interferes with round
robin (<kbd class="command">nscd</KBD
> caches records in one order and doesn't
rotate them).</P
><p class="para"><kbd class="command">nscd</KBD
> is started by default during a multiuser
bootup, and reads the configuration file
<i class="filename">/etc/nscd.conf</I
>.  Administrators can tune a number
of parameters in <i class="filename">nscd.conf</I
>.  The most important
of these are:</P
><dl class="variablelist"><dt class="term">enable-cache hosts (yes | no)</DT
><dd class="listitem"><p class="para">Determines whether or not <kbd class="command">nscd</KBD
> caches the
results of host lookups</P
></DD
><dt class="term">positive-time-to-live hosts value</DT
><dd class="listitem"><p class="para">Determines how long <kbd class="command">nscd</KBD
> caches positive
results (e.g., addresses), in seconds</P
></DD
><dt class="term">negative-time-to-live hosts value</DT
><dd class="listitem"><p class="para">Determines how long <kbd class="command">nscd</KBD
> caches negative
results (e.g., <span class="acronym">NXDOMAIN</SPAN
>), in seconds</P
></DD
></DL
><p class="para">If you're not convinced of <kbd class="command">nscd</KBD
>'s usefulness,
at least with <span class="acronym">DNS</SPAN
> lookups, you can use:</P
><blockquote class="screen"><pre class="screen">enable-cache hosts no</PRE
></BLOCKQUOTE
><p class="para">to turn caching off for the hosts database.</P
><a class="indexterm" name="AUTOID-5747"></A
><a class="indexterm" name="AUTOID-5748"></A
></DIV
></DIV
><div class="sect2"><h3 class="sect2"><a class="title" name="AUTOID-5749">6.4.3 <span class="acronym">HP</SPAN
>'s <span class="acronym">HP-UX</SPAN
></A
></H3
><p class="para"><a class="indexterm" name="DNS3-IDX-6-HP-UX"></A
><span class="acronym">HP</SPAN
>'s resolver implementation is basically straight
<span class="acronym">DNS</SPAN
>; the <span class="acronym">HP-UX</SPAN
> 8.0 and 9.0
resolvers are based on <span class="acronym">DNS</SPAN
> 4.8.3, and support the
standard <i class="structfield">domain</I
>,
<i class="structfield">nameserver</I
>, and
<i class="structfield">search</I
> directives. The order in which a
host consults <span class="acronym">DNS</SPAN
>, <span class="acronym">NIS</SPAN
>, and the
host table is hard-wired. The host will use <span class="acronym">DNS</SPAN
> if
<span class="acronym">DNS</SPAN
> is configured. If <span class="acronym">DNS</SPAN
> isn't
configured, and <span class="acronym">NIS</SPAN
> is running, the host will use
<span class="acronym">NIS</SPAN
>. If neither <span class="acronym">DNS</SPAN
> nor
<span class="acronym">NIS</SPAN
> is running, the host will use the host
table. The host only falls back to using the other services under the
circumstances described earlier in the chapter (i.e., the resolver
only uses one name server&nbsp;- either listed in
<i class="filename">resolv.conf</I
> or on the local host by
default&nbsp;- and four errors are received while contacting that name
server).</P
><p class="para">The hard-wired algorithm is less flexible than what other
vendors provide, but it's easy to troubleshoot. When you can consult
<span class="acronym">DNS</SPAN
>, <span class="acronym">NIS</SPAN
>, and the host table in
any order, diagnosing user problems can be awfully difficult.</P
><p class="para">The <span class="acronym">HP-UX</SPAN
> 10.30 resolver is based on
<span class="acronym">DNS</SPAN
> 4.9.3, and patches are available for all
versions of 10.X to upgrade the server and ancillary programs to
<span class="acronym">DNS</SPAN
> 4.9.6.  To gain access to the patches, visit
the <span class="acronym">HP-UX</SPAN
> patch archive at <a class="systemitem.url" href="../../../../../../../us-support.external.hp.com/">http://us-support.external.hp.com/</A
> and register.
You can then search the patch database for the latest patches.</P
><p class="para"><span class="acronym">HP-UX</SPAN
> 10.0 introduced Solaris's<a class="indexterm" name="AUTOID-5784"></A
>
<i class="filename">nsswitch.conf</I
> functionality; that is, you can use
<i class="filename">nsswitch.conf</I
> to control the order in which the
resolver consults the various naming services.[11] The syntax is exactly the same as that used in Solaris's
<i class="filename">nsswitch.conf</I
>.  The default settings for the
<i class="structname">hosts</I
> database under <span class="acronym">HP-UX</SPAN
>
are:</P
><blockquote class="footnote"><p class="para">[11] Before <span class="acronym">HP-UX</SPAN
> 10.10, you could only use
<i class="filename">nsswitch.conf</I
> to configure order of resolution
for the <i class="structname">hosts</I
> database. From 10.10 on, you
can also use <i class="filename">nsswitch.conf</I
> to configure
resolution order for the <i class="structname">services</I
>,
<i class="structname">networks</I
>, <i class="structname">protocols</I
>,
<i class="structname">rpc</I
>, and <i class="structname">netgroup</I
>
databases.</P
></BLOCKQUOTE
><blockquote class="screen"><pre class="screen">hosts: dns nis files</PRE
></BLOCKQUOTE
><p class="para"><a class="indexterm" name="AUTOID-5804"></A
>This functionality is also available in patches for
<span class="acronym">HP-UX</SPAN
> 9.0. Check the web-based
<span class="acronym">HP-UX</SPAN
> patch archive for these. You may need quite a
few patches:</P
><ul class="itemizedlist"><li class="listitem"><p class="para">One for the standard, shared C library,
<i class="filename">libc.so</I
>, which contains the resolver routines in
<span class="acronym">HP-UX</SPAN
></P
></LI
><li class="listitem"><p class="para">One for the <kbd class="command">mount</KBD
> command, which is
statically linked</P
></LI
><li class="listitem"><p class="para">One for <kbd class="command">nslookup</KBD
></P
></LI
><li class="listitem"><p class="para">One for the <kbd class="command">ifconfig</KBD
> and
<kbd class="command">route</KBD
> commands</P
></LI
><li class="listitem"><p class="para">One for <span class="acronym">HP</SPAN
>'s Visual User Environment
(<span class="acronym">VUE</SPAN
>), which is shipped statically linked</P
></LI
></UL
><p class="para">The <span class="acronym">HP-UX</SPAN
> 10.30 resolver also supports the
<span class="acronym">DNS</SPAN
> 4.9.3 search list behavior and the
<i class="structfield">options ndots</I
> directive.</P
><a class="indexterm" name="AUTOID-5832"></A
></DIV
><div class="sect2"><h3 class="sect2"><a class="title" name="AUTOID-5833">6.4.4 <span class="acronym">IBM</SPAN
>'s <span class="acronym">AIX</SPAN
></A
></H3
><p class="para"><a class="indexterm" name="DNS3-IDX-6-AIX"></A
><a class="indexterm" name="DNS3-IDX-6-IBM-S-AIX"></A
>The resolver shipped with the current version of
<span class="acronym">AIX</SPAN
>, 4.2.1, is also relatively standard. The code
is based on <span class="acronym">DNS</SPAN
> 4.9.3, so it understands the
<i class="structfield">domain</I
>, <i class="structfield">search</I
>,
<i class="structfield">nameserver</I
>,
<i class="structfield">options</I
>, and
<i class="structfield">sortlist</I
> directives; <span class="acronym">AIX</SPAN
>
supports up to three <i class="structfield">nameserver</I
> directives.
<span class="acronym">AIX</SPAN
> versions 4 and 4.1 were based on
<span class="acronym">DNS</SPAN
> 4.8.3, so they handle all the directives
<span class="acronym">AIX</SPAN
> 4.2.1's resolver does except
<i class="structfield">options</I
> and
<i class="structfield">sortlist</I
>.</P
><p class="para">One difference between <span class="acronym">AIX</SPAN
>'s behavior and the
stock <span class="acronym">BSD</SPAN
> behavior is that <span class="acronym">AIX</SPAN
>
uses the existence of the<a class="indexterm" name="AUTOID-5860"></A
>
<i class="filename">resolv.conf</I
> file to determine whether to query a
name server. If <i class="filename">resolv.conf</I
> doesn't exist on the
local host, the resolver reads <i class="filename">/etc/hosts</I
>.  This
means that on a host running a name server, you should create a
zero-length <i class="filename">/etc/resolv.conf</I
> file, even if you
don't intend to put any directives in it.</P
><p class="para"><span class="acronym">IBM</SPAN
> has also modified the resolver so that it
checks <span class="acronym">NIS</SPAN
> and then
<i class="filename">/etc/hosts</I
>, even if <span class="acronym">DNS</SPAN
> claims
there's no such domain name or no such data.  This gives you the
ability to add hosts to <i class="filename">/etc/hosts</I
> temporarily,
before they make it into the name server, and will let you maintain
your own host-specific name-to-address mappings.</P
><p class="para"><span class="acronym">AIX</SPAN
> 4.2.1 also includes a mechanism to
control resolution order similar to Solaris's
<i class="filename">nsswitch.conf</I
>. <span class="acronym">AIX</SPAN
> uses a file
called<a class="indexterm" name="AUTOID-5876"></A
><a class="indexterm" name="AUTOID-5878"></A
>
<i class="filename">/etc/netsvc.conf</I
>.  Like
<i class="filename">nsswitch.conf</I
>, <i class="filename">netsvc.conf</I
>
calls the database <i class="structname">hosts</I
>, but uses an equals
sign between the database name and the sources instead of a colon,
uses commas between sources, uses <i class="wordasword">bind</I
> for
<span class="acronym">DNS</SPAN
>, and uses <i class="wordasword">local</I
> for
<i class="filename">/etc/hosts</I
>.  So:</P
><blockquote class="screen"><pre class="screen">hosts = local,nis,bind</PRE
></BLOCKQUOTE
><p class="para">has the <span class="acronym">AIX</SPAN
> resolver check the local
<i class="filename">/etc/hosts</I
> first, then check the
<span class="acronym">NIS</SPAN
> <i class="structname">hosts</I
> map, and finally
try <span class="acronym">DNS</SPAN
>. Individual users or processes can override
the system-wide resolution order configured with
<i class="filename">netsvc.conf</I
> by setting an environment variable,
<i class="envar">NSORDER</I
>. <span class="acronym">NSORDER</SPAN
> uses the same
syntax <i class="filename">netsvc.conf</I
> does, minus the database name
and equal sign. So to change the resolution order for your user to
check <span class="acronym">DNS</SPAN
> first and then
<i class="filename">/etc/hosts</I
>, ignoring <span class="acronym">NIS</SPAN
>, you
could run:</P
><blockquote class="screen"><pre class="screen">% <code class="userinput"><b>NSORDER=bind,local; export NSORDER</B
></CODE
></PRE
></BLOCKQUOTE
><p class="para"><span class="acronym">AIX</SPAN
> 3.2's resolver was based on the
<span class="acronym">DNS</SPAN
> 4.8.1 resolver, so it doesn't understand the
<i class="structfield">search</I
> directive.  It exhibits the same
peculiarities with respect to the existence of
<i class="filename">resolv.conf</I
> that the 4.1 resolver does.  For
those of you with older <span class="acronym">AIX</SPAN
> 3.2 installations,
there is a patch, <span class="acronym">PTF</SPAN
> U412845, that will let you
shorten the resolver timeout so that <span class="acronym">AIX</SPAN
> will fall
back to <i class="filename">/etc/hosts</I
> more quickly than
normal. There are also instructions on using Bill Wisner's
<kbd class="command">resolv+</KBD
> package with <span class="acronym">AIX</SPAN
> in the
<span class="acronym">AIX</SPAN
> <span class="acronym">FAQ</SPAN
>, posted periodically to
<a class="systemitem.newsgroup" href="../../../WebStripper/protected.html#link=news:comp.unix.aix">comp.unix.aix</A
> and archived
on <a class="systemitem.ftpserver" href="../../../WebStripper/protected.html#link=ftp://rtfm.mit.edu">rtfm.mit.edu</A
> in <a class="systemitem.url" href="../../../WebStripper/protected.html#link=ftp://rtfm.mit.edu/pub/usenet/news.answers/aix-faq/">/pub/usenet/news.answers/aix-faq/</A
>.
Use at your own risk. For more information on
<kbd class="command">resolv+</KBD
>'s functionality, see the Linux section
later in this chapter.</P
><p class="para">We should also note that you can configure the resolver using
<span class="acronym">AIX</SPAN
>'s System Management Interface Tool
(<span class="acronym">SMIT</SPAN
>).<a class="indexterm" name="AUTOID-5924"></A
><a class="indexterm" name="AUTOID-5925"></A
></P
></DIV
><div class="sect2"><h3 class="sect2"><a class="title" name="AUTOID-5926">6.4.5 Digital's Digital <span class="acronym">UNIX</SPAN
></A
></H3
><p class="para"><a class="indexterm" name="DNS3-IDX-6-DIGITAL-UNIX"></A
>The resolver shipped with the most recent version of Digital
<span class="acronym">UNIX</SPAN
>, 4.0D, is based on the <span class="acronym">DNS</SPAN
>
4.9.3 resolver.  As such, it understands all five resolver directives
covered in this chapter.</P
><p class="para">Digital <span class="acronym">UNIX</SPAN
> allows you to configure the
order in which the resolver checks <span class="acronym">NIS</SPAN
>,
<span class="acronym">DNS</SPAN
>, and the host table via a file called<a class="indexterm" name="AUTOID-5938"></A
>
<i class="filename">svc.conf</I
> (see the
<i class="filename">svc.conf</I
>(5) manpage).[12] <i class="filename">svc.conf</I
> also allows you to configure
which services are consulted for other <span class="quote">"databases,"</SPAN
>
including mail aliases, authentication checks (mapping from
<span class="acronym">IP</SPAN
> address to host or domain names), password and
group information, and a slew of other things.</P
><blockquote class="footnote"><p class="para">[12] Digital's <span class="quote">"other"</SPAN
> <span class="acronym">UNIX</SPAN
> operating
system, Ultrix, also supports <i class="filename">svc.conf</I
>.</P
></BLOCKQUOTE
><p class="para">To configure the resolver with <i class="filename">svc.conf</I
>,
use the database name <i class="structname">hosts</I
>, followed by an
equals sign and the keywords for the services you want checked,
separated by commas, in the order you want them checked. The legal
keywords for <i class="structname">hosts</I
> are
<i class="wordasword">local</I
> (the local host table),
<i class="wordasword">yp</I
> (for <span class="quote">"Yellow Pages,"</SPAN
> the old
name for <span class="acronym">NIS</SPAN
>), and <i class="wordasword">bind</I
>
(for <span class="acronym">DNS</SPAN
>). <i class="wordasword">local</I
> must be
the first service listed for <i class="structname">hosts</I
>. Don't use
any whitespace on the line, except (optionally) after commas and at
the end of the line.</P
><p class="para">The line:</P
><blockquote class="screen"><pre class="screen">hosts=local,bind</PRE
></BLOCKQUOTE
><p class="para">instructs the resolver to check <i class="filename">/etc/hosts</I
>
for host names first, and if no match is found, to use domain name
service.  This is very useful when the host has a small local host
table that includes the local host's domain name and
<span class="acronym">IP</SPAN
> address, the host's default router, and any
other hosts referenced during startup. Checking the local host table
first avoids any problems using domain name service during startup,
when networking and <kbd class="command">named</KBD
> may not have
started.</P
><p class="para">Digital <span class="acronym">UNIX</SPAN
> also includes a utility called<a class="indexterm" name="AUTOID-5970"></A
>
<kbd class="command">svcsetup</KBD
> (see the <kbd class="command">svcsetup</KBD
>(8) manpage), which allows you to set up the <i class="filename">svc.conf</I
>
file interactively, without the aid of an editor. Typing
<kbd class="command">svcsetup</KBD
> will throw you into a mode where you can
choose the database you'd like to configure, and will prompt you for
the order of the services you want checked.<a class="indexterm" name="AUTOID-5976"></A
></P
></DIV
><div class="sect2"><h3 class="sect2"><a class="title" name="AUTOID-5977">6.4.6 Silicon Graphics' <span class="acronym">IRIX</SPAN
></A
></H3
><p class="para">As of<a class="indexterm" name="AUTOID-5981"></A
><a class="indexterm" name="AUTOID-5983"></A
>
<span class="acronym">IRIX</SPAN
> 6.2, <span class="acronym">IRIX</SPAN
> has a
<span class="acronym">DNS</SPAN
> 4.9.3 name server, but the resolver is still
essentially 4.8.3. There are also patches available to bring the
server up to <span class="acronym">DNS</SPAN
> 4.9.4.  For the current patch numbers, see <a class="systemitem.url" href="../../../../../../../support.sgi.com/surfzone/patches/browse/index.html">http://support.sgi.com/surfzone/patches/browse/index.html</A
>
(you'll need to register if you aren't
already a SurfZone member).</P
><p class="para">The <span class="acronym">IRIX</SPAN
><a class="indexterm" name="AUTOID-5992"></A
>
<i class="filename">resolv.conf</I
> file, which lives in
<i class="filename">/usr/etc/resolv.conf</I
>, adds a<a class="indexterm" name="AUTOID-5996"></A
>
<i class="structfield">hostresorder</I
> directive.  The
<i class="structfield">hostresorder</I
> directive allows the
administrator to determine the order in which <span class="acronym">NIS</SPAN
>,
<span class="acronym">DNS</SPAN
>, and the local host table are
searched. Individual users can set the environment variable<a class="indexterm" name="AUTOID-6002"></A
>
<i class="envar">HOSTRESORDER</I
> to determine the order in which the
services are used for their commands.</P
><p class="para"><i class="structfield">hostresorder</I
> takes one or more of the
keywords <i class="wordasword">nis</I
>, <i class="wordasword">bind</I
>,
and <i class="wordasword">local</I
> as arguments. (The keywords
correspond to the obvious services.) The keywords may be separated by
either whitespace or a slash. Whitespace indicates that the next
service should be tried if the previous service doesn't return an
answer (e.g., the name isn't found in the host table, or the name
server returns <span class="quote">"no such domain"</SPAN
>) or isn't available
(e.g., the name server isn't running). A slash indicates that the
preceding service is authoritative, and if no answer is returned,
resolution should stop. The next service is tried only if the previous
isn't available.</P
></DIV
><div class="sect2"><h3 class="sect2"><a class="title" name="AUTOID-6012">6.4.7 <span class="acronym">SCO</SPAN
>'s Open Server 5.0</A
></H3
><p class="para">The newest release of <span class="acronym">SCO</SPAN
>'s
<span class="acronym">UNIX</SPAN
> operating system,<a class="indexterm" name="AUTOID-6018"></A
><a class="indexterm" name="AUTOID-6020"></A
>
Open Server 5.0.X, has a resolver based on the <span class="acronym">DNS</SPAN
>
4.9.2 resolver. As a 4.9.2-derived resolver, it understands all of the
normal directives (including <i class="structfield">sortlist</I
> and
<i class="structfield">options</I
>!) in
<i class="filename">resolv.conf</I
> plus
<i class="structfield">hostresorder</I
>. <i class="structfield">hostresorder</I
>
works exactly the same way it does in <span class="acronym">IRIX</SPAN
> (see the
section on <span class="acronym">IRIX</SPAN
> immediately preceding this
section); the keywords are the same (<i class="wordasword">bind</I
>,
<i class="wordasword">nis</I
>, and
<i class="wordasword">local</I
>), and a slash, instead of a
space, indicates that the preceding service is authoritative and the
search should return if that service doesn't find the name. The
default setting (without <i class="structfield">hostresorder</I
>
configured) is equivalent to:</P
><blockquote class="screen"><pre class="screen">hostresorder bind nis local</PRE
></BLOCKQUOTE
><p class="para">Also, even if resolution order isn't explicitly configured, if
<span class="acronym">DNS</SPAN
> and <span class="acronym">NIS</SPAN
> aren't available,
the resolver will use <i class="filename">/etc/hosts</I
>.</P
><p class="para">You can override anything configured with
<i class="structfield">domain</I
>, <i class="structfield">options</I
>,
or <i class="structfield">hostresorder</I
> in
<i class="filename">resolv.conf</I
> with the<a class="indexterm" name="AUTOID-6045"></A
><a class="indexterm" name="AUTOID-6048"></A
><a class="indexterm" name="AUTOID-6051"></A
>
environment variables <i class="envar">LOCALDOMAIN</I
>,
<i class="envar">RES_OPTIONS</I
>, and <i class="envar">HOSTRESORDER</I
>,
respectively.  For example, to change resolution order to
<span class="acronym">DNS</SPAN
>-only and the options to set
<i class="structfield">ndots</I
> to 1 before starting sendmail, you
could run:</P
><blockquote class="screen"><pre class="screen">% <code class="userinput"><b>HOSTRESORDER=&quot;dns&quot;; RES_OPTIONS=&quot;ndots:1&quot;</B
></CODE
>
% <code class="userinput"><b>export HOSTRESORDER RES_OPTIONS</B
></CODE
>
% <code class="userinput"><b>/usr/lib/sendmail -bd -q1h</B
></CODE
></PRE
></BLOCKQUOTE
></DIV
><div class="sect2"><h3 class="sect2"><a class="title" name="AUTOID-6063">6.4.8 Linux</A
></H3
><p class="para"><a class="indexterm" name="AUTOID-6066"></A
>Since we first published this book, Linux has taken the computing
world by storm. A couple of the reasons are that Linux is freeware,
and that it does a better job of keeping up with developments in the
<span class="acronym">UNIX</SPAN
> and Internet communities than any vendor's
version of <span class="acronym">UNIX</SPAN
>.  Attesting to that is the fact
that RedHat Linux 5.1, the latest version of one of the predominant
strains of Linux, ships with a <span class="acronym">DNS</SPAN
> 4.9.6 resolver
and server. The resolver also supports Sun's
<i class="filename">nsswitch.conf</I
> file.</P
><p class="para">However, some older Linux resolvers are based on Bill Wisner's<a class="indexterm" name="AUTOID-6073"></A
>
<kbd class="command">resolv+</KBD
> library, which is in turn based on
<span class="acronym">DNS</SPAN
> 4.8.3. Consequently, the
<i class="filename">resolv.conf</I
> file can include any legit 4.8.3
resolver directives (<i class="structfield">domain</I
>,
<i class="structfield">search</I
>, and
<i class="structfield">nameserver</I
>, but not
<i class="structfield">options</I
>) and has the older default search
list described in this chapter.</P
><p class="para"><kbd class="command">resolv+</KBD
>, as the name suggests, also provides
several enhancements over the standard 4.8.3 resolver. They include
the ability to determine the order in which <span class="acronym">DNS</SPAN
>,
<span class="acronym">NIS</SPAN
>, and <i class="filename">/etc/hosts</I
> are
consulted (replaced by the more standard
<i class="filename">nsswitch.conf</I
> in newer versions), the ability to
detect certain types of <span class="acronym">DNS</SPAN
> spoofing, and the
ability to reorder address records in replies to favor local
subnets.</P
><p class="para">All of these enhancements are controlled by the
<i class="filename">/etc/hosts.conf</I
> file. The most interesting
keywords that <i class="filename">hosts.conf</I
> accepts are:</P
><dl class="variablelist"><dt class="term"><a class="indexterm" name="AUTOID-6095"></A
>order</DT
><dd class="listitem"><p class="para">Controls the order in which the various name services are
consulted; the valid arguments are <i class="wordasword">bind</I
>,
<i class="wordasword">hosts</I
>, and <i class="wordasword">nis</I
>, at
least one of which must follow the keyword. Multiple arguments must be
separated by commas.</P
></DD
><dt class="term"><a class="indexterm" name="AUTOID-6104"></A
>nospoof</DT
><dd class="listitem"><p class="para">Takes the single argument <i class="wordasword">on</I
> or
<i class="wordasword">off</I
>. <i class="structfield">nospoof</I
>
instructs the resolver to check any reverse mapping
(<span class="acronym">PTR</SPAN
>) information it gets from remote name servers
by issuing a forward (address) query for the domain name in the
reply. If the address returned by the address query isn't the same as
the address the resolver originally tried to reverse map, the
<span class="acronym">PTR</SPAN
> record is ignored.</P
></DD
><dt class="term"><a class="indexterm" name="AUTOID-6115"></A
>reorder</DT
><dd class="listitem"><p class="para">Takes the single argument <i class="wordasword">on</I
> or
<i class="wordasword">off</I
>.  With <i class="structfield">reorder</I
>
on, the resolver sorts the addresses of multiply-homed hosts so that
any address on a local subnet appears first.</P
></DD
></DL
></DIV
><div class="sect2"><h3 class="sect2"><a class="title" name="AUTOID-6122">6.4.9 Windows 95</A
></H3
><p class="para"><a class="indexterm" name="AUTOID-6125"></A
><a class="indexterm" name="AUTOID-6127"></A
>Windows 95, the successor to the popular Windows operating system,
includes its own <span class="acronym">TCP</SPAN
>/<span class="acronym">IP</SPAN
> stack
with a <span class="acronym">DNS</SPAN
> resolver. In fact, Windows 95 actually
includes two <span class="acronym">TCP</SPAN
>/<span class="acronym">IP</SPAN
> stacks: one
for <span class="acronym">TCP</SPAN
>/<span class="acronym">IP</SPAN
> over
<span class="acronym">LAN</SPAN
>s, and another for
<span class="acronym">TCP</SPAN
>/<span class="acronym">IP</SPAN
> over dialup
connections. Configuration of the resolver in Windows 95 is, naturally
enough, graphical. To get to the main <span class="acronym">DNS</SPAN
>
configuration panel, start the Control Panel, then select
<i class="guiicon">Network</I
>, then choose the
<span class="acronym">TCP</SPAN
>/<span class="acronym">IP</SPAN
> protocol. This brings up
a new dialog, which looks similar to the one in <a class="xref" href="#DNS3-CHP-6-FIG-1" title="Resolver configuration under Windows 95">Figure 6.1</A
>. Choose the
tab labeled <i class="guilabel"><span class="acronym">DNS</SPAN
>
Configuration</I
>.</P
><h4 class="figure"><a class="title" name="DNS3-CHP-6-FIG-1">Figure 6.1: Resolver configuration under Windows 95</A
></H4
><img class="graphic" src="figs/dns3_0601.gif" alt="Figure 6.1"><p class="para">Configuration using this panel is fairly self-explanatory: you
check <i class="guibutton">Enable <span class="acronym">DNS</SPAN
></I
> to turn on
<span class="acronym">DNS</SPAN
> resolution, then fill in the
<span class="acronym">PC</SPAN
>'s hostname (in this case, the first label of its
domain name) in the <i class="guilabel">Host</I
> field, and the local
domain (everything after the first dot) in the
<i class="guilabel">Domain</I
> field.  You add the <span class="acronym">IP</SPAN
>
addresses of the name servers you want to query, in the order in which
you want to query them, under <i class="guilabel"><span class="acronym">DNS</SPAN
> Server
Search Order</I
>. Finally, you fill in the domains in the
search list under <i class="guilabel">Domain Suffix Search Order</I
> in
the order in which you want them applied.</P
><p class="para">One interesting note about the current version of Windows 95:
you can configure a different set of name servers for each dial-up
connection you might have to an Internet service provider
(<span class="acronym">ISP</SPAN
>) in the<a class="indexterm" name="AUTOID-6162"></A
><a class="indexterm" name="AUTOID-6165"></A
><a class="indexterm" name="AUTOID-6167"></A
>
Dial-Up Networking (<span class="acronym">DUN</SPAN
>) configuration.  To
configure <span class="acronym">DUN</SPAN
>-specific resolver settings,
double-click on the <i class="guiicon">My Computer</I
> icon on your
desktop, then double-click on <i class="guiicon">Dial-Up Networking</I
>,
right-click on the name of the connection whose resolver settings
you'd like to configure, then select
<i class="guimenuitem">Properties</I
>.  Select the <i class="guilabel">Server
Types</I
> tab and click on
<i class="guilabel"><span class="acronym">TCP</SPAN
>/<span class="acronym">IP</SPAN
>
Settings</I
>.  You'll see the window shown in <a class="xref" href="#DNS3-CHP-6-FIG-2" title="DUN resolver configuration under Windows 95">Figure 6.2</A
>.</P
><h4 class="figure"><a class="title" name="DNS3-CHP-6-FIG-2">Figure 6.2: DUN resolver configuration under Windows 95</A
></H4
><img class="graphic" src="figs/dns3_0602.gif" alt="Figure 6.2"><p class="para">If you leave the <i class="guibutton">Server assigned name server
addresses</I
> radio button checked, the resolver will retrieve
the name servers it should query from the <span class="acronym">DHCP</SPAN
>
server you dial into.  If you check <i class="guibutton">Specify name server
addresses</I
> and specify the addresses of one or two name
servers, Windows 95 will try to use those name servers when the
<span class="acronym">DUN</SPAN
> connection is active.</P
><p class="para">This is really useful if you use multiple
<span class="acronym">ISP</SPAN
>s and each has its own name servers. However,
configuring name servers in the
<span class="acronym">TCP</SPAN
>/<span class="acronym">IP</SPAN
> Properties panel
<em class="emphasis">overrides</EM
> the <span class="acronym">DUN</SPAN
>-specific
name servers. To use the <span class="acronym">DUN</SPAN
>-specific name server
feature, you must leave the
<span class="acronym">TCP</SPAN
>/<span class="acronym">IP</SPAN
> Properties panel blank
except for enabling <span class="acronym">DNS</SPAN
> and specifying the local
hostname. This limitation is probably just an oversight due to a lack
of integration between the dial-up and <span class="acronym">LAN</SPAN
>
<span class="acronym">TCP</SPAN
>/<span class="acronym">IP</SPAN
> stacks, and should be
corrected in a future release of Windows 95.</P
><p class="para">Lest you think this is the only idiosyncrasy in the way that
<span class="acronym">DNS</SPAN
> resolution works on Windows 95, we'll point you
to the Windows 95 Networking <span class="acronym">FAQ</SPAN
>, maintained by
Rich Graves, at <a class="systemitem.url" href="../../../../../../../www-leland.stanford.edu/~llurch/win95netbugs/faq.html">http://www-leland.stanford.edu/~llurch/win95netbugs/faq.html</A
>.
This <span class="acronym">FAQ</SPAN
> contains lots of valuable
<span class="acronym">DNS</SPAN
> information, including how to change the order
in which the Win95 resolver uses the <span class="acronym">LMHOSTS</SPAN
> file,
<span class="acronym">WINS</SPAN
>,<a class="indexterm" name="AUTOID-6208"></A
><a class="indexterm" name="AUTOID-6210"></A
>
and <span class="acronym">DNS</SPAN
>.</P
></DIV
><div class="sect2"><h3 class="sect2"><a class="title" name="AUTOID-6213">6.4.10 Windows <span class="acronym">NT</SPAN
></A
></H3
><p class="para">In<a class="indexterm" name="AUTOID-6217"></A
><a class="indexterm" name="AUTOID-6220"></A
>
Windows <span class="acronym">NT</SPAN
>, <span class="acronym">LAN</SPAN
> resolver
configuration is done from a single panel that looks remarkably
similar to Windows 95's now that <span class="acronym">NT</SPAN
>
4.0&nbsp;- which includes the Windows 95
<span class="quote">"shell"</SPAN
>&nbsp;- has been released. In fact, other than the
presence of handy little arrows that allow you to reorder name servers
and elements of the search list, there's really no semantic difference
between them, as shown in <a class="xref" href="#DNS3-CHP-6-FIG-3" title="Resolver configuration under Windows NT">Figure 6.3</A
>.<a class="indexterm" name="AUTOID-6228"></A
><a class="indexterm" name="AUTOID-6231"></A
></P
><h4 class="figure"><a class="title" name="DNS3-CHP-6-FIG-3">Figure 6.3: Resolver configuration under Windows NT</A
></H4
><img class="graphic" src="figs/dns3_0603.gif" alt="Figure 6.3"><p class="para">To get to the <span class="acronym">DNS</SPAN
> configuration panel, start
the Control Panel, click on <i class="guiicon">Network</I
>, and select the <i class="guilabel">Protocols</I
> tab.
Double-click on <i class="guilabel">TCP/IP Protocol</I
>,
then select the <i class="guilabel">DNS</I
> tab.</P
><p class="para">Windows <span class="acronym">NT</SPAN
> also allows the user to configure
resolver settings specific to particular dialup networking
connections.  To configure these, click on the <i class="guiicon">My Computer</I
> icon, start
<i class="guimenuitem">Dial Up Networking</I
>, pull down the top selection box and choose the
name of the <span class="acronym">DUN</SPAN
> connection whose resolver you'd
like to configure.  Then click on the <i class="guimenuitem">More</I
> pull-down and select <i class="guimenuitem">Edit
Entry and Modem Properties</I
>. Select the <i class="guilabel">Server</I
> tab on the resulting
window, and click on the <i class="guibutton">TCP/IP
Settings</I
> button.  You'll see the very same window you'd see in Windows
95 (shown earlier).  If you leave the <i class="guibutton">Server assigned name server
addresses</I
> radio button checked, the resolver will retrieve the name
servers it should query from the <span class="acronym">DHCP</SPAN
> server you
dial into.  If you check <i class="guibutton">Specify name server addresses</I
> and specify the
addresses of one or two name servers, Windows <span class="acronym">NT</SPAN
>
will use those name servers when the <span class="acronym">DUN</SPAN
> connection
is active.  When you drop the <span class="acronym">DUN</SPAN
> connection,
<span class="acronym">NT</SPAN
> will revert to using the <span class="acronym">LAN</SPAN
>
resolver's<a class="indexterm" name="AUTOID-6260"></A
><a class="indexterm" name="AUTOID-6261"></A
><a class="indexterm" name="AUTOID-6262"></A
><a class="indexterm" name="AUTOID-6263"></A
><a class="indexterm" name="AUTOID-6264"></A
>
settings.<a class="indexterm" name="AUTOID-6265"></A
><a class="indexterm" name="AUTOID-6266"></A
><a class="indexterm" name="AUTOID-6267"></A
></P
></DIV
></DIV
><div class="htmlnav"><p></P
><hr align="LEFT" width="515" title="footer"><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="SECT1" href="ch06_03.htm#AUTOID-5173" title="6.3 Minimizing Pain and Suffering"><img src="../gifs/txtpreva.gif" alt="Previous: 6.3 Minimizing Pain and Suffering" border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><a class="book" href="index.htm" title="DNS &amp; BIND"><img src="../gifs/txthome.gif" alt="DNS &amp; BIND" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="CHAPTER" href="ch07_01.htm" title="7. Maintaining BIND"><img src="../gifs/txtnexta.gif" alt="Next: 7. Maintaining BIND" border="0"></A
></TD
></TR
><tr><td align="LEFT" valign="TOP" width="172">6.3 Minimizing Pain and Suffering</TD
><td align="CENTER" valign="TOP" width="171"><a class="index" href="index/idx_0.htm" title="Book Index"><img src="../gifs/index.gif" alt="Book Index" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172">7. Maintaining BIND</TD
></TR
></TABLE
><hr align="LEFT" width="515" title="footer"><p class="nav"><font size="-1">[ <a href="../index.htm" title="The Networking CD Bookshelf">Library Home</A
> | <a href="index.htm" title="DNS &amp; BIND">DNS &amp; BIND</A
> | <a href="../tcpip/index.htm" title="TCP/IP Network Administration">TCP/IP</A
> | <a href="../sendmail/index.htm" title="sendmail">sendmail</A
> | <a href="../smdref/index.htm" title="sendmail Desktop Reference">sendmail Reference</A
> | <a href="../firewall/index.htm" title="Building Internet Firewalls">Firewalls</A
> | <a href="../puis/index.htm" title="Practical UNIX &amp; Internet Security">Practical Security</A
> ]</FONT
></P
></DIV
></BODY
></HTML
>
