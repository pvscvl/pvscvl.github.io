<HTML
><HEAD
><TITLE
>[Chapter 15] Advanced Replication</TITLE
><META
NAME="DC.Creator"
CONTENT="Steven Feuerstein, Charles Dye &amp; John Beresniewicz"><META
NAME="DC.Date"
CONTENT="2000-04-29T18:01:47Z"><META
NAME="DC.Format"
CONTENT="text/html"
SCHEME="MIME"><META
NAME="DC.Identifier"
CONTENT="O'Reilly and Associates-1-56592-375-8E"><META
NAME="DC.Language"
CONTENT="en-US"><META
NAME="DC.Publisher"
CONTENT="O'Reilly &amp; Associates, Inc."><META
NAME="DC.Source"
CONTENT="1-56592-375-8E"
SCHEME="ISBN"><META
NAME="DC.Subject.Keyword"
CONTENT="Oracle Packages"><META
NAME="DC.Title"
CONTENT="Oracle Built-in Packages"><META
NAME="DC.Type"
CONTENT="Text.Monograph"><META
NAME="generator"
CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINK
REL="stylesheet"
TYPE="text/css"
HREF="../style/style1.css"><LINK
REV="made"
HREF="mailto:online-books@oreilly.com"
TITLE="Online Books Comments"><LINK
REL="up"
HREF="part04.htm"
TITLE="IV. Distributed Database Packages"><LINK
REL="prev"
HREF="ch14_04.htm#ch14-SECT-4.1.1"
TITLE="14.4 DBMS_REPCAT: Managing Snapshot Replication Groups"><LINK
REL="next"
HREF="ch15_02.htm#ch15-SECT-2.1.1"
TITLE="15.2 DBMS_REPCAT_ADMIN: Setting Up More Administrator Accounts"></HEAD
><BODY
><DIV
CLASS="htmlnav"
><H1
><IMG
SRC="gifs/smbanner.gif"
ALT="Oracle Built-in Packages"
USEMAP="#srchmap"
BORDER="0"></H1
><MAP
NAME="srchmap"
><AREA
SHAPE="RECT"
COORDS="0,0,466,65"
HREF="index.htm"
ALT="Oracle Built-in Packages"><AREA
SHAPE="RECT"
COORDS="467,0,514,18"
HREF="jobjects/fsearch.htm"
ALT="Search this book"></MAP
><TABLE
WIDTH="515"
BORDER="0"
CELLSPACING="0"
CELLPADDING="0"
><TR
><TD
ALIGN="LEFT"
VALIGN="TOP"
WIDTH="172"
><A
CLASS="sect1"
HREF="ch14_04.htm#ch14-SECT-4.1.1"
TITLE="14.4 DBMS_REPCAT: Managing Snapshot Replication Groups"
><IMG
SRC="../gifs/txtpreva.gif"
ALT="Previous: 14.4 DBMS_REPCAT: Managing Snapshot Replication Groups"
BORDER="0"></A
></TD
><TD
ALIGN="CENTER"
VALIGN="TOP"
WIDTH="171"
><SPAN
CLASS="NAVTITLE"
>Chapter 15</SPAN
></TD
><TD
ALIGN="RIGHT"
VALIGN="TOP"
WIDTH="172"
><A
CLASS="sect1"
HREF="ch15_02.htm#ch15-SECT-2.1.1"
TITLE="15.2 DBMS_REPCAT_ADMIN: Setting Up More Administrator Accounts"
><IMG
SRC="../gifs/txtnexta.gif"
ALT="Next: 15.2 DBMS_REPCAT_ADMIN: Setting Up More Administrator Accounts"
BORDER="0"></A
></TD
></TR
></TABLE
>&nbsp;<HR
ALIGN="LEFT"
WIDTH="515"
TITLE="footer"></DIV
><DIV
CLASS="chapter"
><H1
CLASS="chapter"
><A
CLASS="title"
NAME="ch15-29961"
>15. Advanced Replication</A
></H1
><DIV
CLASS="htmltoc"
><P
><B
>Contents:</B
><BR><A
CLASS="sect1"
HREF="#ch15-SECT-1"
TITLE="15.1 DBMS_REPCAT_AUTH: Setting Up Administrative Accounts"
>DBMS_REPCAT_AUTH: Setting Up Administrative Accounts</A
><BR><A
CLASS="sect1"
HREF="ch15_02.htm#ch15-SECT-2.1.1"
TITLE="15.2 DBMS_REPCAT_ADMIN: Setting Up More Administrator Accounts"
>DBMS_REPCAT_ADMIN: Setting Up More Administrator Accounts</A
><BR><A
CLASS="sect1"
HREF="ch15_03.htm#ch15-SECT-3.1.1"
TITLE="15.3 DBMS_REPCAT: Replication Environment Administration"
>DBMS_REPCAT: Replication Environment Administration</A
><BR><A
CLASS="sect1"
HREF="ch15_04.htm#ch15-SECT-4.2.1"
TITLE="15.4 DBMS_OFFLINE_OG: Performing Site Instantiation"
>DBMS_OFFLINE_OG: Performing Site Instantiation</A
><BR><A
CLASS="sect1"
HREF="ch15_05.htm#ch15-SECT-5.2.2"
TITLE="15.5 DBMS_RECTIFIER_DIFF: Comparing Replicated Tables"
>DBMS_RECTIFIER_DIFF: Comparing Replicated Tables</A
><BR><A
CLASS="sect1"
HREF="ch15_06.htm#ch15-SECT-6.2.1"
TITLE="15.6 DBMS_REPUTIL: Enabling and Disabling Replication"
>DBMS_REPUTIL: Enabling and Disabling Replication</A
></P
><P
></P
></DIV
><P
CLASS="para"
>If you are using the <A
CLASS="indexterm"
NAME="ch15-idx-960513-0"
></A
><A
CLASS="indexterm"
NAME="ch15-idx-960513-1"
></A
>advanced replication option, you will use Oracle built-in packages to create and maintain a replicated environment. This chapter describes packages and the roles they play in the configuration and upkeep of a multi-master environment.</P
><DL
CLASS="variablelist"
><DT
CLASS="term"
>DBMS_REPCAT_AUTH</DT
><DD
CLASS="listitem"
><P
CLASS="para"
>Grants and revokes "surrogate SYS" privileges for an administrator account.</P
></DD
><DT
CLASS="term"
>DBMS_REPCAT_ADMIN</DT
><DD
CLASS="listitem"
><P
CLASS="para"
>Creates administrator accounts for replication.</P
></DD
><DT
CLASS="term"
>DBMS_REPCAT</DT
><DD
CLASS="listitem"
><P
CLASS="para"
>An enormous package that performs many different types of advanced replication operations. This chapter describes only the programs that deal with replication environment maintenance; the other DBMS_REPCAT programs are described in <A
CLASS="xref"
HREF="ch14_01.htm"
>Chapter 14, <CITE
CLASS="chapter"
>Snapshots</CITE
></A
>, and <A
CLASS="xref"
HREF="ch16_01.htm"
>Chapter 16, <CITE
CLASS="chapter"
>Conflict Resolution</CITE
></A
>.</P
></DD
><DT
CLASS="term"
>DBMS_REPUTIL</DT
><DD
CLASS="listitem"
><P
CLASS="para"
>Enables and disables replication at the session level. </P
></DD
><DT
CLASS="term"
>DBMS_OFFLINE_OG</DT
><DD
CLASS="listitem"
><P
CLASS="para"
>Instantiates sites&nbsp;-- that is, lets you export data from an existing master site and import it into the new master site.</P
></DD
><DT
CLASS="term"
>DBMS_RECTIFIER_DIFF</DT
><DD
CLASS="listitem"
><P
CLASS="para"
>Compares the replicated tables at two master sites and allows you to synchronize them if they are different. </P
></DD
></DL
><P
CLASS="para"
>In this chapter, the presentation is more or less chronological&nbsp;-- the packages and their programs are presented in roughly the order in which you would run them in a real advanced replication situation. </P
><DIV
CLASS="sect1"
><H2
CLASS="sect1"
><A
CLASS="title"
NAME="ch15-SECT-1"
>15.1 DBMS_REPCAT_AUTH: Setting Up Administrative Accounts</A
></H2
><P
CLASS="para"
><A
CLASS="indexterm"
NAME="ch15-idx-960515-0"
></A
>The first step in creating an advanced replication environment is to create administrative and end user accounts. The DBMS_REPCAT_AUTH and DBMS_REPCAT_ADMIN packages contain programs that grant and revoke the privileges required in such an environment. This section describes the DBMS_REPCAT_AUTH operations; the next section describes DBMS_REPCAT_ADMIN.</P
><DIV
CLASS="sect2"
><H3
CLASS="sect2"
><A
CLASS="title"
NAME="ch15-SECT-1.1"
>15.1.1 Getting Started with DBMS_REPCAT_AUTH</A
></H3
><P
CLASS="para"
>The <A
CLASS="indexterm"
NAME="ch15-idx-960519-0"
></A
>DBMS_REPCAT_AUTH package is <A
CLASS="indexterm"
NAME="ch15-idx-960587-0"
></A
>created when the Oracle database is installed. The <I
CLASS="filename"
>dbmsrepc.sql </I
><A
CLASS="indexterm"
NAME="ch15-idx-960521-0"
></A
>script (found in the built-in packages source directory, as described in <A
CLASS="xref"
HREF="ch01_01.htm"
>Chapter 1, <CITE
CLASS="chapter"
>Introduction</CITE
></A
>) contains the source code for this package's specification. This script is called by <I
CLASS="filename"
>catrep.sql</I
>, which must be run to install the advanced replication packages. The wrapped sql script <I
CLASS="filename"
>prvtrepc.sql</I
><A
CLASS="indexterm"
NAME="ch15-idx-960522-0"
></A
> creates the public synonym DBMS_REPCAT_AUTH. No EXECUTE privileges are granted on <A
CLASS="indexterm"
NAME="ch15-idx-962842-0"
></A
>DBMS_REPCAT_AUTH; only the owner (SYS) and those with the EXECUTE ANY PROCEDURE system privilege may execute the package.</P
><DIV
CLASS="sect3"
><H4
CLASS="sect3"
><A
CLASS="title"
NAME="ch15-SECT-1.1.1"
>15.1.1.1 DBMS_REPCAT_AUTH programs</A
></H4
><P
CLASS="para"
>The DBMS_REPCAT_AUTH programs are <A
CLASS="indexterm"
NAME="ch15-idx-960523-0"
></A
><A
CLASS="indexterm"
NAME="ch15-idx-960523-1"
></A
>listed in <A
CLASS="xref"
HREF="ch15_01.htm"
>Table 15.1</A
>.</P
><BR><TABLE
CLASS="table"
BORDER="1"
CELLPADDING="3"
><CAPTION
CLASS="table"
><A
CLASS="title"
NAME="ch15-24788"
>Table 15.1: DBMS_REPCAT_AUTH Programs </A
></CAPTION
><THEAD
CLASS="thead"
><TR
CLASS="row"
VALIGN="TOP"
><TH
CLASS="entry"
ALIGN="LEFT"
ROWSPAN="1"
COLSPAN="1"
><P
CLASS="para"
>Name</P
></TH
><TH
CLASS="entry"
ALIGN="LEFT"
ROWSPAN="1"
COLSPAN="1"
><P
CLASS="para"
>Description</P
></TH
><TH
CLASS="entry"
ALIGN="LEFT"
ROWSPAN="1"
COLSPAN="1"
><P
CLASS="para"
>Use in SQL?</P
></TH
></TR
></THEAD
><TBODY
CLASS="tbody"
><TR
CLASS="row"
VALIGN="TOP"
><TD
CLASS="entry"
ROWSPAN="1"
COLSPAN="1"
><P
CLASS="para"
><A
CLASS="indexterm"
NAME="ch15-idx-960524-0"
></A
>GRANT_SURROGATE_REPCAT</P
></TD
><TD
CLASS="entry"
ROWSPAN="1"
COLSPAN="1"
><P
CLASS="para"
>Grants required privileges to a specified user</P
></TD
><TD
CLASS="entry"
ROWSPAN="1"
COLSPAN="1"
><P
CLASS="para"
>No</P
></TD
></TR
><TR
CLASS="row"
VALIGN="TOP"
><TD
CLASS="entry"
ROWSPAN="1"
COLSPAN="1"
><P
CLASS="para"
><A
CLASS="indexterm"
NAME="ch15-idx-960525-0"
></A
>REVOKE_SURROGATE_REPCAT</P
></TD
><TD
CLASS="entry"
ROWSPAN="1"
COLSPAN="1"
><P
CLASS="para"
>Revokes required privileges from a specified user</P
></TD
><TD
CLASS="entry"
ROWSPAN="1"
COLSPAN="1"
><P
CLASS="para"
>No</P
></TD
></TR
></TBODY
></TABLE
></DIV
><DIV
CLASS="sect3"
><H4
CLASS="sect3"
><A
CLASS="title"
NAME="ch15-SECT-1.1.2"
>15.1.1.2 DBMS_REPCAT_AUTH exceptions</A
></H4
><P
CLASS="para"
>The DBMS_REPCAT_AUTH package may raise <A
CLASS="indexterm"
NAME="ch15-idx-960526-0"
></A
>exception ORA-01917 if the specified user does not exist.</P
></DIV
></DIV
><DIV
CLASS="sect2"
><H3
CLASS="sect2"
><A
CLASS="title"
NAME="ch15-SECT-1.2"
>15.1.2 Granting and Revoking Surrogate SYS Accounts</A
></H3
><P
CLASS="para"
><A
CLASS="indexterm"
NAME="ch15-idx-960528-0"
></A
><A
CLASS="indexterm"
NAME="ch15-idx-960528-1"
></A
>The DBMS_REPCAT_AUTH package contains programs that let you grant and revoke "surrogate SYS" privileges to a user. Private <A
CLASS="indexterm"
NAME="ch15-idx-960535-0"
></A
>database links owned by SYS connect to the <A
CLASS="indexterm"
NAME="ch15-idx-960532-0"
></A
>surrogate SYS account at remote sites, thereby avoiding the need for any database links that connect to SYS.</P
><DIV
CLASS="sect3"
><H4
CLASS="sect3"
><A
CLASS="title"
NAME="ch15-SECT-1.2.1"
>15.1.2.1 The DBMS_REPCAT_AUTH.GRANT_SURROGATE_REPCAT procedure</A
></H4
><P
CLASS="para"
>The <A
CLASS="indexterm"
NAME="ch15-idx-960534-0"
></A
><A
CLASS="indexterm"
NAME="ch15-idx-960534-1"
></A
>GRANT_SURROGATE_REPCAT procedure grants surrogate SYS privileges to a particular user. The specification is,</P
><BLOCKQUOTE
><PRE
CLASS="programlisting"
>PROCEDURE DBMS_REPCAT_AUTH.GRANT_SURROGATE_REPCAT
    (userid IN VARCHAR2);</PRE
></BLOCKQUOTE
><P
CLASS="para"
>where userid is the Oracle userid for whom you are granting privileges.</P
><DIV
CLASS="sect4"
><H4
CLASS="sect4"
><A
CLASS="title"
NAME="AUTOID-29307"
>15.1.2.1.1 Exceptions</A
></H4
><P
CLASS="para"
>The GRANT_SURROGATE_REPCAT procedure may raise the exception ORA-1917 if the specified user does not exist.</P
></DIV
><DIV
CLASS="sect4"
><H4
CLASS="sect4"
><A
CLASS="title"
NAME="AUTOID-29310"
>15.1.2.1.2 Example</A
></H4
><P
CLASS="para"
>The following example illustrates how you might use GRANT_SURROGATE_REPCAT:</P
><BLOCKQUOTE
><PRE
CLASS="programlisting"
>BEGIN
    DBMS_REPCAT_AUTH.GRANT_SURROGATE_REPCAT('REPSYS');
END;</PRE
></BLOCKQUOTE
><P
CLASS="para"
>This call configures the REPSYS account to perform tasks required to replicate remote DML and DDL at this site. The SYS account from remote sites should have private database links connecting to this account. The privileges granted include EXECUTE privileges on replication packages. DML privileges are data dictionary tables associated with replication.</P
></DIV
></DIV
><DIV
CLASS="sect3"
><H4
CLASS="sect3"
><A
CLASS="title"
NAME="ch15-SECT-1.2.2"
>15.1.2.2 The DBMS_REPCAT_AUTH.REVOKE_SURROGATE_REPCAT procedure</A
></H4
><P
CLASS="para"
>The <A
CLASS="indexterm"
NAME="ch15-idx-960538-0"
></A
><A
CLASS="indexterm"
NAME="ch15-idx-960538-1"
></A
>REVOKE_SURROGATE_REPCAT procedure revokes the surrogate SYS privileges that have previously been granted to an end user. The specification is,</P
><BLOCKQUOTE
><PRE
CLASS="programlisting"
>PROCEDURE DBMS_REPCAT_AUTH.REVOKE_SURROGATE_REPCAT
    (userid IN VARCHAR2);</PRE
></BLOCKQUOTE
><P
CLASS="para"
>where userid is the Oracle userid for whom you are revoking privileges.</P
><DIV
CLASS="sect4"
><H4
CLASS="sect4"
><A
CLASS="title"
NAME="AUTOID-29326"
>15.1.2.2.1 Exceptions</A
></H4
><P
CLASS="para"
>The REVOKE_SURROGATE_REPCAT procedure may raise the exception ORA-1917 if the specified user does not exist.</P
></DIV
><DIV
CLASS="sect4"
><H4
CLASS="sect4"
><A
CLASS="title"
NAME="AUTOID-29329"
>15.1.2.2.2 Example</A
></H4
><P
CLASS="para"
>The following example shows how to use REVOKE_SURROGATE_REPCAT:</P
><BLOCKQUOTE
><PRE
CLASS="programlisting"
>BEGIN
    DBMS_REPCAT_AUTH.REVOKE_SURROGATE_REPCAT('REPSYS');
END;</PRE
></BLOCKQUOTE
><P
CLASS="para"
>You must have only one surrogate SYS account at each site in a multimaster environment, and it is most convenient if the userid is the same at every site. Generally, the only usage of the surrogate SYS account is via a database <A
CLASS="indexterm"
NAME="ch15-idx-960541-0"
></A
><A
CLASS="indexterm"
NAME="ch15-idx-960541-1"
></A
>link.</P
></DIV
></DIV
></DIV
><DIV
CLASS="sect2"
><H3
CLASS="sect2"
><A
CLASS="title"
NAME="ch15-SECT-1.3"
>15.1.3 Granting and Revoking Propagator Accounts (Oracle8)</A
></H3
><P
CLASS="para"
>Oracle8 and Oracle7 use different mechanisms to propagate changes between sites. Oracle8 does not require a surrogate SYS account, as Oracle7 does. Instead, with Oracle8 you designate a <A
CLASS="indexterm"
NAME="ch15-idx-960543-0"
></A
><A
CLASS="indexterm"
NAME="ch15-idx-960543-1"
></A
>propagator account that delivers queued transactions to remote databases and applies transactions locally on behalf of remote sites.</P
><P
CLASS="para"
>The programs to create and to drop propagator accounts, REGISTER_PROPAGATOR and UNREGISTER_PROPAGATOR, are contained in <A
CLASS="indexterm"
NAME="ch15-idx-960530-0"
></A
>the <A
CLASS="indexterm"
NAME="ch15-idx-960520-0"
></A
>DBMS_DEFER_SYS (described in <A
CLASS="xref"
HREF="ch17_01.htm"
>Chapter 17, <CITE
CLASS="chapter"
>Deferred  Transactions and Remote Procedure Calls</CITE
></A
>).</P
><BLOCKQUOTE
CLASS="note"
><P
CLASS="para"
><STRONG
>NOTE:</STRONG
> We recommend using the same username as the propagator at all database sites. Also, make the account the same as the replication administrator (REPADMIN) account.</P
></BLOCKQUOTE
></DIV
></DIV
></DIV
><DIV
CLASS="htmlnav"
><P
></P
><HR
ALIGN="LEFT"
WIDTH="515"
TITLE="footer"><TABLE
WIDTH="515"
BORDER="0"
CELLSPACING="0"
CELLPADDING="0"
><TR
><TD
ALIGN="LEFT"
VALIGN="TOP"
WIDTH="172"
><A
CLASS="sect1"
HREF="ch14_04.htm#ch14-SECT-4.1.1"
TITLE="14.4 DBMS_REPCAT: Managing Snapshot Replication Groups"
><IMG
SRC="../gifs/txtpreva.gif"
ALT="Previous: 14.4 DBMS_REPCAT: Managing Snapshot Replication Groups"
BORDER="0"></A
></TD
><TD
ALIGN="CENTER"
VALIGN="TOP"
WIDTH="171"
><A
CLASS="book"
HREF="index.htm"
TITLE="Oracle Built-in Packages"
><IMG
SRC="../gifs/txthome.gif"
ALT="Oracle Built-in Packages"
BORDER="0"></A
></TD
><TD
ALIGN="RIGHT"
VALIGN="TOP"
WIDTH="172"
><A
CLASS="sect1"
HREF="ch15_02.htm#ch15-SECT-2.1.1"
TITLE="15.2 DBMS_REPCAT_ADMIN: Setting Up More Administrator Accounts"
><IMG
SRC="../gifs/txtnexta.gif"
ALT="Next: 15.2 DBMS_REPCAT_ADMIN: Setting Up More Administrator Accounts"
BORDER="0"></A
></TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="TOP"
WIDTH="172"
>14.4 DBMS_REPCAT: Managing Snapshot Replication Groups</TD
><TD
ALIGN="CENTER"
VALIGN="TOP"
WIDTH="171"
><A
CLASS="index"
HREF="index/idx_0.htm"
TITLE="Book Index"
><IMG
SRC="../gifs/index.gif"
ALT="Book Index"
BORDER="0"></A
></TD
><TD
ALIGN="RIGHT"
VALIGN="TOP"
WIDTH="172"
>15.2 DBMS_REPCAT_ADMIN: Setting Up More Administrator Accounts</TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="515"
TITLE="footer"></DIV
><IMG SRC="../gifs/smnavbar.gif"
USEMAP="#map"
BORDER="0"
ALT="The Oracle Library Navigation">

<P><font size="-1">
<a href="../copyrght.htm#copy">Copyright (c) 2000</a> O'Reilly &amp; Associates. All rights reserved.
</font></P>

<MAP NAME="map">

<AREA SHAPE="RECT"
COORDS="0,0,35,30"
HREF="../index.htm"
ALT="Library Home">

<AREA SHAPE="RECT"
COORDS="40,0,95,30"
HREF="../prog2/index.htm"
ALT="Oracle PL/SQL Programming, 2nd. Ed.">

<AREA SHAPE="RECT"
COORDS="100,0,200,30"
HREF="../guide8i/index.htm"
ALT="Guide to Oracle 8i Features">

<AREA SHAPE="RECT"
COORDS="205,0,245,30"
HREF="index.htm"
ALT="Oracle Built-in Packages">

<AREA SHAPE="RECT"
COORDS="250,0,320,30"
HREF="../advprog/index.htm"
ALT="Advanced PL/SQL Programming with Packages">

<AREA SHAPE="RECT"
COORDS="325,0,420,30"
HREF="../webapp/index.htm"
ALT="Oracle Web Applications">

<AREA SHAPE="RECT"
COORDS="425,0,490,30"
HREF="../langpkt/index.htm"
ALT="Oracle PL/SQL Language Pocket Reference">

<AREA SHAPE="RECT"
COORDS="495,0,570,30"
HREF="../bipkt/index.htm"
ALT="Oracle PL/SQL Built-ins Pocket Reference">
</MAP>

</BODY
>
<!-- Mirrored from liso.cs.pusan.ac.kr by HTTrack Website Copier/3.x [XR&CO'2001] -->
</HTML
>
