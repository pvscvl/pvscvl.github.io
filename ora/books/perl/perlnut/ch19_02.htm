<html><head>
<title>[Chapter 19] 19.2 Win32::Console</TITLE>
<meta name="DC.title" content="Perl in a Nutshell"><meta name="DC.creator" content="Ellen Siever, Stephen Spainhour &amp; Nathan Patwardhan"><meta name="DC.publisher" content="O'Reilly &amp; Associates, Inc."><meta name="DC.date" content="1999-07-02T01:59:13Z"><meta name="DC.type" content="Text.Monograph"><meta name="DC.format" content="text/html" scheme="MIME"><meta name="DC.source" content="1-56592-286-7" scheme="ISBN"><meta name="DC.language" content="en-US"><meta name="generator" content="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><link rev="made" href="mailto:online-books@oreilly.com" title="Online Books Comments"><link rel="up" href="ch19_01.htm" title="19. Win32 Modules and Extensions"><link rel="prev" href="ch19_01.htm" title="19.1 Win32::Clipboard"><link rel="next" href="ch19_03.htm" title="19.3 Win32::ChangeNotification"></HEAD
><body bgcolor="#FFFFFF" text="#000000"><div class="htmlnav"><h1><img src="gifs/smbanner.gif" alt="Perl in a Nutshell" usemap="#srchmap" border="0"></H1
><map name=index.html"srchmap"><area shape="RECT" coords="0,0,466,71" href="index.htm" alt="Perl in a Nutshell"><area shape="RECT" coords="467,0,514,18" href="../search/nsrch.htm" alt="Search this book"></MAP
><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="SECT1" href="ch19_01.htm" title="19.1 Win32::Clipboard"><img src="../gifs/txtpreva.gif" alt="Previous: 19.1 Win32::Clipboard" border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><b><font face="ARIEL,HELVETICA,HELV,SANSERIF" size="-1"><a class="chapter" rel="up" href="ch19_01.htm" title="19. Win32 Modules and Extensions">Chapter 19<br>Win32 Modules and Extensions</A
></FONT
></B
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="SECT1" href="ch19_03.htm" title="19.3 Win32::ChangeNotification"><img src="../gifs/txtnexta.gif" alt="Next: 19.3 Win32::ChangeNotification" border="0"></A
></TD
></TR
></TABLE
>&nbsp;<hr align="LEFT" width="515" title="footer"></DIV
><div class="SECT1"><h2 class="sect1"><a class="title" name="PNUT-CH-19-SECT-2">19.2 Win32::Console</A
></H2
><p class="para"><a class="indexterm" name="PNUT-CH-19-IX-WIN32-MODULES-WIN32CONSOLE-MODULE"></A
><a class="indexterm" name="PNUT-CH-19-IX-CONSOLE-IMPLEMENTATION"></A
>Win32::Console implements the Win32 console and character mode functions. They give you 
full control on the console input and output, including: 
support of off-screen console buffers (e.g., multiple screen pages);
reading and writing of characters, attributes, and whole portions of the screen;
and complete processing of keyboard and mouse events.</P
><p class="para"><a class="indexterm" name="AUTOID-41002"></A
>The <code class="literal">new</CODE
> constructor is used to create a console object. It can take two
forms:


<blockquote class="screen"><pre class="screen">$con = Win32::Console-&gt;new(<em class="emphasis">standard_handle</EM
>); 
$con = Win32::Console-&gt;new(<em class="emphasis">accessmode</EM
>, <em class="emphasis">sharemode</EM
>);</PRE
></BLOCKQUOTE
>


The first form creates a handle to a standard channel.
<code class="replaceable"><i>standard_handle</I
></CODE
> can be one of <code class="literal">STD_OUTPUT_HANDLE</CODE
>,
<code class="literal">STD_ERROR_HANDLE</CODE
>, or <code class="literal">STD_INPUT_HANDLE</CODE
>.</P
><p class="para">The second form creates a console screen buffer in memory, 
which you can access for reading and writing as a normal console, and then 
redirect on the standard output (the screen) with <code class="literal">Display</CODE
>. In this case, you 
can specify <code class="replaceable"><i>accessmode</I
></CODE
> to be <code class="literal">GENERIC_READ</CODE
>,
<code class="literal">GENERIC_WRITE</CODE
>, or both, determining the permissions you will
have on the created buffer. </P
><p class="para"><code class="replaceable"><i>sharemode</I
></CODE
> affects the way the console can be shared. It can be
specified either as <code class="literal">FILE_SHARE_READ</CODE
>, <code class="literal">FILE_SHARE_WRITE</CODE
>,
or both. If you don't specify any of 
those parameters, all four flags will be used. </P
><p class="para">Methods supported by the Win32::Console module are:
<ul class="nutlist"><li class="term"><a class="nutentry" href="c19_001.htm" title="Reference: Alloc">Alloc</A
></LI
><li class="term"><a class="nutentry" href="c19_002.htm" title="Reference: Attr">Attr</A
></LI
><li class="term"><a class="nutentry" href="c19_003.htm" title="Reference: Cls">Cls</A
></LI
><li class="term"><a class="nutentry" href="c19_004.htm" title="Reference: Cursor">Cursor</A
></LI
><li class="term"><a class="nutentry" href="c19_005.htm" title="Reference: Display">Display</A
></LI
><li class="term"><a class="nutentry" href="c19_006.htm" title="Reference: FillAttr">FillAttr</A
></LI
><li class="term"><a class="nutentry" href="c19_007.htm" title="Reference: FillChar">FillChar</A
></LI
><li class="term"><a class="nutentry" href="c19_008.htm" title="Reference: Flush">Flush</A
></LI
><li class="term"><a class="nutentry" href="c19_009.htm" title="Reference: Free">Free</A
></LI
><li class="term"><a class="nutentry" href="c19_010.htm" title="Reference: GenerateCtrlEvent">GenerateCtrlEvent</A
></LI
><li class="term"><a class="nutentry" href="c19_011.htm" title="Reference: GetEvents">GetEvents</A
></LI
><li class="term"><a class="nutentry" href="c19_012.htm" title="Reference: Info">Info</A
></LI
><li class="term"><a class="nutentry" href="c19_013.htm" title="Reference: Input">Input</A
></LI
><li class="term"><a class="nutentry" href="c19_014.htm" title="Reference: InputChar">InputChar</A
></LI
><li class="term"><a class="nutentry" href="c19_015.htm" title="Reference: InputCP">InputCP</A
></LI
><li class="term"><a class="nutentry" href="c19_016.htm" title="Reference: MaxWindow">MaxWindow</A
></LI
><li class="term"><a class="nutentry" href="c19_017.htm" title="Reference: Mode">Mode</A
></LI
><li class="term"><a class="nutentry" href="c19_018.htm" title="Reference: MouseButtons">MouseButtons</A
></LI
><li class="term"><a class="nutentry" href="c19_019.htm" title="Reference: OutputCP">OutputCP</A
></LI
><li class="term"><a class="nutentry" href="c19_020.htm" title="Reference: PeekInput">PeekInput</A
></LI
><li class="term"><a class="nutentry" href="c19_021.htm" title="Reference: ReadAttr">ReadAttr</A
></LI
><li class="term"><a class="nutentry" href="c19_022.htm" title="Reference: ReadChar">ReadChar</A
></LI
><li class="term"><a class="nutentry" href="c19_023.htm" title="Reference: ReadRect">ReadRect</A
></LI
><li class="term"><a class="nutentry" href="c19_024.htm" title="Reference: Scroll">Scroll</A
></LI
><li class="term"><a class="nutentry" href="c19_025.htm" title="Reference: Select">Select</A
></LI
><li class="term"><a class="nutentry" href="c19_026.htm" title="Reference: Size">Size</A
></LI
><li class="term"><a class="nutentry" href="c19_027.htm" title="Reference: Title">Title</A
></LI
><li class="term"><a class="nutentry" href="c19_028.htm" title="Reference: Window">Window</A
></LI
><li class="term"><a class="nutentry" href="c19_029.htm" title="Reference: Write">Write</A
></LI
><li class="term"><a class="nutentry" href="c19_030.htm" title="Reference: WriteAttr">WriteAttr</A
></LI
><li class="term"><a class="nutentry" href="c19_031.htm" title="Reference: WriteChar">WriteChar</A
></LI
><li class="term"><a class="nutentry" href="c19_032.htm" title="Reference: WriteInput">WriteInput</A
></LI
><li class="term"><a class="nutentry" href="c19_033.htm" title="Reference: WriteRect">WriteRect</A
></LI
></UL
></P
><div class="sect2"><h3 class="sect2"><a class="title" name="PNUT-CH-19-SECT-2.0.1">19.2.1 Constants</A
></H3
><p class="para">The following constants are exported in the main namespace of your 
script using Win32::Console: 


<blockquote class="screen"><pre class="screen">BACKGROUND_BLUE		        BACKGROUND_GREEN
BACKGROUND_INTENSITY	    BACKGROUND_RED
CAPSLOCK_ON		            CONSOLE_TEXTMODE_BUFFER    
ENABLE_ECHO_INPUT		    ENABLE_LINE_INPUT
ENABLE_MOUSE_INPUT		    ENABLE_PROCESSED_INPUT
ENABLE_PROCESSED_OUTPUT	    ENABLE_WINDOW_INPUT
ENABLE_WRAP_AT_EOL_OUTPUT	ENHANCED_KEY
FILE_SHARE_READ		        FILE_SHARE_WRITE
FOREGROUND_BLUE		        FOREGROUND_GREEN
FOREGROUND_INTENSITY	    FOREGROUND_RED
LEFT_ALT_PRESSED		    LEFT_CTRL_PRESSED
NUMLOCK_ON		            GENERIC_READ
GENERIC_WRITE		        RIGHT_ALT_PRESSED
RIGHT_CTRL_PRESSED		    SCROLLLOCK_ON
SHIFT_PRESSED		        STD_INPUT_HANDLE
STD_OUTPUT_HANDLE		    STD_ERROR_HANDLE</PRE
></BLOCKQUOTE
>


Additionally, the following variables can be used: 


<blockquote class="screen"><pre class="screen">$FG_BLACK			$FG_BLUE
$FG_LIGHTBLUE		$FG_RED
$FG_LIGHTRED		$FG_GREEN
$FG_LIGHTGREEN		$FG_MAGENTA
$FG_LIGHTMAGENTA		$FG_CYAN
$FG_LIGHTCYAN		$FG_BROWN
$FG_YELLOW		$FG_GRAY
$FG_WHITE
$BG_BLACK			$BG_BLUE
$BG_LIGHTBLUE		$BG_RED
$BG_LIGHTRED		$BG_GREEN
$BG_LIGHTGREEN		$BG_MAGENTA
$BG_LIGHTMAGENTA		$BG_CYAN
$BG_LIGHTCYAN		$BG_BROWN
$BG_YELLOW		$BG_GRAY
$BG_WHITE
$ATTR_NORMAL		$ATTR_INVERSE</PRE
></BLOCKQUOTE
>


<code class="literal">ATTR_NORMAL</CODE
> is set to gray foreground on black background (DOS's standard colors). <a class="indexterm" name="AUTOID-41584"></A
><a class="indexterm" name="AUTOID-41585"></A
></P
></DIV
></DIV
><div class="htmlnav"><p></P
><hr align="LEFT" width="515" title="footer"><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="SECT1" href="ch19_01.htm" title="19.1 Win32::Clipboard"><img src="../gifs/txtpreva.gif" alt="Previous: 19.1 Win32::Clipboard" border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><a class="book" href="index.htm" title="Perl in a Nutshell"><img src="../gifs/txthome.gif" alt="Perl in a Nutshell" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="SECT1" href="ch19_03.htm" title="19.3 Win32::ChangeNotification"><img src="../gifs/txtnexta.gif" alt="Next: 19.3 Win32::ChangeNotification" border="0"></A
></TD
></TR
><tr><td align="LEFT" valign="TOP" width="172">19.1 Win32::Clipboard</TD
><td align="CENTER" valign="TOP" width="171"><a class="index" href="index/idx_0.htm" title="Book Index"><img src="../gifs/index.gif" alt="Book Index" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172">19.3 Win32::ChangeNotification</TD
></TR
></TABLE
><hr align="LEFT" width="515" title="footer"><p class="nav"><font size="-1">[ <a href="../index.html" title="The Perl CD Bookshelf">Library Home</A
> | <a href="index.htm" title="Perl in a Nutshell">Perl in a Nutshell</A
> | <a href="../learn/index.htm" title="Learning Perl">Learning Perl</A
> | <a href="../learn32/index.htm" title="Learning Perl on Win32 Systems">Learning Perl on Win32</A
> | <a href="../prog/index.htm" title="Programming Perl">Programming Perl</A
> | <a href="../advprog/index.htm" title="Advanced Perl Programming">Advanced Perl Programming</A
> | <a href="../cookbook/index.htm" title="Perl Cookbook">Perl Cookbook</A
> ]</FONT
></P
></DIV
></BODY
></HTML
>
