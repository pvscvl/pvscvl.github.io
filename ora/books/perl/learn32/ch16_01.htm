<html><head>
<title>[Chapter 16] System Information</TITLE>
<meta name="DC.title" content="Learning Perl on Win32 Systems"><meta name="DC.creator" content="Randal L. Schwartz, Erik Olson &amp; Tom Christiansen"><meta name="DC.publisher" content="O'Reilly &amp; Associates, Inc."><meta name="DC.date" content="1999-07-02T01:36:10Z"><meta name="DC.type" content="Text.Monograph"><meta name="DC.format" content="text/html" scheme="MIME"><meta name="DC.source" content="1-56592-324-3" scheme="ISBN"><meta name="DC.language" content="en-US"><meta name="generator" content="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><link rev="made" href="mailto:online-books@oreilly.com" title="Online Books Comments"><link rel="up" href="index.htm" title="Learning Perl on Win32 Systems"><link rel="prev" href="ch15_06.htm" title="15.6 Exercises"><link rel="next" href="ch16_02.htm" title="16.2 Packing and Unpacking Binary Data"></HEAD
><body bgcolor="#FFFFFF" text="#000000"><div class="htmlnav"><h1><img src="gifs/smbanner.gif" alt="Learning Perl on Win32 Systems" usemap="#srchmap" border="0"></H1
><map name="srchindex.htmlmap"><area shape="RECT" coords="0,0,466,54" href="index.htm" alt="Learning Perl on Win32 Systems"><area shape="RECT" coords="467,0,514,18" href="../search/wsrch.htm" alt="Search this book"></MAP
><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="sect1" href="ch15_06.htm" title="15.6 Exercises"><img src="../gifs/txtpreva.gif" alt="Previous: 15.6 Exercises" border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><b><font face="ARIEL,HELVETICA,HELV,SANSERIF" size="-1">Chapter 16</FONT
></B
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="sect1" href="ch16_02.htm" title="16.2 Packing and Unpacking Binary Data"><img src="../gifs/txtnexta.gif" alt="Next: 16.2 Packing and Unpacking Binary Data" border="0"></A
></TD
></TR
></TABLE
>&nbsp;<hr align="LEFT" width="515" title="footer"></DIV
><div class="chapter"><h1 class="chapter"><a class="title" name="ch16-39553">16. System Information</A
></H1
><div class="htmltoc"><p><b>Contents:</B
><br><a class="sect1" href="#ch16-16248" title="16.1 Getting User and Machine Information">Getting User and Machine Information</A
><br><a class="sect1" href="ch16_02.htm" title="16.2 Packing and Unpacking Binary Data">Packing and Unpacking Binary Data</A
><br><a class="sect1" href="ch16_03.htm" title="16.3 Getting Network Information">Getting Network Information</A
><br><a class="sect1" href="ch16_04.htm#ch16-pgfId-648139" title="16.4 The Registry">The Registry</A
><br><a class="sect1" href="ch16_05.htm" title="16.5 Opening and Reading Registry Values">Opening and Reading Registry Values</A
><br><a class="sect1" href="ch16_06.htm#ch16-28986" title="16.6 Setting Registry Values">Setting Registry Values</A
><br><a class="sect1" href="ch16_07.htm" title="16.7 Exercises">Exercises</A
></P
><p></P
></DIV
><div class="sect1"><h2 class="sect1"><a class="title" name="ch16-16248">16.1 Getting User and Machine Information</A
></H2
><p class="para">Perl provides several facilities for finding out information about the user and machine that you are running on. These functions are provided via Win32 extensions (see <a class="xref" href="appb_01.htm" title="Libraries and Modules">Appendix B, <cite class="appendix">Libraries and Modules</CITE
></A
>, for more information).</P
><p class="para">To retrieve the name of the user executing the script, use the <code class="literal">Win32::LoginName</CODE
><a class="indexterm" name="ch16-idx-649526-0"></A
><a class="indexterm" name="ch16-idx-649526-1"></A
> function:</P
><pre class="programlisting">use Win32;
$name = Win32::LoginName;</PRE
><p class="para">To retrieve the name of the machine executing the script, use the <code class="literal">Win32::NodeName</CODE
><a class="indexterm" name="ch16-idx-649530-0"></A
><a class="indexterm" name="ch16-idx-649530-1"></A
> function:</P
><pre class="programlisting">use Win32;
$machine = Win32::NodeName;</PRE
><p class="para">The <code class="literal">Win32::NetAdmin</CODE
><a class="indexterm" name="ch16-idx-649535-0"></A
><a class="indexterm" name="ch16-idx-649535-1"></A
> module provides extensive functionality for administering users and groups. Here's an simple example of how you might use it to retrieve the current user's home directory:</P
><pre class="programlisting">use Win32::NetAdmin;
$user = Win32::LoginName; # grab the name of the current user
Win32::NetAdmin::UserGetAttributes(&quot;&quot;,
    $username, $password, $passwordage,
    $privilege, $homedir, $comment,
    $flags, $scriptpath);
print &quot;The homedir for $username is $homedir\n&quot;;</PRE
><p class="para">For more information on using <code class="literal">Win32::NetAdmin</CODE
>, explore the <em class="emphasis">win32mod</EM
> documentation.</P
><p class="para">As you explore Perl scripts on the Net, you'll no doubt find scripts that refer to any of a myriad of Perl functions that access UNIX password and group files. At the time of this writing, these functions are not implemented in Perl on Win32 platforms, but you can usually duplicate the functionality (if it's applicable) using one of the Win32 extension modules.</P
></DIV
></DIV
><div class="htmlnav"><p></P
><hr align="LEFT" width="515" title="footer"><table width="515" border="0" cellspacing="0" cellpadding="0"><tr><td align="LEFT" valign="TOP" width="172"><a class="sect1" href="ch15_06.htm" title="15.6 Exercises"><img src="../gifs/txtpreva.gif" alt="Previous: 15.6 Exercises" border="0"></A
></TD
><td align="CENTER" valign="TOP" width="171"><a class="book" href="index.htm" title="Learning Perl on Win32 Systems"><img src="../gifs/txthome.gif" alt="Learning Perl on Win32 Systems" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172"><a class="sect1" href="ch16_02.htm" title="16.2 Packing and Unpacking Binary Data"><img src="../gifs/txtnexta.gif" alt="Next: 16.2 Packing and Unpacking Binary Data" border="0"></A
></TD
></TR
><tr><td align="LEFT" valign="TOP" width="172">15.6 Exercises</TD
><td align="CENTER" valign="TOP" width="171"><a class="index" href="index/idx_0.htm" title="Book Index"><img src="../gifs/index.gif" alt="Book Index" border="0"></A
></TD
><td align="RIGHT" valign="TOP" width="172">16.2 Packing and Unpacking Binary Data</TD
></TR
></TABLE
><hr align="LEFT" width="515" title="footer"><p class="nav"><font size="-1">[ <a href="../index.html" title="The Perl CD Bookshelf">Library Home</A
> | <a href="../perlnut/index.htm" title="Perl in a Nutshell">Perl in a Nutshell</A
> | <a href="../learn/index.htm" title="Learning Perl">Learning Perl</A
> | <a href="index.htm" title="Learning Perl on Win32 Systems">Learning Perl on Win32</A
> | <a href="../prog/index.htm" title="Programming Perl">Programming Perl</A
> | <a href="../advprog/index.htm" title="Advanced Perl Programming">Advanced Perl Programming</A
> | <a href="../cookbook/index.htm" title="Perl Cookbook">Perl Cookbook</A
> ]</FONT
></P
></DIV
></BODY
></HTML
>
