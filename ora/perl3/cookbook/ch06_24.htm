<HTML
><HEAD
>
<TITLE>Recipe 6.23. Regular Expression Grabbag (Perl Cookbook)</TITLE>
<META
NAME="DC.title"
CONTENT="Perl Cookbook"><META
NAME="DC.creator"
CONTENT="Tom Christiansen &amp; Nathan Torkington"><META
NAME="DC.publisher"
CONTENT="O'Reilly &amp; Associates, Inc."><META
NAME="DC.date"
CONTENT="1999-07-02T01:35:12Z"><META
NAME="DC.type"
CONTENT="Text.Monograph"><META
NAME="DC.format"
CONTENT="text/html"
SCHEME="MIME"><META
NAME="DC.source"
CONTENT="1-56592-243-3"
SCHEME="ISBN"><META
NAME="DC.language"
CONTENT="en-US"><META
NAME="generator"
CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINK
REV="made"
HREF="mailto:online-books@oreilly.com"
TITLE="Online Books Comments"><LINK
REL="up"
HREF="ch06_01.htm"
TITLE="6. Pattern Matching"><LINK
REL="prev"
HREF="ch06_23.htm"
TITLE="6.22. Program: tcgrep"><LINK
REL="next"
HREF="ch07_01.htm"
TITLE="7. File Access"></HEAD
><BODY
BGCOLOR="#FFFFFF"><img alt="Book Home" border="0" src="gifs/smbanner.gif" usemap="#banner-map" /><map name="banner-map"><area shape="rect" coords="1,-2,616,66" href="index.htm" alt="Perl Cookbook"><area shape="rect" coords="629,-11,726,25" href="jobjects/fsearch.htm" alt="Search this book" /></map><div class="navbar"><p>
<TABLE
WIDTH="684"
BORDER="0"
CELLSPACING="0"
CELLPADDING="0"
><TR
><TD
ALIGN="LEFT"
VALIGN="TOP"
WIDTH="228"
><A
CLASS="sect1"
HREF="ch06_23.htm"
TITLE="6.22. Program: tcgrep"
><IMG
SRC="../gifs/txtpreva.gif"
ALT="Previous: 6.22. Program: tcgrep"
BORDER="0"></A
></TD
><TD
ALIGN="CENTER"
VALIGN="TOP"
WIDTH="228"
><B
><FONT
FACE="ARIEL,HELVETICA,HELV,SANSERIF"
SIZE="-1"
><A
CLASS="chapter"
REL="up"
HREF="ch06_01.htm"
TITLE="6. Pattern Matching"
></A
></FONT
></B
></TD
><TD
ALIGN="RIGHT"
VALIGN="TOP"
WIDTH="228"
><A
CLASS="chapter"
HREF="ch07_01.htm"
TITLE="7. File Access"
><IMG
SRC="../gifs/txtnexta.gif"
ALT="Next: 7. File Access"
BORDER="0"></A
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="sect1"
><H2
CLASS="sect1"
><A
CLASS="title"
NAME="ch06-33146"
>6.23. Regular Expression Grabbag</A
></H2
><P
CLASS="para"
>We have found these <A
CLASS="indexterm"
NAME="ch06-idx-1000007741-0"
></A
><A
CLASS="indexterm"
NAME="ch06-idx-1000007741-1"
></A
>regular expressions useful or interesting.</P
><DL
CLASS="variablelist"
><DT
CLASS="term"
>Roman numbers </DT
><DD
CLASS="listitem"
><PRE
CLASS="programlisting"
>m/^m*(d?c{0,3}|c[dm])(l?x{0,3}|x[lc])(v?i{0,3}|i[vx])$/i</PRE
></DD
><DT
CLASS="term"
>Swap first two words </DT
><DD
CLASS="listitem"
><PRE
CLASS="programlisting"
>s/(\S+)(\s+)(\S+)/$3$2$1/</PRE
></DD
><DT
CLASS="term"
>Keyword = Value </DT
><DD
CLASS="listitem"
><PRE
CLASS="programlisting"
>m/(\w+)\s*=\s*(.*)\s*$/             # keyword is $1, value is $2</PRE
></DD
><DT
CLASS="term"
>Line of at least 80 characters </DT
><DD
CLASS="listitem"
><PRE
CLASS="programlisting"
>m/.{80,}/</PRE
></DD
><DT
CLASS="term"
>MM/DD/YY HH:MM:SS </DT
><DD
CLASS="listitem"
><PRE
CLASS="programlisting"
>m|(\d+)/(\d+)/(\d+) (\d+):(\d+):(\d+)|</PRE
></DD
><DT
CLASS="term"
>Changing directories </DT
><DD
CLASS="listitem"
><PRE
CLASS="programlisting"
>s(/usr/bin)(/usr/local/bin)g</PRE
></DD
><DT
CLASS="term"
>Expanding %7E (hex) escapes </DT
><DD
CLASS="listitem"
><PRE
CLASS="programlisting"
>s/%([0-9A-Fa-f][0-9A-Fa-f])/chr hex $1/ge</PRE
></DD
><DT
CLASS="term"
>Deleting C comments (imperfectly) </DT
><DD
CLASS="listitem"
><PRE
CLASS="programlisting"
>s{
    /\*                    # Match the opening delimiter
    .*?                    # Match a minimal number of characters
    \*/                    # Match the closing delimiter
} []gsx;</PRE
></DD
><DT
CLASS="term"
>Removing leading and trailing whitespace </DT
><DD
CLASS="listitem"
><PRE
CLASS="programlisting"
>s/^\s+//;
s/\s+$//;</PRE
></DD
><DT
CLASS="term"
>Turning \ followed by n into a real newline </DT
><DD
CLASS="listitem"
><PRE
CLASS="programlisting"
>s/\\n/\n/g;</PRE
></DD
><DT
CLASS="term"
>Removing package portion of fully qualified symbols </DT
><DD
CLASS="listitem"
><PRE
CLASS="programlisting"
>s/^.*:://</PRE
></DD
><DT
CLASS="term"
>IP address </DT
><DD
CLASS="listitem"
><PRE
CLASS="programlisting"
>m/^([01]?\d\d|2[0-4]\d|25[0-5])\.([01]?\d\d|2[0-4]\d|25[0-5])\.
   ([01]?\d\d|2[0-4]\d|25[0-5])\.([01]?\d\d|2[0-4]\d|25[0-5])$/;</PRE
></DD
><DT
CLASS="term"
>Removing leading path from filename </DT
><DD
CLASS="listitem"
><PRE
CLASS="programlisting"
>s(^.*/)()</PRE
></DD
><DT
CLASS="term"
>Extracting columns setting from TERMCAP </DT
><DD
CLASS="listitem"
><PRE
CLASS="programlisting"
>$cols = ( ($ENV{TERMCAP} || &quot; &quot;) =~ m/:co#(\d+):/ ) ? $1 : 80;</PRE
></DD
><DT
CLASS="term"
>Removing directory components from program name and arguments </DT
><DD
CLASS="listitem"
><PRE
CLASS="programlisting"
>($name = &quot; $0 @ARGV&quot;) =~ s,  /\S+/,  ,g;</PRE
></DD
><DT
CLASS="term"
>Checking your operating system </DT
><DD
CLASS="listitem"
><PRE
CLASS="programlisting"
>die &quot;This isn't Linux&quot; unless $^O =~ m/linux/i;</PRE
></DD
><DT
CLASS="term"
>Joining continuation lines in multiline string </DT
><DD
CLASS="listitem"
><PRE
CLASS="programlisting"
>s/\n\s+/ /g</PRE
></DD
><DT
CLASS="term"
>Extracting all numbers from a string </DT
><DD
CLASS="listitem"
><PRE
CLASS="programlisting"
>@nums = m/(\d+\.?\d*|\.\d+)/g;</PRE
></DD
><DT
CLASS="term"
>Finding all-caps words </DT
><DD
CLASS="listitem"
><PRE
CLASS="programlisting"
>@capwords = m/(\b[^\Wa-z0-9_]+\b)/g;</PRE
></DD
><DT
CLASS="term"
>Finding all-lowercase words </DT
><DD
CLASS="listitem"
><PRE
CLASS="programlisting"
>@lowords = m/(\b[^\WA-Z0-9_]+\b)/g;</PRE
></DD
><DT
CLASS="term"
>Finding initial-caps word </DT
><DD
CLASS="listitem"
><PRE
CLASS="programlisting"
>@icwords = m/(\b[^\Wa-z0-9_][^\WA-Z0-9_]*\b)/;</PRE
></DD
><DT
CLASS="term"
>Finding links in simple HTML </DT
><DD
CLASS="listitem"
><PRE
CLASS="programlisting"
>@links = m/&lt;A[^&gt;]+?HREF\s*=\s*[&quot;']?([^'&quot; &gt;]+?)[ '&quot;]?&gt;/sig;</PRE
></DD
><DT
CLASS="term"
>Finding middle initial in $_ </DT
><DD
CLASS="listitem"
><PRE
CLASS="programlisting"
>($initial) = m/^\S+\s+(\S)\S*\s+\S/ ? $1 : &quot;&quot;;</PRE
></DD
><DT
CLASS="term"
>Changing inch marks to quotes </DT
><DD
CLASS="listitem"
><PRE
CLASS="programlisting"
>s/&quot;([^&quot;]*)&quot;/``$1''/g</PRE
></DD
><DT
CLASS="term"
>Extracting sentences (two spaces required) </DT
><DD
CLASS="listitem"
><PRE
CLASS="programlisting"
>{ local $/ = &quot;&quot;;
  while (&lt;&gt;) {
    s/\n/ /g;
    s/ {3,}/  /g;
    push @sentences, m/(\S.*?[!?.])(?=  |\Z)/g;
  }
}</PRE
></DD
><DT
CLASS="term"
>YYYY-MM-DD </DT
><DD
CLASS="listitem"
><PRE
CLASS="programlisting"
>m/(\d{4})-(\d\d)-(\d\d)/            # YYYY in $1, MM in $2, DD in $3</PRE
></DD
><DT
CLASS="term"
>North American telephone numbers </DT
><DD
CLASS="listitem"
><PRE
CLASS="programlisting"
>m/ ^
      (?:
       1 \s (?: \d\d\d \s)?            # 1, or 1 and area code
       |                               # ... or ...
       \(\d\d\d\) \s                   # area code with parens
       |                               # ... or ...
       (?: \+\d\d?\d? \s)?             # optional +country code
       \d\d\d ([\s\-])                 # and area code
      )
      \d\d\d (\s|\1)                   # prefix (and area code separator)
      \d\d\d\d                         # exchange
        $
 /x</PRE
></DD
><DT
CLASS="term"
>Exclamations </DT
><DD
CLASS="listitem"
><PRE
CLASS="programlisting"
>m/\boh\s+my\s+gh?o(d(dess(es)?|s?)|odness|sh)\b/i</PRE
></DD
><DT
CLASS="term"
>Extracting lines regardless of line terminator </DT
><DD
CLASS="listitem"
><PRE
CLASS="programlisting"
>push(@lines, $1)
    while ($input =~ s/^([^\012\015]*)(\012\015?|\015\012?)//);<A
CLASS="indexterm"
NAME="ch06-idx-1000007753-0"
></A
><A
CLASS="indexterm"
NAME="ch06-idx-1000007753-1"
></A
><A
CLASS="indexterm"
NAME="ch06-idx-1000007753-2"
></A
></PRE
></DD
></DL
></DIV
><DIV
CLASS="htmlnav"
><P
></P
><HR
ALIGN="LEFT"
WIDTH="684"
TITLE="footer"><TABLE
WIDTH="684"
BORDER="0"
CELLSPACING="0"
CELLPADDING="0"
><TR
><TD
ALIGN="LEFT"
VALIGN="TOP"
WIDTH="228"
><A
CLASS="sect1"
HREF="ch06_23.htm"
TITLE="6.22. Program: tcgrep"
><IMG
SRC="../gifs/txtpreva.gif"
ALT="Previous: 6.22. Program: tcgrep"
BORDER="0"></A
></TD
><TD
ALIGN="CENTER"
VALIGN="TOP"
WIDTH="228"
><A
CLASS="book"
HREF="index.htm"
TITLE="Perl Cookbook"
><IMG
SRC="../gifs/txthome.gif"
ALT="Perl Cookbook"
BORDER="0"></A
></TD
><TD
ALIGN="RIGHT"
VALIGN="TOP"
WIDTH="228"
><A
CLASS="chapter"
HREF="ch07_01.htm"
TITLE="7. File Access"
><IMG
SRC="../gifs/txtnexta.gif"
ALT="Next: 7. File Access"
BORDER="0"></A
></TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="TOP"
WIDTH="228"
>6.22. Program: tcgrep</TD
><TD
ALIGN="CENTER"
VALIGN="TOP"
WIDTH="228"
><A
CLASS="index"
HREF="index/index.htm"
TITLE="Book Index"
><IMG
SRC="../gifs/index.gif"
ALT="Book Index"
BORDER="0"></A
></TD
><TD
ALIGN="RIGHT"
VALIGN="TOP"
WIDTH="228"
>7. File Access</TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="684"
TITLE="footer"><FONT
SIZE="-1"
></DIV<!-- LIBRARY NAV BAR --> <img src="../gifs/smnavbar.gif" usemap="#library-map" border="0" alt="Library Navigation Links"><p> <a href="copyrght.htm">Copyright &copy; 2002</a> O'Reilly &amp; Associates. All rights reserved.</font> </p> <map name="library-map"> <area shape="rect" coords="1,0,85,94" href="../index.htm"><area shape="rect" coords="86,1,178,103" href="../lwp/index.htm"><area shape="rect" coords="180,0,265,103" href="../lperl/index.htm"><area shape="rect" coords="267,0,353,105" href="../perlnut/index.htm"><area shape="rect" coords="354,1,446,115" href="../prog/index.htm"><area shape="rect" coords="448,0,526,132" href="../tk/index.htm"><area shape="rect" coords="528,1,615,119" href="index.htm"><area shape="rect" coords="617,0,690,135" href="../pxml/index.htm"></map> </BODY
></HTML
>
