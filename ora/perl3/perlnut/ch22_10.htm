<html><head><title>Win32::NetAdmin (Perl in a Nutshell, 2nd Edition)</title><link rel="stylesheet" type="text/css" href="../style/style1.css" />

<meta name="DC.Creator" content="Stephen Spainhour" /><meta name="DC.Format" content="text/xml" scheme="MIME" /><meta name="DC.Language" content="en-US" /><meta name="DC.Publisher" content="O'Reilly &amp; Associates, Inc." /><meta name="DC.Source" scheme="ISBN" content="0596002416L" /><meta name="DC.Subject.Keyword" content="stuff" /><meta name="DC.Title" content="Perl in a Nutshell, 2nd Edition" /><meta name="DC.Type" content="Text.Monograph" />

</head><body bgcolor="#ffffff">

<img src="gifs/smbanner.gif" usemap="#banner-map" border="0" alt="Book Home" /><map name="banner-map"><area shape="rect" coords="1,-2,616,66" href="index.htm" alt="Java and XSLT" /><area shape="rect" coords="629,-11,726,25" href="jobjects/fsearch.htm" alt="Search this book" /></map>

<div class="navbar"><table width="684" border="0"><tr><td align="left" valign="top" width="228"><a href="ch22_09.htm"><img src="../gifs/txtpreva.gif" alt="Previous" border="0" /></a></td><td align="center" valign="top" width="228" /><td align="right" valign="top" width="228"><a href="ch22_11.htm"><img src="../gifs/txtnexta.gif" alt="Next" border="0" /></a></td></tr></table></div>



<h2 class="sect1">22.10. Win32::NetAdmin</h2>

<p><a name="INDEX-3300" /><a name="INDEX-3301" /><a name="INDEX-3302" />The Win32::NetAdmin module
provides extensive functionality for administering users and groups
on Windows NT servers. This module does not implement an object
interface for administration; it exports several functions that
execute administrative commands. (This module does not load on
Windows 95 systems.)
</p>

<p>The following functions are provided by the Win32::NetAdmin module.
The <em class="replaceable"><tt>server</tt></em> argument of each function is
optional; however, a placeholder for the argument must be used if you
don't supply a name. An empty string
("") will work, indicating that the
local machine should be used.
</p>



<a name="INDEX-3303" /><div class="refentry"><table width="515" border="0" cellpadding="5"><tr><td align="left"><font size="+1"><b>GetDomainController</b></font></td><td align="right"><i></i></td></tr></table><hr width="515" size="3" noshade="true" align="left" color="black" /><pre>
GetDomainController (<em class="replaceable">server</em>, <em class="replaceable">domain</em>, $<em class="replaceable">name</em>)
</pre><p><a name="INDEX-3303" />Returns the name of the
domain controller for the specified <em class="replaceable"><tt>server</em>and <em class="replaceable">domain</tt></em> to the variable
<tt class="literal">$</tt><em class="replaceable"><tt>name</tt></em>.
</p></div>

<div class="refentry"><table width="515" border="0" cellpadding="5"><tr><td align="left"><font size="+1"><b>GroupAddUsers</b></font></td><td align="right"><i></i></td></tr></table><hr width="515" size="3" noshade="true" align="left" color="black" /><pre>
GroupAddUsers (<em class="replaceable">server</em>, <em class="replaceable">name</em>, <em class="replaceable">users</em>)
</pre><p>Adds users to group <em class="replaceable">name</em> on
<em class="replaceable"><tt>server</em>. <em class="replaceable">users</tt></em>can be a list of usernames or a list variable containing multiple
usernames.
</p></div>

<div class="refentry"><table width="515" border="0" cellpadding="5"><tr><td align="left"><font size="+1"><b>GroupCreate</b></font></td><td align="right"><i></i></td></tr></table><hr width="515" size="3" noshade="true" align="left" color="black" /><pre>
GroupCreate (<em class="replaceable">server</em>, <em class="replaceable">name</em>, <em class="replaceable">comment</em>)
</pre><p>Creates a group with the specified <em class="replaceable">name</em> on
<em class="replaceable"><tt>server</em>. <em class="replaceable">comment</tt></em>is a string used to provide a description about the group.
</p></div>

<div class="refentry"><table width="515" border="0" cellpadding="5"><tr><td align="left"><font size="+1"><b>GroupDelete</b></font></td><td align="right"><i></i></td></tr></table><hr width="515" size="3" noshade="true" align="left" color="black" /><pre>
GroupDelete (<em class="replaceable">server</em>, <em class="replaceable">name</em>)
</pre><p>Deletes a group named <em class="replaceable">name</em> from
<em class="replaceable"><tt>server</tt></em>.
</p></div>

<div class="refentry"><table width="515" border="0" cellpadding="5"><tr><td align="left"><font size="+1"><b>GroupDeleteUsers</b></font></td><td align="right"><i></i></td></tr></table><hr width="515" size="3" noshade="true" align="left" color="black" /><pre>
GroupDeleteUsers (<em class="replaceable">server</em>, <em class="replaceable">name</em>, <em class="replaceable">users</em>)
</pre><p>Deletes a list of <em class="replaceable">users</em> from the group
<em class="replaceable"><tt>name</em> on <em class="replaceable">server</tt></em>.
</p></div>

<div class="refentry"><table width="515" border="0" cellpadding="5"><tr><td align="left"><font size="+1"><b>GroupGetAttributes</b></font></td><td align="right"><i></i></td></tr></table><hr width="515" size="3" noshade="true" align="left" color="black" /><pre>
GroupGetAttributes (<em class="replaceable">server</em>, <em class="replaceable">name</em>, <em class="replaceable">comment</em>)
</pre><p>Returns the comment for group <em class="replaceable">name</em> on
<em class="replaceable"><tt>server</tt></em> to the variable
<em class="replaceable"><tt>comment</tt></em>.
</p></div>

<div class="refentry"><table width="515" border="0" cellpadding="5"><tr><td align="left"><font size="+1"><b>GroupGetMembers</b></font></td><td align="right"><i></i></td></tr></table><hr width="515" size="3" noshade="true" align="left" color="black" /><pre>
GroupGetMembers (<em class="replaceable">server</em>, <em class="replaceable">name</em>, $<em class="replaceable">users</em>)
</pre><p>Returns the usernames that are members of group
<em class="replaceable"><tt>name</em> on <em class="replaceable">server</em>to the array referenced by <em class="replaceable">users</tt></em>.
</p></div>

<div class="refentry"><table width="515" border="0" cellpadding="5"><tr><td align="left"><font size="+1"><b>GroupIsMember</b></font></td><td align="right"><i></i></td></tr></table><hr width="515" size="3" noshade="true" align="left" color="black" /><pre>
GroupIsMember (<em class="replaceable">server</em>, <em class="replaceable">name</em>, <em class="replaceable">user</em>)
</pre><p>Queries group <em class="replaceable">name</em> on
<em class="replaceable"><tt>server</tt></em> to see if
<em class="replaceable"><tt>user</tt></em> is a member. Returns true if
<em class="replaceable"><tt>user</tt></em> is a member, false if not.
</p></div>

<div class="refentry"><table width="515" border="0" cellpadding="5"><tr><td align="left"><font size="+1"><b>GroupSetAttributes</b></font></td><td align="right"><i></i></td></tr></table><hr width="515" size="3" noshade="true" align="left" color="black" /><pre>
GroupSetAttributes (<em class="replaceable">server</em>, <em class="replaceable">name</em>, <em class="replaceable">comment</em>)
</pre><p>Sets the comment for group <em class="replaceable">name</em> on
<em class="replaceable"><tt>server</tt></em> to the string provided in
<em class="replaceable"><tt>comment</tt></em>.
</p></div>

<div class="refentry"><table width="515" border="0" cellpadding="5"><tr><td align="left"><font size="+1"><b>LocalGroupAddUsers</b></font></td><td align="right"><i></i></td></tr></table><hr width="515" size="3" noshade="true" align="left" color="black" /><pre>
LocalGroupAddUsers (<em class="replaceable">server</em>, <em class="replaceable">name</em>, <em class="replaceable">users</em>)
</pre><p>Adds users to local group <em class="replaceable">name</em> on
<em class="replaceable"><tt>server</em>. <em class="replaceable">users</tt></em>can be a list of usernames or a list variable containing multiple
usernames.
</p></div>

<div class="refentry"><table width="515" border="0" cellpadding="5"><tr><td align="left"><font size="+1"><b>LocalGroupCreate</b></font></td><td align="right"><i></i></td></tr></table><hr width="515" size="3" noshade="true" align="left" color="black" /><pre>
LocalGroupCreate (<em class="replaceable">server</em>, <em class="replaceable">name</em>, <em class="replaceable">comment</em>)
</pre><p>Creates a local group with the specified
<em class="replaceable"><tt>name</em> on <em class="replaceable">server</tt></em>.
<em class="replaceable"><tt>comment</tt></em> is a string used to provide a
description about the group.
</p></div>

<div class="refentry"><table width="515" border="0" cellpadding="5"><tr><td align="left"><font size="+1"><b>LocalGroupDelete</b></font></td><td align="right"><i></i></td></tr></table><hr width="515" size="3" noshade="true" align="left" color="black" /><pre>
LocalGroupDelete (<em class="replaceable">server</em>, <em class="replaceable">name</em>)
</pre><p>Deletes a local group named <em class="replaceable">name</em> from
<em class="replaceable"><tt>server</tt></em>.
</p></div>

<div class="refentry"><table width="515" border="0" cellpadding="5"><tr><td align="left"><font size="+1"><b>LocalGroupDeleteUsers</b></font></td><td align="right"><i></i></td></tr></table><hr width="515" size="3" noshade="true" align="left" color="black" /><pre>
LocalGroupDeleteUsers (<em class="replaceable">server</em>, <em class="replaceable">name</em>, <em class="replaceable">users</em>)
</pre><p>Deletes a list of <em class="replaceable">users</em> from the local
group <em class="replaceable"><tt>name</tt></em> on
<em class="replaceable"><tt>server</tt></em>.
</p></div>

<div class="refentry"><table width="515" border="0" cellpadding="5"><tr><td align="left"><font size="+1"><b>LocalGroupGetAttributes</b></font></td><td align="right"><i></i></td></tr></table><hr width="515" size="3" noshade="true" align="left" color="black" /><pre>
LocalGroupGetAttributes (<em class="replaceable">server</em>, <em class="replaceable">name</em>, $<em class="replaceable">comment</em>)
</pre><p>Returns the comment for local group <em class="replaceable">name</em>on <em class="replaceable">server</em> to the variable
<tt class="literal">$</tt><em class="replaceable"><tt>comment</tt></em>.
</p></div>

<a name="INDEX-3304" /><a name="INDEX-3305" /><a name="INDEX-3306" /><div class="refentry"><table width="515" border="0" cellpadding="5"><tr><td align="left"><font size="+1"><b>LocalGroupGetMembers</b></font></td><td align="right"><i></i></td></tr></table><hr width="515" size="3" noshade="true" align="left" color="black" /><pre>
LocalGroupGetMembers (<em class="replaceable">server</em>, <em class="replaceable">name</em>, \@<em class="replaceable">users</em>)
</pre><p>Returns the usernames that are members of local group
<em class="replaceable"><tt>name</em> on <em class="replaceable">server</tt></em>to the array referenced by
<em class="replaceable"><tt>users</tt></em>.<a name="INDEX-3304" /><a name="INDEX-3305" /><a name="INDEX-3306" /> 
</p></div>

<div class="refentry"><table width="515" border="0" cellpadding="5"><tr><td align="left"><font size="+1"><b>LocalGroupIsMember</b></font></td><td align="right"><i></i></td></tr></table><hr width="515" size="3" noshade="true" align="left" color="black" /><pre>
LocalGroupIsMember (<em class="replaceable">server</em>, <em class="replaceable">name</em>, <em class="replaceable">user</em>)
</pre><p>Queries local group <em class="replaceable">name</em> on
<em class="replaceable"><tt>server</tt></em> to see if
<em class="replaceable"><tt>user</tt></em> is a member. Returns true if
<em class="replaceable"><tt>user</tt></em> is a member, false if not.
</p></div>

<div class="refentry"><table width="515" border="0" cellpadding="5"><tr><td align="left"><font size="+1"><b>LocalGroupSetAttributes</b></font></td><td align="right"><i></i></td></tr></table><hr width="515" size="3" noshade="true" align="left" color="black" /><pre>
LocalGroupSetAttributes (<em class="replaceable">server</em>, <em class="replaceable">name</em>, <em class="replaceable">comment</em>)
</pre><p>Sets the comment for local group <em class="replaceable">name</em> on
<em class="replaceable"><tt>server</tt></em> to the string provided in
<em class="replaceable"><tt>comment</tt></em>.
</p></div>

<a name="INDEX-3307" /><div class="refentry"><table width="515" border="0" cellpadding="5"><tr><td align="left"><font size="+1"><b>UserCreate</b></font></td><td align="right"><i></i></td></tr></table><hr width="515" size="3" noshade="true" align="left" color="black" /><table width="515" border="0" cellpadding="5"><tr><td align="left"><pre>
UserCreate (<em class="replaceable">server</em>, <em class="replaceable">username</em>, <em class="replaceable">password</em>, <em class="replaceable">passwordage</em>, <em class="replaceable">privilege</em>, 
<em class="replaceable">homedir</em>, <em class="replaceable">comment</em>, <em class="replaceable">flags</em>, <em class="replaceable">scriptpath</em>)
</pre></td><td align="right" /></tr></table><p><p><a name="INDEX-3307" />Creates a new user with the
specified settings:
</p><dl>
<dt><i><em class="replaceable"><tt>server</tt></em></i></dt>
<dd>
Name of the server</p>
</dd>


<dt><i><em class="replaceable"><tt>username</tt></em></i></dt>
<dd>
Name of new user</p>
</dd>


<dt><i><em class="replaceable"><tt>password</tt></em></i></dt>
<dd>
The user's password</p>
</dd>


<dt><i><em class="replaceable"><tt>passwordage</tt></em> </i></dt>
<dd>
Amount of time before password expires</p>
</dd>


<dt><i><em class="replaceable"><tt>privilege</tt></em></i></dt>
<dd>
Privilege settings of the new user, which can be one of the
following:
</p>


<blockquote><pre class="code">USER_PRIV_MASK 
USER_PRIV_GUEST 
USER_PRIV_USER 
USER_PRIV_ADMIN</pre></blockquote>
</dd>


<dt><i><em class="replaceable"><tt>homedir</tt></em></i></dt>
<dd>
Pathname of the user's home directory</p>
</dd>


<dt><i><em class="replaceable"><tt>comment</tt></em></i></dt>
<dd>
A string containing a comment about the user</p>
</dd>


<dt><i><em class="replaceable"><tt>flag</tt></em></i></dt>
<dd>
A flag containing user creation settings, which can be one of the
following:
</p>


<blockquote><pre class="code">UF_TEMP_DUPLICATE_ACCOUNT 
UF_NORMAL_ACCOUNT 
UF_INTERDOMAIN_TRUST_ACCOUNT 
UF_WORKSTATION_TRUST_ACCOUNT 
UF_SERVER_TRUST_ACCOUNT 
UF_MACHINE_ACCOUNT_MASK 
UF_ACCOUNT_TYPE_MASK 
UF_DONT_EXPIRE_PASSWD 
UF_SETTABLE_BITS 
UF_SCRIPT 
UF_ACCOUNTDISABLE 
UF_HOMEDIR_REQUIRED 
UF_LOCKOUT 
UF_PASSWD_NOTREQD 
UF_PASSWD_CANT_CHANGE</pre></blockquote>
</dd>


<dt><i><em class="replaceable"><tt>scriptpath</tt></em></i></dt>
<dd>
Pathname for the user's login script</p>
</dd>

</dl></div>

<div class="refentry"><table width="515" border="0" cellpadding="5"><tr><td align="left"><font size="+1"><b>UserDelete</b></font></td><td align="right"><i></i></td></tr></table><hr width="515" size="3" noshade="true" align="left" color="black" /><pre>
UserDelete (<em class="replaceable">server</em>, <em class="replaceable">username</em>)
</pre><p>Deletes a user with <em class="replaceable">username</em> from
<em class="replaceable"><tt>server</tt></em>.
</p></div>

<div class="refentry"><table width="515" border="0" cellpadding="5"><tr><td align="left"><font size="+1"><b>UserGetAttributes</b></font></td><td align="right"><i></i></td></tr></table><hr width="515" size="3" noshade="true" align="left" color="black" /><pre>
UserGetAttributes (<em class="replaceable">server</em>, <em class="replaceable">username</em>, $<em class="replaceable">password</em>, $<em class="replaceable">passwordage</em>, $<em class="replaceable">privilege</em>, $<em class="replaceable">homedir</em>, $<em class="replaceable">comment</em>, $<em class="replaceable">flags</em>, $<em class="replaceable">scriptpath</em>)
</pre><p>Retrieves information from a user profile for the user identified by
<em class="replaceable"><tt>username</tt></em> on
<em class="replaceable"><tt>server</tt></em> and stores each piece in the
corresponding variables you provide as arguments. The elements and
order of user information are the same as described in the
<tt class="literal">UserCreate</tt> function.
</p></div>

<div class="refentry"><table width="515" border="0" cellpadding="5"><tr><td align="left"><font size="+1"><b>UserSetAttributes</b></font></td><td align="right"><i></i></td></tr></table><hr width="515" size="3" noshade="true" align="left" color="black" /><pre>
UserSetAttributes (<em class="replaceable">server</em>, <em class="replaceable">username</em>, <em class="replaceable">password</em>, <em class="replaceable">passwordage</em>, <em class="replaceable">privilege</em>, <em class="replaceable">homedir</em>, <em class="replaceable">comment</em>, <em class="replaceable">flags</em>, <em class="replaceable">scriptpath</em>)
</pre><p>Sets attributes for user <em class="replaceable">username</em> on
<em class="replaceable"><tt>server</tt></em>. The attributes are those described
for the <tt class="literal">UserCreate</tt> function.
</p></div>

<hr width="684" align="left" />
<div class="navbar"><table width="684" border="0"><tr><td align="left" valign="top" width="228"><a href="ch22_09.htm"><img src="../gifs/txtpreva.gif" alt="Previous" border="0" /></a></td><td align="center" valign="top" width="228"><a href="index.htm"><img src="../gifs/txthome.gif" alt="Home" border="0" /></a></td><td align="right" valign="top" width="228"><a href="ch22_11.htm"><img src="../gifs/txtnexta.gif" alt="Next" border="0" /></a></td></tr><tr><td align="left" valign="top" width="228">22.9. Win32::Mutex</td><td align="center" valign="top" width="228"><a href="index/index.htm"><img src="../gifs/index.gif" alt="Book Index" border="0" /></a></td><td align="right" valign="top" width="228">22.11. Win32::NetResource</td></tr></table></div>
<hr width="684" align="left" />

<img src="../gifs/navbar.gif" usemap="#library-map" border="0" alt="Library Navigation Links" />
<p><p><font size="-1"><a href="copyrght.htm">Copyright &copy; 2002</a> O'Reilly &amp; Associates. All rights reserved.</font></p>

<map name="library-map">
<area shape="rect" coords="1,0,85,94" href="../index.htm"><area shape="rect" coords="86,1,178,103" href="../lwp/index.htm"><area shape="rect" coords="180,0,265,103" href="../lperl/index.htm"><area shape="rect" coords="267,0,353,105" href="index.htm"><area shape="rect" coords="354,1,446,115" href="../prog/index.htm"><area shape="rect" coords="448,0,526,132" href="../tk/index.htm"><area shape="rect" coords="528,1,615,119" href="../cookbook/index.htm"><area shape="rect" coords="617,0,690,135" href="../pxml/index.htm">
</map>

</body></html>